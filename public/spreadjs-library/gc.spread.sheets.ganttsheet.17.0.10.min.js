/*!
 * 
 * SpreadJS Library 17.0.10
 *
 * Copyright(c) GrapeCity Software inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * info.xa@grapecity.com
 * https://www.grapecity.com.cn/developer/spreadjs
 *
 */
!function(t){"object"==typeof module&&"object"==typeof module.exports?module.exports=t(require("@grapecity-software/spread-sheets")):"function"==typeof define&&define.amd?define(["@grapecity-software/spread-sheets"],t):"object"==typeof exports?exports.Spread=t(require("@grapecity-software/spread-sheets")):t(GC)}(function(n){!function(){"use strict";var i,e,t;function s(t){var n,n,n=e[t];return void 0!==n||(n=e[t]={exports:{}},i[t].call(n.exports,n,n.exports,s)),n.exports}i={"./dist/plugins/gantt/celltypes/complete.js":function(t,n,i){var e,s,i,r,u,o,i,h,a;function c(){var t=a.call(this)||this;return t.typeName="100",t}e=this&&this.__extends||(h=function(t,n){return(h=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}h(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.TaskCompleteCellType=void 0,s=i("Core"),i=i("./dist/plugins/gantt/celltypes/numberInput.base.js"),r=Math.floor,u=Math.ceil,o=Math.round,a=i.NumberInputCellType,e(c,a),c.prototype.getChangedValue=function(t){var n,i,e,t,n,n=t.sheet,i=t.row,e=t.col,t=t.isReservedOnButton,n=n.getValue(i,e);return"Up"===t?n=(5*r(o(100*n)/5)+5)/100:"Down"===t&&(n=(5*u(o(100*n)/5)-5)/100),n=n<0?0:n},n.TaskCompleteCellType=i=c,s.CellTypes.ti[100]=i},"./dist/plugins/gantt/celltypes/date.js":function(t,n,i){var e,o,s,i,i,h,u,i,r,a,c;function f(t,n,i){var t=a.call(this,t)||this;return t.sAi=n,t.rAi=i,t}function l(t){var n=c.call(this)||this;return n.typeName="101",n.hAi=!!t,n}e=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.TaskDateCellType=void 0,o=i("Common"),s=i("Core"),i=i("./dist/plugins/gantt/gantt.ns.js"),i=new o.Common.ResourceManager(i.SR,"GanttSheet"),h=i.getResource.bind(i),a=o.Formatter.GeneralFormatter,e(f,a),f.prototype.parse=function(t){var n,i,e,s,t,n=a.prototype.parse.call(this,t);if(n instanceof Date)if(0===n.getHours()&&0===n.getMinutes()&&0===n.getSeconds()&&0===n.getMilliseconds())try{i=this.sAi,e=t+" ".concat(i.hour,":").concat(i.minute),(s=a.prototype.parse.call(this,e))instanceof Date&&(n=s)}catch(t){}else 1899===n.getFullYear()&&11===n.getMonth()&&30===n.getDate()&&(t=this.rAi,n.setFullYear(t.getFullYear()),n.setMonth(t.getMonth()),n.setDate(t.getDate()));return n},u=f,c=s.CellTypes.Text,e(l,c),Object.defineProperty(l.prototype,"forStartDate",{get:function(){return this.hAi},set:function(t){this.hAi=t},enumerable:!1,configurable:!0}),l.prototype.getDefaultTime=function(t){return this.hAi?{hour:8,minute:0}:{hour:17,minute:0}},l.prototype.getDefaultDate=function(t){return new Date},l.prototype.parse=function(t,n,i){var n,n,e,s,r,u,t,n="string"==typeof n?n:h().DEFAULT_DATE_TIME_FORMAT,n=new o.Formatter.GeneralFormatter(n),e=n.parse(t);if(e instanceof Date&&0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()&&0===e.getMilliseconds())try{s=this.getDefaultTime(i),r=t+" ".concat(s.hour,":").concat(s.minute),(u=n.parse(r))instanceof Date&&(e=u)}catch(t){}else 1899===e.getFullYear()&&11===e.getMonth()&&30===e.getDate()&&(t=this.getDefaultDate(i),e.setFullYear(t.getFullYear()),e.setMonth(t.getMonth()),e.setDate(t.getDate()));return e},l.prototype.format=function(t,n,i,e){var n,s,n="string"==typeof n?n:h().DEFAULT_DATE_TIME_FORMAT,s;return new o.Formatter.GeneralFormatter(n).format(t)},l.prototype.je=function(t,n,i,e){var n,n,s,r,n=n.formatter,n="string"==typeof n?n:h().DEFAULT_DATE_TIME_FORMAT,s=this.getDefaultTime(e),r=this.getDefaultDate(e);return t.Ii=new u(n,s,r),this.format(i,n,null,e)},n.TaskDateCellType=i=l,s.CellTypes.ti[101]=i},"./dist/plugins/gantt/celltypes/duration.js":function(t,n,i){var e,s,r,i,i,u,o;function h(t){var t=o.call(this,t=void 0===t?!0:t)||this;return t.typeName="102",t}e=this&&this.__extends||(u=function(t,n){return(u=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.TaskDurationCellType=void 0,s=i("Core"),r=i("./dist/plugins/gantt/project/calendar.js"),i=i("./dist/plugins/gantt/celltypes/numberInput.base.js"),o=i.NumberInputCellType,e(h,o),h.prototype.oAi=function(t){if(t&&t.sheet&&t.sheet.NMi)return t.sheet.NMi.project},h.prototype.cAi=function(t){return t.row},h.prototype.parse=function(t,n,i){var i=this.oAi(i);return i?i.parseDuration(t):t},h.prototype.format=function(t,n,i,e){var e=this.oAi(e);return e?e.formatDuration(t):t},h.prototype.je=function(t,n,i,e){var e=this.oAi(e);return e?e.formatDuration(i):i},h.prototype.getChangedValue=function(t){var n,i,e,s,n=this.oAi(t),i=t.sheet.getValue(t.row,t.col);if(n)return i=(i=n.parseDuration(i))?(e=i.value,s=i.unit,"Up"===t.isReservedOnButton?e=Math.floor(e+1):"Down"===t.isReservedOnButton&&(e=Math.max(Math.ceil(e-1),0)),{value:e,unit:s}):r.DurationHelper.default(n.calendarSettings),i=n.parseDuration(i)},n.TaskDurationCellType=i=h,s.CellTypes.ti[102]=i},"./dist/plugins/gantt/celltypes/numberInput.base.js":function(t,n,i){var e,c,s,r,u,o,h,a,f,l,d,A;function v(t){void 0===t&&(t=!0);var n=A.call(this)||this;return n.showButton=t,n.aAi="None",n.typeName="NumberInput",n}function g(){this.isReservedOnButton="None"}function b(t,n,i,e,s){var r,u,r;if(t.getCellType(n,i,s)instanceof a){e&&t.Ut.do("setValueForKey",n,i,h,!0,s);try{u=t.getCellRect(n,i,s),t.repaint(u)}finally{e&&t.Ut.do("setValueForKey",n,i,h,void 0,s)}}}e=this&&this.__extends||(d=function(t,n){return(d=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}d(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.NumberInputCellType=n.NumberInputCellHitInfo=void 0,c=i("Core"),r=3,u=s=5,o=8,h="_leaveCell",A=c.CellTypes.Text,e(v,A),v.prototype.paint=function(t,n,i,e,s,r,u,o){var h,a,h=this.isCurrentCellSelected(o.sheet,o.row,o.col),a=u.hAlign;h&&(u.hAlign=c.HorizontalAlign.left),A.prototype.paint.call(this,t,n,i,e,s,r,u,o),h&&this.showButton&&this.paintButtons(t,i,e,s,r,o),u.hAlign=a},v.prototype.isCurrentCellSelected=function(t,n,i){var e=t.Ut.getValueForKey(n,i,h);return t.getActiveRowIndex()===n&&t.getActiveColumnIndex()===i&&!0!==e},v.prototype.paintButtons=function(t,n,i,e,s,r){this.drawTriangleUp(t,n+e-8-5,i+(s-6-5)/2,5,3,r),this.drawTriangleDown(t,n+e-8-5,i+(s-6-5)/2+3+5,5,3,r)},v.prototype.drawTriangleUp=function(t,n,i,e,s,r){var u="Up"===this.aAi?"black":"gray";t.beginPath(),t.moveTo(n+e/2,i),t.lineTo(n,i+s),t.lineTo(n+e,i+s),t.lineTo(n+e/2,i),t.closePath(),t.strokeStyle=u,t.stroke(),t.fillStyle=u,t.fill()},v.prototype.drawTriangleDown=function(t,n,i,e,s,r){var u="Down"===this.aAi?"black":"gray";t.beginPath(),t.moveTo(n,i),t.lineTo(n+e/2,i+s),t.lineTo(n+e,i),t.lineTo(n,i),t.closePath(),t.strokeStyle=u,t.stroke(),t.fillStyle=u,t.fill()},v.prototype.getButtonHoveredByHitInfo=function(t){var n,i,e,s,n,n=t.cellRect,i=t.x,e=t.y,s=new c.Rect(n.x+n.width-8-5-1,n.y,7,n.height/2),n=new c.Rect(n.x+n.width-8-5-1,n.y+n.height/2,7,n.height/2);return t.sheet.getActiveRowIndex()===t.row&&t.sheet.getActiveColumnIndex()===t.col&&this.showButton?s.contains(i,e)?"Up":n.contains(i,e)?"Down":"None":"None"},v.prototype.refreshButtonHoverEffect=function(t,n,i){(this.aAi!==n||this.fAi&&this.fAi!==i)&&(this.aAi=n,"None"===this.aAi&&this.fAi?(t.repaint(this.fAi),delete this.fAi):(t.repaint(i),this.fAi=i))},v.prototype.getHitInfo=function(t,n,i,e,s){var r,r;if(s&&(null==(r=s.sheetArea)||3===r))return(r={x:t,y:n,row:s.row,col:s.col,cellRect:e,sheetArea:c.SheetArea.viewport,isReservedLocation:!1,sheet:s.sheet,cellStyle:i,isReservedOnButton:"None"}).isReservedOnButton=this.getButtonHoveredByHitInfo(r),r},v.prototype.processMouseMove=function(t){var n;if(t)return n=t.cellRect,this.refreshButtonHoverEffect(t.sheet,t.isReservedOnButton,n),A.prototype.processMouseMove.call(this,t)},v.prototype.getChangedValue=function(t){},v.prototype.processMouseDown=function(t){var n;if(t&&(t.row===t.sheet.getActiveRowIndex()&&t.col===t.sheet.getActiveColumnIndex()&&"None"!==t.isReservedOnButton))return n=this.getChangedValue(t),t.sheet.setValue(t.row,t.col,n),A.prototype.processMouseDown.call(this,t)},v.prototype.processMouseLeave=function(t){return this.refreshButtonHoverEffect(t.sheet,t.isReservedOnButton,t.cellRect),!1},v.prototype.getAutoFitWidth=function(t,n,i,e,s){var r;return A.prototype.getAutoFitWidth.call(this,t,n,i,e,s)+5+16},v.prototype.getAutoFitHeight=function(t,n,i,e,s){var t=A.prototype.getAutoFitHeight.call(this,t,n,i,e,s);return Math.max(t,18)},v.prototype.toJSON=function(){return{typeName:this.typeName}},a=v,n.NumberInputCellType=a,n.NumberInputCellHitInfo=g,c.Worksheet.ch(l="numberInputCellType",{setHost:function(){var i=this;i.bind(c.Events.EnterCell+"."+l,function(t,n){b(i,n.row,n.col,!1,n.sheetArea)}),i.bind(c.Events.LeaveCell+"."+l,function(t,n){b(i,n.row,n.col,!0,n.sheetArea)}),i.bind(c.Events.TopRowChanged+"."+l,function(t,n){b(i,n.row,n.col,!0,n.sheetArea)})},dispose:function(t){var n=this;n.unbind(c.Events.EnterCell+"."+l),n.unbind(c.Events.LeaveCell+"."+l),n.unbind(c.Events.TopRowChanged+"."+l)}})},"./dist/plugins/gantt/celltypes/predecessor.js":function(t,n,i){var e,c,o,i,h,a,i,f,s,r,u,l,d,A,v;function g(){var t=v.call(this)||this;return t.typeName="103",t}function b(t,n){var e=this;this.globalMousedownEventHandler=function(t){var n,i;if(e.rf){for(i=n=t.target;i&&i!==e.Wc;)i=i.parentElement;i||(e.close(),t.stopPropagation(),t.preventDefault())}},this.windowResizeEventHandler=function(){e.rf&&e.close()},this.rf=!1,this.lAi=t,this.LEt=n,this.AAi=this.getOriginalValueMap()}function m(){return{canUndo:!1,execute:function(t,n){var i,t,e,s,r,u,i=(0,c._f)(t,n.sheetName);return!!(i&&t.jg().name()===n.sheetName&&i.NMi instanceof o.GanttSheet)&&(t=n.row,e=n.col,(h(t)||h(e))&&(n.row=t=i.getActiveRowIndex(),n.col=e=i.getActiveColumnIndex()),s=n.sheetArea,h(s)&&(n.sheetArea=s=3),(r=i.getCellType(t,e,s))instanceof a)&&(i.showCell(t,e,c.VerticalPosition.nearest,c.HorizontalPosition.nearest),(u=new d(i.NMi,n)).open(),!0)}}}e=this&&this.__extends||(A=function(t,n){return(A=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}A(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.TaskPredecessorCellType=void 0,c=i("Core"),o=i("./dist/plugins/gantt/gantt-sheet.js"),i=i("Common"),h=i.Common.lt.ht,v=c.CellTypes.Text,e(g,v),g.prototype.toJSON=function(){return{typeName:this.typeName}},a=g,n.TaskPredecessorCellType=a,c.CellTypes.ti[103]=a,i="taskPredecessorCellType",f="data-task-number",s="OpenPredecessor",r="ribbon-dropdowngroup-popup",u="_cellButtonParam",l=window.gcGlobal,Object.defineProperty(b.prototype,"sheet",{get:function(){return this.lAi.Mf},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"project",{get:function(){return this.lAi.project},enumerable:!1,configurable:!0}),b.prototype.open=function(){this.rf||(l.ef(),this.bindEvent(),this.render(),this.clearPosition(),this.calcPosition(),this.scrollListToCurrentItem(),this.attachExpandButtonClick(),this.rf=!0,this.Wc.tabIndex=-1,this.Wc.style.cssText+="outline:none",this.Wc.focus())},b.prototype.dispose=function(){var n=this;document.removeEventListener("resize",this.windowResizeEventHandler),"mousedown touchstart MSPointerDown pointerdown".split(" ").forEach(function(t){document.removeEventListener(t,n.globalMousedownEventHandler,!0)}),this.Ti.parentElement.removeChild(this.Ti),this.Ti=null},b.prototype.close=function(){if(this.rf){this.rf=!1;try{this.setValue()}catch(t){}finally{this.dispose(),this.gAi(),l.cf()}}},b.prototype.gAi=function(){var t,n,i,e,e,t=this.LEt.row,n=this.LEt.col,i=this.LEt.sheetArea,e=this.sheet.Il(t,n,i).cellButtons;this.sheet&&e&&0<e.length&&(e=this.sheet.Ut.getValueForKey(t,n,u,i))&&e.isMouseDownReservedLocation&&(e.buttonDownIndex=-1,e.isMouseDownReservedLocation=!1,this.sheet.repaint(this.sheet.getCellRect(t,n)))},b.prototype.bindEvent=function(){var n=this;"mousedown touchstart MSPointerDown pointerdown".split(" ").forEach(function(t){document.addEventListener(t,n.globalMousedownEventHandler,!0)}),document.addEventListener("resize",this.windowResizeEventHandler)},b.prototype.render=function(){this.Ti=document.createElement("div"),this.Ti.style.cssText="position:absolute; z-index:10000; box-shadow:rgba(0, 0, 0, 0.4) 2px 4px 5px; outline:none",this.Ti.classList.add(r),this.Wc=document.createElement("div"),this.renderList(),this.Ti.appendChild(this.Wc),this.sheet.qc().appendChild(this.Ti)},b.prototype.renderList=function(){var t,n;this.Wc.classList.add("gc-list-control"),this.Wc.style.outline="none",(t=document.createElement("div")).className="gc-list-control-container gc-list-alignment-vertical",t.style.maxHeight="300px",t.style.maxWidth="500px",t.style.overflow="auto",this.Wc.appendChild(t),n=this.project.root,this.renderTaskTree(n,t)},b.prototype.scrollListToCurrentItem=function(){var t,t,t,t=this.project.getRowState(this.LEt.row).taskNumber,t=document.querySelector("[".concat(f,'="').concat(t,'"]'));t&&(t=t.parentElement.parentElement.offsetTop,document.querySelector(".gc-list-control-container").scrollTop=t)},b.prototype.attachExpandButtonClick=function(){var i=this;this.Wc.addEventListener("click",function(t){var n=t.target;n.hasAttribute("data-open")&&(i.setButtonExpandStatus(n,"false"===n.getAttribute("data-open")),t.preventDefault(),t.stopImmediatePropagation())})},b.prototype.renderTaskTree=function(t,n){var i,e,s,r,i=this,e=this.project.Lji(t),s=document.createElement("div");s.className="gc-list-control-tree",n.appendChild(s),e||this.renderTaskItem(t,!0,s),(r=document.createElement("div")).className="gc-list-control-tree-content gc-list-alignment-vertical",e||(r.style.marginLeft="1.5em"),s.appendChild(r),t.children.forEach(function(t){0<t.children.length?i.renderTaskTree(t,r):i.renderTaskItem(t,!1,r)})},b.prototype.renderTaskItem=function(t,n,i){var e,s,r,u,n,n,e,n,e=this.project.getRowState(this.LEt.row).task,s=Object.keys(this.AAi).map(function(t){return parseInt(t)}),r=document.createElement("div");r.classList.add("gc-list-control-item"),n&&r.classList.add("gc-list-control-hassubitem"),(u=document.createElement("label")).setAttribute("for","task-".concat(t.taskNumber)),u.className="gc-list-control-tree-text",u.style.display="flex",u.style.alignItems="center",n&&((n=document.createElement("span")).style.display="inline-flex",n.style.transition="0.2s linear",n.style.borderLeft="5px solid transparent",n.style.borderRight="5px solid transparent",n.style.borderTop="6px solid #000",this.setButtonExpandStatus(n,!0),u.appendChild(n)),e&&e.taskNumber===t.taskNumber?((n=document.createElement("span")).id="task-".concat(t.taskNumber),n.style.width="23px",n.style.height="18px",n.style.display="inline-block",n.setAttribute(f,t.taskNumber.toString()),u.appendChild(n),u.style.backgroundColor="#E1E1E1",u.style.cursor="default"):((e=document.createElement("input")).id="task-".concat(t.taskNumber),e.type="checkbox",e.style.marginLeft="5px",e.style.marginRight="5px",e.setAttribute(f,t.taskNumber.toString()),-1<s.indexOf(t.taskNumber)&&(e.checked=!0),u.appendChild(e)),(n=document.createElement("span")).innerText="".concat(t.taskNumber,"  ").concat(t.name||""),this.setTextSpanEllipsis(n),u.appendChild(n),r.appendChild(u),i.appendChild(r)},b.prototype.setButtonExpandStatus=function(t,n){for(var i=t;i&&!i.classList.contains("gc-list-control-tree");)i=i.parentElement;n?(t.style.removeProperty("transform"),t.setAttribute("data-open","true"),i&&i.classList.remove("hide-children")):(t.style.transform="rotate(-90deg)",t.setAttribute("data-open","false"),i&&i.classList.add("hide-children"))},b.prototype.setTextSpanEllipsis=function(t){t.style.overflow="hidden",t.style.textOverflow="ellipsis",t.style.whiteSpace="nowrap",t.title=t.innerText},b.prototype.clearPosition=function(){this.Ti.style.top=this.Ti.style.bottom=this.Ti.style.left=this.Ti.style.right=""},b.prototype.getTargetRect=function(){var t,n,t,t=1===this.LEt.sheetArea?-1:void 0,n=2===this.LEt.sheetArea?-1:void 0,t=this.sheet.getCellRect(this.LEt.row,this.LEt.col,t,n);return t.x=this.sheet.uw().left+t.x,t.y=this.sheet.uw().top+t.y,t},b.prototype.calcPosition=function(){var t,n,i,n,e,s,e,t=this.calculateDropDownLocation(),n=this.Ti.offsetParent,i=n.getBoundingClientRect(),n=n===document.body,e=document.documentElement,s=(window.pageXOffset||e.scrollLeft)-(e.clientLeft||0),e=(window.pageYOffset||e.scrollTop)-(e.clientTop||0);this.Ti.style.left="".concat(t.x-(n?-s:i.left),"px"),this.Ti.style.top="".concat(t.y-(n?-e:i.top),"px")},b.prototype.calculateDropDownLocation=function(){var t,n,i,e,n,s,r,u,o,h,a,i,t=new c.Rect(0,0,window.innerWidth,window.innerHeight),n=this.getTargetRect(),i=n.x+n.width,e=n.y,n=n.y+n.height,s=t.height-n,r=!0,u=this.Wc.offsetHeight,o=this.Wc.offsetWidth,a=0;return(i=new c.Rect(h=i-o,a=(r=s<u?!1:r)?n:e-u,o,u)).width>t.width?i.x=0:(i.x=Math.max(i.x,0),i.x=Math.min(i.x,t.width-i.width)),i.height>t.height?i.y=0:(i.y=Math.max(i.y,0),i.y=Math.min(i.y,t.height-i.height)),{x:i.x,y:i.y}},b.prototype.getOriginalValueMap=function(){var t,i,e,t=this.sheet.getValue(this.LEt.row,this.LEt.col),i=/^(\d*)[^\d]*$/,e={};return t?(t.split(",").forEach(function(t){var n;t.match(i)&&(n=t.match(i)[1],e[n]=t.match(i)[0])}),e):{}},b.prototype.getSelectedValuesInList=function(){var n,t,i,n=this.AAi,t=this.Wc.querySelectorAll(".gc-list-control-item input:checked"),i=[];return t.forEach(function(t){var t=parseInt(t.getAttribute(f));n[t]?i.push(n[t]):i.push(t.toString())}),i.join(",")},b.prototype.setValue=function(){var t,n,i,e,s,r,u,s,o,s,t=this.sheet,n=this.getSelectedValuesInList(),i=this.LEt.row,e=this.LEt.col,s=this.LEt.sheetArea;t.isEditing()&&t.ci===e&&t.ui===i?(r=t.getCellType(i,e),u={sheet:t,row:i,col:e,sheetArea:s},s=t.Il(i,e,s),o=t.getCellRect(i,e),r.updateEditor(t.li,s,o,u),r.setEditorValue(t.li,n,u)):(s=t.getValue(i,e),h(s)&&""===n||n!==s&&t.setValue(i,e,n))},d=b,c.Workbook.ch(i,{init:function(){this.commandManager().register(s,m())}})},"./dist/plugins/gantt/celltypes/resources.js":function(t,n,i){var e,c,o,i,h,a,i,f,s,r,u,l,d,A,v;function g(){var t=v.call(this)||this;return t.typeName="104",t}function b(t,n){var e=this;this.globalMousedownEventHandler=function(t){var n,i;if(e.rf){for(i=n=t.target;i&&i!==e.Wc;)i=i.parentElement;i||(e.close(),t.stopPropagation(),t.preventDefault())}},this.windowResizeEventHandler=function(){e.rf&&e.close()},this.rf=!1,this.lAi=t,this.LEt=n,this.AAi=this.getOriginalValueMap()}function m(){return{canUndo:!1,execute:function(t,n){var i,t,e,s,r,u,i=(0,c._f)(t,n.sheetName);return!!(i&&t.jg().name()===n.sheetName&&i.NMi instanceof o.GanttSheet)&&(t=n.row,e=n.col,(h(t)||h(e))&&(n.row=t=i.getActiveRowIndex(),n.col=e=i.getActiveColumnIndex()),s=n.sheetArea,h(s)&&(n.sheetArea=s=3),(r=i.getCellType(t,e,s))instanceof a)&&(i.showCell(t,e,c.VerticalPosition.nearest,c.HorizontalPosition.nearest),(u=new d(i.NMi,n)).open(t),!0)}}}e=this&&this.__extends||(A=function(t,n){return(A=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}A(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.TaskResourcesCellType=void 0,c=i("Core"),o=i("./dist/plugins/gantt/gantt-sheet.js"),i=i("Common"),h=i.Common.lt.ht,v=c.CellTypes.Text,e(g,v),g.prototype.toJSON=function(){return{typeName:this.typeName}},a=g,n.TaskResourcesCellType=a,c.CellTypes.ti[104]=a,i="taskResourcesCellType",f="data-resource-id",s="OpenResources",r="ribbon-dropdowngroup-popup",u="_cellButtonParam",l=window.gcGlobal,Object.defineProperty(b.prototype,"sheet",{get:function(){return this.lAi.Mf},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"project",{get:function(){return this.lAi.project},enumerable:!1,configurable:!0}),b.prototype.open=function(t){var t,n,i,t;if(!this.rf){if(t=this.lAi.getTaskByRow(t),i=(n=this.project.host.getDataView()).gLt.primaryKey(),t=t.getDataValue(i),h(t))return!1;l.ef(),this.bindEvent(),this.render(),this.clearPosition(),this.calcPosition(),this.rf=!0,this.Wc.tabIndex=-1,this.Wc.style.cssText+="outline:none",this.Wc.focus()}},b.prototype.dispose=function(){var n=this;document.removeEventListener("resize",this.windowResizeEventHandler),"mousedown touchstart MSPointerDown pointerdown".split(" ").forEach(function(t){document.removeEventListener(t,n.globalMousedownEventHandler,!0)}),this.Ti.parentElement.removeChild(this.Ti),this.Ti=null},b.prototype.close=function(){if(this.rf){this.rf=!1;try{this.setValue()}catch(t){}finally{this.dispose(),this.gAi(),l.cf()}}},b.prototype.gAi=function(){var t,n,i,e,e,t=this.LEt.row,n=this.LEt.col,i=this.LEt.sheetArea,e=this.sheet.Il(t,n,i).cellButtons;this.sheet&&e&&0<e.length&&(e=this.sheet.Ut.getValueForKey(t,n,u,i))&&e.isMouseDownReservedLocation&&(e.buttonDownIndex=-1,e.isMouseDownReservedLocation=!1,this.sheet.repaint(this.sheet.getCellRect(t,n)))},b.prototype.bindEvent=function(){var n=this;"mousedown touchstart MSPointerDown pointerdown".split(" ").forEach(function(t){document.addEventListener(t,n.globalMousedownEventHandler,!0)}),document.addEventListener("resize",this.windowResizeEventHandler)},b.prototype.render=function(){this.Ti=document.createElement("div"),this.Ti.style.cssText="position:absolute; z-index:10000; box-shadow:rgba(0, 0, 0, 0.4) 2px 4px 5px; outline:none",this.Ti.classList.add(r),this.Wc=document.createElement("div"),this.renderList(),this.Ti.appendChild(this.Wc),this.sheet.qc().appendChild(this.Ti)},b.prototype.renderList=function(){var t,n,i;for(this.Wc.classList.add("gc-list-control"),this.Wc.style.outline="none",(t=document.createElement("div")).className="gc-list-control-container gc-list-alignment-vertical",t.style.maxHeight="300px",t.style.maxWidth="500px",t.style.overflow="auto",this.Wc.appendChild(t),n=this.project.resourcesManager.resourcesList,i=0;i<n.length;i++)this.renderResource(n[i],t)},b.prototype.renderResource=function(t,n){var i=document.createElement("div");i.className="gc-list-control-tree",n.appendChild(i),this.renderResourceItem(t,!0,i)},b.prototype.renderResourceItem=function(t,n,i){var e,t,s,r,n,u,s,e=t.id,t=t.name,s=Object.keys(this.AAi),r=document.createElement("div");r.classList.add("gc-list-control-item"),n&&r.classList.add("gc-list-control-hassubitem"),(n=document.createElement("label")).setAttribute("for","resource-".concat(e)),n.className="gc-list-control-tree-text",n.style.display="flex",n.style.alignItems="center",(u=document.createElement("input")).id="resource-".concat(e),u.type="checkbox",u.style.marginLeft="5px",u.style.marginRight="5px",u.setAttribute(f,e.toString()||""),-1<s.indexOf(e.toString())&&(u.checked=!0),n.appendChild(u),(s=document.createElement("span")).innerText="".concat(t||""),this.setTextSpanEllipsis(s),n.appendChild(s),r.appendChild(n),i.appendChild(r)},b.prototype.setTextSpanEllipsis=function(t){t.style.overflow="hidden",t.style.textOverflow="ellipsis",t.style.whiteSpace="nowrap",t.title=t.innerText},b.prototype.clearPosition=function(){this.Ti.style.top=this.Ti.style.bottom=this.Ti.style.left=this.Ti.style.right=""},b.prototype.getTargetRect=function(){var t,n,t,t=1===this.LEt.sheetArea?-1:void 0,n=2===this.LEt.sheetArea?-1:void 0,t=this.sheet.getCellRect(this.LEt.row,this.LEt.col,t,n);return t.x=this.sheet.uw().left+t.x,t.y=this.sheet.uw().top+t.y,t},b.prototype.calcPosition=function(){var t,n,i,n,e,s,e,t=this.calculateDropDownLocation(),n=this.Ti.offsetParent,i=n.getBoundingClientRect(),n=n===document.body,e=document.documentElement,s=(window.pageXOffset||e.scrollLeft)-(e.clientLeft||0),e=(window.pageYOffset||e.scrollTop)-(e.clientTop||0);this.Ti.style.left="".concat(t.x-(n?-s:i.left),"px"),this.Ti.style.top="".concat(t.y-(n?-e:i.top),"px")},b.prototype.calculateDropDownLocation=function(){var t,n,i,e,n,s,r,u,o,h,a,i,t=new c.Rect(0,0,window.innerWidth,window.innerHeight),n=this.getTargetRect(),i=n.x+n.width,e=n.y,n=n.y+n.height,s=t.height-n,r=!0,u=this.Wc.offsetHeight,o=this.Wc.offsetWidth,a=0;return(i=new c.Rect(h=i-o,a=(r=s<u?!1:r)?n:e-u,o,u)).width>t.width?i.x=0:(i.x=Math.max(i.x,0),i.x=Math.min(i.x,t.width-i.width)),i.height>t.height?i.y=0:(i.y=Math.max(i.y,0),i.y=Math.min(i.y,t.height-i.height)),{x:i.x,y:i.y}},b.prototype.getOriginalValueMap=function(){var i,t,e,i=this,t=this.sheet.getValue(this.LEt.row,this.LEt.col),e={};return t?(t.forEach(function(t){var n=i.project.resourcesManager.getResourcesByName(t).id;e[n]=t}),e):{}},b.prototype.getSelectedValuesInList=function(){var n,i,t,e,n=this,i=this.AAi,t=this.Wc.querySelectorAll(".gc-list-control-item input:checked"),e=[];return t.forEach(function(t){var t,t,t=parseInt(t.getAttribute(f));i[t]?e.push(i[t]):(t=n.project.resourcesManager.getResourcesById(t),e.push(t.name))}),e},b.prototype.setValue=function(){var t,n,i,e,t=this.sheet,n=this.getSelectedValuesInList(),i=this.LEt.row,e=this.LEt.col;t.setValue(i,e,n)},d=b,c.Workbook.ch(i,{init:function(){this.commandManager().register(s,m())}})},"./dist/plugins/gantt/celltypes/subject.js":function(t,n,i){var e,i,e,s,r;function u(){var t=r.call(this)||this;return t.typeName="105",t}e=this&&this.__extends||(s=function(t,n){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.TaskSubjectCellType=void 0,i=i("Core"),r=i.CellTypes.Text,e(u,r),u.prototype.cAi=function(t){return t.row},u.prototype.toJSON=function(){return{typeName:this.typeName}},n.TaskSubjectCellType=e=u,i.CellTypes.ti[105]=e},"./dist/plugins/gantt/celltypes/taskbar.js":function(t,n,i){var e,s,c,r,u,o,l,i,i,h,a,i,f,e,d,A;function v(t){this.className=t}function g(t){void 0===t&&(t=0);var n=A.call(this)||this;return n.typeName="106",n.IOProps=["typeName","leftTextStyle","topTextStyle","rightTextStyle","bottomTextStyle","insideTextStyle","showDefaultTips","allowMoveOrResizeTask","allowLinkTask","allowChangeProgress","allowDragNewTask"],n.leftTextStyle={},n.topTextStyle={},n.rightTextStyle={},n.bottomTextStyle={},n.insideTextStyle={},n.showDefaultTips=!0,n.allowMoveOrResizeTask=!0,n.allowLinkTask=!0,n.allowChangeProgress=!0,n.allowDragNewTask=!0,n.dAi=t,n}e=this&&this.__extends||(d=function(t,n){return(d=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}d(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.TaskbarCellType=n.TipSettings=void 0,s=i("Common"),c=i("Core"),r=i("./dist/plugins/gantt/utils/util.js"),u=i("./dist/plugins/gantt/gantt-json.js"),o=i("./dist/plugins/gantt/taskbar/action.js"),l=i("./dist/plugins/gantt/gantt.enum.js"),i=i("./dist/plugins/gantt/gantt.ns.js"),i=new s.Common.ResourceManager(i.SR,"GanttSheet"),h=i.getResource.bind(i),a=c.mt.vi,i=c.CellTypes.Base,v.prototype.getContent=function(){return'\n        <div class="'.concat(this.className,'" style="padding:4px;font-size:14px;color:black;max-width:500px">\n            <div style="overflow:hidden;text-overflow:ellipsis;">\n                <div class="gantt-tip-title" style="text-align:center">').concat(r.GanttUtil.encodeHtml(this.title),"</div>\n                ").concat(this.getBodyString(),"\n            </div>\n        </div>")},v.prototype.getBodyString=function(){var t,n,t="";for(n in this.body)this.body.hasOwnProperty(n)&&(t+='<div>\n                    <span class="gantt-tip-key">'.concat(r.GanttUtil.encodeHtml(this.body[n][0]),'</span>\n                    <span class="gantt-tip-value">').concat(r.GanttUtil.encodeHtml(this.body[n][1]),"</span>\n                </div>"));return t},v.prototype.addTaskTipItems=function(n,t){var i=this;this.body||(this.body=[]),t.forEach(function(t){i.addTaskItemDictionary[t]&&i.addTaskItemDictionary[t](n)})},Object.defineProperty(v.prototype,"addTaskItemDictionary",{get:function(){var n=this;return{name:function(t){n.addNameItem(t)},start:function(t){n.addStartItem(t)},finish:function(t){n.addFinishItem(t)},duration:function(t){n.addDurationItem(t)},"%complete":function(t){n.addCompleteTextItem(t)},completeThrough:function(t){n.addCompleteThroughItem(t)}}},enumerable:!1,configurable:!0}),v.prototype.addNameItem=function(t){t.name?this.body.push([h().GANTT_ACTION_TASK_COLON,t.name]):this.body.push([h().GANTT_ACTION_TASK_COLON,h().GANTT_TASK_BAR_UNNAMED])},v.prototype.addStartItem=function(t){var n=new s.Formatter.GeneralFormatter(t.project.layout.tipDateFormat);this.body.push([h().GANTT_ACTION_TASK_START,n.format(t.startDisplayed)])},v.prototype.addFinishItem=function(t){var n=new s.Formatter.GeneralFormatter(t.project.layout.tipDateFormat);this.body.push([h().GANTT_ACTION_TASK_FINISH,n.format(t.finishDisplayed)])},v.prototype.addDurationItem=function(t){t.duration&&this.body.push([h().GANTT_ACTION_DURATION,t.project.formatDuration(t.duration)])},v.prototype.addCompleteThroughItem=function(t){var n=new s.Formatter.GeneralFormatter(t.project.layout.tipDateFormat);t.completeThrough&&this.body.push([h().GANTT_TASK_BAR_COMPLETE_THROUGH,n.format(t.completeThrough)])},v.prototype.addCompleteTextItem=function(t){var n=new s.Formatter.GeneralFormatter("0%");this.body.push([h().GANTT_TASK_BAR_COMPLETE,n.format(t.complete)])},v.prototype.addLinkFromItem=function(t,n){t.from&&this.body.push([n,"(".concat(t.from.taskNumber,") ").concat(t.from.name)])},v.prototype.addLinkToItem=function(t,n){t.to&&this.body.push([n,"(".concat(t.to.taskNumber,") ").concat(t.to.name)])},v.getDefaultTaskHoverTipItems=function(t){switch(t){case"progress":case"manualProgress":return["name","start","completeThrough","duration","%complete"];case"milestone":case"manualMilestone":case"finishOnlyMilestone":case"durationOnlyMilestone":case"finishOnly":return["name","finish"];case"startOnly":case"startOnlyMilestone":return["name","start"];default:return["name","start","finish","duration"]}},f=v,n.TipSettings=f,e(g,A=i),g.prototype.oAi=function(t){if(t&&t.sheet&&t.sheet.NMi)return t.sheet.NMi.project},g.prototype.cAi=function(t){return t.row-this.dAi},g.prototype.An=function(t,n,i){return t.clone()},g.prototype.paintValue=function(t,n,i,e,s,r,u,o){var h,a,c,f,h,h=o.sheet,a=this.oAi(o);t&&a&&0<s&&0<r&&(t.save(),t.rect(i,e,s,r),t.clip(),c=this.cAi(o),f=a.getTaskByRow(c),h=h.NMi.gji,o.offsetX=0,h.paintTask(t,f,i,e,s,r,u,o,this,this.paintTextCore),h.paintLinkLines(t,a,f,c,i,e,s,r),this.barAction&&this.barAction.actionStatus===l.ActionStatus.InProgress&&h.paintActionPending(t,this.barAction),t.restore())},g.prototype.paintTextCore=function(t,n,i,e,s,r,u,o){A.prototype.paintValue.call(this,t,n,i,e,s,r,u,o)},g.prototype.getHitInfo=function(t,n,i,e,s){var r,u,o,h,a,e;return s&&s.sheetArea===c.SheetArea.viewport&&e?(r=s.sheetArea,u=e.x,o=e.x+e.width,h=e.y,a=e.y+e.height,e={x:t,y:n,row:s.row,col:s.col,cellRect:e,sheetArea:r,sheet:s.sheet,cellStyle:i},u<=t&&t<=o&&h<=n&&n<=a&&(e.isReservedLocation=!0),e):null},g.prototype.processMouseDown=function(t){var n,i,e,n=t&&t.sheet;if(!n||!t.isReservedLocation)return!1;(i=this.oAi(t))&&((e=o.BarActionBuilder.getBarHitInfo(i,this,t)).task&&(n.clearSelection(),n.setActiveCell(t.row,t.col),n.addSelection(t.row,0,1,n.getColumnCount()-1)),this.barAction=o.BarActionBuilder.getHitAction(i,this,e),this.barAction)&&this.barAction.start()},g.prototype.processMouseMove=function(t){var n,i,e,s,r,i,e,i,n=t&&t.sheet;if(!n||!t.isReservedLocation)return!1;(i=this.oAi(t))&&!this.barAction&&(s=void 0,(e=o.BarActionBuilder.getBarHitInfo(i,this,t))&&e.task?(o.BarActionBuilder.updateCursorByBarHitInfo(n.Dg(),i,this,e),s=this.bAi(e.task,e.style),r={task:e.task,partName:e.style.name,tip:s},n.ki(l.GanttSheetEvent.Event_HoverOnBar,r),s=r.tip):(o.BarActionBuilder.updateCursorStyle(n.Dg(),l.CursorStyle.Default),(i=this.mAi(t))&&(s=this.pAi(i),n.ki(l.GanttSheetEvent.Event_HoverOnLink,r={dependency:i,tip:s}),s=r.tip)),s&&this.showDefaultTips)&&(e=s.getContent(),(i=n.parent).Tw(e,0,0),i.R3.style.whiteSpace="normal",i.ny(e,t.x-25-i.R3.offsetWidth,t.y-25))},g.prototype.bAi=function(t,n){var i,e;if(t&&n)return(e=new f((i="gc-gantt-hover-on-")+n.name)).title=n.name,e.addTaskTipItems(t,f.getDefaultTaskHoverTipItems(n.name)),e},g.prototype.pAi=function(t){var n,i;if(t)return(i=new f((n="gc-gantt-hover-on-")+"link")).title="",i.body=[[h().GANTT_TASK_BAR_TASK_LINK,this.getDependencyTypeText(t.type)],[h().GANTT_TASK_BAR_FROM,"(ID ".concat(t.from.taskNumber,") ").concat(t.from.name)],[h().GANTT_TASK_BAR_TO,"(ID ".concat(t.to.taskNumber,") ").concat(t.to.name)]],i},g.prototype.getDependencyTypeText=function(t){switch(t){case"FS":return h().GANTT_TASK_BAR_FS;case"FF":return h().GANTT_TASK_BAR_FF;case"SF":return h().GANTT_TASK_BAR_SF;case"SS":return h().GANTT_TASK_BAR_SS}},g.prototype.mAi=function(t){for(var n,i,e,s,r,u,o,h,n,i=(t&&t.sheet).NMi.gji,e=this.cAi(t),s,u=0,o=i.getLinkLines(e,t.cellRect);u<o.length;u++)(h=o[u]).contains({x:t.x,y:t.y})&&(r=h.data);return r},g.prototype.isReservedKey=function(t,n){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},g.prototype.getAutoFitWidth=function(t,n,i,e,s){var s,r,u,e,o,h,a,c,f,l,d,h,A,v,g,s=s.sheet,r=s.NMi,u;if(r.gp())return r.wAi()*e;if(e=s.ot().width,o=0,h=s.OF())for(a=0,c=h;a<c.length;a++)o+=l=(f=c[a]).width;if(d=0,h=s.m9())for(A=r.getGanttColumnIndex(),v=0,g=h;v<g.length;v++)(f=g[v]).col!==A&&(d+=l=f.width);return e-o-d},g.prototype.getAutoFitHeight=function(t,n,i,e,s){var r=s.sheet.NMi.gji;return r?r.getBarStyleRowHeight()*e:A.prototype.getAutoFitHeight.call(this,t,n,i,e,s)},g.prototype.QD=function(t){this.isReservedKey(t)&&a(t)},g.prototype.isImeAware=function(t){return!1},g.prototype.jn=function(t){},g.prototype.Ke=function(){},g.prototype.toJSON=function(){return u.GanttSheetJsonConverter.toJSON(this,this.IOProps)},g.prototype.fromJSON=function(t){u.GanttSheetJsonConverter.fromJSON(this,t,this.IOProps)},g.prototype.activeOnClick=function(){return!1},n.TaskbarCellType=e=g,c.CellTypes.ti[106]=e},"./dist/plugins/gantt/celltypes/timescales.js":function(t,n,i){var e,p,d,s,y,A,i,w,r,u,j,o,c,T,v,h,i,a,f;function l(t,n){return v*t*n+5}function g(t,n){this.lAi=t,this.startX=n,this.yAi=!1}function b(){var t=f.call(this)||this;return t.typeName="107",t.marginTop=2,t.marginBottom=2,t.backColor="#f0f0f0",t.topTierTextStyle={},t.middleTierTextStyle={},t.bottomTierTextStyle={},t.allowDragScroll=!0,t.IOProps=["typeName","allowDragScroll","topTierTextStyle","middleTierTextStyle","bottomTierTextStyle"],t}e=this&&this.__extends||(a=function(t,n){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}a(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.TimescaleCellType=n.getTimescaleHeight=void 0,p=i("Core"),d=i("./dist/plugins/gantt/gantt-column.js"),s=i("./dist/plugins/gantt/gantt-json.js"),y=i("./dist/plugins/gantt/project/calendar.js"),A=i("./dist/plugins/gantt/gantt.enum.js"),i=i("Common"),w=i.Common.lt.ht,r=p.mt.vi,u=p.CellTypes.Context,j=p.CellTypes.Base,o=p.GC$,c=null,T=void 0,v=18,n.getTimescaleHeight=l,Object.defineProperty(g.prototype,"sheet",{get:function(){return this.lAi.Mf},enumerable:!1,configurable:!0}),Object.defineProperty(g.prototype,"project",{get:function(){return this.lAi.project},enumerable:!1,configurable:!0}),g.prototype.start=function(){this.jAi=this.project.timescale.currentDateUtc,this.yAi=!1,this.sheet.Dg().style.cursor="grabbing",this.Fg()},g.prototype.Fg=function(){var n=this;o(document).bind("mousemove.ganttSheet.timescale",function(t){n.pg(t)}).bind("mouseup.ganttSheet.timescale",function(t){n.bg(t)})},g.prototype.OAi=function(){o(document).unbind("mousemove.ganttSheet.timescale").unbind("mouseup.ganttSheet.timescale")},g.prototype.pg=function(t){var n,i,t,n,i;this.sheet&&(n=this.sheet.uw(),i=t.pageX-n.left,t=t.pageY-n.top,n=this.sheet.hitTest(i,t),i=this.startX-n.x-this.getScrollDistance(),this.project.timescale.scroll(i))},g.prototype.getScrollDistance=function(){return-this.project.timescale.getOffsetByDateUtc(this.jAi)},g.prototype.bg=function(t){this.OAi(),this.yAi=!0,delete this.jAi},g.prototype.isFinish=function(){return this.yAi},h=g,e(b,f=j),b.prototype.oAi=function(t){if(t&&t.sheet&&t.sheet.NMi)return t.sheet.NMi.project},b.prototype.paintValue=function(t,n,i,e,s,r,u,o){var h,h;t&&0<s&&0<r&&(t.save(),t.rect(i,e,s,r),t.clip(),t.beginPath(),h=void 0,h=this.backColor,t.fillStyle!==h&&(t.fillStyle=h),p.W.setFillStyle(t,h,i,e,s,r,function(){t.fillRect(i,e,s,r)}),this.paintTimescales(t,i,e,s,r,o),t.restore())},b.prototype.paintTimescales=function(t,n,i,e,s,r){var u,o,h,a,c,f,l,u=r.sheet.zoom(),o=v*u+this.marginTop,h=this.oAi(r);if(h)switch(a=h.timescale,c=new p.Style,f=new p.Style,l=new p.Style,this.topTierTextStyle&&(0,d.mergeTextStyle)(this.topTierTextStyle,c),this.middleTierTextStyle&&(0,d.mergeTextStyle)(this.middleTierTextStyle,f),this.bottomTierTextStyle&&(0,d.mergeTextStyle)(this.bottomTierTextStyle,l),r.offsetX=0,a.tierMode){case A.TimescaleTierMode.middle:0<=s-o&&(this.paintSeparatorLine(t,n,i+s-.5,e,a),this.paintTier(t,n,i+s-o,e,o,f,h,a.middleTier,r));break;case A.TimescaleTierMode.middleBottom:0<=s-2*o&&(this.paintSeparatorLine(t,n,i+s-.5,e,a),this.paintTier(t,n,i+s-o,e,o,l,h,a.bottomTier,r),this.paintTier(t,n,i+s-2*o,e,o,f,h,a.middleTier,r));break;case A.TimescaleTierMode.topMiddleBottom:0<=s-3*o&&(this.paintSeparatorLine(t,n,i+s-.5,e,a),this.paintTier(t,n,i+s-o,e,o,l,h,a.bottomTier,r),this.paintTier(t,n,i+s-2*o,e,o,f,h,a.middleTier,r),this.paintSeparatorLine(t,n,i+s-2*o-.5,e,a),this.paintTier(t,n,i+s-3*o,e,o,c,h,a.topTier,r))}},b.prototype.paintTier=function(t,n,i,e,s,r,u,o,h){var a,c,f,l,d,A,v,A,g,b,v,m,a=this;if(!w(o))for(f=c=u.timescale.currentDateUtc,d=o.labelAlign||"Left",(l=r).hAlign="Left"===d?p.HorizontalAlign.left:"Center"===d?p.HorizontalAlign.center:p.HorizontalAlign.right;;){if(v=(A=u.timescale.getDateUtcRange(f,o.unit,o.count))[0],A=A[1],n+e<=(g=n+u.timescale.getOffsetByDateUtc(v)))break;b=n+u.timescale.getOffsetByDateUtc(A)+.5,b=Math.floor(b)+.5,v=o.formatDate(y.Calendar.utcToLocal(v)),j.prototype.paintText.call(a,t,v,g,i,b-g,s,l,h,v,m={},T,T),o.showTickLines&&(t.beginPath(),t.moveTo(b,i),t.lineTo(b,i+s),t.strokeStyle="gray",t.stroke()),f=A}},b.prototype.paintSeparatorLine=function(t,n,i,e,s){s.showScaleSeparator&&(t.beginPath(),t.moveTo(n,i),t.lineTo(n+e,i),t.strokeStyle="gray",t.stroke())},b.prototype.getText=function(t,n){return t},b.prototype.getHitInfo=function(t,n,i,e,s){var r,u,o,h,a,r,e,r=this;return s?(u=s.sheetArea,o=e.x,h=e.x+e.width,a=e.y+r.marginTop,r=e.y+e.height-r.marginBottom,e={x:t,y:n,row:s.row,col:s.col,cellRect:e,sheetArea:u,sheet:s.sheet,cellStyle:i},o<=t&&t<=h&&a<=n&&n<=r&&(e.isReservedLocation=!0),e):c},b.prototype.processMouseDown=function(t){var n,i,n;return!!this.oAi(t)&&!!((i=t&&t.sheet)&&t.isReservedLocation&&this.allowDragScroll)&&(this.TAi=new h(t.sheet.NMi,t.x),this.TAi.start(),!0)},b.prototype.processMouseMove=function(t){this.allowDragScroll&&(this.TAi&&!this.TAi.isFinish()||(t.sheet.Dg().style.cursor="grab"),this.TAi)&&!this.TAi.isFinish()&&(t.sheet.Dg().style.cursor="grabbing")},b.prototype.processKeyDown=function(t,n){return!1},b.prototype.processKeyUp=function(t,n){return!1},b.prototype.isReservedKey=function(t,n){return 32===t.keyCode&&!t.ctrlKey&&!t.shiftKey&&!t.altKey},b.prototype.getAutoFitWidth=function(t,n,i,e,s){return u.Bt(t,n,i,e,s)},b.prototype.getAutoFitHeight=function(t,n,i,e,s){var r=this.oAi(s);return l(r?r.timescale.tierMode:A.TimescaleTierMode.middle,s.sheet.zoom())},b.prototype.QD=function(t){this.isReservedKey(t)&&r(t)},b.prototype.isImeAware=function(t){return!1},b.prototype.jn=function(t){},b.prototype.Ke=function(){},b.prototype.activeOnClick=function(){return!1},b.prototype.toJSON=function(){return s.GanttSheetJsonConverter.toJSON(this,this.IOProps)},b.prototype.fromJSON=function(t){s.GanttSheetJsonConverter.fromJSON(this,t,this.IOProps)},n.TimescaleCellType=i=b,p.CellTypes.ti[107]=i},"./dist/plugins/gantt/gantt-action.js":function(t,n,i){var a,n,e,o,s,d,i,i,h,r;function u(t,n){for(var i,e,i=new Array(t),e=0;e<t;e++)i[e]=n();return i}a=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var e=0,s=n.length,r;e<s;e++)!r&&e in n||((r=r||Array.prototype.slice.call(n,0,e))[e]=n[e]);return t.concat(r||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n=i("Common"),e=i("Core"),o=i("./dist/plugins/gantt/gantt-sheet.js"),s=i("./dist/plugins/gantt/gantt.enum.js"),d=i("./dist/plugins/gantt/utils/util.js"),i=i("./dist/plugins/gantt/gantt.ns.js"),i=new n.Common.ResourceManager(i.SR,"GanttSheet"),h=i.getResource.bind(i),r=n.Common.lt.ht,e.Commands[s.GanttCommandNames.GANTTSHEET_TIMESCALE_PAGE_UP]={canUndo:!1,execute:function(t,n){var t,i,i,t,t=d.GanttUtil.getGanttSheet(t);if(t)return(i=t.project)&&(i=i.timescale,t=t.getTaskbarAreaVisibleSize(),i.scroll(-1*t)),!1}},e.Commands[s.GanttCommandNames.GANTTSHEET_TIMESCALE_PAGE_DOWN]={canUndo:!1,execute:function(t,n){var t,i,i,t,t=d.GanttUtil.getGanttSheet(t);if(t)return(i=t.project)&&(i=i.timescale,t=t.getTaskbarAreaVisibleSize(),i.scroll(t)),!1}},e.Commands[s.GanttCommandNames.GANTTSHEET_TIMESCALE_BEGIN]={canUndo:!1,execute:function(t,n){var t,t,t=d.GanttUtil.getGanttSheet(t);if(t)return(t=t.project).timescale.scrollTo(t.startDate,.25),!1}},e.Commands[s.GanttCommandNames.GANTTSHEET_TIMESCALE_END]={canUndo:!1,execute:function(t,n){var t,t,t=d.GanttUtil.getGanttSheet(t);if(t)return(t=t.project).timescale.scrollTo(t.finishDate,.75),!1}},e.Commands[s.GanttCommandNames.GANTTSHEET_TIMESCALE_LEFT]={canUndo:!1,execute:function(t,n){var t,t,i,t=d.GanttUtil.getGanttSheet(t);if(t)return(t=t.project)&&(i=t.timescale).scrollOneTick(!1),!1}},e.Commands[s.GanttCommandNames.GANTTSHEET_TIMESCALE_RIGHT]={canUndo:!1,execute:function(t,n){var t,t,i,t=d.GanttUtil.getGanttSheet(t);if(t)return(t=t.project)&&(i=t.timescale).scrollOneTick(!0),!1}},e.Commands[s.GanttCommandNames.GANTTSHEET_TIMESCALE_ZOOM_IN]={canUndo:!1,execute:function(t,n){var t,i,e,t=d.GanttUtil.getGanttSheet(t);if(t)return e=(i=t.project).timescale,t.uiOptions.allowZoomTimescale&&e.zoomIn(),!1}},e.Commands[s.GanttCommandNames.GANTTSHEET_TIMESCALE_ZOOM_OUT]={canUndo:!1,execute:function(t,n){var t,i,e,t=d.GanttUtil.getGanttSheet(t);if(t)return e=(i=t.project).timescale,t.uiOptions.allowZoomTimescale&&e.zoomOut(),!1}},e.Commands[s.GanttCommandNames.GANTTSHEET_TIMESCALE_ZOOM_CUSTOMER]={canUndo:!0,execute:function(t,n){var t,t,i,n,t=d.GanttUtil.getGanttSheet(t);if(t)return t=t.project,i=n.start,n=n.finish,t.timescale.zoomToRange(i,n),!0}},e.Commands[s.GanttCommandNames.GANTTSHEET_CHANGE_COMPLETE]={canUndo:!0,execute:function(t,n){var i,t,e,s,r,u,i=d.GanttUtil.getGanttSheet(t);if(i){for(t=d.GanttUtil.getSelectedTasks(i),e=n.complete,s=0,r=t;s<r.length;s++)(u=r[s]).complete!==e&&i.project.taskManager.setTaskValue(u,"complete",e);return!0}}},e.Commands[s.GanttCommandNames.GANTTSHEET_INDENT_TASKS]={canUndo:!0,execute:function(t,n){var t,i,t=d.GanttUtil.getGanttSheet(t);if(t)return i=d.GanttUtil.getSelectedTasks(t),t.project.indentTasks(i.map(function(t){return t.taskNumber})),!0}},e.Commands[s.GanttCommandNames.GANTTSHEET_OUTDENT_TASKS]={canUndo:!0,execute:function(t,n){var t,i,t=d.GanttUtil.getGanttSheet(t);if(t)return i=d.GanttUtil.getSelectedTasks(t),t.project.outdentTasks(i.map(function(t){return t.taskNumber})),!0}},e.Commands[s.GanttCommandNames.GANTTSHEET_LINK_TASKS]={canUndo:!0,execute:function(t,n){var t,i,e,s,r,u,o,h,a,c,f,l,f,t=d.GanttUtil.getGanttSheet(t);if(t){for(i=t.project,e=[],s=t.getSelections(),r=-1,u=0;u<s.length;u++){for(o=s[u],-1!==r&&e.push([r,o.row]),h=o.row+1;h<o.row+o.rowCount;h++)e.push([h-1,h]);r=o.row+o.rowCount-1}if(e.length<=0)return!1;for(i.suspendSchedule(),a=0,c=e;a<c.length;a++){l=(f=c[a])[0],f=f[1];try{i.addDependency({fromTaskNumber:l,toTaskNumber:f})}catch(t){}}return i.resumeSchedule(),!0}}},e.Commands[s.GanttCommandNames.GANTTSHEET_UNLINK_TASKS]={canUndo:!0,execute:function(t,n){var t,i,t,e,s,r,u,o,h,t=d.GanttUtil.getGanttSheet(t);if(t){if(i=d.GanttUtil.getSelectedTaskNumbers(t),t=t.project,e=[],1===i.length)s=t.getTaskByRow(i[0]),e=a(a([],s.predecessorDependencies,!0),s.successorDependencies,!0);else{for(r={},u=0,o=i;u<o.length;u++)h=o[u],r[h]=!0;e=t.dependencies.filter(function(t){return r[t.from.taskNumber]&&r[t.to.taskNumber]})}return 1<=e.length&&t.removeDependency(e),!0}}},e.Commands[s.GanttCommandNames.GANTTSHEET_CHANGE_TASK_MODE]={canUndo:!0,execute:function(t,n){var i,n,e,s,r,u,i=n.taskMode,n=t.getActiveSheetTab();if(n&&n instanceof o.GanttSheet){for(s=0,r=e=d.GanttUtil.getSelectedTasks(n);s<r.length;s++)(u=r[s]).setValue("mode",i);return!0}}},e.Commands[s.GanttCommandNames.GANTTSHEET_MOVE_TASK]={canUndo:!0,execute:function(t,n){var t,i,e,s,n,t=d.GanttUtil.getGanttSheet(t);if(t)return i=n.duration,e=n.forward,s=t.project,n=d.GanttUtil.getSelectedTaskNumbers(t),s.suspendSchedule(),n.forEach(function(t){var n,n,t,n,t=s.getTask(t),n=e?null!=(n=i.value)?n:0:-1*(null!=(n=i.value)?n:0);"Week"===i.unit?t.moveInWeeks(n):t.moveInWorkingDays(n)}),s.resumeSchedule(),!0}},e.Commands[s.GanttCommandNames.GANTTSHEET_INSERT_TASK]={canUndo:!0,execute:function(t,n){var t,i,e,s,r,t=d.GanttUtil.getGanttSheet(t);if(t)return i=t.project,e=t.getSelections().map(function(t){return t.rowCount}).reduce(function(t,n){return t+n}),s=Math.min.apply(Math,a(a([],t.getSelections().map(function(t){return t.row}),!1),[i.count],!1)),r=u(e,function(){return{name:h().GANTT_NEW_TASK}}),i.insertTasksByRow(s,r),t.setSelection(s,-1,e,-1),!0}},e.Commands[s.GanttCommandNames.GANTTSHEET_INSERT_SUMMARY_TASK]={canUndo:!0,execute:function(t,n){var i,t,e,s,r,u,o,i=d.GanttUtil.getGanttSheet(t);if(i)return t=i.project,s=(e=i.getSelections()[0]).row,r=i.getTaskNumberByRow(s)||t.count,0===(u=d.GanttUtil.getSelectedRowIndexes(i).map(function(t){return i.getTaskByRow(t)}).filter(function(t){return!!t})).length?(o=t.insertTasks(r,{name:h().GANTT_NEW_SUMMARY_TASK})[0],t.insertTasks(r+1,{name:h().GANTT_NEW_TASK},o.level+1)):(t.insertTasks(r,{name:h().GANTT_NEW_SUMMARY_TASK},u[0].level),t.sorted?t.indentTasks([u[0].taskNumber]):t.indentTasksByRange(e.row+1,e.rowCount)),i.setSelection(s,-1,1,-1),!0}},e.Commands[s.GanttCommandNames.GANTTSHEET_INSERT_MILESTONE]={canUndo:!0,execute:function(t,n){var t,i,e,s,r,t=d.GanttUtil.getGanttSheet(t);if(t)return i=t.project,e=t.getSelections().map(function(t){return t.rowCount}).reduce(function(t,n){return t+n}),s=Math.min.apply(Math,a(a([],t.getSelections().map(function(t){return t.row}),!1),[i.count],!1)),r=u(e,function(){return{name:h().GANTT_NEW_MILESTONE,duration:0}}),i.insertTasksByRow(s,r),t.setSelection(s,-1,e,-1),!0}},e.Commands[s.GanttCommandNames.GANTTSHEET_DELETE_TASK]={canUndo:!0,execute:function(t,n){var t,i,t,t=d.GanttUtil.getGanttSheet(t);if(t)return i=t.project,t=d.GanttUtil.getSelectedTaskNumbers(t),i.removeTasks(t),!0}},e.Commands[s.GanttCommandNames.GANTTSHEET_SCROLL_TO_TASK]={canUndo:!0,execute:function(t,n){var t,i,t=d.GanttUtil.getGanttSheet(t);if(t)return i=t.getActiveTask(),r(i.start)&&r(i.duration)?t.project.timescale.scrollTo(i.finishDisplayed,.25):t.project.timescale.scrollTo(i.startDisplayed,.25),!0}},e.Commands.kAi=function(t){var n,i=!e.mt.Qf();t.register(s.GanttCommandNames.GANTTSHEET_TIMESCALE_PAGE_UP,e.Commands[s.GanttCommandNames.GANTTSHEET_TIMESCALE_PAGE_UP],33,!1,!1,!0,!1),t.register(s.GanttCommandNames.GANTTSHEET_TIMESCALE_PAGE_DOWN,e.Commands[s.GanttCommandNames.GANTTSHEET_TIMESCALE_PAGE_DOWN],34,!1,!1,!0,!1),t.register(s.GanttCommandNames.GANTTSHEET_TIMESCALE_BEGIN,e.Commands[s.GanttCommandNames.GANTTSHEET_TIMESCALE_BEGIN],36,!1,!1,!0,!1),t.register(s.GanttCommandNames.GANTTSHEET_TIMESCALE_END,e.Commands[s.GanttCommandNames.GANTTSHEET_TIMESCALE_END],35,!1,!1,!0,!1),t.register(s.GanttCommandNames.GANTTSHEET_TIMESCALE_LEFT,e.Commands[s.GanttCommandNames.GANTTSHEET_TIMESCALE_LEFT],37,!1,!1,!0,!1),t.register(s.GanttCommandNames.GANTTSHEET_TIMESCALE_RIGHT,e.Commands[s.GanttCommandNames.GANTTSHEET_TIMESCALE_RIGHT],39,!1,!1,!0,!1),t.register(s.GanttCommandNames.GANTTSHEET_TIMESCALE_ZOOM_IN,e.Commands[s.GanttCommandNames.GANTTSHEET_TIMESCALE_ZOOM_IN],111,i,!1,!1,!1),t.register(s.GanttCommandNames.GANTTSHEET_TIMESCALE_ZOOM_OUT,e.Commands[s.GanttCommandNames.GANTTSHEET_TIMESCALE_ZOOM_OUT],106,i,!1,!1,!1),t.register(s.GanttCommandNames.GANTTSHEET_TIMESCALE_ZOOM_CUSTOMER,e.Commands[s.GanttCommandNames.GANTTSHEET_TIMESCALE_ZOOM_CUSTOMER],106,i,!1,!1,!1),t.register(s.GanttCommandNames.GANTTSHEET_CHANGE_COMPLETE,e.Commands[s.GanttCommandNames.GANTTSHEET_CHANGE_COMPLETE]),t.register(s.GanttCommandNames.GANTTSHEET_INDENT_TASKS,e.Commands[s.GanttCommandNames.GANTTSHEET_INDENT_TASKS]),t.register(s.GanttCommandNames.GANTTSHEET_OUTDENT_TASKS,e.Commands[s.GanttCommandNames.GANTTSHEET_OUTDENT_TASKS]),t.register(s.GanttCommandNames.GANTTSHEET_LINK_TASKS,e.Commands[s.GanttCommandNames.GANTTSHEET_LINK_TASKS]),t.register(s.GanttCommandNames.GANTTSHEET_UNLINK_TASKS,e.Commands[s.GanttCommandNames.GANTTSHEET_UNLINK_TASKS]),t.register(s.GanttCommandNames.GANTTSHEET_CHANGE_TASK_MODE,e.Commands[s.GanttCommandNames.GANTTSHEET_CHANGE_TASK_MODE]),t.register(s.GanttCommandNames.GANTTSHEET_MOVE_TASK,e.Commands[s.GanttCommandNames.GANTTSHEET_MOVE_TASK]),t.register(s.GanttCommandNames.GANTTSHEET_INSERT_TASK,e.Commands[s.GanttCommandNames.GANTTSHEET_INSERT_TASK]),t.register(s.GanttCommandNames.GANTTSHEET_INSERT_SUMMARY_TASK,e.Commands[s.GanttCommandNames.GANTTSHEET_INSERT_SUMMARY_TASK]),t.register(s.GanttCommandNames.GANTTSHEET_INSERT_MILESTONE,e.Commands[s.GanttCommandNames.GANTTSHEET_INSERT_MILESTONE]),t.register(s.GanttCommandNames.GANTTSHEET_DELETE_TASK,e.Commands[s.GanttCommandNames.GANTTSHEET_DELETE_TASK]),t.register(s.GanttCommandNames.GANTTSHEET_SCROLL_TO_TASK,e.Commands[s.GanttCommandNames.GANTTSHEET_SCROLL_TO_TASK])},e.Workbook.ch("ganttSheet",{init:function(){var t;e.Commands.kAi(this.commandManager())}})},"./dist/plugins/gantt/gantt-chart.js":function(t,n,i){var e,s,r,u;function o(t){this.propertyChanged=new e.EventList,this.IOProps=["taskbarAllowChangeProgress","taskbarAllowLinkTask","taskbarAllowMoveOrResizeTask","taskbarLeftTextStyle","taskbarRightTextStyle","taskbarTopTextStyle","taskbarBottomTextStyle","taskbarInsideTextStyle","taskbarShowDefaultTips","timescaleAllowDragScroll","timescaleTopTierTextStyle","timescaleMiddleTierTextStyle","timescaleBottomTierTextStyle"],this.YC="*",this._Ai=new r.TaskbarCellType}Object.defineProperty(n,"__esModule",{value:!0}),n.TaskbarColumn=void 0,e=i("./dist/plugins/gantt/utils/foundation.js"),s=i("./dist/plugins/gantt/gantt-json.js"),r=i("./dist/plugins/gantt/celltypes/taskbar.js"),Object.defineProperty(o.prototype,"width",{get:function(){return this.YC},set:function(t){this.YC=t,this.propertyChanged.invoke(this,"width")},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"taskbarLeftTextStyle",{get:function(){return this._Ai.leftTextStyle},set:function(t){this._Ai.leftTextStyle=t,this.propertyChanged.invoke(this,"_taskbarCellType")},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"taskbarTopTextStyle",{get:function(){return this._Ai.topTextStyle},set:function(t){this._Ai.topTextStyle=t,this.propertyChanged.invoke(this,"_taskbarCellType")},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"taskbarRightTextStyle",{get:function(){return this._Ai.rightTextStyle},set:function(t){this._Ai.rightTextStyle=t,this.propertyChanged.invoke(this,"_taskbarCellType")},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"taskbarBottomTextStyle",{get:function(){return this._Ai.bottomTextStyle},set:function(t){this._Ai.bottomTextStyle=t,this.propertyChanged.invoke(this,"_taskbarCellType")},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"taskbarInsideTextStyle",{get:function(){return this._Ai.insideTextStyle},set:function(t){this._Ai.insideTextStyle=t,this.propertyChanged.invoke(this,"_taskbarCellType")},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"taskbarShowDefaultTips",{get:function(){return this._Ai.showDefaultTips},set:function(t){this._Ai.showDefaultTips=t,this.propertyChanged.invoke(this,"_taskbarCellType")},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"taskbarAllowMoveOrResizeTask",{get:function(){return this._Ai.allowMoveOrResizeTask},set:function(t){this._Ai.allowMoveOrResizeTask=t,this.propertyChanged.invoke(this,"_taskbarCellType")},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"taskbarAllowLinkTask",{get:function(){return this._Ai.allowLinkTask},set:function(t){this._Ai.allowLinkTask=t,this.propertyChanged.invoke(this,"_taskbarCellType")},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"taskbarAllowChangeProgress",{get:function(){return this._Ai.allowChangeProgress},set:function(t){this._Ai.allowChangeProgress=t,this.propertyChanged.invoke(this,"_taskbarCellType")},enumerable:!1,configurable:!0}),o.prototype.toJSON=function(){return s.GanttSheetJsonConverter.toJSON(this,this.IOProps)},o.prototype.fromJSON=function(t){s.GanttSheetJsonConverter.fromJSON(this,t,this.IOProps)},n.TaskbarColumn=o},"./dist/plugins/gantt/gantt-column.js":function(t,n,i){var h,a,o,e,s,r,u,c,f,l,i,d,A;function v(t,n,i){var e,s,e,r,u,s,e=t.NMi;e instanceof o.GanttSheet&&(s=e.project,r=(e=e.fDi(i.col)).value,(u=e.dataType)&&(s=s.taskManager.getFieldByDataType(u))&&(r=s.name),e)&&-1!==["start","finish"].indexOf(r)&&g(t,e,n),b(t,n,i)}function g(t,n,i){var e,t,s,r,r,r,e,t=t.NMi.project,s=n.value,r=n.dataType;r&&(r=t.taskManager.getFieldByDataType(r))&&(s=r.name),n&&-1!==["start","finish"].indexOf(s)&&(r="start"===n.name?t.calendarSettings.defaultStartTime:t.calendarSettings.defaultFinishTime,i.setHours(r.hour,r.minute,0,0))}function b(t,n,i){var e,s,i,r,r,u,o,i,e,e=i.row,s=i.col,i=i.sheetArea,r=(new h.Common.CultureInfo).DateTimeFormat,r=new h.Formatter.GeneralFormatter(r.defaultDatePattern).format(n);t.getParent().commandManager().execute({cmd:"editCell",sheetName:t.name(),row:e,col:s,newValue:r,autoFormat:!0,sheetArea:i,isUndo:!1}),t.isEditing()&&t.ci===s&&t.ui===e&&(u=t.getCellType(e,s),o={sheet:t,row:e,col:s,sheetArea:a.SheetArea.viewport},i=t.Il(e,s,i),e=t.getCellRect(e,s),t.li.Li=n,u.updateEditor(t.li,i,e,o),u.setEditorValue(t.li,r,o))}function m(){var t=new a.Style;return t.cellType=new u.TaskSubjectCellType,t}function p(t,n){void 0===n&&(n=!0);var i=new a.Style;return t&&i.compose(t),i.cellType=new e.TaskDurationCellType(n),i.cellType.showButton=n,i}function y(t){var n=new a.Style;return t&&n.compose(t),n.cellButtons=[{imageType:a.ButtonImageType.dropdown,command:"openList",useButtonStyle:!1,visibility:a.ButtonVisibility.onSelected}],n.dropDowns=[{type:a.DropDownType.list,option:{items:[{text:"Manual",item:"Manual"},{text:"Auto",item:"Auto"}]}}],n}function w(t){var n=new a.Style;return t&&n.compose(t),(A(t)||A(t.formatter))&&(n.formatter="0%"),n.cellType=new l.TaskCompleteCellType,n}function j(t,n){var i,t,i=new a.Style;return t&&i.compose(t),(A(t)||A(t.formatter))&&(i.formatter=d().DEFAULT_DATE_TIME_FORMAT),i.cellButtons=[{imageType:a.ButtonImageType.dropdown,command:"openDateTimePicker",useButtonStyle:!1,visibility:a.ButtonVisibility.onSelected}],i.dropDowns=[{type:a.DropDownType.dateTimePicker,option:{showTime:!1,startDay:a.CalendarStartDay.sunday},submitCommand:v}],t=new c.TaskDateCellType(n),i.cellType=t,i}function T(t){var n=new a.Style;return t&&n.compose(t),n.cellButtons=[{imageType:a.ButtonImageType.dropdown,command:"OpenPredecessor",useButtonStyle:!1,visibility:a.ButtonVisibility.onSelected}],n.cellType=new s.TaskPredecessorCellType,n}function O(t){var n=new a.Style;return t&&n.compose(t),n.cellButtons=[{imageType:a.ButtonImageType.dropdown,command:"OpenResources",useButtonStyle:!1,visibility:a.ButtonVisibility.onSelected}],n.cellType=new r.TaskResourcesCellType,n}function k(t,n){t&&(t.font&&(n.font=t.font),t.color&&(n.foreColor=t.color),t.textDecoration)&&(n.textDecoration=t.textDecoration)}Object.defineProperty(n,"__esModule",{value:!0}),n.mergeTextStyle=n.createStyleForResources=n.createStyleForPredecessors=n.createStyleForDateTime=n.createStyleForComplete=n.createStyleForMode=n.createStyleForDuration=n.createStyleForSubject=void 0,h=i("Common"),a=i("Core"),o=i("./dist/plugins/gantt/gantt-sheet.js"),e=i("./dist/plugins/gantt/celltypes/duration.js"),s=i("./dist/plugins/gantt/celltypes/predecessor.js"),r=i("./dist/plugins/gantt/celltypes/resources.js"),u=i("./dist/plugins/gantt/celltypes/subject.js"),c=i("./dist/plugins/gantt/celltypes/date.js"),f=i("./dist/plugins/gantt/gantt.ns.js"),l=i("./dist/plugins/gantt/celltypes/complete.js"),i=new h.Common.ResourceManager(f.SR,"GanttSheet"),d=i.getResource.bind(i),A=h.Common.lt.ht,n.createStyleForSubject=m,n.createStyleForDuration=p,n.createStyleForMode=y,n.createStyleForComplete=w,n.createStyleForDateTime=j,n.createStyleForPredecessors=T,n.createStyleForResources=O,n.mergeTextStyle=k},"./dist/plugins/gantt/gantt-contextmenu.js":function(t,n,i){var e,s,r,u,o,h,a,i,c,f,l,d,A,v,g,b,m,p,y,w,j,T,O,k;function S(){return null!==O&&O.apply(this,arguments)||this}function M(){var t,i,t=k.call(this)||this;return t.menuView=new w,i=[l+d,l+A,l+b],t.menuData.forEach(function(t,n){-1<i.indexOf(t.name)&&(t.workArea+="GanttColHeader",t.workArea+="GanttRowHeader",t.workArea+="GanttField")}),t}e=this&&this.__extends||(T=function(t,n){return(T=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}T(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.GanttContextMenu=n.GanttContextMenuView=void 0,s=i("Core"),r=i("ContextMenu"),u=i("./dist/plugins/gantt/gantt-sheet.js"),o=i("./dist/plugins/gantt/celltypes/taskbar.js"),h=i("./dist/plugins/gantt/celltypes/timescales.js"),a=i("./dist/plugins/gantt/taskbar/action.js"),i=i("Common"),c=i.Common.lt.ht,f={Timescale:function(t,n,i,e){return new RegExp("Timescale","i").test(t.workArea)&&i instanceof h.TimescaleCellType},GanttChart:function(t,n,i,e){var e=i instanceof o.TaskbarCellType&&c(a.BarActionBuilder.getBarHitInfo(e.NMi.project,i,n).task);return new RegExp("GanttChart","i").test(t.workArea)&&e},GanttBar:function(t,n,i,e){var e=i instanceof o.TaskbarCellType&&!c(a.BarActionBuilder.getBarHitInfo(e.NMi.project,i,n).task);return new RegExp("GanttBar","i").test(t.workArea)&&e},GanttField:function(t,n,i,e){return new RegExp("GanttField","i").test(t.workArea)&&n.sheetArea===s.SheetArea.viewport&&!(i instanceof o.TaskbarCellType)&&!(i instanceof h.TimescaleCellType)},GanttColHeader:function(t,n,i,e){return new RegExp("GanttColHeader","i").test(t.workArea)&&n.sheetArea===s.SheetArea.colHeader&&!(i instanceof h.TimescaleCellType)},GanttRowHeader:function(t,n,i,e){return new RegExp("GanttRowHeader","i").test(t.workArea)&&n.sheetArea===s.SheetArea.rowHeader}},l="gc.spread.",d="copy",A="cut",v="separator",g="paste",b="ganttSheetPaste",m="gc-spread-",p="pasteOptions",y=s.GC$,O=r.MenuView,e(S,O),S.prototype.getCommandOptions=function(t,n,i){if(new RegExp("GanttBar","i").test(t.workArea))return t.commandOptions},w=S,n.GanttContextMenuView=w,k=r.ContextMenu,e(M,k),M.prototype.xq=function(t,n,i){var e=(0,s.jf)(i);return e.NMi instanceof u.GanttSheet&&n.worksheetHitInfo?this.xAi(t,n,e):k.prototype.xq.call(this,t,n,i)},M.prototype.xAi=function(t,n,e){var s,r,u,s=e.getCellType(n.worksheetHitInfo.row,n.worksheetHitInfo.col,n.worksheetHitInfo.hitTestType);return s?(r={x:n.worksheetHitInfo.x,y:n.worksheetHitInfo.y,row:n.worksheetHitInfo.row,col:n.worksheetHitInfo.col,sheet:e,cellRect:n.worksheetHitInfo.cellTypeHitInfo?n.worksheetHitInfo.cellTypeHitInfo.cellRect:void 0,sheetArea:n.worksheetHitInfo.hitTestType},u=[],y.each(t,function(t,n){for(var i in n.type===v&&u.push(n),f)f[i](n,r,s,e)&&("GanttBar"===i&&s instanceof o.TaskbarCellType&&(n.commandOptions=a.BarActionBuilder.getBarHitInfo(e.NMi.project,s,r).style),u.push(n))}),u):t},M.prototype.kk=function(t,n){var i,e,s,i=t.getCellType(n.row,n.col,n.hitTestType);i instanceof h.TimescaleCellType&&t.NMi instanceof u.GanttSheet||(i instanceof o.TaskbarCellType&&t.NMi instanceof u.GanttSheet?(e={x:n.x,y:n.y,row:n.row,col:n.col,sheet:t,cellRect:n.cellTypeHitInfo?n.cellTypeHitInfo.cellRect:void 0,sheetArea:n.hitTestType},(s=!c(a.BarActionBuilder.getBarHitInfo(t.NMi.project,i,e).task))&&(t.clearSelection(),t.setActiveCell(e.row,e.col),t.addSelection(e.row,0,1,t.getColumnCount()-1))):k.prototype.kk.call(this,t,n))},j=M,n.GanttContextMenu=j,s.Workbook.ch("ganttcontextmenu",{setHost:function(){var t=this;t.contextMenu&&t.contextMenu instanceof j||(t.contextMenu=new j)}})},"./dist/plugins/gantt/gantt-events.js":function(t,n,i){var e,i,s,r,u;function o(t){return u.call(this,t)||this}e=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.GanttSheetEventHandler=void 0,i=i("Core"),u=i.nk,e(o,u),n.GanttSheetEventHandler=o},"./dist/plugins/gantt/gantt-filter.js":function(t,n,i){var e,s,r,u,o,h,a;function c(t,n,i,e){return a.call(this,t,n,i,e)||this}e=this&&this.__extends||(h=function(t,n){return(h=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}h(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.GanttFilterDialog=void 0,s=i("Filters"),r=i("./dist/plugins/gantt/gantt-sheet.js"),u=i("./dist/plugins/gantt/celltypes/subject.js"),a=s.iut,e(c,a),c.prototype.Ust=function(t,n,i){var n,i,e,s,n=a.prototype.Ust.call(this,t,n,i);return this.sheet.NMi instanceof r.GanttSheet&&(i=this.sheet,e=i.NMi,s=i.JS(this.filterButtonInfo.rowFilter.range),i.getCellType(-1,t)instanceof u.TaskSubjectCellType)&&(this.dataSource.forEach(function(t,n){t.level=e.getRowState(s.row+n).level}),n.forEach(function(t,n){t.children[0].level=e.getRowState(s.row+n).level})),n},n.GanttFilterDialog=c},"./dist/plugins/gantt/gantt-gridline.js":function(t,n,i){var e,s,r;function u(t){this.IOProps=["topTierColumn","middleTierColumn","bottomTierColumn","currentDate","ganttRows","projectFinish","projectStart"],this.lAi=t,this.LAi={lineColor:"",lineType:s.GanttGridlineType.empty},this.PAi={lineColor:"#FFFFFF",lineType:s.GanttGridlineType.thin},this.HAi={lineColor:"",lineType:s.GanttGridlineType.empty},this.YAi={lineColor:"transparent",lineType:s.GanttGridlineType.thin},this.QAi={lineColor:"#8BBF8A",lineType:s.GanttGridlineType.thin},this.WAi={lineColor:"#808080",lineType:s.GanttGridlineType.dotted},this.GAi={lineColor:"#808080",lineType:s.GanttGridlineType.dotted}}Object.defineProperty(n,"__esModule",{value:!0}),n.GanttGridlines=void 0,e=i("./dist/plugins/gantt/gantt-json.js"),s=i("./dist/plugins/gantt/gantt.enum.js"),Object.defineProperty(u.prototype,"topTierColumn",{get:function(){return this.LAi},set:function(t){this.LAi=t,this.onLinesChanged()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"middleTierColumn",{get:function(){return this.PAi},set:function(t){this.PAi=t,this.onLinesChanged()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"bottomTierColumn",{get:function(){return this.HAi},set:function(t){this.HAi=t,this.onLinesChanged()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"currentDate",{get:function(){return this.QAi},set:function(t){this.QAi=t,this.onLinesChanged()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"projectStart",{get:function(){return this.WAi},set:function(t){this.WAi=t,this.onLinesChanged()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"projectFinish",{get:function(){return this.GAi},set:function(t){this.GAi=t,this.onLinesChanged()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"ganttRows",{get:function(){return this.YAi},set:function(t){this.YAi=t,this.onLinesChanged()},enumerable:!1,configurable:!0}),u.prototype.onLinesChanged=function(){this.lAi.project.VAi.invoke()},u.prototype.getLineInfos=function(t){var n=t.lineColor,i=t.lineType,e=t.intervalLineColor,t=t.intervalLineType;return i===s.GanttGridlineType.empty&&(n="transparent",i=s.GanttGridlineType.thin),t===s.GanttGridlineType.empty&&(e="transparent",t=s.GanttGridlineType.thin),{lineColor:n,lineType:i,intervalLineColor:e,intervalLineType:t}},u.prototype.toJSON=function(){return e.GanttSheetJsonConverter.toJSON(this,this.IOProps)},u.prototype.fromJSON=function(t){e.GanttSheetJsonConverter.fromJSON(this,t,this.IOProps)},n.GanttGridlines=u},"./dist/plugins/gantt/gantt-json.js":function(t,n,i){var u,e,o,h,s;function r(){}Object.defineProperty(n,"__esModule",{value:!0}),n.GanttSheetJsonConverter=void 0,u=i("Core"),e=i("Common"),o=i("./dist/plugins/gantt/utils/util.js"),h=e.Common.lt.tv,r.toJSON=function(t,n){for(var i,e,s,r,i={},e=0,s=n;e<s.length;e++)t[r=s[e]]instanceof Date?i[r]={oaDate:u.util.Z0(t[r])}:t[r]&&t[r].toJSON&&"function"==typeof t[r].toJSON?i[r]=t[r].toJSON():void 0!==t[r]&&(i[r]=h(t[r]));return i},r.fromJSON=function(t,n,i){for(var e,s,r,e=0,s=i;e<s.length;e++)t[r=s[e]]&&t[r].fromJSON&&"function"==typeof t[r].fromJSON?t[r].fromJSON(n[r]):n[r]&&o.GanttUtil.lji(n[r].oaDate)?t[r]=u.util.V0(n[r].oaDate):void 0!==n[r]&&(t[r]=h(n[r]))},n.GanttSheetJsonConverter=r},"./dist/plugins/gantt/gantt-options.js":function(t,n,i){var e,s;function r(t){this.zAi=!0,this.KAi=!0,this.XAi=!0,this.allowZoomTimescale=!0,this.IOProps=["allowAddTask","allowRemoveTask","allowReorderTask","allowZoomTimescale"],this.uAi=t}Object.defineProperty(n,"__esModule",{value:!0}),n.GanttUIOptions=void 0,e=i("./dist/plugins/gantt/gantt-json.js"),Object.defineProperty(r.prototype,"allowAddTask",{get:function(){return this.zAi&&this.uAi.canAddTask},set:function(t){this.zAi=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"allowRemoveTask",{get:function(){return this.KAi&&this.uAi.canRemoveTask},set:function(t){this.KAi=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"allowReorderTask",{get:function(){return this.XAi},set:function(t){this.XAi=t},enumerable:!1,configurable:!0}),r.prototype.toJSON=function(){return e.GanttSheetJsonConverter.toJSON(this,this.IOProps)},r.prototype.fromJSON=function(t){e.GanttSheetJsonConverter.fromJSON(this,t,this.IOProps)},n.GanttUIOptions=r},"./dist/plugins/gantt/gantt-outline.js":function(t,n,i){var e,i,e,s,o,r;function u(t){this.lAi=t}Object.defineProperty(n,"__esModule",{value:!0}),n.GanttOutline=void 0,e=i("Common"),i=i("./dist/plugins/gantt/gantt.ns.js"),s=(e=new e.Common.ResourceManager(i.SR,"GanttSheet")).getResource.bind(e),o=void 0,Object.defineProperty(u.prototype,"sheet",{get:function(){return this.lAi.getSheet()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"project",{get:function(){return this.lAi.project},enumerable:!1,configurable:!0}),u.prototype.isRowCollapsed=function(t){return this.sheet.rowOutlines.isCollapsed(t)},u.prototype.initOutlineColumn=function(){var t,n,t=this.Vji();-1<t&&(n=this.sheet).outlineColumn.options({columnIndex:t,showImage:!0,maxLevel:10})},u.prototype.updateOutlineColumnModel=function(){var t,n,i,e,s,r,u,u,t=this.Vji();if(-1!==t){for(i=(n=this.lAi).Mf,e=this.project.count,(s=n.options.allowAddNew)&&i.getCell(e,t).textIndent(o),r=0;r<e;r++)u=(u=this.project.getTaskByRow(r))?u.level:o,i.getCell(r,t).textIndent(u);i.outlineColumn.refresh(),i.rowOutlines.A2t=null}},u.prototype.Vji=function(){var t,n,i,e,s,r,t,n=this.lAi.getDataView(),i=-1;if(n)for(e=n.getColumnInfos(),s=0;s<e.length;s++)if("TaskSubject"===(r=e[s]).dataType){i=s;break}return i},u.prototype.backupCollapsedState=function(){for(var t,n,i,e,s,r,u,t=!1,n=[],i=this.project.count,e=this.sheet,s=0;s<i;s++)(r=e.rowOutlines.getCollapsed(s))&&(t=t||!0,n[u=this.project.getTaskByRow(s).taskNumber]=!0);if(t){for(s=0;s<i;s++)e.rowOutlines.setCollapsed(s,!1);this.iOi=n}},u.prototype.restoreCollapsedState=function(){var t,n,i,e,t=this.iOi;if(t){for(n=0;n<t.length;n++)t[n]&&(e=(i=this.project.getTask(n)).rowIndex,this.sheet.rowOutlines.setCollapsed(e,!0));this.iOi=null}},n.GanttOutline=u},"./dist/plugins/gantt/gantt-override.js":function(t,n,i){var a,c,r;function e(t){for(var n,i,e,s,n,i=0,e=Object.keys(r);i<e.length;i++)s=e[i],r[s].call(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.$Ai=void 0,a=i("Common"),c=i("Core"),r={ETi:function(){var t,v,o,s,h,i,r,u,e,t=this,v=this,o=v.Mf;o.NMi=this,o.hP=function(){var t=this.parent;return!t||t.getActiveSheetTab()===v},s=o.columnOutlines.setCollapsed,o.rowOutlines.setCollapsed=function(t,n,i){var e=v.project;e&&!e.keepOutlineStructure&&v.getTaskByRow(t)||s.call(this,t,n,i)},o.TF=function(){return t},h=o.getActualStyle,o.getActualStyle=function(t,n,i,e,s,r){var u,e,s,r,u=v.zDi(t),e=h.call(o,t,n,i,e,s,r);return u||(s=void 0===i||i===c.SheetArea.viewport,r=v.getGanttColumnIndex(),i!==c.SheetArea.colHeader&&n!==r||(e.cellPadding=void 0),s&&0<=t&&0<=n&&(n===r?v.mergeGanttTaskbarColumnStyle(t,e):v.margeGanttFieldColumnStyle(t,n,e))),e},i=o.getScrollTooltipContent,o.getScrollTooltipContent=function(t,n){var n;return n?(n=v.project.timescale.currentDateUtc,new a.Formatter.GeneralFormatter("yy-mm-dd").format(n)):i.call(o,t)},r=o.m6,o.m6=function(t,n,i){var e=o.hitTest(n,i);e.cellTypeHitInfo&&("Up"===e.cellTypeHitInfo.isReservedOnButton||"Down"===e.cellTypeHitInfo.isReservedOnButton)||r.call(o,t,n,i)},o.sortRange=function(t,n,i,e,s,r,u,o,h){for(var a,c,f,l,d,A,a=[],c=[],f,l=v.getDataView().getColumnInfos(),d=0;d<r.length;d++)l[r[d].index]&&(A=l[r[d].index].name,a.push(A),c.push(r[d].ascending));return v.project.sort(a,c),!1},o.JAi=function(){return!0},o.continuousPaginateLargeColumn=function(){return!0},u=o.getColumnWidth,o.getColumnWidth=function(t,n,i){var e,s,e=v.Kji,s=v.getGanttColumnIndex();return e&&n===c.SheetArea.viewport&&t===s?v.wAi():u.call(o,t,n,i)},e=o.Sy,o.Sy=function(t){var n;return v.Kji?v.zji():e.call(o,t)}}},n.$Ai=e},"./dist/plugins/gantt/gantt-renderer.js":function(t,n,i){var e,A,v,s,g,r,b,m,u,p,d,o,h,y,i,l,w,a,i,c,R,f,j,T,O,k;function S(t,n,i){this.endArrow=void 0,this.points=t,this.color=n,this.data=i}function M(){}function _(){return null!==j&&j.apply(this,arguments)||this}function x(){return null!==T&&T.apply(this,arguments)||this}function D(t){this.lAi=t,this.Ami=u(this.sheet.getCell(-1,-1).font())}function E(t){this.lAi=t,this.ymi=new a(t)}function C(t){return O.call(this,t)||this}function F(t){return k.call(this,t)||this}function N(t){var n,i,e,s,r,n;if(!t||!t.project)return null;for((i=t[n="__celltypeRenderers"])||(t[n]=i=[]),e=0,s=i;e<s.length;e++)if((r=s[e]).project===t.project)return r;return n=new c(t),i.push(n),n}e=this&&this.__extends||(f=function(t,n){return(f=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}f(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.vAi=n.GanttSheetRender=n.GanttCellTypeRenderer=n.GanttRenderer=void 0,A=i("Common"),v=i("Core"),s=i("./dist/plugins/gantt/gantt-sheet.js"),g=i("./dist/plugins/gantt/gantt-column.js"),r=i("./dist/plugins/gantt/project/calendar.js"),b=i("./dist/plugins/gantt/taskbar/renderer.js"),m=i("./dist/plugins/gantt/gantt.enum.js"),u=v.util.vt,p=A.Common.lt.ht,d=A.Common.ft.YGt,o=v.util.Mt,h=8,Object.defineProperty(S.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t},enumerable:!1,configurable:!0}),S.prototype.contains=function(t){var n,i,e,s,r,u;if(!(this.points.length<2))for(n=0;n<this.points.length-1;n++)if(i=this.points[n].x,e=this.points[n].y,s=this.points[n+1].x,r=this.points[n+1].y,u=3,t.x>Math.min(i,s)-3&&t.x<Math.max(i,s)+3&&t.y>Math.min(e,r)-3&&t.y<Math.max(e,r)+3)return!0;return!1},S.prototype.paint=function(t){var n,i;for(t.beginPath(),t.moveTo(this.points[0].x+.5,this.points[0].y+.5),n=1;n<this.points.length;n++)i=this.points[n],t.lineTo(i.x+.5,i.y+.5);t.strokeStyle=this.color,t.stroke(),this.endArrow&&this.jmi(t,this.endArrow)},S.prototype.jmi=function(t,n){var i,e,s,r;if(this.endArrow){switch(e=(i=this.points[this.points.length-1]).x,s=i.y,t.beginPath(),r=4,t.moveTo(e,s),n){case"Left":t.lineTo(e+4,s-4),t.lineTo(e+4,s+4);break;case"Right":t.lineTo(e-4,s-4),t.lineTo(e-4,s+4);break;case"Top":t.lineTo(e-4,s-4),t.lineTo(e+4,s-4);break;case"Bottom":t.lineTo(e-4,s+4),t.lineTo(e+4,s+4)}t.closePath(),t.fillStyle=this.color,t.fill()}},y=S,M.prototype.maxDate=function(t,n){return t<n?n:t},M.prototype.minDate=function(t,n){return t<n?t:n},M.prototype.getLinePoints=function(t,n,i,e,s){var r,u,e,o,h,a,c,e,f,l,d,A,r=e.y,u=e.height,e=this.layoutLineX(t,n,i),o=e[0],h=e[1],a=e[2],c=e[3],e=this.layoutLineY(t,n,i),f=e[0],l=e[1],d=e[2],A=this.getArrowDirection(t,n,i);switch(s){case"cross":return[{x:a,y:r},{x:a,y:r+u}];case"start":return[{x:o,y:f},{x:h,y:f},{x:h,y:l},{x:a,y:l},{x:a,y:n.viewIndex<i.viewIndex?r+u:r}];case"end":return"Top"===A?[{x:a,y:n.viewIndex<i.viewIndex?r:r+u},{x:a,y:d}]:[{x:a,y:n.viewIndex<i.viewIndex?r:r+u},{x:a,y:d},{x:c,y:d}]}},e(_,j=i=M),_.prototype.getArrowDirection=function(t,n,i){switch(t){case"SS":case"FS":return"Right";case"FF":case"SF":return"Left"}},_.prototype.layoutLineX=function(t,n,i){var e,s,r,u,o,h,e=n.bounds,s=i.bounds;switch(t){case"SS":r=e.x,u=e.x-8,o=Math.min(u,s.x-8),h=s.x;break;case"SF":r=e.x,u=e.x-8,o=s.x+s.w+8,h=s.x+s.w;break;case"FS":r=e.x+e.w,o=(u=e.x+e.w+8)<(o=s.x-8)?u:o,h=s.x;break;case"FF":r=e.x+e.w,o=u=Math.max(e.x+e.w,s.x+s.w)+8,h=s.x+s.w}return[r,u,o,h]},_.prototype.layoutLineY=function(t,n,i){var e,s,r,u,o,e=n.bounds,s=i.bounds,r,u,o;return[e.y+e.h/2,n.viewIndex<i.viewIndex?n.cellRect.y+n.cellRect.height-2:n.cellRect.y+1,s.y+s.h/2]},l=_,e(x,T=i),x.prototype.getArrowDirection=function(t,n,i){var e,s,e=n.bounds,s=i.bounds;switch(t){case"FS":return e.x+e.w<=s.x+5?n.viewIndex<i.viewIndex?"Top":"Bottom":"Right";case"SS":return"Right";case"FF":case"SF":return"Left"}},x.prototype.layoutLineX=function(t,n,i){var e,s,r,u,o,h,e=n.bounds,s=i.bounds;switch(t){case"SS":r=e.x,o=u=Math.min(e.x-8,s.x-8),h=s.x;break;case"SF":r=e.x,u=e.x-8,o=s.x+s.w+8,h=s.x+s.w;break;case"FS":r=e.x+e.w,h=e.x+e.w<=s.x+5?u=o=Math.max(s.x,e.x+e.w+5):(o=(u=Math.max(e.x+e.w+8,s.x-8))<(o=s.x-8)?u:o,s.x);break;case"FF":r=e.x+e.w,o=u=Math.max(e.x+e.w,s.x+s.w)+8,h=s.x+s.w}return[r,u,o,h]},x.prototype.layoutLineY=function(t,n,i){var e,s,r,u,o,e=n.bounds,s=i.bounds,r=e.y+e.h/2,u=n.viewIndex<i.viewIndex?n.cellRect.y+n.cellRect.height-2:n.cellRect.y+1,o=s.y+s.h/2;return[r,u,o="FS"===t&&e.x+e.w<=s.x+5?n.viewIndex<i.viewIndex?s.y:s.y+s.h:o]},w=x,Object.defineProperty(D.prototype,"sheet",{get:function(){return this.lAi.Mf},enumerable:!1,configurable:!0}),Object.defineProperty(D.prototype,"project",{get:function(){return this.lAi.project},enumerable:!1,configurable:!0}),D.prototype.getMiddleHeight=function(){var t,t,t,t,t,t,t,t,n,n=this.project.layout.barHeight;return n=this.lAi instanceof s.GanttSheet&&(this.project.Omi.hasLeftText&&null!=(t=null==(t=this.lAi)?void 0:t.taskbarColumn)&&t.taskbarLeftTextStyle&&(n=Math.max(this.getTextActualHeight(null==(t=null==(t=this.lAi)?void 0:t.taskbarColumn)?void 0:t.taskbarLeftTextStyle),n)),this.project.Omi.hasRightText)&&null!=(t=null==(t=this.lAi)?void 0:t.taskbarColumn)&&t.taskbarRightTextStyle?Math.max(this.getTextActualHeight(null==(t=null==(t=this.lAi)?void 0:t.taskbarColumn)?void 0:t.taskbarRightTextStyle),n):n},D.prototype.getTopHeight=function(t){var n,n,n,n,t,t=Math.max((D.minHeight-t)/2,3);return this.lAi instanceof s.GanttSheet&&this.project.Omi.hasTopText&&null!=(n=null==(n=this.lAi)?void 0:n.taskbarColumn)&&n.taskbarTopTextStyle?this.getTextActualHeight(null==(n=null==(n=this.lAi)?void 0:n.taskbarColumn)?void 0:n.taskbarTopTextStyle):t},D.prototype.getBottomHeight=function(t){var n,n,n,n,t,t=Math.max((D.minHeight-t)/2,2);return this.lAi instanceof s.GanttSheet&&this.project.Omi.hasBottomText&&null!=(n=null==(n=this.lAi)?void 0:n.taskbarColumn)&&n.taskbarBottomTextStyle?this.getTextActualHeight(null==(n=null==(n=this.lAi)?void 0:n.taskbarColumn)?void 0:n.taskbarBottomTextStyle):t},D.prototype.getTextActualHeight=function(t){return t.font?u(t.font):this.Ami},D.prototype.updateHeightWithTaskStyle=function(i,e,s){var r=this;return this.project.tasks.forEach(function(t){var n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,n,t,t;t.style&&(null!=(n=null==(n=null==(n=(t=t.getBarStyleRules()[0]).style)?void 0:n.taskbarStyle)?void 0:n.leftTextStyle)&&n.font&&(i=Math.max(r.getTextActualHeight(null==(n=null==(n=t.style)?void 0:n.taskbarStyle)?void 0:n.leftTextStyle),i)),null!=(n=null==(n=null==(n=t.style)?void 0:n.taskbarStyle)?void 0:n.rightTextStyle)&&n.font&&(i=Math.max(r.getTextActualHeight(null==(n=null==(n=t.style)?void 0:n.taskbarStyle)?void 0:n.rightTextStyle),i)),null!=(n=null==(n=null==(n=t.style)?void 0:n.taskbarStyle)?void 0:n.topTextStyle)&&n.font&&(e=Math.max(r.getTextActualHeight(null==(n=null==(n=t.style)?void 0:n.taskbarStyle)?void 0:n.topTextStyle)+2,e)),null!=(n=null==(n=null==(n=t.style)?void 0:n.taskbarStyle)?void 0:n.bottomTextStyle))&&n.font&&(s=Math.max(r.getTextActualHeight(null==(t=null==(n=t.style)?void 0:n.taskbarStyle)?void 0:t.bottomTextStyle)+2,s))}),[i,e,s]},D.prototype.getRowHeight=function(){var t,n,i,e,n=this.getMiddleHeight(),i=this.getTopHeight(n),e=this.getBottomHeight(n),t=this.updateHeightWithTaskStyle(n,i,e);return n=t[0],{height:(i=t[1])+n+(e=t[2]),topHeight:i,middleHeight:n,bottomHeight:e}},D.prototype.getData=function(){return this.getRowHeight()},D.minHeight=30,a=D,Object.defineProperty(E.prototype,"sheet",{get:function(){return this.lAi.Mf},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"project",{get:function(){return this.lAi.project},enumerable:!1,configurable:!0}),E.prototype.calcDateWidth=function(t,n){return this.calcDateLocation(0,n)-this.calcDateLocation(0,t)},E.prototype.calcDateLocation=function(t,n){return t+Math.floor(this.project.timescale.getOffsetByDateUtc(n))},E.prototype.getBarStyleRowHeight=function(){return this.ymi.getData().height},E.prototype.getLineTaskbarStyle=function(t){var n;return t.getBarStyleRules()[0]},E.prototype.clipBackgroundRects=function(t,n,i,e,s){for(var r,u,o,u,h,o,r=this.project.timescale.currentDateUtc;o=(u=this.project.timescale.getDateUtcRange(r))[0],u=u[1],!(n+e<=(h=this.calcDateLocation(n,o)));)this.project.timescale.nonWorkingTime.calendar.isNonWorkingArea(o,u)||(o=this.calcDateWidth(o,u),h=Math.floor(h),o=Math.floor(h+o)-h,t.rect(h,i,o,s)),r=u;t.clip()},E.prototype.paintTierColumns=function(t,n,i,e,s){var r={};this.project.timescale.tierMode!==m.TimescaleTierMode.middle&&this.paintTierColumn(t,n,i,e,s,this.lAi.gridlines.bottomTierColumn,this.project.timescale.bottomTier,r),this.paintTierColumn(t,n,i,e,s,this.lAi.gridlines.middleTierColumn,this.project.timescale.middleTier,r),this.project.timescale.tierMode===m.TimescaleTierMode.topMiddleBottom&&this.paintTierColumn(t,n,i,e,s,this.lAi.gridlines.topTierColumn,this.project.timescale.topTier,r)},E.prototype.paintTierColumn=function(t,n,i,e,s,r,u,o){var h,a,c,f,c,l,f,d;if(r&&r.lineType!==m.GanttGridlineType.empty)for(a=h=this.project.timescale.currentDateUtc;;){if(f=(c=this.project.timescale.getDateUtcRange(a,u.unit,u.count))[0],c=c[1],n+e<=(l=n+this.project.timescale.getOffsetByDateUtc(f)))break;o[f=n+this.project.timescale.getOffsetByDateUtc(c)]||(f=Math.floor(f)+.5,(d=(0,v.Zx)(f,i,f,i+s,r.lineColor,r.lineType))._e(t),o[f]=!0),a=c}},E.prototype.paintSpecialLines=function(t,n,i,e,s){var r,u,o,h,r=this.lAi.gridlines,u=this.project.layout.roundBarsToWholeDays?this.roundDateUtcWholeDay(this.project.startDateUtc):this.project.startDateUtc,o=this.project.layout.roundBarsToWholeDays?this.roundDateUtcWholeDay(this.project.finishDateUtc):this.project.finishDateUtc,h=this.project.layout.roundBarsToWholeDays?this.roundDateUtcWholeDay(this.project.currentDateUtc):this.project.currentDateUtc;this.paintSingleGridline(r.projectStart,u,t,n,i,e,s),this.paintSingleGridline(r.projectFinish,o,t,n,i,e,s),this.paintSingleGridline(r.currentDate,h,t,n,i,e,s)},E.prototype.paintSingleGridline=function(t,n,i,e,s,r,u){var r,o;t&&t.lineType!==m.GanttGridlineType.empty&&n&&(e+r<=(r=e+this.project.timescale.getOffsetByDateUtc(n))||r<e||(r=Math.floor(r)+.5,(o=(0,v.Zx)(r,s+.5,r,s+u+.5,t.lineColor,t.lineType))._e(i)))},E.getTextWidthAndHeight=function(t,n,i){var e,s,e=p(n)?0:u(i),s;return[o(t,i,n)+3,e]},E.prototype.layoutLinkEndInfo=function(t,n,i){var e,e,s,e,r,u,e=this.layoutTask(n,i.x,i.y);if(e)return e=(e=e[0]).styleRule.style.taskbarStyle.middleShape?(s=E.getTaskbarMiddleBounds(e.bounds,e.styleRule.style.taskbarStyle.middleShape),e.styleRule.style.taskbarStyle.middleColor):(s=E.getTaskbarMiddleBounds(e.bounds,"rectangleBar"),r=void 0,e.styleRule.style.taskbarStyle.startShape&&!p(e.styleRule.style.taskbarStyle.startShape)&&(r=e.styleRule.style.taskbarStyle.startColor),u=void 0,e.styleRule.style.taskbarStyle.endShape&&!p(e.styleRule.style.taskbarStyle.endShape)&&(u=e.styleRule.style.taskbarStyle.endColor),t?r||u:u||r),s?{bounds:s,color:e,viewIndex:n.viewIndex,cellRect:i}:void 0},E.prototype.layoutTask=function(n,i,e){var s,t,s=this,t=n.getBarStyleRules();if(!p(t)&&0!==t.length)return t.map(function(t){return s.layoutTaskCore(n,t,i,e)})},E.prototype.layoutTaskCore=function(t,n,i,e){var s,r,t,s,r,u,i,s,r,o,s=n.getFromDate(t),r=n.getToDate(t),t=n.getScale(t),s=this.tAe(s),r=this.tAe(r),u=this.project.layout.barHeight,i=this.calcDateLocation(i,s),s=Math.max(this.calcDateWidth(s,r)*t,1),r=e;return{styleRule:n,bounds:o={x:i,y:r+=this.ymi.getData().topHeight+(this.ymi.getData().middleHeight-u)/2,w:s,h:u}}},E.prototype.tAe=function(t){t instanceof Date||(t=this.project.getDefaultStartDate());var t=r.Calendar.localToUTC(t);return t=this.project.layout.roundBarsToWholeDays?this.roundDateUtcWholeDay(t):t},E.prototype.nAe=function(t){var n,t,n,t,n=t.startDisplayed,t=t.finishDisplayed,n=this.tAe(n),t=this.tAe(t);return Math.max(this.calcDateWidth(n,t),1)},E.prototype.getProjectLength=function(t){var n,t,n=r.Calendar.localToUTC(t.startDisplayed),t=r.Calendar.localToUTC(t.finishDisplayed);return n=this.roundDateUtcWholeDay(n),t=this.roundDateUtcWholeDay(t),Math.max(this.calcDateWidth(n,t),1)},E.prototype.roundDateUtcWholeDay=function(t){var n,i,e,e,s,r,u,s,o,s,n=864e5,i=t.valueOf(),e=i%n;return e<0&&(e+=n),i<=(r=(e=i-e)+60*(60*(s=this.project.calendarSettings.defaultStartTime).hour+s.minute)*1e3)?(u=this.project.timescale.getDateUtcRange(t),new Date(Math.max(u[0].valueOf(),e))):(o=e+60*(60*(s=this.project.calendarSettings.defaultFinishTime).hour+s.minute)*1e3)<=i?(s=(u=this.project.timescale.getDateUtcRange(t))[0].valueOf()===t.valueOf()?t:u[1],new Date(Math.min(s.valueOf(),e+n))):t},E.getTaskbarMiddleBounds=function(t,n){if(n){var i=t.x,e=t.y,s=t.w,r=t.h;switch(n){case"lineTop":e+=1,r=2;break;case"lineMiddle":e+=r/2-1,r=2;break;case"lineBottom":e+=r-2,r=2;break;case"rectangleTop":r/=2;break;case"rectangleMiddle":e+=r/3,r/=3;break;case"rectangleBottom":e+=r/2,r/=2;break;case"rectangleBar":e+=1,r-=2}return{x:i,y:e,w:s,h:r}}},E.getTaskbarStartBounds=function(t){var n=t.x,i=t.y,t=t.h;return{x:n-(t-=2)/2,y:i+1,w:t,h:t}},E.getTaskbarEndBounds=function(t){var n=t.x,i=t.y,e=t.w,t=t.h;return{x:n+e-(t-=2)/2,y:i+1,w:t,h:t}},E.prototype.getOffsetX=function(t,n){},E.prototype.getOffsetY=function(t,n){},E.prototype.getActionPendingBounds=function(t){var n,i,e,s,r,n=t.task,i=t.styleRule;if(n&&i){switch(e=this.layoutTaskCore(n,i,this.getOffsetX(t.rowIndex,t.colIndex),this.getOffsetY(t.rowIndex,t.colIndex)).bounds,s=t.partName){case m.BarPartName.Start:(r=E.getTaskbarStartBounds(e)).x+=t.movedX;break;case m.BarPartName.End:(r=E.getTaskbarEndBounds(e)).x+=t.movedX;break;case m.BarPartName.Middle:r=E.getTaskbarMiddleBounds(e,i.style.taskbarStyle.middleShape),t.stretchX?(r.w+=t.stretchX,r.w<0&&(r.w=Math.abs(r.w),r.x-=r.w)):r.x+=t.movedX;break;case m.BarPartName.Whole:r=e,t.stretchX?(r.w+=t.stretchX,r.w<0&&(r.w=Math.abs(r.w),r.x-=r.w)):r.x+=t.movedX}return r}},n.GanttRenderer=i=E,e(C,O=i),C.prototype.paintTask=function(t,n,i,e,s,r,u,o,h,a){var c,f,l,d,A,c=this.getTaskLayoutData(n,i,e,s),f;switch(this.project.timescale.nonWorkingTime.drawMode){case"None":case"Behind":this.paintTierColumns(t,i,e,s,r),this.paintTaskbars(t,c)}if(this.paintSpecialLines(t,i,e,s,r),c)for(l=0,d=c;l<d.length;l++)A=d[l],this.paintBarText(t,n,A.styleRule.style.taskbarStyle,A.bounds,u,o,h,a)},C.prototype.getTaskLayoutData=function(t,n,i,e){if(t)return this.layoutTask(t,n,i)},C.prototype.paintTaskbars=function(t,n){var i,e,s;if(n)for(i=0,e=n;i<e.length;i++)s=e[i],C.paintTaskbar(t,s.styleRule.style.taskbarStyle,s.bounds)},C.paintTaskbar=function(t,n,i){C.drawMiddle(t,n,C.getTaskbarMiddleBounds(i,null==n?void 0:n.middleShape)),C.drawStart(t,n,C.getTaskbarStartBounds(i)),C.drawEnd(t,n,C.getTaskbarEndBounds(i))},C.drawMiddle=function(t,n,i){null!=n&&n.middleShape&&b.BarPainter.draw(t,n.middlePattern||"solidFill",n.middleColor||"#000000",i)},C.drawStart=function(t,n,i){p(null==n?void 0:n.startShape)||p(i)||("triangleLeft"!==n.startShape&&"triangleRight"!==n.startShape||(i.x-=i.w/2),b.BarEndPainter.draw(t,n.startShape,n.startType||"solid",n.startColor||"#000000",i))},C.drawEnd=function(t,n,i){p(null==n?void 0:n.endShape)||p(i)||("triangleLeft"!==n.startShape&&"triangleRight"!==n.startShape||(i.x+=i.w/2),b.BarEndPainter.draw(t,n.endShape,n.endType||"solid",n.endColor||"#000000",i))},C.prototype.paintBarText=function(t,n,i,e,s,r,u,o){var h=6;this.paintBarTextCore(t,u,n,i.leftText,i.leftTextStyle||{},s,e,r,o,function(t,n,i){return[i.x-t-6,i.y+(i.h-n)/2,t,n]}),this.paintBarTextCore(t,u,n,i.rightText,i.rightTextStyle||{},s,e,r,o,function(t,n,i){return[i.x+i.w+6,i.y+(i.h-n)/2,t,n]}),this.paintBarTextCore(t,u,n,i.topText,i.topTextStyle||{},s,e,r,o,function(t,n,i){return[i.x+i.w/2-t/2,i.y-n,t,n]}),this.paintBarTextCore(t,u,n,i.bottomText,i.bottomTextStyle||{},s,e,r,o,function(t,n,i){return[i.x+i.w/2-t/2,i.y+i.h,t,n]}),this.paintBarTextCore(t,u,n,i.insideText,i.insideTextStyle||{},s,e,r,o,function(t,n,i){var e,t,e=t;return t>i.w&&(e=i.w-6),t=Math.min(t,i.h),[i.x+6,i.y+(i.h-t)/2,e,t]})},C.prototype.paintBarTextCore=function(t,n,i,e,s,r,u,o,h,a){var c,f,f,e,i,f,l,d,r,s,i,a,f;if(!p(e)&&""!==e.trim()){if((f="="===e[0]?(f=i.rowIndex-1,this.lAi.evaluateCalcColumnFormula(f,e)):this.project.taskManager.getTaskValue(i,e))&&this.lAi.Epi(f))c=this.lAi.mapping.formatDuration(f);else if(f instanceof Date)c=new A.Formatter.GeneralFormatter(i.project.layout.barTextDateFormat).format(f);else{if(p(f))return;c="".concat(f)}(e=r.clone()).vAlign=v.VerticalAlign.center,s&&(0,g.mergeTextStyle)(s,e),s.font||(i=this.sheet.currentTheme().bodyFont(),e.font="bold normal 10pt ".concat(i)),s=(r=a(l=(f=C.getTextWidthAndHeight(t,c,e.font))[0],d=f[1],u))[0],i=r[1],a=r[2],f=r[3],h.call(n,t,c,s,i,a,f,e,o)}},C.prototype.paintLinkLines=function(t,n,i,e,s,r,u,o){var n,h,a,c,f;switch(n.layout.linkLineMode){case"toTop":this.lineLayout=new w;break;case"toEnd":this.lineLayout=new l;break;case"noLinks":return}for(n=new v.Rect(s,r,u,o),a=0,c=h=this.getLinkLines(e,n);a<c.length;a++)(f=c[a]).paint(t)},C.prototype.getLinkLines=function(t,n){var t,i,e,t,n,s,t=this.project.kmi(t);return t?(i=this.getLineData(t.startLines,"start",n),e=this.getLineData(t.crossLines,"cross",n),t=this.getLineData(t.endLines,"end",n),(n=i.concat(e).concat(t)).sort(s=function(t,n){return t.data.from.viewIndex-n.data.from.viewIndex}),n):[]},C.prototype.getLineData=function(t,n,i){for(var e,s,r,u,o,h,a,c,a,c,f,l,f,e=this,s=function(t){return!e.project.host||e.project.host.getRowVisible(t.from.viewIndex)&&e.project.host.getRowVisible(t.to.viewIndex)},r=[],u=0,o=t;u<o.length;u++)a="SS"===(h=o[u]).type||"SF"===h.type,c="SS"===h.type||"FS"===h.type,a=this.layoutLinkEndInfo(a,h.from,i),c=this.layoutLinkEndInfo(c,h.to,i),s(h)&&a&&c&&this.lineLayout&&(f=this.lineLayout.getLinePoints(h.type,a,c,i,n),l=d(a.color,-.8),f=new y(f,l,h),"end"===n&&(f.endArrow=this.lineLayout.getArrowDirection(h.type,a,c)),r.push(f));return r},C.prototype.paintActionPending=function(t,n){var i;"Link"===n.command?(this.paintActionGraph(t,(i=n).getPendingFromTaskInfo()),this.paintActionLink(t,i.getPendingLinkInfo()),i.getPendingToTaskInfo()&&this.paintActionGraph(t,i.getPendingToTaskInfo())):this.paintActionGraph(t,n.getBarPendingInfo())},C.prototype.paintActionGraph=function(t,n){var i,n,i=this.getActionPendingBounds(n);i&&(--i.x,i.y-=2,i.h+=2,i.w+=2,n.partName===m.BarPartName.Middle||n.partName===m.BarPartName.Whole?this.paintActionRect(t,i):(n=n.partName===m.BarPartName.Start?n.styleRule.style.taskbarStyle.startShape:n.styleRule.style.taskbarStyle.endShape,b.BarEndPainter.draw(t,n,"framed","#808080",i)))},C.prototype.paintActionRect=function(t,n){n&&(t.lineWidth=1,t.strokeStyle="#808080",t.strokeRect(n.x,n.y,n.w,n.h))},C.prototype.paintActionLink=function(t,n){var i,n,i={x:n.startX,y:n.startY},n={x:i.x+n.movedX,y:i.y+n.movedY};t.beginPath(),t.lineWidth=1,t.strokeStyle="#808080",t.moveTo(i.x,i.y),t.lineTo(n.x,n.y),t.closePath(),t.stroke()},C.prototype.getTaskRect=function(t,n,i){return this.layoutTaskCore(t,n,i.x,i.y).bounds},C.prototype.getOffsetX=function(t,n){return this.sheet.getCellRect(t,n).x},C.prototype.getOffsetY=function(t,n){return this.sheet.getCellRect(t,n).y},c=C,n.GanttCellTypeRenderer=c,k=v.g7,e(F,k),F.prototype.eO=function(t,n,i,e,s,r,u,o,h){void 0===u&&(u=0),void 0===o&&(o=0),void 0===h&&(h=1),this.Mmi(n,i)&&this.paintNonworkingBackground(t,n[0].x,n[0].y,n[0].width,n[n.length-1].y+n[n.length-1].height-n[0].y),k.prototype.eO.call(this,t,n,i,e,s,r,u,o,h)},F.prototype.Mmi=function(t,n){var i=this.Mf.NMi;return 0!==t.length&&n===v.SheetArea.viewport&&t.filter(function(t){return t.col===i.getGanttColumnIndex()}).length===t.length},F.prototype.paintNonworkingBackground=function(t,n,i,e,s){var r,u,o,h,a,c,f,c,l,f,d,r,u=this.Mf.NMi.project;if("None"!==u.timescale.nonWorkingTime.drawMode)for(o=u.timescale.currentDateUtc,h=u.timescale.nonWorkingTime.color,a=u.timescale.nonWorkingTime.pattern;;){if(f=(c=u.timescale.getDateUtcRange(o))[0],c=c[1],n+e<=(l=this.calcDateLocation(n,f)))break;u.timescale.nonWorkingTime.calendar.isNonWorkingArea(f,c)&&(f=this.calcDateWidth(f,c),l=Math.floor(l),f=Math.floor(l+f)-l,b.BarPainter.draw(t,a,h,d={x:l,y:i,w:f,h:s},!1)),o=c}},F.prototype.calcDateLocation=function(t,n){var i,e,i,e=this.Mf.NMi.project;return t+Math.floor(e.timescale.getOffsetByDateUtc(n))},F.prototype.calcDateWidth=function(t,n){return this.calcDateLocation(0,n)-this.calcDateLocation(0,t)},n.GanttSheetRender=F,n.vAi=N,v.Worksheet.ch("GanttsheetRender",{dispose:function(t){var n=this;!1!==t.clearCache&&n.Dn&&(n.Dn.Mf=null,n.Dn=null)}})},"./dist/plugins/gantt/gantt-sheet.js":function(I,t,n){var i,e,S,s,r,u,o,a,h,c,f,l,d,A,v,g,b,M,m,O,p,_,B,T,y,n,w,L,k,j,P,x,D,E,C;function F(t){return"number"==typeof t}function N(t){return"string"==typeof t}function R(t,n,i){var e=C.call(this,t,n,i)||this;return e._gi=S.SheetType.ganttSheet,e.yAe=[],e.IOProps=["project","gridlines"],e.xmi=function(t){return e.Dmi(t)},e}function U(t){var n=t.floatingObjects;n&&(t.floatingObjects=n.filter(function(t){return!t.isGanttChart}),0===t.floatingObjects.length)&&delete t.floatingObjects}function H(t){var n,i,n=t.style;if(n&&n.cellType)switch(i=n.cellType.typeName){case"TaskComplete":n.cellType.typeName="100";break;case"TaskDate":n.cellType.typeName="101";break;case"TaskDuration":n.cellType.typeName="102";break;case"TaskPredecessor":n.cellType.typeName="103";break;case"TaskResources":n.cellType.typeName="104";break;case"TaskSubject":n.cellType.typeName="105";break;case"Taskbar":n.cellType.typeName="106";break;case"Timescale":n.cellType.typeName="107"}}function G(){var t="GanttSheet"+D.rL;return D.rL++,t}function Q(t){for(var n=G(),i=0;i<t.length;)t[i].name()===n?(n=G(),i=0):i++;return n}i=this&&this.__extends||(E=function(t,n){return(E=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}E(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(t,"__esModule",{value:!0}),t.GanttSheet=void 0,e=n("Common"),S=n("Core"),s=n("Filters"),r=n("TableSheet"),u=n("./dist/plugins/gantt/utils/mapping.js"),o=n("./dist/plugins/gantt/gantt-renderer.js"),a=n("./dist/plugins/gantt/gantt-filter.js"),h=n("./dist/plugins/gantt/gantt-outline.js"),c=n("./dist/plugins/gantt/gantt-events.js"),f=n("./dist/plugins/gantt/gantt-options.js"),l=n("./dist/plugins/gantt/gantt-column.js"),d=n("./dist/plugins/gantt/gantt-chart.js"),A=n("./dist/plugins/gantt/gantt-json.js"),v=n("./dist/plugins/gantt/gantt-override.js"),g=n("./dist/plugins/gantt/project/project.js"),b=n("./dist/plugins/gantt/project/calendar.js"),M=n("./dist/plugins/gantt/celltypes/timescales.js"),m=n("./dist/plugins/gantt/celltypes/taskbar.js"),O=n("./dist/plugins/gantt/gantt.enum.js"),p=n("./dist/plugins/gantt/gantt-gridline.js"),_=n("FloatingObject"),B=n("./dist/plugins/gantt/gantt.ns.js"),T=n("./dist/plugins/gantt/gantt-sort.js"),y=n("./dist/plugins/gantt/utils/util.js"),n=new e.Common.ResourceManager(B.SR,"GanttSheet"),w=n.getResource.bind(n),L="start",k=e.Common.lt.ht,j="_ganttColumn",P=e.Common.lt.tv,x=e.Common.ct.W0,C=r.TableSheet,i(R,C),R.prototype.Hc=function(t,n){this.suspendPaint(),C.prototype.Hc.call(this,t,n),this.Cmi(),this.applyTableTheme(),(0,v.$Ai)(this),t&&(this.Hji=null,this.Emi()),this.resumePaint()},R.prototype.hji=function(){return this.Mf.options},R.prototype.Ob=function(t,n,i){var e,n;"allowAddNew"===t?!0===n&&!1===i?C.prototype.CNi.call(this):!1===n&&!0===i&&C.prototype.rTi.call(this):"enableGanttColumn"===t?(e=this.getDataView())&&(!0===n&&!1===i?this.bindGanttView(e):!1===n&&!0===i&&(this.removeGanttColumn(e),this.bindGanttView(e))):"sheetTabColor"===t&&(n=this.getParent(),k(n.getHost())||n.AC(!1))},Object.defineProperty(R.prototype,"rowStyleSelector",{get:function(){return this.xmi},set:function(t){this.xmi=t,this.project.Rmi.invoke()},enumerable:!1,configurable:!0}),R.prototype.adrs=function(){var t,n,t=this.name(),n=this.getParent();n.suspendPaint(),n.removeSheetTab(t),n.setActiveSheetIndex(0),n.resumePaint()},R.prototype.getActiveTask=function(){var t=this.getActiveRowIndex();return this.getTaskByRow(t)},R.prototype.getTaskByRow=function(t){var t;return-1!==t&&(t=this.project.getRowState(t))?t.task:null},R.prototype.getTaskNumberByRow=function(t){return this.project.getRowState(t).taskNumber},R.prototype.getDefaultOptions=function(){return{enableGanttColumn:!0,allowAddNew:!0,sheetTabColor:void 0}},R.prototype.Sji=function(t){var n=this.project.count+(this.options.allowAddNew?1:0);t?this.Mf.setRowCount(n):this.lNi(n)},R.prototype.resumePaint=function(){this.Mf.resumePaint()},R.prototype.GNi=function(t,n){var i,e,s,r,i=this.Mf;this.project.clearBackupTasks(),this.project.suspendDirty(),this.suspendPaint(),s=(e=i.getRowCount())-1,r=i.getColumnCount(),i.Ut.clear(0,0,s,r,S.StorageType.data,[]),i.clearPendingChanges({row:0,col:0,rowCount:s,colCount:r,clearType:S.ClearPendingChangeType.dirty|S.ClearPendingChangeType.insert|S.ClearPendingChangeType.delete}),n&&this.EDi(),this.Emi(),this.project.resumeDirty(),this.eOi(),this.resumePaint()},R.prototype.ENi=function(t){var n;t&&t.data&&(this.suspendPaint(),this.pAe(t.data),this.resumePaint()),this.Mf.repaint()},R.prototype.pAe=function(t){var n,i,e,s,r,u,r,r,o,h,a,c,n=this.getDataView().gLt.primaryKey();if(n)for(i="parentId",e=0,s=t;e<s.length;e++)if(u=(r=s[e])[n],F(r=r.taskNumber)&&(r=this.project.getTask(r))&&(r.setDataValue(n,u),o=r.Fpi())&&0<o.length)for(h=0,a=o;h<a.length;h++)(c=a[h]).setDataValue(i,u)},R.prototype.FM=function(){this.Mf.FM()},R.prototype.Fmi=function(){this.Mf.repaint()},R.prototype.L0=function(t,n){C.prototype.L0.call(this,t,n),this.Nmi=null},R.prototype.gp=function(){var t,n,t=!1,n=this.Mf;return t=n&&n.parent?!!n.parent.Gie:t},R.prototype.fDi=function(t){var n,i,e,i,n,i=this.Mf.getDataSource();return i?t>=(i=i.getColumnInfos()).length?null:i[t]:(e=this.gp())&&this.Bmi?this.Bmi[t]:null},R.prototype.uOi=function(t,n){var t,i,t,t=this.qji(t),i,t=this.getDataView().getRowData(t);return t?t[n]:void 0},R.prototype.setSelection=function(t,n,i,e){this.Mf.setSelection(t,n,i,e)},R.prototype.getActiveRowIndex=function(){return this.Mf.getActiveRowIndex()},R.prototype.sOi=function(t){var n=this.options;t.options={enableGanttColumn:n.enableGanttColumn}},R.prototype.rOi=function(t){var t=t.options;k(t.enableGanttColumn)||(this.options.enableGanttColumn=t.enableGanttColumn)},R.prototype.toJSON=function(t){var n,i,e,s,r,u,u,e,r,t,o,h,a,c,i,f,l,e,d,n=t&&t.gp,i=t&&t.includeBindingSource,e=this.getGanttColumnIndex(),s=-1<e,r=this.Mf.getColumnWidth(e);if(n&&s&&(u=this.wAi(),this.Mf.setColumnWidth(e,u),this.Mf.frozenTrailingColumnCount(0),t.includeBindingSource=!1),u=C.prototype.toJSON.call(this,t),n&&s&&(this.Mf.setColumnWidth(e,r),this.Mf.frozenTrailingColumnCount(1),t.includeBindingSource=i),e=A.GanttSheetJsonConverter.toJSON(this,this.IOProps),this.sOi(e),u.sheetType=this._gi,u.gantt=e,s&&(r=this.getGanttChartPicture(this.name()),u.floatingObjects||(u.floatingObjects=[]),(t=r.toJSON()).isGanttChart=!0,u.floatingObjects.push(t)),n){for(h=(o=this.getDataView()).length(),a=[],c=[],i=o.getColumnInfos(),f=0;f<h;f++)a[f]=o.getRowData(f),o.isHierarchy()&&(l=o.getHierarchyNode(f),c.push({id:l.id,parentId:l.parentId,level:l.level}));(e=0)<a.length&&o.isHierarchy()&&(e=(d=o.getHierarchyRootNode()).level),u.gantt.dataViewForPrint={data:a,columns:i,hierarchyNodes:c,rootLevel:e}}return u},R.prototype.fromJSON=function(t,n,i,e,s){var r,n,r=e&&e.gp;this.suspendEvent(),this.suspendPaint(),this.project.suspendSchedule(),this.rOi(t.gantt),A.GanttSheetJsonConverter.fromJSON(this,t.gantt,this.IOProps),C.prototype.fromJSON.call(this,t,n,i,e,s),r&&(n=t.gantt.dataViewForPrint)&&(this.Emi(n),this.Bmi=n.columns),this.project.resumeSchedule(),this.resumeEvent(),this.resumePaint()},R.prototype.getGanttChartPicture=function(t){var n,i,e,s,r,u,o,h,a,c,f,l,d,A,v,g,e,l,i,t,b,m,p,y,w,e,j,T,O,k;if(this.Kji=!0,i=(n=this.Mf).Dn,s=(e=this.project).timescale,r=this.getGanttColumnIndex(),o=(u=n.yw(2)[0]).x,h=n.getColumnCount(),a=this.wAi(),l=(c=(0,M.getTimescaleHeight)(e.timescale.tierMode,n.zoom()))+(f=this.zji()),d=e.count,A=s.currentDate,v=n.Tb,g=n.ly,n.Tb=0,n.ly=0,s.scrollTo(e.startDate),(e=this.Nmi)||((e=document.createElement("canvas")).style.width=a+"px",e.style.height=l+"px",e.width=a,e.height=l,S.Bf.Wl(e,this.getParent(),n),S.Bf.$l(e,a,l),this.Nmi=e),(l=e.getContext("2d")).fillStyle="white",l.fillRect(0,0,e.width,e.height),l.translate(-o,0),i.Y7(l,2,void 0,void 0),i.W7(l,1,2,void 0,void 0),i=new _.Picture("".concat(t,"_Chart"),e.toDataURL("jpg")),m=t=r,e=d+1,j=w=y=p=b=0,T=h,O=a-n.getColumnWidth(r),k=n.defaults.colWidth,0<=O)for(;;){if(m=T,(O-=k)<0){p=O;break}T++}else m++,p=O;return i.startColumn(t),i.startColumnOffset(0),i.endColumn(m),i.endColumnOffset(p),i.startRow(0),i.startRowOffset(0),i.endRow(e),i.endRowOffset(0),l.translate(o,0),n.Tb=v,n.ly=g,s.scrollTo(A),this.Kji=!1,i},R.prototype.Imi=function(t){var n,i,e,s,r,t,n=this.Mf,i=n.getRowHeight(t),e;return i=this.gp()&&(r=(s=n.printInfo()).bestFitRows())?(t=S.mt.e0(t,n,S.SheetArea.viewport,S.AutoFitType.cellWithHeader))<=0?n.defaults.rowHeight:t:i},R.prototype.wAi=function(){var t,n,t=this.gji,n=this.project;return t.getProjectLength(n.root)},R.prototype.zji=function(){for(var t,n,i,t=this.project.count,n=0,i=0;i<t;i++)n+=this.Imi(i);return n},R.prototype.wh=function(t,n,i){var t,n,t=C.prototype.wh.call(this,t,n,i),n=A.GanttSheetJsonConverter.toJSON(this,this.IOProps);return this.sOi(n),t.lossless.gantt=n,t.lossless.sheetType=this._gi,t},R.prototype.yh=function(t,n,i,e){var s,s;this.suspendPaint(),this.suspendEvent(),this.project.suspendSchedule(),(s=t.lossless)&&(s=s.gantt,this.rOi(s),A.GanttSheetJsonConverter.fromJSON(this,s,this.IOProps)),C.prototype.yh.call(this,t,n,i,e),this.project.resumeSchedule(),this.resumeEvent(),this.resumePaint()},R.prototype.restoreView=function(t,n){C.prototype.restoreView.call(this,t,n),n&&this.bindGanttView(t)},R.prototype.Cmi=function(){var t=this.hji();this.project=new g.Project(this.name()),this.gji=new o.GanttCellTypeRenderer(this),(this.project.host=this).taskbarColumn=new d.TaskbarColumn(this.project),this.outline=new h.GanttOutline(this),this.gridlines=new p.GanttGridlines(this),this.uiOptions=new f.GanttUIOptions(this.project),this.mapping=new u.GanttMapping(this.project),t.allowCellOverflow=!1,t.reversalTrailingResizeOrder=!0,t.clipBoardOptions=1,this.Mf.showRowOutline(!1),this.Umi(),this.V5t(),this.setDefaultRowHeight(this.gji.getBarStyleRowHeight()),this.project.Lmi.attach(this.Pmi,this),this.project.Hmi.attach(this.Ymi,this),this.project.VAi.attach(this.Fmi,this),this.project.Rmi.attach(this.Qmi,this),this.project.Wmi.attach(this.Gmi,this),this.project.Vmi.attach(this.Umi,this),this.taskbarColumn.propertyChanged.attach(this.Tji,this)},R.prototype.Emi=function(t){var n,i,e,s,r,u,o,o,h,s,a;if(t)n=t.columns,i=t.data.length,e=t;else{if(!(s=this.getDataView()))return;i=s.length(),n=s.getColumnInfos(),e=s}for(r=[],u=0;u<i;u++)o=void 0,o=t?e.data[u]:e.getRowData(u),this.Hji||(this.Hji=o),o=this.Kmi(o,n),h=void 0,e.isHierarchy&&e.isHierarchy()?h=e.getHierarchyNode(u):e.hierarchyNodes&&(h=e.hierarchyNodes[u]),h&&(o.id=h.id,o.parentId=h.parentId,o.level=h.level),r.push(o);(s=0)<r.length&&(e.isHierarchy&&e.isHierarchy()?s=(a=e.getHierarchyRootNode()).level:F(e.rootLevel)&&(s=e.rootLevel)),this.project.loadTasksInternal(r,s),this.Gji()},R.prototype.Gji=function(){this.project.taskView.Qji&&(this.project.taskView.Wji(),delete this.project.taskView.Qji)},R.prototype.wji=function(){for(var t,n,i,e,s,r,u,u,u,o,h,a,o,c,t,n=this.getDataView().getColumnInfos(),i=this.project.taskManager,e=0;e<n.length;e++)(s=n[e]).ganttChart||(r=s.value,(u=s.dataType)&&(r=(u=this.project.taskManager.getFieldByDataType(u))?u.name:r),u=s.isPrimaryKey,o=this.mapping.getDefaultMapping(r),a=h=null,"function"==typeof s.convert?h=s.convert:o&&(h=o[2]),"function"==typeof s.convertBack?a=s.convertBack:o&&(a=o[3]),o=s.readonly,i.addField(c={name:r,convert:h,convertBack:a,isPrimaryKey:u,enabled:!0,readonly:o}))},R.prototype.qji=function(t){return t.taskNumber-1},R.prototype.Jji=function(t,n){for(var i,s,r,e,u,i=t.fields,s=t.ascendingStates,r=[],e=function(t){var e,t,n,e=i[t],t=s[t],n;r.push({field:e.name,ascending:t,compare:function(t,n,i){"duration"===e.name?((N(t)||F(t))&&(t=b.DurationHelper.parse(t)),(N(n)||F(n))&&(n=b.DurationHelper.parse(n))):"start"!==e.name&&"finish"!==e.name||(N(t)&&(t=y.ValueHelper.parseDate(t)),N(n)&&(n=y.ValueHelper.parseDate(n)));var t=T.GanttSortService.compareValueWithField(t,n,e);if(0!==t)return i?t:-t}})},u=0;u<i.length;u++)e(u);0<r.length&&n.sort(r)},R.prototype.xji=function(t,n,r){var u=this;t&&0<t.length?n.removeItems(t,function(t){var n,i,e,s,e,n=t.removedItems;if(n&&0<n.length)for(i=0;i<n.length;i++)s=(e=n[i]).index,e=e.count,u.ZNi(s,e);r(!0)}):r(!0)},R.prototype.Dji=function(t,n,i){var e,s,e=this;t&&0<t.length?((s=0===n.length())&&!this.Hji&&(this.Hji=t[0].data),n.insertItems(t,function(t){var n=t.row,t=t.addedCount;e.mNi(n,t),i(!0)})):i(!0)},R.prototype.Eji=function(t,n){var i,e,s,e;if(t&&0<t.length)for(i=0;i<t.length;i++)s=(e=t[i]).row,0<(e=e.level)?n.demoteHierarchyLevel(s):e<0&&n.promoteHierarchyLevel(s)},R.prototype.Cji=function(t,n,i,e){var s,i,r,u,o,h,a,c;if((t=e&&0<e.length&&(i=i.Vp,e.length===i.length)?this.Aji(e,i):t)&&0<t.length)for(r=0;r<t.length;r++)if(u=t[r])for(h=0,a=o=Object.keys(u);h<a.length;h++)(c=a[h])!==this.iAe||k(u[c])?n.updateItem(r,((s={})[c]=u[c],s)):this.project.resourcesManager.resourcesAssignment.updateTaskAssignment(r,u[c],this.iAe)},R.prototype.Xmi=function(t,n,i){var e,s,r,u,o,h,a,e=this,s=this.project,r=this.getDataView();return n.action===O.TasksChangeAction.Renumber&&this.Jji(n.sortInfos,r),u=t.updated,o=t.inserted,h=t.deleted,a=t.levels,new Promise(function(t){e.xji(h,r,t)}).then(function(){return new Promise(function(t){e.Dji(o,r,t)})}).then(function(){return e.Eji(a,r),e.Cji(u,r,s,i),Promise.resolve()})},R.prototype.Kmi=function(t,n){for(var i,e,s,r,u,o,r,h,a,i={},e=0;e<n.length;e++)s=n[e].value,r=n[e].dataType,u=this.project.taskManager.getField(s),(u=r?(o=this.project.taskManager.getFieldByDataType(r))||u:u)&&(r=u.convert,h=t[s],r&&(h=r(h)),i[a=(a=s)!==u.name?u.name:s]=h);return i},R.prototype.getRowState=function(t){return this.project.getRowState(t)},R.prototype.evaluateCalcColumnFormula=function(t,n){var i,e,s,n,i,e=this.getDataView().gLt.POt,s=e.getCalcService(),n=s.parse(e,n,0,0);return e.pe(t),s.evaluateExpression(e,n,{row:t,col:0})},R.prototype.Qmi=function(){var t,n,i;for(this.suspendPaint(),t=this.getRowCount(),n=this.gji.getBarStyleRowHeight(),i=0;i<t;i++)Math.abs(this.Mf._o(i)-this.Mf.defaults.rowHeight)<.1&&this.$mi(i,n);this.Mf.defaults.rowHeight=n,this.resumePaint()},R.prototype.$mi=function(t,n,i){var e=this.gji.getBarStyleRowHeight();i===S.SheetArea.viewport&&n<e*this.zoom()&&(n=e*this.zoom()),this.Mf.setRowHeight(t,n,i)},R.prototype.getRowVisible=function(t){return this.Mf.getRowVisible(t)},R.prototype.Dmi=function(t){var n,i,n=this.currentTheme().bodyFont(),i=new S.Style;return t&&0===t.taskNumber?i.font="bold normal 12pt ".concat(n):t&&t.isSummary&&(i.font="bold normal 11pt ".concat(n)),i},R.prototype.Gmi=function(){var t,n,i,e,e,i;this.suspendPaint(),-1<(t=this.getGanttColumnIndex())&&(i=(n=this.project.timescale).getDateUtcRange(n.minDateUtc)[0],e=n.getDateUtcRange(n.maxDateUtc)[1],e=b.Calendar.diffDaysUtc(i,e)*n.pixelPerDay+this.getTaskbarAreaVisibleSize(),i=b.Calendar.diffDaysUtc(i,n.currentDateUtc)*n.pixelPerDay,this.Mf.setColumnScrollWidth(t,e),this.Mf.setColumnScrollOffsetX(t,-i),this.Mf.setCellType(0,t,n.MAi,S.SheetArea.colHeader)),this.resumePaint()},R.prototype.getGanttColumnIndex=function(){var t,n,i,e,s,r,t=-1,n;if(this.gp()){if(i=this.Bmi)for(e=i.length-1;0<=e;e--)if((s=i[e]).ganttChart){t=e;break}}else if(r=this.getDataView())for(i=r.getColumnInfos(),e=0;e<i.length;e++)if((s=i[e]).ganttChart){t=e;break}return t},R.prototype.getTaskbarAreaVisibleSize=function(){return this.Mf.Do(this.getGanttColumnIndex())},R.prototype.Umi=function(){this.$mi(0,(0,M.getTimescaleHeight)(this.project.timescale.tierMode,this.zoom()),S.SheetArea.colHeader)},R.prototype.onBarColumnScroll=function(t){var n,i,e,s,r,u,n=this.Mf,i=this.project.timescale,e=t.newValue,s=t.oldValue,r=t.scrollEventType,u=i.getDateUtcRange(i.minDateUtc)[0];switch(r){case S.Zi.smallDecrement:n.Qy().execute({cmd:O.GanttCommandNames.GANTTSHEET_TIMESCALE_LEFT,sheetName:this.name()});break;case S.Zi.smallIncrement:n.Qy().execute({cmd:O.GanttCommandNames.GANTTSHEET_TIMESCALE_RIGHT,sheetName:this.name()});break;case S.Zi.largeDecrement:n.Qy().execute({cmd:O.GanttCommandNames.GANTTSHEET_TIMESCALE_PAGE_UP,sheetName:this.name()});break;case S.Zi.largeIncrement:n.Qy().execute({cmd:O.GanttCommandNames.GANTTSHEET_TIMESCALE_PAGE_DOWN,sheetName:this.name()});break;case S.Zi.thumbTrack:0===e?i.scroll(-1-s):i.scroll(e-s)}t.newValue=b.Calendar.diffDaysUtc(u,i.currentDateUtc)*i.pixelPerDay},R.prototype.mergeGanttTaskbarColumnStyle=function(t,n){var i,e,s,r,u,e,s,r;this.gridlines.ganttRows&&(i=this.gridlines.ganttRows,s=(e=this.gridlines.getLineInfos(i)).lineColor,r=e.lineType,u=e.intervalLineColor,e=e.intervalLineType,s=new S.LineBorder(s,r),n.borderTop=n.borderBottom=s,!k(i.intervalLineType))&&0<t&&i.interval&&(r=this.Mf.eP().visibleIndex[t],s=new S.LineBorder(u,e),(r+1)%i.interval==0?n.borderBottom=s:r%i.interval==0&&(n.borderTop=s))},R.prototype.margeGanttFieldColumnStyle=function(t,n,i){var t,e,e,t,e;this.rowStyleSelector&&(t=this.project.getTaskByRow(t))&&(e=this.rowStyleSelector(t))&&(i.h5(e),e.font&&(i.font=e.font),0<(e=t.getBarStyleRules()).length)&&(t=e[0].style)&&t.gridStyle&&((e=t.gridStyle).font&&(i.font=e.font),e.color&&(i.foreColor=e.color),e.backColor&&(i.backColor=e.backColor),e.textDecoration)&&(i.textDecoration=e.textDecoration)},R.prototype.V5t=function(){var r,u,o,h,r=this,u=this.Mf,o=new s.HideRowFilter(new S.Range(-1,-1,-1,-1));u.rowFilter(o),o.filterDialogVisibleInfo({sortByValue:!0,sortByColor:!1,filterByColor:!1,filterByValue:!0,listFilterArea:!0}),o.filterButtonVisible(!0),o.openFilterDialog=function(t){var t=new a.GanttFilterDialog(u.parent.j2(),u,t,o.filterDialogVisibleInfo());(u.Cut=t).rQ()},h=o.Act,o.Act=function(t,n,i){var e,s,s,e=u.loading,s=r.getDataView();return e&&s&&delete u.loading,s=h.call(o,t,n,i),e&&(u.loading=!0),s}},R.prototype.suspendAll=function(){var t=this.getParent();(t&&t.suspendPaint&&t.resumePaint?t:this).suspendPaint(),this.Mf.suspendCalcService(!1),this.suspendEvent()},R.prototype.resumeAll=function(){this.Mf.IB.isFiltered()&&this.Mf.IB.reFilter(),this.resumeEvent(),this.Mf.resumeCalcService(!0);var t=this.getParent();(t&&t.suspendPaint&&t.resumePaint?t:this).resumePaint()},R.prototype.$ji=function(t){t.tOi=!0,t.autoSort=!1},R.prototype.eAe=function(t){var n,t,i,n=this.project.resourcesManager,t=this.sAe(t);t&&(i=this.rAe(t),n.uAe(t),n.oAe(i),i&&n.hAe(),n.aAe())},R.prototype.sAe=function(t){for(var n,i,e,s,r,n,e=0,s=t.gLt.ltt();e<s.length;e++)if("taskId"===(r=s[e]).targetField){i=r.targetTable;break}return i},R.prototype.rAe=function(t){return t.tBt("resourceId")},R.prototype.beforeSetDataView=function(t){var n;t&&(this.$ji(t),this.eAe(t),this.setCellTypeToColumn(t),n=this.getGanttColumnIndex(),this.options.enableGanttColumn)&&-1===n&&this.addGanttColumn(t)},R.prototype.beforeSubmitChanges=function(){var t=this.project.resourcesManager.resourcesAssignment.assignmentTable;t&&t.submitChanges()},R.prototype.beforeCancelChanges=function(){var t=this.project.resourcesManager.resourcesAssignment.assignmentTable;t&&t.cancelChanges()},R.prototype.afterSetDataView=function(){this.outline.initOutlineColumn(),this.aji(),this._pi(),this.Gmi(),this.Emi()},R.prototype.Mji=function(t){var n=this.Mf;t&&(n.setColumnCount(t.getColumnInfos().length),this.Sji(!0))},R.prototype.bindGanttView=function(t,n){var i,e,s,r;if(n)for(i=0,e=Object.keys(this.options);i<e.length;i++)void 0!==(r=n[s=e[i]])&&(this.options[s]=n[s]);C.prototype.setDataView.call(this,t)},R.prototype.aji=function(){var t=this.getGanttColumnIndex();-1<t?(this.Mf.frozenTrailingColumnCount(1),this.Mf.setColumnWidth(t,this.taskbarColumn.width||"*")):this.Mf.frozenTrailingColumnCount(0)},R.prototype.Epi=function(t){return t.hasOwnProperty("value")&&t.hasOwnProperty("unit")&&t.hasOwnProperty("time")},R.prototype.getFilterButtonVisibleFromColumnInfo=function(t,n,i){var n,e,n,n=n[t],e=!1!==n.allowSort||!1!==n.allowFilterByValue||!1!==n.allowFilterByList;return k(n.allowSort)&&k(n.allowFilterByValue)&&k(n.allowFilterByList)&&(!(n=i.getValue(0,t))||"object"!=typeof n||x(n)||this.Epi(n)||(e=!1)),e=t===this.getGanttColumnIndex()?!1:e},R.prototype.setCellTypeToColumn=function(t){var n,t,n=this,t=t.getColumnInfos();t&&t.forEach(function(t){switch(H(t),t.dataType){case"TaskStartDate":t.style=(0,l.createStyleForDateTime)(t.style,!0);break;case"TaskFinishDate":t.style=(0,l.createStyleForDateTime)(t.style,!1);break;case"TaskDuration":t.style=(0,l.createStyleForDuration)(t.style);break;case"TaskMode":t.style=(0,l.createStyleForMode)(t.style);break;case"TaskComplete":t.style=(0,l.createStyleForComplete)(t.style);break;case"TaskPredecessor":t.style=(0,l.createStyleForPredecessors)(t.style);break;case"TaskResources":n.iAe=t.value,t.style=(0,l.createStyleForResources)(t.style)}switch(t.value){case"start":case"finish":t.style=(0,l.createStyleForDateTime)(t.style,t.value===L);break;case"duration":t.style=(0,l.createStyleForDuration)(t.style);break;case"name":t.dataType="TaskSubject";break;case"mode":t.style=(0,l.createStyleForMode)(t.style);break;case"complete":t.style=(0,l.createStyleForComplete)(t.style);break;case"predecessors":case"successors":t.style=(0,l.createStyleForPredecessors)(t.style);break;case"workTime":t.style=(0,l.createStyleForDuration)(t.style,!1)}})},R.prototype.addGanttColumn=function(t){var n;t.getColumn(t.getColumn().length-1).value!==j&&(n={value:j,width:"*",ganttChart:!0,style:this.addTaskbarCellType(),headerStyle:this.addTimescaleCellType()},t.addColumn(n))},R.prototype.removeGanttColumn=function(t){t.removeColumn(j)},R.prototype.addTaskbarCellType=function(){var t=new S.Style;return t.cellType=new m.TaskbarCellType,t},R.prototype.addTimescaleCellType=function(){var t=new S.Style;return t.cellType=new M.TimescaleCellType,t},R.prototype.onHorizontalDockScroll=function(t,n){var i;this.getGanttColumnIndex()===this.Mf.getDockScrollbarAttachedIndex()?this.onBarColumnScroll(n):this.Mf.onHorizontalDockScroll(t,n)},R.prototype.pM=function(t){this.Mf.pM(t),this._pi()},R.prototype._pi=function(){var t=this.getGanttColumnIndex();-1<t?this.Mf.setDockScrollbarAttachedIndex(t):this.Mf.setDockScrollbarAttachedIndex(null)},R.prototype.jDi=function(t){var t,n,t;return-1!==t&&!!(t=this.getTaskByRow(t))&&!(n=this.project.Lji(t))&&(t=this.qji(t),C.prototype.jDi.call(this,t))},R.prototype.vDi=function(t){var t,n,t;return-1!==t&&!!(t=this.getTaskByRow(t))&&!(n=this.project.Lji(t))&&(t=this.qji(t),C.prototype.vDi.call(this,t))},R.prototype._Ni=function(t,n){if(this.qNi(n)){var n=this.getRowState(t);if(!k(n))return n.level}return 0},R.prototype.qNi=function(t){var n,i,i,n,i=this.getDataView();return!k(i)&&(i=i.getColumn(t))&&"TaskSubject"===i.dataType},R.prototype.ZNi=function(t,n){var i=this;i.suspendPaint(),i.KDi(t,n),i.eOi(),i.resumePaint()},R.prototype.mNi=function(t,n){var i=this;k(n)||(i.suspendPaint(),i.Mf.addRows(t,n),i.refreshStyleRuleCache(),i.eOi(),i.resumePaint())},R.prototype.togglePinnedRows=function(t){return this instanceof R?-1:C.prototype.togglePinnedRows.call(this,t)},R.prototype.isAlternatingRowStyleColumn=function(t){return t!==this.getGanttColumnIndex()},R.prototype.leV=function(){var t;this instanceof R&&((t=this.Mf).rt=new c.GanttSheetEventHandler(t),t.Dn=new o.GanttSheetRender(t),this.applyTableTheme(),this.project)&&this.Umi()},R.prototype.Rpi=function(t,n){var t,n,i,e,n,e,s,n,t=this.getRowState(t).task,n=this.fDi(n);return n&&(e=n.value,n=n.dataType,e=this.project.taskManager.getField(e),e=n&&(s=this.project.taskManager.getFieldByDataType(n))||e)&&(i=this.project.taskManager.getTaskValue(t,e.name),"function"==typeof(n=e.convertBack)?i=n(i):"duration"===e.name?i=this.Pji(i,!0):"start"!==e.name&&"finish"!==e.name||(i=this.Uji(i))),i},R.prototype.eOi=function(){var t=this.outline;t&&(t.updateOutlineColumnModel(),t.restoreCollapsedState())},R.prototype.wAe=function(){return 0<this.yAe.length},R.prototype.jAe=function(t,n,i){this.yAe.push({recordsChanges:t,change:n,backupTasks:i})},R.prototype.TAe=function(){var t=this.yAe[0],n=t.recordsChanges,i=t.change,t=t.backupTasks;this.OAe(n,i,t)},R.prototype.kAe=function(){return this.yAe.shift()},R.prototype.Pmi=function(t){var n,i,n=t.needReschedule,i=this.project.isSuspendDirty();n&&!i&&this.project.backupTasksForSchedule(t.action),t.action===O.TasksChangeAction.Sort&&this.outline.backupCollapsedState(),this.suspendAll()},R.prototype.Ymi=function(t){var n,n,i;t.action===O.TasksChangeAction.Reset&&this.Sji(!0),n=this.getDataView(),t.noChange||!n?this.resumeAll():(n=this.cji(t),i=this.project.getBackupTasks(),this.wAe()?this.jAe(n,t,i):(this.jAe(n,t,i),this.TAe()))},R.prototype.OAe=function(t,n,i){var e=this;this.Xmi(t,n,i).finally(function(){e.eOi(),e.resumeAll(),e.kAe(),e.wAe()&&e.TAe()})},R.prototype.Tji=function(t,n){var i=this.getGanttColumnIndex();-1!==i&&("width"===n?this.Mf.setColumnWidth(i,this.taskbarColumn.width):"_taskbarCellType"===n&&(this.Mf.setCellType(-1,i,t._Ai,S.SheetArea.viewport),this.Qmi()))},R.prototype.cji=function(t){var n,i,e,t,s,r,u,t,o,h,a,c,f,l,d,A,v,g,v,v,b,m,p,y,m,p,y,b,w,j,T,T,n=this.project,i=t.action,e=t.changedItems,t=t.needReschedule,s={updated:[],inserted:[],deleted:[],levels:[]};if(i===O.TasksChangeAction.Update)u=r=void 0,t||(u=(r=e).map(function(t){var t=t.taskNumber;return n.getTask(t)})),t=this.Aji(r,u),s.updated=t;else if(i===O.TasksChangeAction.Insert)for(h=(o=this.getDataView()).getColumnInfos(),a=0,c=e;a<c.length;a++){for(f=c[a],l=P(f.getData()),d=0,A=h;d<A.length;d++)g=(v=A[d]).value,(v=v.dataType)&&(v=n.taskManager.getFieldByDataType(v))&&(l[g]=l[v.name]);b=this.Hji,m=this.mAe("duration","TaskDuration"),p=this.mAe("start","TaskStartDate"),y=this.mAe("finish","TaskFinishDate"),m=l.duration&&b&&(N(b)||F(m))||k(b),p=x(l.start)&&"Manual"===f.mode&&(b&&N(p)||k(b)),y=x(l.finish)&&"Manual"===f.mode&&(b&&N(y)||k(b)),m&&(l.duration=this.Pji(l.duration)),p&&(l.start=this.Uji(l.start)),y&&(l.finish=this.Uji(l.finish)),b=this.nOi(f,l),s.inserted.push(b)}else if(i===O.TasksChangeAction.Remove)for(w=e.length;0<=w;w--)(f=e[w])&&(j=this.qji(f),s.deleted.push(j));else if(i===O.TasksChangeAction.Level)for(w=0;w<e.length;w++)(T=e[w])&&(f=T.task,T=T.delta,s.levels.push({row:this.qji(f),level:T}));return s},R.prototype.nOi=function(t,n){var i,e,s,r,u,r,t,o,h,a,i=this.project,e=i.taskView,s=this.outline,r=t.taskNumber,u=e.findPreviousTask(r),r=e.findNextTask(r,!0),t={row:this.qji(t),isAfter:!1,data:n};if(u)if(r)(a=!s.isRowCollapsed(e.tokens[u.taskNumber].viewIndex))&&!u.isSummary&&(t.row=this.qji(u),t.isAfter=!0);else{for(o=u,h=void 0;s.isRowCollapsed(e.tokens[o.taskNumber].viewIndex);){if(i.Lji(o.parent)){h=o;break}o=o.parent}t.row=h?this.qji(h):this.qji(o),t.isAfter=!0}return t},R.prototype.Aji=function(t,n){var i,e,s,r,u,o,h,a,c,f,l,d,A,v,A,g,b,A,m,p,y,A,p,w,j,i=this.project,e=this.getDataView(),s=[];if(e&&t)for(r=t.length,u=e.getColumnInfos(),o=this.project.taskManager,h=0;h<r;h++)if(a=t[h],(c=n[h])!==i.root&&(r!==i.count||0!==h)){if(f=void 0,a&&c)for(l=0,d=u;l<d.length;l++)(A=d[l]).ganttChart||(v=A.value,A=A.dataType,e.FPt(v)&&"TaskResources"!==A)||(g=o.getField(v),"level"!==(g=A?(b=i.taskManager.getFieldByDataType(A))||g:g).name&&"parentId"!==g.name&&"id"!==g.name&&"children"!==g.name&&"workTime"!==g.name&&("Auto"!==c.mode||"start"!==g.name&&"finish"!==g.name)&&(A=void 0,p=0,p=typeof(A="predecessors"===g.name||"successors"===g.name?a.getDataValue(g.name):o.getTaskValue(a,g))!=typeof(m=o.getTaskValue(c,g))?1:T.GanttSortService.compareValueWithField(A,m,g),0!==(p="start"!==g.name&&"finish"!==g.name?p:1))&&(f=f||{},(y=this.Hji)&&(A=this.mAe("duration","TaskDuration"),p=this.mAe("start","TaskStartDate"),w=this.mAe("finish","TaskFinishDate"),"duration"===g.name&&(N(A)||F(A))?m=this.Pji(m):("start"===g.name&&(N(p)||k(p))&&x(m)||"finish"===g.name&&(N(w)||k(w))&&x(m))&&(m=this.Uji(m))),f[v]=m));f&&(s[j=this.qji(c)]=f)}return s},R.prototype.Pji=function(t,n){var i,e,s,n,r,i;return k(t)?null:(i=this.Hji,e=t,s=!1,n||(n=b.DurationHelper.default(),r=this.mAe("duration","TaskDuration"),i&&!k(r)&&(N(i=r)?n=b.DurationHelper.parseText(r):F(i)&&(s=!0),n.unit)&&(e=b.DurationHelper.normalize({time:t.time,unit:n.unit}))),s?e.value:b.DurationHelper.format(e))},R.prototype.mAe=function(t,n){for(var i,e,s,r,u,o,i=this.Hji,e,s,r=0,u=this.getDataView().getColumnInfos();r<u.length;r++)if((o=u[r]).value===t||o.dataType===n)return i[o.value];return null},R.prototype.Uji=function(t){return y.ValueHelper.formatDate(t)},R.prototype.paintTaskbar=function(t,n,i){o.GanttCellTypeRenderer.paintTaskbar(t,n,i)},R.prototype.getTextWidthAndHeight=function(t,n,i){return o.GanttCellTypeRenderer.getTextWidthAndHeight(t,n,i)},R.prototype.refreshBindColumns=function(){C.prototype.refreshBindColumns.call(this),this.wji()},D=R,t.GanttSheet=D,S.Workbook.ch("ganttSheet",{adlc:function(t){var n,i,e,s,r,t,u,o,h,a,n=t.flg,i=t.checkRs,e=t.m,s=t.d,r=t.nl,t=t.fn,u="G",o=["eet","anttSh"],h=this.gtwm||this.parent&&this.parent.gtwm;n&&-1===n.indexOf(u.toUpperCase()+o[1]+o[0])?(i.wm=i.wm||[],(a=h&&h(e,s,!0))&&i.wm.push(a),i.nwm=!0,i.state||(i.state=[]),i.state.push([u.toLocaleLowerCase()+"te",0]),i.dis||(i.dis=[]),i.dis.push("67616e74745368656574"),this.parent&&t&&t(this,i.dis,"ad")):-1===e&&(i.wm=i.wm||[],(a=h&&h(e,s,!1))&&i.wm.push(a),i.nwm=!0)},preFromJson:function(t,n,i){var e,s,r,u,o,h;if(D.rL=1,!(e=i&&i.cb===S.OpenSaveFileType.excel)&&(s=t.sheetTabs))for(r=0,u=Object.keys(s);r<u.length;r++)(h=s[o=u[r]]).sheetType===S.SheetType.ganttSheet&&U(h)},createSheetTab:function(t){var n=this.ls;n&&0===n.gte&&(n.hl||!n.b)||t.type!==S.SheetType.ganttSheet||(t.name||(t.name=Q(this.mp)),t.sheetTab=new D(t.name))},preFromSJSFormat:function(t,n,i){D.rL=1}}),S.Y8.ch("ganttSheet",{priority:7001,isValid:function(){return this.Mf.NMi&&this.Mf.NMi instanceof D},getValue:function(t){var n,i,e,s,r,u,o,r,h,r,n,a,n,i,a,c,n,n=t.sheetArea,i=t.row,e=t.col,s=t.valueType,r=this.Mf,u=r.NMi;u&&u instanceof D&&((o=u.gp())&&n===S.SheetArea.colHeader&&1===r.getRowCount(S.SheetArea.colHeader)&&(r=u.Bmi)&&r[e]?(h=r[e].caption||r[e].value,t.value=h,t.isValueGet=!0):n===S.SheetArea.rowHeader&&0===e?(t.value=u.getRowState(i).taskNumber,t.isValueGet=!0):void 0!==n&&n!==S.SheetArea.viewport||(r=u.getRowState(i).task,(n=u.fDi(e))?(a=n.value,n=n.dataType,"taskNumber"===a?t.value=u.getRowState(i).taskNumber:"="===a[0]?t.value=r?u.uOi(r,a):void 0:r&&(a=(i=u.project).taskManager.getField(a),a=n&&(c=i.taskManager.getFieldByDataType(n))||a)&&(h=i.taskManager.getTaskValue(r,a.name),n=a.convertBack,s===S.ValueType.richText&&"duration"===a.name&&(h=i.formatDuration(h)),"function"==typeof n&&(h=n(h)),t.value=h)):e===u.getGanttColumnIndex()&&(t.value=r),t.isValueGet=!0))},setValue:function(t){var n,i,e,s,r,u,n,t,u,e,u,e,o,u,t,n=t.sheetArea,i=t.row,e=t.col,s=t.value,r,u=this.Mf.NMi;u&&u instanceof D&&(void 0!==n&&n!==S.SheetArea.viewport||(n=u.project,t.isValueSet=!0,t=u.getRowState(i).task,n.Lji(t))||!(u=u.fDi(e))||u.readonly||(e=u.value,u=u.dataType,e=n.taskManager.getField(e),u&&(e=(o=n.taskManager.getFieldByDataType(u))||e),y.GanttUtil.lji(s)&&(s=S.util.V0(s)),t?n.taskManager.setTaskValue(t,e,s,!0):!t&&i>=n.count&&0<(u=n.addTasks()).length&&(t=u[0],n.taskManager.setTaskValue(t,e,s,!0))))}}),S.GC$.extend(S.Workbook.prototype,{gtwm:function(t,n,i){return i?[w().wmk1,0]:-1===t?i?[w().wmk1,0]:[w().wmk2,1]:void 0}}),S.GC$.extend(S.Worksheet.prototype,{gtwm:function(t,n,i){return i?[w().wmk1,0]:-1===t?i?[w().wmk1,0]:[w().wmk2,1]:void 0}})},"./dist/plugins/gantt/gantt-sort.js":function(t,n,i){var c,A,i,v,s,e;function r(){}c=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var e=0,s=n.length,r;e<s;e++)!r&&e in n||((r=r||Array.prototype.slice.call(n,0,e))[e]=n[e]);return t.concat(r||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.GanttSortService=void 0,A=i("./dist/plugins/gantt/project/tasks.js"),i=i("Common"),v=i.Common.lt.ht,s=Array.isArray,r.sort=function(t,n,i,e,s){return s?this.treeSort(t,n,i,e):this.flatSort(t,n,i,e)},r.flatSort=function(t,i,e,s){var r=this;return c([],t,!0).sort(function(t,n){return r.sortCompare(t,n,i,e,s)})},r.treeSort=function(t,n,i,e){var s,r,s=n[0],r=[];return this.subTreeSort(r,n,s,i,e),this.mergeBlankRows(t,n,r)},r.subTreeSort=function(t,i,n,e,s){var r,n,u,o,h,a,r=this;if(t.push(n.kU),(n=n.Fpi())&&n.length)for(h=u=c([],n,!(o=0)).sort(function(t,n){return r.sortCompare(t,n,i,e,s)});o<h.length;o++)a=h[o],this.subTreeSort(t,i,a,e,s)},r.mergeBlankRows=function(t,n,i){var e,s,e=this.buildBlankRowMap(t,n),s=[];return i.forEach(function(t){var n=e[t.taskNumber];(s=n?s.concat(n):s).push(t)}),s=e[-1]?s.concat(e[-1]):s},r.buildBlankRowMap=function(t,n){for(var i,e,s,r,i={},s=0;s<n.length;s++)(r=n[s])?e&&(i[s]=e,e=null):(e=e||[]).push(t[s]);return e&&(i[-1]=e),i},r.sortCompare=function(t,n,i,e,s){var r,t,u,o,t,h,a,c,f,l,d,l,r=function(t){return t instanceof A.Task?[t,t.kU]:[i[t.taskNumber],t]},t=r(t),u=t[0],o=t[1],t=r(n),h=t[0],a=t[1];if(0<e.length&&"taskNumber"===e[0].name)return s[0]?o.taskNumber-a.taskNumber:a.taskNumber-o.taskNumber;for(c=0;c<e.length;c++){if(v(u)&&v(h))return o.taskNumber-a.taskNumber;if(v(u))return 1;if(v(h))return-1;if(f=e[c],l=u?u.project.taskManager.getTaskValue(u,f):void 0,d=h?h.project.taskManager.getTaskValue(h,f):void 0,0!==(l=this.compareValueWithField(l,d,f)))return s[c]?l:-l}return 0},r.compareValueWithField=function(t,n,i){var e=0,e;return e=v(t)||v(n)?this.compareWithEmpty(t,n):i.comparer?i.comparer(t,n):r.builtinCompareFunction(t,n,i)},r.builtinCompareFunction=function(t,n,i){var e,i,t,e=0;return t instanceof Date&&n instanceof Date?e=this.dateCompareFunction(t,n):"number"==typeof t&&"number"==typeof n?e=this.numberCompareFunction(t,n):"boolean"==typeof t&&"boolean"==typeof n?e=this.booleanCompareFunction(t,n):"string"==typeof t&&"string"==typeof n?e=this.stringCompareFunction(t,n):s(t)&&s(n)?e=this.compareArray(t,n):"duration"===i.name&&"object"==typeof t&&"object"==typeof n&&(i=v(t)?-1:t.time,t=v(n)?-1:n.time,e=this.numberCompareFunction(i,t)),e},r.compareArray=function(t,n){var i,e,s;if(t.length!==n.length)return 1;for(i=c([],t,!0).sort(),e=c([],n,!0).sort(),s=0;s<t.length;s++)if(i[s]!==e[s])return 1;return 0},r.compareWithEmpty=function(t,n){return v(t)&&v(n)?0:v(t)&&!v(n)?1:!v(t)&&v(n)?-1:void 0},r.numberCompareFunction=function(t,n){return t-n},r.booleanCompareFunction=function(t,n){return!0===t&&!1===n?1:!1===t&&!0===n?-1:0},r.stringCompareFunction=function(t,n){return t.toLowerCase().localeCompare(n.toLowerCase())},r.dateCompareFunction=function(t,n){var t,n,t=t?t.valueOf():0,n=n?n.valueOf():0;return this.numberCompareFunction(t,n)},n.GanttSortService=r},"./dist/plugins/gantt/gantt.entry.js":function(t,n,i){var e,s,e=this&&this.__createBinding||(Object.create?function(t,n,i,e){void 0===e&&(e=i);var s=Object.getOwnPropertyDescriptor(n,i);s&&("get"in s?n.__esModule:!s.writable&&!s.configurable)||(s={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,e,s)}:function(t,n,i,e){t[e=void 0===e?i:e]=n[i]}),s=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||e(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),i("./dist/plugins/gantt/gantt.typedef.js"),s(i("./dist/plugins/gantt/utils/mapping.js"),n),s(i("./dist/plugins/gantt/project/calendar.js"),n),s(i("./dist/plugins/gantt/project/tasks.js"),n),s(i("./dist/plugins/gantt/project/project.js"),n),s(i("./dist/plugins/gantt/project/dependency.js"),n),s(i("./dist/plugins/gantt/project/timescales.js"),n),s(i("./dist/plugins/gantt/taskbar/layout.js"),n),s(i("./dist/plugins/gantt/taskbar/style.js"),n),s(i("./dist/plugins/gantt/celltypes/timescales.js"),n),s(i("./dist/plugins/gantt/celltypes/taskbar.js"),n),s(i("./dist/plugins/gantt/gantt-action.js"),n),s(i("./dist/plugins/gantt/gantt-options.js"),n),s(i("./dist/plugins/gantt/gantt-gridline.js"),n),s(i("./dist/plugins/gantt/gantt-outline.js"),n),s(i("./dist/plugins/gantt/gantt-sheet.js"),n),s(i("./dist/plugins/gantt/gantt-chart.js"),n),s(i("./dist/plugins/gantt/gantt-contextmenu.js"),n),s(i("./dist/plugins/gantt/gantt.ns.js"),n),s(i("./dist/plugins/gantt/gantt.enum.js"),n)},"./dist/plugins/gantt/gantt.enum.js":function(t,n){var i,e,s,r,u,o,h,a,c,f,l,l,l,l,l,l,l,l,l,l;Object.defineProperty(n,"__esModule",{value:!0}),n.TimescaleUnit=n.TimescaleTierMode=n.DayOfWeek=n.GanttGridlineType=n.GanttSheetEvent=n.TasksChangeAction=n.ActionStatus=n.ScrollDirection=n.CursorStyle=n.BarPartName=n.GanttCommandNames=void 0,n.GanttCommandNames={GANTTSHEET_INSERT_TASK:"ganttSheetInsertTask",GANTTSHEET_INSERT_SUMMARY_TASK:"ganttSheetInsertSummaryTask",GANTTSHEET_INSERT_MILESTONE:"ganttSheetInsertMilestone",GANTTSHEET_DELETE_TASK:"ganttSheetDeleteTask",GANTTSHEET_TIMESCALE_PAGE_UP:"ganttSheetTimescalePageUp",GANTTSHEET_TIMESCALE_PAGE_DOWN:"ganttSheetTimescalePageDown",GANTTSHEET_TIMESCALE_BEGIN:"ganttSheetTimescaleBegin",GANTTSHEET_TIMESCALE_END:"ganttSheetTimescaleEnd",GANTTSHEET_TIMESCALE_LEFT:"ganttSheetTimescaleLeft",GANTTSHEET_TIMESCALE_RIGHT:"ganttSheetTimescaleRight",GANTTSHEET_TIMESCALE_ZOOM_IN:"ganttSheetTimescaleZoomIn",GANTTSHEET_TIMESCALE_ZOOM_OUT:"ganttSheetTimescaleZoomOut",GANTTSHEET_TIMESCALE_ZOOM_CUSTOMER:"ganttSheetTimescaleZoomCustomer",GANTTSHEET_CHANGE_COMPLETE:"ganttSheetChangeComplete",GANTTSHEET_INDENT_TASKS:"ganttSheetIndentTasks",GANTTSHEET_OUTDENT_TASKS:"ganttSheetOutdentTasks",GANTTSHEET_LINK_TASKS:"ganttSheetLinkTasks",GANTTSHEET_UNLINK_TASKS:"ganttSheetUnLinkTasks",GANTTSHEET_CHANGE_TASK_MODE:"ganttSheetChangeTaskMode",GANTTSHEET_MOVE_TASK:"ganttSheetMoveTask",GANTTSHEET_SCROLL_TO_TASK:"ganttSheetScrollToTask"},(l=i=n.BarPartName||(n.BarPartName={}))[l.Start=0]="Start",l[l.Middle=1]="Middle",l[l.End=2]="End",l[l.Whole=3]="Whole",(l=e=n.CursorStyle||(n.CursorStyle={}))[l.TaskDrag=0]="TaskDrag",l[l.LinkLine=1]="LinkLine",l[l.ProcessDrag=2]="ProcessDrag",l[l.LeftStretch=3]="LeftStretch",l[l.RightStretch=4]="RightStretch",l[l.Move=5]="Move",l[l.Default=6]="Default",l[l.Crosshair=7]="Crosshair",(l=s=n.ScrollDirection||(n.ScrollDirection={}))[l.Positive=1]="Positive",l[l.Negative=-1]="Negative",(l=r=n.ActionStatus||(n.ActionStatus={}))[l.NotStart=0]="NotStart",l[l.InProgress=1]="InProgress",l[l.Finish=2]="Finish",(l=u=n.TasksChangeAction||(n.TasksChangeAction={}))[l.Reset=0]="Reset",l[l.Insert=1]="Insert",l[l.Remove=2]="Remove",l[l.Move=3]="Move",l[l.Replace=4]="Replace",l[l.Level=5]="Level",l[l.Sort=6]="Sort",l[l.Update=7]="Update",l[l.Renumber=8]="Renumber",(l=o=n.GanttSheetEvent||(n.GanttSheetEvent={})).Event_BarAction_Pending="Event_BarAction_Pending",l.Event_BarAction_End="Event_BarAction_End",l.Event_HoverOnBar="Event_HoverOnBar",l.Event_HoverOnLink="Event_HoverOnLink",l.Event_DataBindingError="Event_DataBindingError",(l=h=n.GanttGridlineType||(n.GanttGridlineType={}))[l.empty=0]="empty",l[l.thin=1]="thin",l[l.dashed=3]="dashed",l[l.dotted=4]="dotted",l[l.dashDot=9]="dashDot",(l=a=n.DayOfWeek||(n.DayOfWeek={}))[l.Sunday=0]="Sunday",l[l.Monday=1]="Monday",l[l.Tuesday=2]="Tuesday",l[l.Wednesday=3]="Wednesday",l[l.Thursday=4]="Thursday",l[l.Friday=5]="Friday",l[l.Saturday=6]="Saturday",(l=c=n.TimescaleTierMode||(n.TimescaleTierMode={}))[l.middle=1]="middle",l[l.middleBottom=2]="middleBottom",l[l.topMiddleBottom=3]="topMiddleBottom",(l=f=n.TimescaleUnit||(n.TimescaleUnit={}))[l.years=1]="years",l[l.halfYears=2]="halfYears",l[l.quarters=3]="quarters",l[l.months=4]="months",l[l.thirdsOfMonth=5]="thirdsOfMonth",l[l.weeks=6]="weeks",l[l.days=7]="days",l[l.hours=8]="hours",l[l.minutes=9]="minutes"},"./dist/plugins/gantt/gantt.ns.js":function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var i=i("./dist/plugins/gantt/gantt.res.en.js");n.SR={en:i}},"./dist/plugins/gantt/gantt.res.en.js":function(t,n,i){var e,s;for(s in Object.defineProperty(n,"__esModule",{value:!0}),n.GANTT_ACTION_FROM_OF=n.GANTT_ACTION_FINISH_LINK=n.GANTT_ACTION_START_LINK=n.GANTT_ACTION_TASK_FINISH=n.GANTT_ACTION_TASK_START=n.GANTT_ACTION_FINISH=n.GANTT_ACTION_START=n.GANTT_ACTION_TASK_COLON=n.GANTT_ACTION_TASK=n.DEFAULT_DATE_TIME_FORMAT=n.GANTT_VALUE_READONLY=n.GANTT_VALUE_INVALID=n.GANTT_INVALID_ASCENDING_STATES=n.GANTT_INVALID_FIELD=n.GANTT_INVALID_TASK_LEVEL=n.GANTT_INVALID_TASK_PARENT_ID=n.GANTT_INVALID_TASK_ID=n.GANTT_INVALID_WORK_DAYS=n.GANTT_INVALID_UNIT=n.GANTT_INVALID_DEPENDENCY=n.GANTT_INVALID_TASK=n.GANTT_INVALID_COUNT=n.GANTT_INVALID_INDEX=n.GANTT_INVALID_ROW_INDEX=n.GANTT_INVALID_ID=n.GANTT_INVALID_LEVEL=n.GANTT_INVALID_OPERATION=n.GANTT_TASK_SCHEDULE_MODE_AUTO=n.GANTT_TASK_SCHEDULE_MODE_MANUALLY=n.GANTT_COMPLETE_CHANGE=n.GANTT_COMPLETE=n.GANTT_SUCCESSORS=n.GANTT_PREDECESSORS=n.GANTT_FINISH_DISPLAYED=n.GANTT_START_DISPLAYED=n.GANTT_FINISH=n.GANTT_START=n.GANTT_DURATION=n.GANTT_MODE=n.GANTT_MILESTONE=n.GANTT_TASK_NAME=n.GANTT_TASK_NUMBER=n.GANTT_NEW_MILESTONE=n.GANTT_NEW_SUMMARY_TASK=n.GANTT_NEW_TASK=n.GANTT_MINUTE=n.GANTT_HOUR=n.GANTT_DAY=n.GANTT_WEEK=n.GANTT_MONTH=void 0,n.GANTT_CALENDAR_UNIT_LABELS_PLURALS=n.GANTT_CALENDAR_UNIT_LABELS=n.GANTT_CALENDAR_MONTH_NAMES=n.GANTT_CALENDAR_MONTH=n.GANTT_CALENDAR_WEEK_NAMES=n.GANTT_CALENDAR_WEEK=n.GANTT_CALENDAR_DAY_NAMES=n.GANTT_CALENDAR_DAY=n.GANTT_CALENDAR_HOUR_NAMES=n.GANTT_CALENDAR_HOUR=n.GANTT_CALENDAR_MINUTE_NAMES=n.GANTT_CALENDAR_MINUTE=n.GANTT_CALENDAR_24HOURS=n.GANTT_CALENDAR_NIGHT_SHIFT=n.GANTT_CALENDAR_STANDARD=n.GANTT_TASK_BAR_COMPLETE=n.GANTT_TASK_BAR_COMPLETE_THROUGH=n.GANTT_TASK_BAR_UNNAMED=n.GANTT_TASK_BAR_SS=n.GANTT_TASK_BAR_SF=n.GANTT_TASK_BAR_FF=n.GANTT_TASK_BAR_FS=n.GANTT_TASK_BAR_TO=n.GANTT_TASK_BAR_FROM=n.GANTT_TASK_BAR_TASK_LINK=n.GANTT_ACTION_LINE_TIP_TITLE=n.GANTT_ACTION_COMPLETE_THROUGH=n.GANTT_ACTION_DURATION=n.GANTT_ACTION_FINISH_ONLY=n.GANTT_ACTION_START_ONLY=n.GANTT_ACTION_TO_OF=void 0,n.GANTT_MONTH="Month",n.GANTT_WEEK="Week",n.GANTT_DAY="Day",n.GANTT_HOUR="Hour",n.GANTT_MINUTE="Minute",n.GANTT_NEW_TASK="<New Task>",n.GANTT_NEW_SUMMARY_TASK="<New Summary Task>",n.GANTT_NEW_MILESTONE="<New Milestone>",n.GANTT_TASK_NUMBER="Task Number",n.GANTT_TASK_NAME="Task Name",n.GANTT_MILESTONE="Milestone",n.GANTT_MODE="Mode",n.GANTT_DURATION="Duration",n.GANTT_START="Start",n.GANTT_FINISH="Finish",n.GANTT_START_DISPLAYED="StartDisplayed",n.GANTT_FINISH_DISPLAYED="FinishDisplayed",n.GANTT_PREDECESSORS="Predecessors",n.GANTT_SUCCESSORS="Successors",n.GANTT_COMPLETE="% Complete",n.GANTT_COMPLETE_CHANGE="Complete Through",n.GANTT_TASK_SCHEDULE_MODE_MANUALLY="Manual",n.GANTT_TASK_SCHEDULE_MODE_AUTO="Auto",n.GANTT_INVALID_OPERATION="invalidOperation",n.GANTT_INVALID_LEVEL="invalidLevel",n.GANTT_INVALID_ID="invalidId",n.GANTT_INVALID_ROW_INDEX="invalidRowIndex",n.GANTT_INVALID_INDEX="invalidIndex",n.GANTT_INVALID_COUNT="invalidCount",n.GANTT_INVALID_TASK="invalidTask",n.GANTT_INVALID_DEPENDENCY="invalidDependency",n.GANTT_INVALID_UNIT="invalidUnit",n.GANTT_INVALID_WORK_DAYS="invalidWorkDays",n.GANTT_INVALID_TASK_ID="invalidTaskId",n.GANTT_INVALID_TASK_PARENT_ID="invalidTaskParentId",n.GANTT_INVALID_TASK_LEVEL="invalidTaskLevel",n.GANTT_INVALID_FIELD="invalidField",n.GANTT_INVALID_ASCENDING_STATES="invalidAscendingStates",n.GANTT_VALUE_INVALID="valueInvalid",n.GANTT_VALUE_READONLY="valueReadonly",n.DEFAULT_DATE_TIME_FORMAT="yy-mm-dd h:mm",n.GANTT_ACTION_TASK="Task",n.GANTT_ACTION_TASK_COLON="Task:",n.GANTT_ACTION_START="Start:",n.GANTT_ACTION_FINISH="Finish:",n.GANTT_ACTION_TASK_START="Task Start:",n.GANTT_ACTION_TASK_FINISH="Task Finish:",n.GANTT_ACTION_START_LINK="Start",n.GANTT_ACTION_FINISH_LINK="Finish",n.GANTT_ACTION_FROM_OF="From {0} Of:",n.GANTT_ACTION_TO_OF="To {0} Of:",n.GANTT_ACTION_START_ONLY="StartOnly",n.GANTT_ACTION_FINISH_ONLY="FinishOnly",n.GANTT_ACTION_DURATION="Duration:",n.GANTT_ACTION_COMPLETE_THROUGH="CompleteThrough:",n.GANTT_ACTION_LINE_TIP_TITLE="{0} to {1} Link",n.GANTT_TASK_BAR_TASK_LINK="Task Link:",n.GANTT_TASK_BAR_FROM="From:",n.GANTT_TASK_BAR_TO="To:",n.GANTT_TASK_BAR_FS="Finish-to-Start (FS)",n.GANTT_TASK_BAR_FF="Finish-to-Finish (FF)",n.GANTT_TASK_BAR_SF="Start-to-Finish (SF)",n.GANTT_TASK_BAR_SS="Start-to-Start (SS)",n.GANTT_TASK_BAR_UNNAMED="Unnamed",n.GANTT_TASK_BAR_COMPLETE_THROUGH="Complete Through:",n.GANTT_TASK_BAR_COMPLETE="% Complete:",n.GANTT_CALENDAR_STANDARD="Standard",n.GANTT_CALENDAR_NIGHT_SHIFT="Night Shift",n.GANTT_CALENDAR_24HOURS="24 Hours",n.GANTT_CALENDAR_MINUTE="Minute",n.GANTT_CALENDAR_MINUTE_NAMES=["m","min","minute"],n.GANTT_CALENDAR_HOUR="Hour",n.GANTT_CALENDAR_HOUR_NAMES=["h","hr","hour"],n.GANTT_CALENDAR_DAY="Day",n.GANTT_CALENDAR_DAY_NAMES=["d","dy","day"],n.GANTT_CALENDAR_WEEK="Week",n.GANTT_CALENDAR_WEEK_NAMES=["w","wk","week"],n.GANTT_CALENDAR_MONTH="Month",n.GANTT_CALENDAR_MONTH_NAMES=["mo","mon","month"],n.GANTT_CALENDAR_UNIT_LABELS=["min","hr","day","wk","mon","yr"],n.GANTT_CALENDAR_UNIT_LABELS_PLURALS=["mins","hrs","days","wks","mons","yrs"],e=i("./dist/plugins/gantt/lr.gcn.js"))e.hasOwnProperty(s)&&(n[s]=e[s])},"./dist/plugins/gantt/gantt.typedef.js":function(t,n){Object.defineProperty(n,"__esModule",{value:!0})},"./dist/plugins/gantt/lr.gcn.js":function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.wmk2=n.wmk1=void 0,n.wmk1=["757256","1879fe"],n.wmk2=["757256","1879fe"]},"./dist/plugins/gantt/project/calendar.js":function(t,n,i){var e,s,r,u,o,i,i,h,f,a,c,l,d,A,v,g;function b(){this.Upi=p(8,0),this.Bpi=u.DayOfWeek.Sunday,this.Lpi=p(17,0),this.Hpi=8,this.Ypi=40,this.Qpi=20,this.Wpi="Day",this.Gpi=3,this.Vpi=h().GANTT_CALENDAR_UNIT_LABELS,this.zpi=h().GANTT_CALENDAR_UNIT_LABELS_PLURALS,this.propertyChanged=new s.EventList,this.IOProps=["defaultDurationDecimalDigits","defaultDurationUnit","defaultFinishTime","defaultStartTime","daysPerMonth","hoursPerDay","hoursPerWeek","unitLabels","unitLabelsPlurals","weekStartOn"]}function m(){}function p(t,n){return{hour:t,minute:n}}function y(t,n,i,e){return{start:{hour:t,minute:n},end:{hour:i,minute:e}}}function w(){return[]}function j(){return[y(8,0,12,0),y(13,0,17,0)]}function T(t){if(!t||7!==t.length)throw new Error(h().GANTT_INVALID_WORK_DAYS);this.workDays=t}function O(t,n,i){var t=g.call(this,t)||this;return t.start=n,t.finish=i,t}function k(t,n,i){this.Kpi=[],this.Xpi=[],this.name=t,this.Zpi=n||new l(k.defaultWorkDays()),this.Kpi=i||[]}e=this&&this.__extends||(v=function(t,n){return(v=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}v(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.Calendar=n.CustomWorkWeek=n.WorkWeek=n.DurationHelper=n.CalendarSettings=void 0,s=i("./dist/plugins/gantt/utils/foundation.js"),r=i("./dist/plugins/gantt/gantt-json.js"),u=i("./dist/plugins/gantt/gantt.enum.js"),o=i("Common"),i=i("./dist/plugins/gantt/gantt.ns.js"),i=new o.Common.ResourceManager(i.SR,"GanttSheet"),h=i.getResource.bind(i),f=o.Common.lt.ht,Object.defineProperty(b.prototype,"weekStartOn",{get:function(){return this.Bpi},set:function(t){this.Bpi=t,this.onPropertyChanged("weekStartOn")},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"defaultStartTime",{get:function(){return this.Upi},set:function(t){this.Upi=t,this.onPropertyChanged("defaultStartTime")},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"defaultFinishTime",{get:function(){return this.Lpi},set:function(t){this.Lpi=t,this.onPropertyChanged("defaultFinishTime")},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"hoursPerDay",{get:function(){return this.Hpi},set:function(t){this.Hpi=t,this.onPropertyChanged("hoursPerDay")},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"hoursPerWeek",{get:function(){return this.Ypi},set:function(t){this.Ypi=t,this.onPropertyChanged("hoursPerWeek")},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"daysPerMonth",{get:function(){return this.Qpi},set:function(t){this.Qpi=t,this.onPropertyChanged("daysPerMonth")},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"defaultDurationUnit",{get:function(){return this.Wpi},set:function(t){this.Wpi=t,this.onPropertyChanged("defaultDurationUnit")},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"defaultDurationDecimalDigits",{get:function(){return this.Gpi},set:function(t){this.Gpi=t,this.onPropertyChanged("defaultDurationDecimalDigits")},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"unitLabels",{get:function(){return this.Vpi},set:function(t){this.Vpi=t,this.onPropertyChanged("unitLabels")},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"unitLabelsPlurals",{get:function(){return this.zpi},set:function(t){this.zpi=t,this.onPropertyChanged("unitLabelsPlurals")},enumerable:!1,configurable:!0}),b.prototype.onPropertyChanged=function(t){this.propertyChanged.invoke(t)},b.prototype.toJSON=function(){return r.GanttSheetJsonConverter.toJSON(this,this.IOProps)},b.prototype.fromJSON=function(t){r.GanttSheetJsonConverter.fromJSON(this,t,this.IOProps)},b.default=new b,n.CalendarSettings=a=b,m.empty=function(t){var n=0;return this.fromTime(0,t.defaultDurationUnit,t)},m.default=function(t){var n=this.getTime(1,"Day",t=t||a.default);return this.fromTime(n,t.defaultDurationUnit,t)},m.parse=function(t,n,i){if(null==t||""===t)return null;var e=null;if("object"==typeof t)e=t;else if("number"==typeof t)e={value:t};else{if("string"!=typeof t)return null;if(e=this.parseText(t,n),f(e))return null}return f(e.unit)&&(e.unit=i||n.defaultDurationUnit),this.normalize(e,n)},m.normalize=function(t,n){var i=t.value,e=t.unit,t=t.time,e;return e=(e=e?this.parseUnit(e,n):null)||n.defaultDurationUnit,f(t)?f(i)?t=i=0:(i=this.normalizeNumber(i),(t=this.getTime(i,e,n))>this.MaxTime&&(t=this.MaxTime,i=this.getValue(t,e,n))):((t=this.normalizeNumber(t))>this.MaxTime&&(t=this.MaxTime),i=this.getValue(t,e,n)),{value:i,unit:e,time:t}},m.normalizeNumber=function(t){return"number"!=typeof t||isNaN(t)||t<0?0:t},m.parseText=function(t,n){var i,e,e,t,e;return!t||(t=(e=0<=(e=(t=t.trim()).search(/[^\d\.\s]/))?(i=t.substr(0,e).trim(),t.substr(e)):(i=t,null))?this.parseUnit(e,n):null,e=parseFloat(i),isNaN(e))?null:{value:e,unit:t}},m.getUnitTextMap=function(){var i,t,i=this;return this.qpi||(this.qpi={},(t=function(n,t){t.forEach(function(t){i.qpi[t]=n,i.qpi[t+"s"]=n})})(h().GANTT_CALENDAR_MINUTE,h().GANTT_CALENDAR_MINUTE_NAMES),t(h().GANTT_CALENDAR_HOUR,h().GANTT_CALENDAR_HOUR_NAMES),t(h().GANTT_CALENDAR_DAY,h().GANTT_CALENDAR_DAY_NAMES),t(h().GANTT_CALENDAR_WEEK,h().GANTT_CALENDAR_WEEK_NAMES),t(h().GANTT_CALENDAR_MONTH,h().GANTT_CALENDAR_MONTH_NAMES)),this.qpi},m.parseUnit=function(t,n){var i,e,i=this.getUnitTextMap()[t.toLowerCase()];if(0<=this.$pi.indexOf(i))return i;if(n=n||a.default,f(i))for(e=0;e<this.$pi.length;e++)if(t===n.unitLabels[e]||t===n.unitLabelsPlurals[e])return this.$pi[e];return n.defaultDurationUnit},m.format=function(t,n){var i,e,t,i,s,r;if("string"==typeof t)return t;if("object"!=typeof t||null===t)return"";switch(n=n||a.default,i=Math.max(0,Math.min(10,n.defaultDurationDecimalDigits)),e=t.value,t=t.unit,i=Math.pow(10,i),s=(Math.round(e*i)/i).toString(),r=1===e?n.unitLabels:n.unitLabelsPlurals,t){case"Minute":return"".concat(s," ").concat(r[0]);case"Hour":return"".concat(s," ").concat(r[1]);case"Day":return"".concat(s," ").concat(r[2]);case"Week":return"".concat(s," ").concat(r[3]);case"Month":return"".concat(s," ").concat(r[4])}},m.getTime=function(t,n,i){switch(i=i||a.default,n){case"Month":return t*i.daysPerMonth*i.hoursPerDay*this.hourTime;case"Week":return t*i.hoursPerWeek*this.hourTime;case"Day":return t*i.hoursPerDay*this.hourTime;case"Hour":return t*this.hourTime;case"Minute":return t*this.minuteTime;default:return 0}},m.getValue=function(t,n,i){switch(i=i||a.default,n){case"Month":return t/this.hourTime/i.hoursPerDay/i.daysPerMonth;case"Week":return t/this.hourTime/i.hoursPerWeek;case"Day":return t/this.hourTime/i.hoursPerDay;case"Hour":return t/this.hourTime;case"Minute":return t/this.minuteTime;default:return 0}},m.fromValue=function(t,n,i){var e;return{value:t,unit:n,time:this.getTime(t,n,i)}},m.fromTime=function(t,n,i){var e;return{value:this.getValue(t,n,i),unit:n,time:t}},m.minuteTime=6e4,m.hourTime=36e5,m.MaxTime=864e9,m.$pi=["Minute","Hour","Day","Week","Month"],c=m,n.DurationHelper=c,T.prototype.getWorkDay=function(t){return this.workDays[t]},l=T,n.WorkWeek=l,e(O,g=l),Object.defineProperty(O.prototype,"start",{get:function(){return this.ak},set:function(t){this.ak=t},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"finish",{get:function(){return this.oz},set:function(t){this.oz=t},enumerable:!1,configurable:!0}),d=O,n.CustomWorkWeek=d,Object.defineProperty(k,"standard",{get:function(){return new k(h().GANTT_CALENDAR_STANDARD)},enumerable:!1,configurable:!0}),Object.defineProperty(k,"nightShift",{get:function(){return new k(h().GANTT_CALENDAR_NIGHT_SHIFT,new l([[],[y(23,0,24,0)],[y(0,0,3,0),y(4,0,8,0),y(23,0,24,0)],[y(0,0,3,0),y(4,0,8,0),y(23,0,24,0)],[y(0,0,3,0),y(4,0,8,0),y(23,0,24,0)],[y(0,0,3,0),y(4,0,8,0),y(23,0,24,0)],[y(0,0,3,0),y(4,0,8,0)]]))},enumerable:!1,configurable:!0}),Object.defineProperty(k,"hours24",{get:function(){return new k(h().GANTT_CALENDAR_24HOURS,new l([0,1,2,3,4,5,6].map(function(){return[y(0,0,24,0)]})))},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"name",{get:function(){return this.Zc},set:function(t){this.Zc=t},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"defaultWorkWeek",{get:function(){return this.Zpi},set:function(t){this.Zpi=t,this.invalidDateWorkCache()},enumerable:!1,configurable:!0}),Object.defineProperty(k.prototype,"customWorkWeeks",{get:function(){return this.Kpi},set:function(t){this.Kpi=t,this.invalidDateWorkCache()},enumerable:!1,configurable:!0}),k.defaultWorkDays=function(){return[[],j(),j(),j(),j(),j(),[]]},k.copyWorkDays=function(t){for(var n,i,e,n=[],i=0;i<7;i++)e=t.getWorkDay(i),n[i]=e.map(function(t){return y(t.start.hour,t.start.minute,t.end.hour,t.end.minute)});return n},k.prototype.copyTo=function(t){return new k(t,new l(k.copyWorkDays(this.defaultWorkWeek)),this.customWorkWeeks.map(function(t){return new d(k.copyWorkDays(t),new Date(t.start.valueOf()),new Date(t.finish.valueOf()))}))},k.utcToLocal=function(t){return t?new Date(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()):null},k.localToUTC=function(t){return t?new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())):null},k.diffDaysUtc=function(t,n){var i;return(n.valueOf()-t.valueOf())/this.millisecondsPerDay},k.prototype.invalidDateWorkCache=function(){this.Xpi=[]},k.prototype.getDateIndex=function(t){return Math.floor(t/k.millisecondsPerDay)},k.prototype.getTimeInDay=function(t){var n;return"number"==typeof t?(n=t%k.millisecondsPerDay)<0?k.millisecondsPerDay+n:n:60*(60*t.hour+t.minute)*1e3},k.prototype.getDateValue=function(t){return t*k.millisecondsPerDay},k.prototype.getDateWork=function(t){var n,i,e,n=this.Xpi[t];return n||(i=this.getDateWorkCore(t),e=this.getWorkDayTotal(i),this.Xpi[t]=n={total:e,work:i}),n},k.prototype.getDateWorkFallback=function(){for(var t,n,t=2;t<9;t++)if(n=this.defaultWorkWeek.getWorkDay(t%7),0<this.getWorkDayTotal(n))return n;return j()},k.prototype.getDateWorkCore=function(t){for(var n,i,e,s,t,n=this.getDateValue(t),e=this.customWorkWeeks.length-1;0<=e;e--)if((s=this.customWorkWeeks[e]).start.valueOf()<=n&&s.finish.valueOf()>=n){i=s;break}return(t=(t+4)%7)<0&&(t+=7),(i=i||this.defaultWorkWeek).getWorkDay(t)},k.prototype.getWorkDayTotal=function(t){var i=0;return t.forEach(function(t){var n=t.start,t=t.end;i+=60*(60*t.hour+t.minute-60*n.hour-n.minute)*1e3}),i},k.prototype.calcDurationUtc=function(t,n,i,e,s){var t,n,r,u,t,n,o,h;if(s=s||e.defaultDurationUnit,t=t.valueOf(),(n=n.valueOf())<=t)return c.fromTime(0,s,e);if(r=this.getDateIndex(t),u=this.getDateIndex(n),t=this.getTimeInDay(t),n=this.getTimeInDay(n),o=0,r===u)o+=this.calcDurationInDate(r,t,n,i);else if(r<u){for(o+=this.calcDurationInDate(r,t,null,i),h=r+1;h<u;h++)o+=this.getDateWork(h).total;o+=this.calcDurationInDate(u,null,n,i)}return c.fromTime(o,s,e)},k.prototype.calcDurationInDate=function(t,n,i,e){var t,s,t,t,r,u,o,h,a,h;if(null!==n&&null!==i&&i<=n)return 0;if(s=(t=this.getDateWork(t)).work,0===t.total){if(!e)return 0;s=this.getDateWorkFallback()}for(f(n)&&(n=i<(t=this.getTimeInDay(s[0].start))?0:t),f(i)&&(i=(t=this.getTimeInDay(s[s.length-1].end))<n?k.millisecondsPerDay:t),u=!(r=0),o=0;o<s.length;o++)if(h=s[o],!((a=this.getTimeInDay(h.end))<n)){if(n<(h=this.getTimeInDay(h.start))){if(i<h)return e&&(r+=i-n),r;u&&e&&(r+=h-n),n=h}if(i<=a)return r+=i-Math.max(n,h);r+=a-Math.max(n,h),n=a,u=!1}return e&&(r+=i-n),r},k.prototype.addDuration=function(t,n,i,e,s){var t=k.localToUTC(t);return k.utcToLocal(this.addDurationUtc(t,n,i,e,s))},k.prototype.addDurationUtc=function(t,n,i,e,s){var r,u,o,h,r=(n=c.parse(n,s||a.default)).time,u=this.getDateIndex(t.valueOf()),o=this.getTimeInDay(t.valueOf());if(i)for(;;){if("number"!=typeof(h=this.addDurationUtcForwardInDay(u,o,r,e)))return h;o=null,r=h,u++}else for(;;){if("number"!=typeof(h=this.addDurationUtcBackwardInDay(u,o,r,e)))return h;o=null,r=h,u--}},k.prototype.addDurationUtcForwardInDay=function(t,n,i,e){var s,r,s,u,o,h,a,h,s=this.getDateWork(t),r=s.work;if(f(n)){if(i>s.total)return i-s.total;if(i===s.total)return e?0:this.createDate(t,this.getTimeInDay(r[r.length-1].end));n=this.getTimeInDay(r[0].start)}else if(0===s.total){if(e)return 0;r=this.getDateWorkFallback()}if(!e&&(s=this.getTimeInDay(r[r.length-1].end))<n)return n+i<=(s=k.millisecondsPerDay)?this.createDate(t,n+i):i-(s-n);for(u=!!e,o=0;o<r.length;o++)if(h=r[o],!((a=this.getTimeInDay(h.end))<n)){if(n<(h=this.getTimeInDay(h.start))){if(!u){if(n+i<=h)return this.createDate(t,n+i);i-=h-n}n=h}if(e?n+i<a:n+i<=a)return this.createDate(t,n+i);i-=a-n,n=a,u=!0}return i},k.prototype.addDurationUtcBackwardInDay=function(t,n,i,e){var s,r,u,o,h,a,c,a,s=this.getDateWork(t),r=s.work;if(f(n)){if(i>s.total)return i-s.total;if(i===s.total)return e?this.createDate(t,this.getTimeInDay(r[0].start)):0;n=this.getTimeInDay(r[r.length-1].end)}else if(0===s.total){if(!e)return 0;r=this.getDateWorkFallback()}if(e&&n<(u=this.getTimeInDay(r[0].start)))return(u=0)<=n-i?this.createDate(t,n-i):i-+n;for(o=!e,h=r.length-1;0<=h;h--)if(a=r[h],!(n<(c=this.getTimeInDay(a.start)))){if((a=this.getTimeInDay(a.end))<n){if(!o){if(a<=n-i)return this.createDate(t,n-i);i-=n-a}n=a}if(e?c<=n-i:c<n-i)return this.createDate(t,n-i);i-=n-c,n=c,o=!0}return i},k.prototype.createDate=function(t,n){return new Date(t*k.millisecondsPerDay+n)},k.prototype.isNonWorkingArea=function(t,n){var i;return 0===this.calcDurationUtc(t,n,!1,a.default).time},k.prototype.isWorkingDay=function(t){var t,n,t=this.getDateIndex(t.valueOf()),n;return 0<this.getDateWork(t).total},k.millisecondsPerDay=864e5,n.Calendar=k},"./dist/plugins/gantt/project/dependency.js":function(t,n,i){var f,e,i,i,u,h,s,r;function o(t,n,i){void 0===i&&(i="FS"),this.xT=!1,this.m1n=t,this.Jpi=n,this.uit=i}function a(t){this.project=t,this.dependencies=[]}f=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var e=0,s=n.length,r;e<s;e++)!r&&e in n||((r=r||Array.prototype.slice.call(n,0,e))[e]=n[e]);return t.concat(r||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.TaskDependencyMap=n.TaskDependency=void 0,e=i("Common"),i=i("./dist/plugins/gantt/gantt.ns.js"),i=new e.Common.ResourceManager(i.SR,"GanttSheet"),u=i.getResource.bind(i),h=e.Common.lt.ht,Object.defineProperty(o.prototype,"from",{get:function(){return this.m1n},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"to",{get:function(){return this.Jpi},enumerable:!1,configurable:!0}),Object.defineProperty(o.prototype,"type",{get:function(){return this.uit},enumerable:!1,configurable:!0}),o.parsePredecessors=function(t,n){return t&&n?this.parseText(n,t,!0):null},o.parseSuccessors=function(t,n){return t&&n?this.parseText(n,t,!1):null},o.parseText=function(t,i,e){var s,n,r,s=this,n=+t;return isNaN(n)?(r=t.split(",")).map(function(t){var n,t,t,n=+(t=t.trim());if(!isNaN(n))return s.createParseResult(n,i,e);if(t=t.match(s.DEPENDENCY_REGEX))return n=+t[1],t=t[2]?t[2].toUpperCase():"FS",s.createParseResult(n,i,e,t);throw new Error(u().GANTT_INVALID_DEPENDENCY)}):[this.createParseResult(n,i,e)]},o.createParseResult=function(t,n,i,e){if(void 0===e&&(e="FS"),!n)return{taskNumber:t,type:e};var t=n.project.getTask(t);if(t)return i?new o(t,n,e):new o(n,t,e);throw new Error(u().GANTT_INVALID_DEPENDENCY)},o.formatPredecessors=function(t){return t.map(function(t){return t.getText(t.from)}).join(",")},o.formatSuccessors=function(t){return t.map(function(t){return t.getText(t.to)}).join(",")},o.prototype.getText=function(t){var t,n,t=t.taskNumber,n=this.type;return"FS"!==n?"".concat(t).concat(n):"".concat(t)},o.DEPENDENCY_REGEX=/^([1-9][0-9]*)(FF|FS|SF|SS)?([+-].*)?$/i,s=o,n.TaskDependency=s,a.prototype.rebuild=function(){this.dependencies=[];try{var t=this.buildDependencies(this.project.Vp);this.validate(t)&&(this.dependencies=t)}catch(t){this.dependencies=[]}this.dependencies.forEach(function(t){t.from.tyi().push(t),t.to.nyi().push(t)})},a.prototype.buildDependencies=function(t){var i=[];return t.forEach(function(t){var n,n;t&&((n=t._data.predecessors)&&i.push.apply(i,s.parsePredecessors(t,n)),n=t._data.successors)&&i.push.apply(i,s.parseSuccessors(t,n))}),i},a.prototype.add=function(t){var n;if(!h(t)&&0!==t.length){if(!1===this.validateChanges(t))throw new Error(u().GANTT_INVALID_DEPENDENCY);t.forEach(function(t){t.from.tyi().push(t),t.to.nyi().push(t)}),(n=this.dependencies).push.apply(n,t),this.invalidateLines()}},a.prototype.validateChanges=function(t,n){for(var i,e,s,r,u,o,h,a,c,i=0,e=t;i<e.length;i++)if(s=e[i],!1===this.validateMembership(s))return!1;if(r=f([],this.dependencies,!0),n&&0<n.length){for(u=0,o=n;u<o.length;u++)(h=o[u]).iyi=!0;for(r=r.filter(function(t){return!t}),a=0,c=n;a<c.length;a++)delete(h=c[a]).iyi}return this.validateCircle(f(f([],r,!0),t,!0))},a.prototype.validate=function(t){for(var n,i,e,n=0,i=t;n<i.length;n++)if(e=i[n],!1===this.validateMembership(e))return!1;return!1!==this.validateCircle(t)},a.prototype.validateMembership=function(t){var n,i,e,s,n=t.from,i=t.to;if(i.isSummary&&("SF"===t.type||"FF"===t.type))return!1;for(e=n.level>i.level?n:i,s=n.level>i.level?i:n;e.level>s.level;)e=e.parent;return e!==s},a.prototype.validateCircle=function(t){var t=this.buildDependencyMap(t);return!(!t||!1===this.validateCircleCore(t))},a.prototype.validateCircleCore=function(t){for(var n,i,e,s,r,n=[],i=[],e=this.project.count<<1,s=[],r=0;r<e;r++)if(!n[r])for(s.push([r,-1]);s.length;)if(!1===this.dfs(t,n,i,s))return!1;return!0},a.prototype.buildDependencyMap=function(t){for(var n,i,e,s,n=this.initDependencyMap(),i=0,e=t;i<e.length;i++)if(s=e[i],!1===this.buildDependencyMapLine(n,s.from,s.to))return null;return n},a.prototype.initDependencyMap=function(){for(var t,n,i,e,e,s,r,u,o,t=[],n=0;n<this.project.count;n++)if(i=this.project.getTask(n),!h(i)){for(t[e=i.taskNumber<<1]=s=[e=1+e],r=0,u=i.Fpi();r<u.length;r++)o=u[r],s.push(o.taskNumber<<1);0!==n&&(t[e]=[1+(i.parent.taskNumber<<1)])}return t},a.prototype.buildDependencyMapLine=function(t,n,i){var n,i,e,n=1+(n.taskNumber<<1),i=i.taskNumber<<1,e=t[n];if(e){if(0<=e.indexOf(i))return!1}else t[n]=e=[];return e.push(i),!0},a.prototype.dfs=function(t,n,i,e){var s,r,s,n,s=e[e.length-1],r=s[0],s=s[1];if(-1===s){if(n[r])return!i[r]&&(e.pop(),!0);n[r]=!0,i[r]=!0}return s++,(n=t[r])&&s<n.length?(e[e.length-1][1]=s,e.push([n[s],-1])):(i[r]=!1,e.pop()),!0},a.prototype.remove=function(t){var n=this;t.forEach(function(t){n.disposeDependency(t)}),this.dependencies=this.dependencies.filter(function(t){return!t.xT}),this.invalidateLines()},a.prototype.onTasksRemoved=function(){var n=this;this.dependencies.forEach(function(t){(t.from.xT||t.to.xT)&&n.disposeDependency(t)}),this.dependencies=this.dependencies.filter(function(t){return!t.xT})},a.prototype.onTasksMembershipChanged=function(){var n=this;this.dependencies.forEach(function(t){n.validateMembership(t)||n.disposeDependency(t)}),this.dependencies=this.dependencies.filter(function(t){return!t.xT})},a.prototype.disposeDependency=function(t){t.xT=!0,this.removeArrayItem(t.from.tyi(),t),this.removeArrayItem(t.to.nyi(),t)},a.prototype.removeArrayItem=function(t,n){for(var i=0;i<t.length;i++)if(t[i]===n){t.splice(i,1);break}},a.prototype.getLinkLineInRow=function(t){return this.lineMap||this.rebuildLines(),this.getRowData(t)},a.prototype.invalidateLines=function(){this.lineMap=null},a.prototype.rebuildLines=function(){var r=this;this.lineMap=[],this.project.eyi().forEach(function(t){for(var n,i,e,s,n=t.from.viewIndex,i=t.to.viewIndex,e=Math.min(n,i);e<=Math.max(n,i);e++)s=r.getRowData(e,!0),(e===n?s.startLines:e===i?s.endLines:s.crossLines).push(t)})},a.prototype.getRowData=function(t,n){void 0===n&&(n=!1);var i=this.lineMap[t];return!i&&n&&(this.lineMap[t]=i={startLines:[],endLines:[],crossLines:[]}),i},n.TaskDependencyMap=a},"./dist/plugins/gantt/project/gantt-assignment.js":function(t,n){var i;function e(t){this.uAi=t,this.assignments=[],this.taskAssignments={}}Object.defineProperty(n,"__esModule",{value:!0}),n.ResourcesAssignment=void 0,e.prototype.uAe=function(t){this.assignmentTable=t},e.prototype.cAe=function(){this.assignments=[]},e.prototype.fAe=function(){this.taskAssignments={}},e.prototype.aAe=function(){var i,t,i=this,t=this.assignmentTable.VRt();this.cAe(),this.fAe(),t.forEach(function(t){i.assignments.push(t);var n=i.taskAssignments[t.taskId];n?n.push(t.resourceId):i.taskAssignments[t.taskId]=[t.resourceId]})},e.prototype.lAe=function(t){var n,i,n,i=this.uAi.host.getDataView().gLt.primaryKey();return t.getDataValue(i)},e.prototype.updateTaskAssignment=function(t,o,h){var a,c,n,i,f,l,d,a=this,c=this.uAi.host,n=c.getDataView(),i=this.uAi.getTaskByRow(t+1),f=this.lAe(i),l=[],d=n.gLt;d.yRt(t,1,function(){var t,n,i,e,s,r,r,u;for(c.suspendPaint(),t=a.assignmentTable,n=0;n<a.assignments.length;n++)(i=a.assignments[n]).taskId===f&&(a.assignments.splice(n,1),n--);for(e=0,s=o;e<s.length;e++)r=s[e],r=a.uAi.getResourcesByName(r),u={taskId:f,resourceId:r.id},l.push(r.id),t.insertItem(t.length(),u),a.assignments.push(u);a.taskAssignments[f]=l,d.rRt(h),c.resumePaint()})},e.prototype.getResourcesCountByTaskNumber=function(t){var t,t,t,t=this.uAi.getTask(t);return t&&(t=this.lAe(t),null==(t=this.taskAssignments[t])?void 0:t.length)||0},n.ResourcesAssignment=e},"./dist/plugins/gantt/project/gantt-resources.js":function(t,n,i){var e,s,r;function u(t,n){this.name=t,this._data=n}function o(t){this.uAi=t,this.resourcesAssignment=new e.ResourcesAssignment(this.uAi)}Object.defineProperty(n,"__esModule",{value:!0}),n.ResourcesManager=n.Resources=void 0,e=i("./dist/plugins/gantt/project/gantt-assignment.js"),Object.defineProperty(u.prototype,"id",{get:function(){return this._data.id},enumerable:!1,configurable:!0}),s=u,n.Resources=s,o.prototype.uAe=function(t){this.resourcesAssignment.uAe(t)},o.prototype.oAe=function(t){this.resourcesTable=t},o.prototype.getResourcesByTaskId=function(t){var t;return null!=(t=this.resourcesAssignment.taskAssignments[t])?t:[]},o.prototype.getResourcesById=function(t){for(var n=0;n<this.resourcesList.length;n++)if(this.resourcesList[n].id===t)return this.resourcesList[n];return null},o.prototype.getResourcesByName=function(t){for(var n=0;n<this.resourcesList.length;n++)if(this.resourcesList[n].name===t)return this.resourcesList[n];return null},o.prototype.aAe=function(){this.resourcesAssignment.aAe()},o.prototype.hAe=function(){var n,t,n=this,t=this.resourcesTable.VRt();this.dAe(),t.forEach(function(t){var t=new s(t.name,t);n.resourcesList.push(t)})},o.prototype.dAe=function(){this.resourcesList=[]},o.prototype.AAe=function(){var t=this;this.resourcesTable.fetch().then(function(){t.hAe()})},n.ResourcesManager=o},"./dist/plugins/gantt/project/project.js":function(t,n,i){var e,s,r,u,o,h,a,c,f,l,d,A,v,g,b,m,i,p,y,w,j;function T(t){var n,t,i,n=this;this.dji=[],this.Kj=0,this.Lmi=new s.EventList,this.Hmi=new s.EventList,this.VAi=new s.EventList,this.Rmi=new s.EventList,this.Wmi=new s.EventList,this.Vmi=new s.EventList,this.IOProps=["calendarSettings","timescale","layout","defaultMode","taskStyleRules","startDate","currentDate","taskView"],this.Zc=t,this.taskManager=new c.TaskManager(this),this.resourcesManager=new b.ResourcesManager(this),this.syi=h.Calendar.standard,this.ryi=new h.CalendarSettings,this.ryi.propertyChanged.attach(function(){n.uyi.reSchedule()},this),this.hyi=new o.Timescale(this),this.GY=new f.TaskbarLayout(this),this.taskView=new c.TaskCollectionView(this),this.taskView.onTasksChanging=this.onTasksChanging.bind(this),this.taskView.onTasksChanged=this.onTasksChanged.bind(this),this.oyi=new u.TaskDependencyMap(this),this.Omi=new l.TaskbarStyleManager(this),this.uyi=new a.ScheduleManager(this),t=new Date,i=this.calendarSettings.defaultStartTime,t.setHours(i.hour,i.minute,0,0),this.startDate=t,this.loadTasksInternal([],0)}e=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var e=0,s=n.length,r;e<s;e++)!r&&e in n||((r=r||Array.prototype.slice.call(n,0,e))[e]=n[e]);return t.concat(r||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.Project=void 0,s=i("./dist/plugins/gantt/utils/foundation.js"),r=i("./dist/plugins/gantt/utils/util.js"),u=i("./dist/plugins/gantt/project/dependency.js"),o=i("./dist/plugins/gantt/project/timescales.js"),h=i("./dist/plugins/gantt/project/calendar.js"),a=i("./dist/plugins/gantt/project/schedule.js"),c=i("./dist/plugins/gantt/project/tasks.js"),f=i("./dist/plugins/gantt/taskbar/layout.js"),l=i("./dist/plugins/gantt/taskbar/style.js"),d=i("./dist/plugins/gantt/gantt.enum.js"),A=i("./dist/plugins/gantt/gantt-json.js"),v=i("Common"),g=i("./dist/plugins/gantt/gantt.ns.js"),b=i("./dist/plugins/gantt/project/gantt-resources.js"),m=i("./dist/plugins/gantt/gantt-sort.js"),i=new v.Common.ResourceManager(g.SR,"GanttSheet"),p=i.getResource.bind(i),y=v.Common.lt.ht,w=v.Common.lt.tv,Object.defineProperty(T.prototype,"name",{get:function(){return this.Zc},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"startDateUtc",{get:function(){return this.jAi},set:function(t){this.jAi=t},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"startDate",{get:function(){return h.Calendar.utcToLocal(this.jAi)},set:function(t){this.jAi=h.Calendar.localToUTC(t),this.hyi.update(t),this.uyi.reSchedule()},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"finishDateUtc",{get:function(){return this.ayi||this.jAi},set:function(t){this.ayi=t},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"finishDate",{get:function(){return h.Calendar.utcToLocal(this.finishDateUtc)},set:function(t){throw new Error(p().GANTT_INVALID_OPERATION)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"currentDateUtc",{get:function(){var t;return this.cyi||((t=new Date).setHours(this.calendarSettings.defaultStartTime.hour,this.calendarSettings.defaultStartTime.minute,0,0),this.cyi=h.Calendar.localToUTC(t)),this.cyi},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"currentDate",{get:function(){return h.Calendar.utcToLocal(this.currentDateUtc)},set:function(t){this.cyi=h.Calendar.localToUTC(t),this.VAi.invoke()},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"calendar",{get:function(){return this.syi},set:function(t){this.syi=t,this.uyi.reSchedule()},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"calendarSettings",{get:function(){return this.ryi},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"timescale",{get:function(){return this.hyi},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"taskStyleRules",{get:function(){return this.Omi.rules},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"layout",{get:function(){return this.GY},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"canAddTask",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"canRemoveTask",{get:function(){return!0},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"tasks",{get:function(){return e([],this.taskView.tasks,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"Vp",{get:function(){return this.taskView.tasks},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"tasksSorted",{get:function(){return this.taskView.getTasksInView()},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"root",{get:function(){return this.Vp[0]},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"count",{get:function(){return this.Vp.length},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"sorted",{get:function(){return this.taskView.sorted},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"keepOutlineStructure",{get:function(){return!this.taskView.fyi||this.taskView.fyi.keepStructure},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"sortState",{get:function(){return this.taskView.fyi},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"defaultMode",{get:function(){return this.uyi.defaultMode},set:function(t){this.uyi.defaultMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(T.prototype,"dependencies",{get:function(){return e([],this.oyi.dependencies,!0)},enumerable:!1,configurable:!0}),T.prototype.Lji=function(t){return this.root===t},T.prototype.getTask=function(t){return this.taskView.getTask(t)},T.prototype.getTaskByRow=function(t){var t=this.getRowState(t);return t?t.task:null},T.prototype.getResources=function(t){return this.resourcesManager.getResourcesById(t)},T.prototype.getResourcesByName=function(t){return this.resourcesManager.getResourcesByName(t)},T.prototype.getResourcesByTaskNumber=function(t){return this.resourcesManager.getResourcesByTaskId(t)},T.prototype.getRowState=function(t){return this.taskView.getRowState(t)},T.prototype.cloneTask=function(t){var n,n,i,n=w(t.getData()),n=this.createTask(n),i=t.kU;return n.kU.taskNumber=i.taskNumber,n.kU.viewIndex=i.viewIndex,t.predecessors&&(n._data.predecessors=t.predecessors),t.successors&&(n._data.successors=t.successors),n},T.prototype.getBackupTasks=function(){return this.dji},T.prototype.clearBackupTasks=function(){this.dji=[]},T.prototype.backupTasksForSchedule=function(t){for(var n,i,e,s,r,n=[],i=this.count,e=t===d.TasksChangeAction.Renumber,s=0;s<i;s++)r=e?this.getTaskByRow(s):this.getTask(s),n.push(this.cloneTask(r));return this.dji=n},T.prototype.addField=function(t){this.taskManager.addField(t)},T.prototype.getField=function(t){return this.taskManager.getField(t)},T.prototype.suspendDirty=function(){this.Kj++},T.prototype.resumeDirty=function(){this.Kj--,0<this.Kj&&this.Kj--},T.prototype.isSuspendDirty=function(){return 0<this.Kj},T.prototype.createChange=function(t,n,i,e){return{action:t,changedItems:n,needReschedule:!!i,sortInfos:e}},T.prototype.Fji=function(t,n){var i,e,i,i=t.start,e;0!==m.GanttSortService.dateCompareFunction(i,n)&&(i=this.createChange(d.TasksChangeAction.Update,[],!0),this.Lmi.invoke(i),this.uyi.Fji(t,n),this.Hmi.invoke(i))},T.prototype.Nji=function(t,n){var i,e,i,i=t.finish,e;0!==m.GanttSortService.dateCompareFunction(i,n)&&(i=this.createChange(d.TasksChangeAction.Update,[],!0),this.Lmi.invoke(i),this.uyi.Nji(t,n),this.Hmi.invoke(i))},T.prototype.sort=function(t,n,i,e){var s,r,u,o,o,h;if(void 0===i&&(i=!0),(e=void 0===e?!1:e)&&!i)throw new Error(p().GANTT_INVALID_OPERATION);if(n&&n.length!==t.length)throw new Error(p().GANTT_INVALID_OPERATION);for(s=[],r=0,u=t;r<u.length;r++){if(o=u[r],!(o=this.getField(o)))throw new Error(p().GANTT_INVALID_FIELD);s.push(o)}if((n=n||s.map(function(){return!0})).length!==s.length)throw new Error(p().GANTT_INVALID_ASCENDING_STATES);this.taskView.sort(s,n,i),e&&this.taskView.renumberTaskNumbers(h={fields:s,ascendingStates:n})},T.prototype.resort=function(){var t,n,i,t;this.taskView.sorted&&(n=(t=this.taskView.fyi).fields,i=t.ascendingStates,t=t.keepStructure,this.taskView.sort(n,i,t))},T.prototype.createTask=function(t){return this.taskManager.createTask(t)},T.prototype.createRoot=function(){var t=this.createTask({name:this.name});return t.kU.taskNumber=0,t.kU.viewIndex=0,t.q2t(0),t},T.prototype.loadTasksInternal=function(t,n){var t=this.createTasks(t,n);this.taskView.reset(t)},T.prototype.createTasks=function(t,n){var i,e,s,r,u,o,h,a,c,f,l,d,A,v,v,a,g,i=[];for(i[0]=this.createRoot(),e={},s=this.taskManager.getPrimaryKeyField(),r=this.taskView.Qji,u=0,o=t;u<o.length;u++)"number"==typeof(a=(h=o[u]).taskNumber)&&(c=h.id,l=e[f=h.parentId],d=this.createTask(h),s&&r&&(v=r[A=this.taskManager.getTaskValue(d,s.name)])&&(v.task=d),(i[a]=d).kU.taskNumber=a,l?(i[v=l.taskNumber]||(i[v]=l),this.setParent(l,d)):this.setParent(i[0],d),"number"!=typeof(a=h.level)&&(a=1),d.q2t(g=a-n),e[c]=d);return i.filter(function(t){return!!t})},T.prototype.setParent=function(t,n){n.lyi(t),t.Fpi().push(n)},T.prototype.addTasks=function(t,n){var t;if(void 0===t&&(t=1),this.canAddTask)return t=this.insertTasks(this.count,t,n),this.resort(),t;throw new Error(p().GANTT_INVALID_OPERATION)},T.prototype.insertTasks=function(t,n,i){if(void 0===n&&(n=1),this.canAddTask)return this.validateInsertIndex(t,!0),this.insertTasksCore(t,n,i);throw new Error(p().GANTT_INVALID_OPERATION)},T.prototype.insertTasksByRow=function(t,n,i){var t;if(this.canAddTask)return t=this.validateInsertIndex(t,!1),this.insertTasksCore(t,n,i);throw new Error(p().GANTT_INVALID_OPERATION)},T.prototype.insertTasksCore=function(t,n,i){if(void 0===i)i=this.taskView.calcRowLevel(t);else if(!1===this.taskView.validateLevel(t,i))throw new Error(p().GANTT_INVALID_LEVEL);var n=this.createTasksForInsert(n);return n.forEach(function(t){t.q2t(i)}),this.taskView.insert(t,n),this.resort(),n},T.prototype.createTasksForInsert=function(t){var n,i,n=[];if("number"==typeof t)for(i=0;i<t;i++)n.push(this.createTask());else if(Array.isArray(t))for(i=0;i<t.length;i++)n.push(this.createTask(t[i]));else n.push(this.createTask(t));return n},T.prototype.addRecurringTask=function(t,n){if(!this.canAddTask)throw new Error(p().GANTT_INVALID_OPERATION)},T.prototype.insertRecurringTask=function(t,n,i){if(!this.canAddTask)throw new Error(p().GANTT_INVALID_OPERATION)},T.prototype.validateInsertIndex=function(t,n){if(isNaN(t)||t<=0||t>this.count)throw new Error(n?p().GANTT_INVALID_ID:p().GANTT_INVALID_ROW_INDEX);return n||t===this.count?t:this.getRowState(t).taskNumber},T.prototype.removeTasks=function(t){if(!this.canRemoveTask)throw new Error(p().GANTT_INVALID_OPERATION);this.validateOperationIndexes(t="number"==typeof t?[t]:t)&&this.taskView.remove(t)},T.prototype.removeTasksByRange=function(t,n){if(void 0===n&&(n=1),!this.canRemoveTask)throw new Error(p().GANTT_INVALID_OPERATION);var t=this.validateOperationIndexAndCount(t,!0,n);this.taskView.remove(t)},T.prototype.removeTasksByRowRange=function(t,n){if(void 0===n&&(n=1),!this.canRemoveTask)throw new Error(p().GANTT_INVALID_OPERATION);var t=this.validateOperationIndexAndCount(t,!1,n);this.taskView.remove(t)},T.prototype.clearTasks=function(t){if(!this.canRemoveTask)throw new Error(p().GANTT_INVALID_OPERATION);this.validateOperationIndexes(t="number"==typeof t?[t]:t)&&this.taskView.clear(t)},T.prototype.clearTasksByRange=function(t,n){if(void 0===n&&(n=1),!this.canRemoveTask)throw new Error(p().GANTT_INVALID_OPERATION);var t=this.validateOperationIndexAndCount(t,!0,n);this.taskView.clear(t)},T.prototype.clearTasksByRowRange=function(t,n){if(void 0===n&&(n=1),!this.canRemoveTask)throw new Error(p().GANTT_INVALID_OPERATION);var t=this.validateOperationIndexAndCount(t,!1,n);this.taskView.clear(t)},T.prototype.renewTasks=function(t,n){if(!this.canAddTask||!this.canRemoveTask)throw new Error(p().GANTT_INVALID_OPERATION);if(this.validateOperationIndexes(t="number"==typeof t?[t]:t)){var i=void 0,i;if((i=y(n)?this.createTasksForInsert(t.length):this.createTasksForInsert(n)).length!==t.length)throw new Error(p().GANTT_INVALID_COUNT);return this.taskView.renew(t,i),i}},T.prototype.renewTasksByRange=function(t,n){var n,t;if(void 0===n&&(n=1),this.canAddTask&&this.canRemoveTask)return n=this.createTasksForInsert(n),t=this.validateOperationIndexAndCount(t,!0,n.length),this.taskView.renew(t,n),n;throw new Error(p().GANTT_INVALID_OPERATION)},T.prototype.renewTasksByRowRange=function(t,n){var n,t;if(void 0===n&&(n=1),this.canAddTask&&this.canRemoveTask)return n=this.createTasksForInsert(n),t=this.validateOperationIndexAndCount(t,!1,n.length),this.taskView.renew(t,n),n;throw new Error(p().GANTT_INVALID_OPERATION)},T.prototype.indentTasks=function(t){this.validateOperationIndexes(t="number"==typeof t?[t]:t)&&this.indentOutdentCore(t,1)},T.prototype.indentTasksByRange=function(t,n){var t=this.validateOperationIndexAndCount(t,!0,n=void 0===n?1:n);this.indentOutdentCore(t,1)},T.prototype.indentTasksByRowRange=function(t,n){var t=this.validateOperationIndexAndCount(t,!1,n=void 0===n?1:n);this.indentOutdentCore(t,1)},T.prototype.outdentTasks=function(t){this.validateOperationIndexes(t="number"==typeof t?[t]:t)&&this.indentOutdentCore(t,-1)},T.prototype.outdentTasksByRange=function(t,n){var t=this.validateOperationIndexAndCount(t,!0,n=void 0===n?1:n);this.indentOutdentCore(t,-1)},T.prototype.outdentTasksByRowRange=function(t,n){var t=this.validateOperationIndexAndCount(t,!1,n=void 0===n?1:n);this.indentOutdentCore(t,-1)},T.prototype.indentOutdentCore=function(t,n){this.keepOutlineStructure&&(this.taskView.changeTasksLevel(t,n),this.resort())},T.prototype.validateOperationIndexAndCount=function(t,n,i){var e,t,e=this;if(isNaN(t)||t<=0||t>=this.count)throw new Error(n?p().GANTT_INVALID_ID:p().GANTT_INVALID_ROW_INDEX);if(!y(i)&&(isNaN(i)||i<=0||t+i-1>=this.count))throw new Error(p().GANTT_INVALID_COUNT);return t=r.GanttUtil.range(t,i),n?t:t.map(function(t){return e.getRowState(t).taskNumber})},T.prototype.validateOperationIndexes=function(t){var n=this;return!!(t&&0<t.length)&&(t.forEach(function(t){if(isNaN(t)||t<=0||t>=n.count)throw new Error(p().GANTT_INVALID_ID)}),!0)},T.prototype.eyi=function(){return this.oyi.dependencies},T.prototype.addDependency=function(t){var e,t,e=this;if(t&&0!==t.length){if(t=(t=Array.isArray(t)?t:[t]).map(function(t){var n,i;if(t instanceof u.TaskDependency){if(t.from.project!==e||t.to.project!==e)throw new Error(p().GANTT_INVALID_DEPENDENCY);return t}if(n=e.getTask(t.fromTaskNumber),i=e.getTask(t.toTaskNumber),y(n)||y(i))throw new Error(p().GANTT_INVALID_DEPENDENCY);return new u.TaskDependency(n,i,t.type)}),!this.Ayi(t))throw new Error(p().GANTT_INVALID_DEPENDENCY);this.gyi(null,t)}},T.prototype.removeDependency=function(t){var n,i,e;if(t&&0!==t.length){for(n=0,i=t=Array.isArray(t)?t:[t];n<i.length;n++)if(!(e=i[n])||e.from.project!==this||e.to.project!==this)throw new Error(p().GANTT_INVALID_DEPENDENCY);this.gyi(t,null)}},T.prototype.gyi=function(t,n,i){var e=this.createChange(d.TasksChangeAction.Update,this.Vp,!0);i||this.Lmi.invoke(e),t&&t.length&&(this.uyi.invalidTasks(t.map(function(t){return t.to})),this.oyi.remove(t)),n&&n.length&&(t&&t.length&&!1===this.oyi.validateChanges(n)?(this.uyi.validTasks(t.map(function(t){return t.to})),this.oyi.add(t)):(this.oyi.add(n),this.uyi.invalidTasks(n.map(function(t){return t.to})))),i||this.Hmi.invoke(e)},T.prototype.Ayi=function(t,n){return!(!y(t)&&0!==t.length)||this.oyi.validateChanges(t,n)},T.prototype.kmi=function(t){return this.oyi.getLinkLineInRow(t)},T.prototype.getDefaultStartDate=function(){var t,n,t=this.calendarSettings.defaultStartTime,n=new Date;return n.setHours(t.hour,t.minute,0,0),n},T.prototype.getDefaultFinishDate=function(){var t,n,t=this.calendarSettings.defaultFinishTime,n=new Date;return n.setHours(t.hour,t.minute,0,0),n},T.prototype.suspendSchedule=function(){this.uyi.suspend()},T.prototype.resumeSchedule=function(){this.uyi.resume()},T.prototype.parseDuration=function(t){return h.DurationHelper.parse(t,this.calendarSettings)},T.prototype.formatDuration=function(t){return h.DurationHelper.format(t,this.calendarSettings)},T.prototype.onTasksChanging=function(t){this.Lmi.invoke(t)},T.prototype.onTasksChanged=function(t){t.action===d.TasksChangeAction.Reset?this.oyi.rebuild():t.action===d.TasksChangeAction.Remove||t.action===d.TasksChangeAction.Replace?this.oyi.onTasksRemoved():t.action===d.TasksChangeAction.Move&&this.oyi.onTasksMembershipChanged(),this.oyi.invalidateLines(),this.Hmi.invoke(t)},T.prototype.toJSON=function(){return A.GanttSheetJsonConverter.toJSON(this,this.IOProps)},T.prototype.fromJSON=function(t){A.GanttSheetJsonConverter.fromJSON(this,t,this.IOProps)},n.Project=T},"./dist/plugins/gantt/project/schedule.js":function(t,n,i){var c,i,u,e;function f(t){this.vyi="Auto",this.byi=0,this.uAi=t,this.uAi.Hmi.attach(this.onTasksChanged,this)}Object.defineProperty(n,"__esModule",{value:!0}),n.ScheduleManager=void 0,c=i("./dist/plugins/gantt/project/calendar.js"),i=i("Common"),u=i.Common.lt.ht,Object.defineProperty(f.prototype,"defaultMode",{get:function(){return this.vyi},set:function(t){this.vyi=t,this.reSchedule()},enumerable:!1,configurable:!0}),Object.defineProperty(f.prototype,"isSuspended",{get:function(){return 0<this.byi},enumerable:!1,configurable:!0}),f.prototype.suspend=function(){this.byi++},f.prototype.resume=function(){0<this.byi&&this.byi--,0===this.byi&&this.reSchedule()},f.prototype.validTasks=function(t){for(var n,i,e,n=0,i=t;n<i.length;n++)(e=i[n]).myi=!1,e.pyi=!1},f.prototype.invalidTasks=function(t){for(var n,i,e,n=0,i=t;n<i.length;n++)(e=i[n]).myi=!0,e.pyi=!0},f.prototype.invalidAllTasks=function(){this.invalidTasks(this.uAi.Vp)},f.prototype.Fji=function(t,n){var i=this.prepareSetTaskStartFinishDuration(t);i&&(i=this.setTaskStartCore(i,n,t.mode),this.applyScheduleData(t,i))},f.prototype.setTaskStartCore=function(t,n,i){var e=f.getScheduleDataType(t);return n?t="All"===e?this.buildScheduleData(n,null,t.duration,i,!1):this.buildScheduleData(n,t.finish,t.duration,i,!1):(t.start=null,"All"===e&&(t.duration=null)),t},f.prototype.Nji=function(t,n){var i=this.prepareSetTaskStartFinishDuration(t);i&&(i=this.setTaskFinishCore(i,n,t.mode),this.applyScheduleData(t,i))},f.prototype.setTaskFinishCore=function(t,n,i){var e,s,e=f.getScheduleDataType(t);return n?t="All"===e?(s=t.duration.unit,this.buildScheduleData(t.start,n,null,i,!1,s)):this.buildScheduleData(t.start,n,t.duration,i,!1):(t.finish=null,"All"===e&&(t.duration=null)),t},f.prototype.setTaskDuration=function(t,n){var i=this.prepareSetTaskStartFinishDuration(t);i&&(i=this.setTaskDurationCore(i,n,t.mode),this.applyScheduleData(t,i),this.onTaskChanged(t))},f.prototype.setTaskDurationCore=function(t,n,i){var e,s,r,u,e=f.getScheduleDataType(t);return n?t="All"===e?"Manual"===i&&n.time<=t.duration.time?(s=c.Calendar.localToUTC(t.finish),r=this.uAi.calendar.addDurationUtc(c.Calendar.localToUTC(t.start),n,!0,!1,this.uAi.calendarSettings),u=t.duration.time-n.time,s.valueOf()-u<r.valueOf()&&(r=new Date(s.valueOf()-u)),this.buildScheduleData(t.start,c.Calendar.utcToLocal(r),null,i,!1,n.unit)):this.buildScheduleData(t.start,null,n,i,!1):this.buildScheduleData(t.start,t.finish,n,i,!1):(t.duration=null,"All"===e&&(t.finish=null)),t},f.prototype.prepareSetTaskStartFinishDuration=function(t){if(t&&0!==t.taskNumber)return"Auto"===t.mode&&t.isSummary&&(t._data.mode="Manual"),this.buildScheduleData(t._data.start,t._data.finish,t._data.duration,t.mode,!1)},f.prototype.buildScheduleData=function(t,n,i,e,s,r){var u,o,u={start:t,finish:n,duration:i},o;return"Partly"===f.getScheduleDataType(u)&&(t&&i?this.updateScheduleDataFinish(u,t,i,s):n&&i?this.updateScheduleDataStart(u,n,i,s):t&&n&&this.updateScheduleDataDuration(u,t,n,r,e,s)),u},f.prototype.updateScheduleDataStart=function(t,n,i,e){0===i.time?t.start=new Date(n.getTime()):t.start=e?this.uAi.calendar.addDurationUtc(n,i,!1,!0,this.uAi.calendarSettings):this.uAi.calendar.addDuration(n,i,!1,!0,this.uAi.calendarSettings)},f.prototype.updateScheduleDataFinish=function(t,n,i,e){0===i.time?t.finish=new Date(n.getTime()):t.finish=e?this.uAi.calendar.addDurationUtc(n,i,!0,!1,this.uAi.calendarSettings):this.uAi.calendar.addDuration(n,i,!0,!1,this.uAi.calendarSettings)},f.prototype.updateScheduleDataDuration=function(t,n,i,e,s,r){e=e||this.uAi.calendarSettings.defaultDurationUnit;var s="Manual"===s;t.duration=r?this.uAi.calendar.calcDurationUtc(n,i,s,this.uAi.calendarSettings,e):this.uAi.calendar.calcDurationUtc(c.Calendar.localToUTC(n),c.Calendar.localToUTC(i),s,this.uAi.calendarSettings,e)},f.prototype.applyScheduleData=function(t,n){t._data.start=n.start,t._data.finish=n.finish,t._data.duration=n.duration},f.prototype.onTaskChanged=function(t){this.invalidTasks([t]),this.reSchedule()},f.prototype.onTasksChanged=function(t){t.noChange||(this.invalidAllTasks(),this.reSchedule())},f.prototype.reSchedule=function(){var t,n;this.isSuspended||0!==(t=this.uAi.Vp).length&&(this.beforeSchedule(t),n=this.buildIncomingDegreeList(t),this.scheduleTasks([this.uAi.root],n),this.afterSchedule(t),this.uAi.VAi.invoke())},f.prototype.beforeSchedule=function(t){for(var n,i,e,s,r,u,n=0,i=t;n<i.length;n++)s=(e=i[n])._data.start?c.Calendar.localToUTC(e._data.start):null,r=e._data.finish?c.Calendar.localToUTC(e._data.finish):null,u=(u=e._data.duration)||(s||r||"Auto"===e.mode?c.DurationHelper.default(this.uAi.calendarSettings):c.DurationHelper.empty(this.uAi.calendarSettings)),e.wyi=this.buildScheduleData(s,r,u,e.mode,!0),e.yyi={},e.myi=!0,e.pyi=!0;t[0].wyi=this.buildScheduleData(this.uAi.startDateUtc,this.uAi.startDateUtc,null,"Auto",!0)},f.prototype.buildIncomingDegreeList=function(t){for(var n,i,e,s,r,n=[],i=0,e=t;i<e.length;i++)n[2*(r=(s=e[i]).taskNumber)]=(u(s.parent)?0:1)+s.nyi().length,n[2*r+1]=s.Fpi().length;return n},f.prototype.scheduleTasks=function(t,n){var i=[];for(i.push.apply(i,t);i.length;)this.scheduleTask(i.shift(),i,n)},f.prototype.scheduleTask=function(t,n,i){var e,s,r,u,o,h,a;if(t.myi){if(this.scheduleTaskInitially(t),t.myi)return;if(t.isSummary)for(e=0,s=t.Fpi();e<s.length;e++)r=s[e],this.determineFollowing(r,n,i,!0)}if(t.pyi&&(this.scheduleTaskFinally(t),!t.pyi)){if((u=t.tyi())&&0<u.length)for(o=0,h=u;o<h.length;o++)a=h[o],this.determineFollowing(a.to,n,i,!0);t.parent&&this.determineFollowing(t.parent,n,i,!1)}},f.prototype.determineFollowing=function(t,n,i,e){var e,s,e=2*t.taskNumber+(e?0:1),s=i[e];0==(i[e]=--s)&&n.push(t)},f.prototype.scheduleTaskInitially=function(t){var i,n,e,s,r,r,i=this;if(0===t.taskNumber||"Manual"===t.mode&&t.wyi.start)t.yyi.start=t.wyi.start,t.myi=!1;else if(n=t.parent.yyi.start,n="Manual"===t.mode&&t.parent.jyi?t.parent.jyi:n){if((r=t.nyi())&&r.length){if(!(r=this.getPredecessorsDates(r)))return;e=r[0],s=r[1]}t.yyi.start=this.getMaxDate(n,e),t.isSummary?t.jyi=t.Fpi().reduce(function(t,n){return"Manual"===n.mode?i.getMinDate(n.wyi.start,t):t},t.yyi.start):t.yyi.finish=s,t.myi=!1}},f.prototype.scheduleTaskFinally=function(t){var n,i,e,n,i,s,r,i,u,s,i;t.myi||(i=(n=this.getChildrenScheduleResult(t))[0],e=n[1],n=n[2],i&&("Manual"===t.mode&&t.wyi.finish?(s=(i=t.wyi).start,r=i.finish,i=i.duration,(u=this.uAi.calendar.calcDurationUtc(s,r,!0,this.uAi.calendarSettings)).time!==i.time&&(r=this.uAi.calendar.addDurationUtc(s,i,!0,!1,this.uAi.calendarSettings)),t.yyi.duration=this.fixDuration(i),t.yyi.finish=r):"Auto"===t.mode&&t.isSummary?e&&n&&(t.yyi.start=e,t.yyi.finish=n,t.yyi.duration=this.uAi.calendar.calcDurationUtc(e,n,!1,this.uAi.calendarSettings,t.wyi.duration.unit)):(t.yyi.duration=this.fixDuration(t.wyi.duration),s=t.yyi.start,i=t.yyi.finish,0===t.yyi.duration.time&&"Auto"===t.mode?(s=this.getMaxDate(s,i),t.yyi.start=s,t.yyi.finish=s):(i&&(s=this.getMaxDate(s,this.uAi.calendar.addDurationUtc(i,t.yyi.duration,!1,!0,this.uAi.calendarSettings))),"Auto"===t.mode?t.yyi.start=this.uAi.calendar.addDurationUtc(s,c.DurationHelper.empty(this.uAi.calendarSettings),!0,!0,this.uAi.calendarSettings):t.yyi.start=s,t.yyi.finish=this.getMaxDate(i,this.uAi.calendar.addDurationUtc(t.yyi.start,t.yyi.duration,!0,!1,this.uAi.calendarSettings)))),t.pyi=!1))},f.prototype.getPredecessorsDates=function(t){for(var n,i,e,s,r,u,n=null,i=null,e=0,s=t;e<s.length;e++){if((u=(r=s[e]).from).pyi)return;"FS"===r.type?n=this.getMaxDate(n,u.yyi.finish):"SS"===r.type?n=this.getMaxDate(n,u.yyi.start):"FF"===r.type?i=this.getMaxDate(i,u.yyi.finish):"SF"===r.type&&(i=this.getMaxDate(i,u.yyi.start))}return[n,i]},f.prototype.getMaxDate=function(t,n){return u(t)||!u(n)&&t.valueOf()<n.valueOf()?n:t},f.prototype.getMinDate=function(t,n){return!u(t)&&(u(n)||t.valueOf()<n.valueOf())?t:n},f.prototype.getChildrenScheduleResult=function(t){var n,i,e,t,s,r,u,n=!0,t=t.Fpi();if(t||t.length)for(s=0,r=t;s<r.length;s++){if((u=r[s]).myi||u.pyi){n=!1;break}i=this.getMinDate(i,u.yyi.start),e=this.getMaxDate(e,u.yyi.finish)}return[n,i,e]},f.prototype.afterSchedule=function(t){var n,i,e,s,r,u,u,o,h,a,t;for(t=t.slice(1),n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY,e=0,s=t;e<s.length;e++)r=s[e],n=Math.min(n,r.yyi.start.valueOf()),i=Math.max(i,r.yyi.finish.valueOf()),"Auto"===r.mode?(r._data.start=c.Calendar.utcToLocal(r.yyi.start),r._data.finish=c.Calendar.utcToLocal(r.yyi.finish),r._data.duration=r.yyi.duration):(u={start:r.start,finish:r.finish,duration:r.duration},"All"!==(u=f.getScheduleDataType(u))&&"Partly"!==u&&"StartOnly"!==u||(r._data.start=c.Calendar.utcToLocal(r.yyi.start)),"All"!==u&&"Partly"!==u&&"FinishOnly"!==u||(r._data.finish=c.Calendar.utcToLocal(r.yyi.finish)),"All"!==u&&"Partly"!==u&&"DurationOnly"!==u||(r._data.duration=r.yyi.duration)),r.wyi=null;a=h=o=null,n!==Number.POSITIVE_INFINITY&&(o=new Date(n)),i!==Number.NEGATIVE_INFINITY&&(h=new Date(i)),a=0===t.length?(o=this.uAi.startDateUtc,h=this.uAi.startDateUtc,c.DurationHelper.empty(this.uAi.calendarSettings)):(t=this.uAi.calendarSettings.defaultDurationUnit,this.uAi.calendar.calcDurationUtc(o,h,!1,this.uAi.calendarSettings,t)),this.uAi.root._data.start=c.Calendar.utcToLocal(o),this.uAi.root._data.finish=c.Calendar.utcToLocal(h),this.uAi.root._data.duration=a,this.uAi.finishDateUtc=h},f.prototype.fixDuration=function(t){return t?c.DurationHelper.fromTime(t.time,t.unit,this.uAi.calendarSettings):null},f.getScheduleDataType=function(t){return t.start||t.finish||t.duration?t.start&&t.finish&&t.duration?"All":!t.start||t.finish||t.duration?!t.finish||t.start||t.duration?!t.duration||t.start||t.finish?"Partly":"DurationOnly":"FinishOnly":"StartOnly":"None"},n.ScheduleManager=f},"./dist/plugins/gantt/project/tasks.js":function(t,n,i){var s,r,e,h,u,o,a,g,c,i,i,f,l,b,d,A;function v(t){this.xT=!1,this.k1=!1,this.myi=!1,this.pyi=!1,this.bAe=!1,this.ayt=t}function m(t){var n,i,e;for(this.fields={},this.uAi=t,this.Oyi=b.ZX(this),n=0,i=m.defaultFields;n<i.length;n++)e=i[n],this.fields[e.name]=s({},e)}function p(t){this.tasks=[],this.tokens=[],this.project=t}s=this&&this.__assign||function(){return(s=Object.assign||function(t){for(var n,i,e,s,i=1,e=arguments.length;i<e;i++)for(s in n=arguments[i])Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s]);return t}).apply(this,arguments)},r=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var e=0,s=n.length,r;e<s;e++)!r&&e in n||((r=r||Array.prototype.slice.call(n,0,e))[e]=n[e]);return t.concat(r||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.TaskCollectionView=n.TaskManager=n.Task=void 0,e=i("./dist/plugins/gantt/utils/util.js"),h=i("./dist/plugins/gantt/gantt-sort.js"),u=i("./dist/plugins/gantt/project/dependency.js"),o=i("./dist/plugins/gantt/project/calendar.js"),a=i("./dist/plugins/gantt/project/schedule.js"),g=i("./dist/plugins/gantt/gantt.enum.js"),c=i("Common"),i=i("./dist/plugins/gantt/gantt.ns.js"),i=new c.Common.ResourceManager(i.SR,"GanttSheet"),f=i.getResource.bind(i),l=c.Common.lt.ht,v.ZX=function(t){return new v(t)},Object.defineProperty(v.prototype,"project",{get:function(){return this.ayt.project},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"taskNumber",{get:function(){return this.kU.taskNumber},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"viewIndex",{get:function(){return this.kU.viewIndex},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"rowIndex",{get:function(){return this.viewIndex},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"parent",{get:function(){return this.sft},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"level",{get:function(){return this.YAt},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"children",{get:function(){return r([],this.R1t,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"predecessors",{get:function(){return this.Tyi.length?u.TaskDependency.formatPredecessors(this.Tyi):""},set:function(t){var t=u.TaskDependency.parsePredecessors(this,t);if(!this.project.Ayi(t,this.predecessorDependencies))throw new Error(f().GANTT_INVALID_DEPENDENCY);this.project.gyi(this.predecessorDependencies,t,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"predecessorDependencies",{get:function(){return r([],this.Tyi,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"successors",{get:function(){return this.kyi.length?u.TaskDependency.formatSuccessors(this.kyi):""},set:function(t){var t=u.TaskDependency.parseSuccessors(this,t);if(!this.project.Ayi(t,this.successorDependencies))throw new Error(f().GANTT_INVALID_DEPENDENCY);this.project.gyi(this.successorDependencies,t,!0),this._data.successors=u.TaskDependency.formatSuccessors(this.kyi)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"successorDependencies",{get:function(){return r([],this.kyi,!0)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"start",{get:function(){return this._data.start},set:function(t){this.project.Fji(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"startDisplayed",{get:function(){return this.yyi&&this.yyi.start?o.Calendar.utcToLocal(this.yyi.start):this._data.start||this.project.startDate},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"finish",{get:function(){return this._data.finish},set:function(t){this.project.Nji(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"finishDisplayed",{get:function(){return this.yyi&&this.yyi.finish?o.Calendar.utcToLocal(this.yyi.finish):this._data.finish||this.project.startDate},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"duration",{get:function(){var t;return this.isSummary?(t=this._data.duration)&&this.project.parseDuration({time:t.time}):this._data.duration},set:function(t){var t=this.project.parseDuration(t);this.project.uyi.setTaskDuration(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"workTime",{get:function(){var t,t,n,i,e,s,r,u,n=this.project.parseDuration(this._data.duration),i=this.project.resourcesManager.resourcesAssignment.getResourcesCountByTaskNumber(this.taskNumber),e=0;if(0!==i&&(e=n.time*i),this.isSummary)for(s=0,r=this.children;s<r.length;s++)e+=null!=(t=null==(t=(u=r[s]).workTime)?void 0:t.time)?t:0;return o.DurationHelper.normalize({time:e,unit:"Hour"})},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"mode",{get:function(){return 0===this.taskNumber?"Auto":this._data.mode||this.project.uyi.defaultMode},set:function(t){if(0===this.taskNumber)throw new Error(f().GANTT_INVALID_OPERATION);this._data.mode=t,this.project.uyi.onTaskChanged(this)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"name",{get:function(){return this.getDataValue("name")},set:function(t){this.setDataValue("name",t)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"complete",{get:function(){var t=0,t;return t=this.isSummary?this.vAe():this.getDataValue("complete")||0},set:function(t){this.isSummary||0<=t&&this.setDataValue("complete",t)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"completeThrough",{get:function(){var t,n,n,n,t;return 0===this.complete?this.startDisplayed:(t=o.Calendar.localToUTC(this.startDisplayed),n=o.Calendar.localToUTC(this.finishDisplayed),n=this.project.calendar.calcDurationUtc(t,n,!0,this.project.calendarSettings),n=this.project.parseDuration({time:n.time*this.complete}),t=this.project.calendar.addDurationUtc(t,n,!0,!1,this.project.calendarSettings),o.Calendar.utcToLocal(t))},set:function(t){var n,i,t,t,n,i,n=o.Calendar.localToUTC(this.startDisplayed),i=o.Calendar.localToUTC(this.finishDisplayed),t=o.Calendar.localToUTC(t),t=this.project.calendar.calcDurationUtc(n,t,!0,this.project.calendarSettings),n=this.project.calendar.calcDurationUtc(n,i,!0,this.project.calendarSettings),i=0===n.time?1:t.time/n.time;this.complete!==(i=i<0?0:i)&&this.ayt.setTaskValue(this,"complete",i)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"style",{get:function(){return this.getDataValue("styles")},set:function(t){var n;this.ayt.getPrimaryKeyField()&&(this.project.Omi.invalidateTextStates(),this.setDataValue("styles",t,!0))},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"isMilestone",{get:function(){var t,n,t=this.getDataValue("isMilestone");return t=l(t)?(n=this.duration)&&0===n.time:t},set:function(t){this.setDataValue("isMilestone",t)},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"isSummary",{get:function(){return this.R1t&&0<this.R1t.length},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"isNormal",{get:function(){return!this.isMilestone&&!this.isSummary},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"isManuallyScheduled",{get:function(){return"Manual"===this.mode},enumerable:!1,configurable:!0}),Object.defineProperty(v.prototype,"dirty",{get:function(){return this.k1},enumerable:!1,configurable:!0}),v.prototype.initialize=function(t){this.kU={taskNumber:-1,viewIndex:-1},this.R1t=[],this.Tyi=[],this.kyi=[],this._data=t},v.prototype.getData=function(t){void 0===t&&(t=!1);var n=this._data;return n.taskNumber=this.taskNumber,n.level=this.level,n.predecessors=this.predecessors,n.successors=this.successors,n.complete=this.complete,t&&(n.children=this.Fpi().map(function(t){return t.getData(!0)})),n},v.prototype.lyi=function(t){this.sft=t},v.prototype.q2t=function(t){this.YAt=t},v.prototype.Fpi=function(){return this.R1t},v.prototype.nyi=function(){return this.Tyi},v.prototype.tyi=function(){return this.kyi},v.prototype.L0=function(){this.xT=!0},v.prototype.vAe=function(){var n,i,n=0,i=0;return e.GanttUtil.traverseChildren(this,function(t){t.isNormal&&(t.duration?(n+=t.duration.time*t.complete,i+=t.duration.time):(n+=0,i+=0))}),0===i?0:n/i},v.prototype.moveInWorkingDays=function(t){var n,i,i;if("Auto"!==this.mode)switch(n=a.ScheduleManager.getScheduleDataType({start:this.start,finish:this.finish,duration:this.duration})){case"All":case"Partly":case"StartOnly":case"DurationOnly":i=o.Calendar.localToUTC(this.startDisplayed),i=this.isInWorkingTime(i)?(i=this.moveByDays(i,t,!0),this.moveToNextWorkingTime(i)):this.moveByDays(i,t,!1),this.start=o.Calendar.utcToLocal(i);break;case"FinishOnly":i=o.Calendar.localToUTC(this.finish),i=this.moveByDays(i,t,!0),i=this.moveToNextWorkingTime(i),this.finish=o.Calendar.utcToLocal(i)}},v.prototype.moveInWeeks=function(t){var n,i,i;if("Auto"!==this.mode)switch(n=a.ScheduleManager.getScheduleDataType({start:this.start,finish:this.finish,duration:this.duration})){case"All":case"Partly":case"StartOnly":case"DurationOnly":i=o.Calendar.localToUTC(this.startDisplayed),i=this.isInWorkingTime(i)?(i=this.moveByWeeks(i,t,!0),this.moveToNextWorkingTime(i)):this.moveByWeeks(i,t,!1),this.start=o.Calendar.utcToLocal(i);break;case"FinishOnly":i=o.Calendar.localToUTC(this.finish),i=this.moveByWeeks(i,t,!0),i=this.moveToNextWorkingTime(i),this.finish=o.Calendar.utcToLocal(i)}},v.prototype.isInWorkingTime=function(t){var n=new Date(t.valueOf()+1);return 0<this.project.calendar.calcDurationUtc(t,n,!1,this.project.calendarSettings).time},v.prototype.moveByDays=function(t,n,i){if(0===n)return t;var e=new Date(t.valueOf());if(i){for(;0<n;)e.setUTCDate(e.getUTCDate()+1),this.project.calendar.isWorkingDay(e)&&n--;for(;n<0;)e.setUTCDate(e.getUTCDate()-1),this.project.calendar.isWorkingDay(e)&&n++}else e.setUTCDate(e.getUTCDate()+n);return e},v.prototype.moveByWeeks=function(t,n,i){if(0===n)return t;var e=new Date(t.valueOf());if(e.setUTCDate(e.getUTCDate()+7*n),i){if(0<n)for(;!this.project.calendar.isWorkingDay(e);)e.setUTCDate(e.getUTCDate()+1);if(n<0)for(;!this.project.calendar.isWorkingDay(e);)e.setUTCDate(e.getUTCDate()-1)}return e},v.prototype.moveToNextWorkingTime=function(t){return this.project.calendar.addDurationUtc(t,{time:0},!0,!0,this.project.calendarSettings)},v.prototype.getValue=function(t){return this.ayt.getTaskValue(this,t)},v.prototype.setValue=function(t,n){return this.ayt.setTaskValue(this,t,n)},v.prototype.getDataValue=function(t){return this._data[t]},v.prototype.setDataValue=function(t,n,i){void 0===i&&(i=!1);var e=this._data[t];e!==n&&(this._data[t]=n,this.wmi(),this.ayt.notifyTaskValueChanged(this,t,e,n,i))},v.prototype.wmi=function(){this.k1=!0},v.prototype.pOt=function(){this.k1=!1},v.prototype.getBarStyleRules=function(){return this.project.Omi.getBarStyleRuleForTask(this)},b=v,n.Task=b,Object.defineProperty(m.prototype,"project",{get:function(){return this.uAi},enumerable:!1,configurable:!0}),m.prototype.resetTaskPrototype=function(){this.Oyi=b.ZX(this)},m.prototype.createTask=function(t){var n=Object.create(this.Oyi);return null!==(t=t||{}).duration&&void 0!==t.duration&&(t.duration=this.project.parseDuration(t.duration)),t.mode||(t.mode=this.project.defaultMode),n.initialize(t),n},m.prototype.addField=function(n){var t=this.fields[n.name];t?m.mergeField(t,n):this.fields[n.name]=n,Object.prototype.hasOwnProperty.call(Object.getPrototypeOf(this.Oyi),n.name)||Object.defineProperty(this.Oyi,n.name,{configurable:!0,enumerable:!0,get:function(){return this.getDataValue(n.name)},set:function(t){this.setDataValue(n.name,t)}})},m.prototype.getField=function(t){return this.fields[t]},m.prototype.getFieldByDataType=function(t){for(var n,i,e,s,n,i=0,e=Object.values(this.fields);i<e.length;i++)if((s=e[i]).dataType===t)return s;return null},m.prototype.getPrimaryKeyField=function(){var t,n,i;if(this.Yji)return this.Yji;for(n in this.fields)(i=this.fields[n])&&i.isPrimaryKey&&(t=i);return this.Yji=t},m.prototype.isFieldEnabled=function(t){var t,n,t,t=this.getField(t),n=void 0===t.enabled||t.enabled,t=void 0!==t.readonly&&t.readonly;return n&&!t},m.prototype.getTaskValue=function(t,n){if(t&&(n="string"==typeof n?this.getField(n):n))return n.getter?n.getter(t):b.prototype.hasOwnProperty(n.name)?t[n.name]:t.getDataValue(n.name)},m.prototype.setTaskValue=function(t,n,i,e){var s,r,u,s,o,o;if(t&&(n="string"==typeof n?this.getField(n):n)&&!n.readonly&&n.enabled&&(n.fixValue&&(i=n.fixValue(i,t)),s=this.project.taskManager.getTaskValue(t,n),0!==(r=h.GanttSortService.compareValueWithField(s,i,n)))){if(s=[],(u=n.fji)||(o=this.project.cloneTask(t),s.push(o)),o=this.project.createChange(g.TasksChangeAction.Update,s,u),this.project.Lmi.invoke(o),n.setter)n.setter(t,i);else if(b.prototype.hasOwnProperty(n.name)&&Object.getOwnPropertyDescriptor(b.prototype,n.name).set)if(e)try{t[n.name]=i}catch(t){o.noChange=!0}else t[n.name]=i;else t.setDataValue(n.name,i);this.project.Hmi.invoke(o)}},m.prototype.notifyTaskValueChanged=function(t,n,i,e,s){((s=void 0===s?!1:s)?this.project.Rmi:this.project.VAi).invoke()},m.mergeField=function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])},m.defaultFields=[{name:"taskNumber",text:f().GANTT_TASK_NUMBER,readonly:!0},{name:"name",text:f().GANTT_TASK_NAME,dataType:"TaskSubject",fixValue:function(t){return e.ValueHelper.parseString(t)}},{name:"isMilestone",text:f().GANTT_MILESTONE,fixValue:function(t){return e.ValueHelper.parseBoolean(t,!0)},enabled:!0},{name:"mode",text:f().GANTT_MODE,dataType:"TaskMode",fixValue:function(t){var t=e.ValueHelper.parseStringEnumValues(t,["Auto","Manual"]);return l(t)?"Auto":t},enabled:!1,fji:!0},{name:"duration",text:f().GANTT_DURATION,dataType:"TaskDuration",fixValue:function(t,n){var i=n.duration;return o.DurationHelper.parse(t,n.project.calendarSettings,i?i.unit:void 0)},fji:!0},{name:"start",text:f().GANTT_START,dataType:"TaskStartDate",fixValue:function(t){return e.ValueHelper.parseDate(t)},fji:!0},{name:"finish",text:f().GANTT_FINISH,dataType:"TaskFinishDate",fixValue:function(t){return e.ValueHelper.parseDate(t)},fji:!0},{name:"startDisplayed",text:f().GANTT_START_DISPLAYED,readonly:!0},{name:"finishDisplayed",text:f().GANTT_FINISH_DISPLAYED,readonly:!0},{name:"predecessors",text:f().GANTT_PREDECESSORS,dataType:"TaskPredecessor",fixValue:function(t){return e.ValueHelper.parseString(t)},comparer:function(t,n){return e.ValueHelper.compareTaskDependency(t,n)},enabled:!1,fji:!0},{name:"successors",text:f().GANTT_SUCCESSORS,dataType:"TaskPredecessor",fixValue:function(t){return e.ValueHelper.parseString(t)},comparer:function(t,n){return e.ValueHelper.compareTaskDependency(t,n)},enabled:!1,fji:!0},{name:"complete",text:f().GANTT_COMPLETE,dataType:"TaskComplete",fixValue:function(t,n){return n.isSummary&&(t=n.complete),e.ValueHelper.parseNumber(t,!1)},enabled:!1},{name:"completeText",text:f().GANTT_COMPLETE,getter:function(t){return"".concat((100*t.complete).toFixed(),"%")},readonly:!0},{name:"completeThrough",text:f().GANTT_COMPLETE_CHANGE,fixValue:function(t){return e.ValueHelper.parseDate(t)}}],n.TaskManager=m,p.prototype.getTask=function(t){return this.tasks[t]},p.prototype.getRowState=function(t){var t,n,i;return t>=this.tasks.length||l(t)?{taskNumber:void 0,level:void 0,task:void 0}:(t=this.viewTokens?this.viewTokens[t].taskNumber:t,n=this.tasks[t],{taskNumber:t,level:i=this.getLevel(t),task:n})},p.prototype.getTasksInView=function(){var n=this;return this.viewTokens?this.viewTokens.map(function(t){return n.tasks[t.taskNumber]}):r([],this.tasks,!0)},p.prototype.generateTokens=function(t){return t.map(function(t){return t?t.kU:{taskNumber:-1,viewIndex:-1}})},p.prototype.reset=function(t){var n=this.project.createChange(g.TasksChangeAction.Reset,t,!0);this.onTasksChanging(n),this.tasks=t,this.tokens=this.generateTokens(t),delete this.viewTokens,this.fixTokens(),this.onTasksChanged(n)},p.prototype.insert=function(t,n){var i,e,e,s,i,e,s,s=t;this.tokens[t]&&(s=this.tokens[t].viewIndex),(i=this.tasks).splice.apply(i,r([t,0],n,!1)),i=this.generateTokens(n),(e=this.tokens).splice.apply(e,r([t,0],i,!1)),this.viewTokens&&(e=this.viewTokens).splice.apply(e,r([s,0],i,!1)),e=this.project.createChange(g.TasksChangeAction.Insert,n,!0),this.onTasksChanging(e),this.fixTokens(),(s=this.findParentTask(t))&&this.fixTaskMembership(s),this.onTasksChanged(e)},p.prototype.remove=function(t){var n,i,e,s,r,u,o,h,a,c,t,f,l,n=this,i=this.tasks.length;if(!((t=t.filter(function(t){return 0<t&&t<i}).sort(function(t,n){return t-n})).length<=0)){for(s={},r=(e=this.calculateSubTreeRanges(t)).length-1;0<=r;r--)u=e[r],(o=this.tasks[u[0]])&&(s[o.parent.taskNumber]=o.parent);for(h=[],r=e.length-1;0<=r;r--)u=e[r],(a=this.tasks.splice(u[0],u[1]-u[0]+1)).forEach(function(t){t&&(n._ji(t,h)||(h[t.taskNumber]=t),t.L0())}),(c=this.tokens.splice(u[0],u[1]-u[0]+1)).forEach(function(t){t.viewIndex=-1});for(f in this.viewTokens&&(this.viewTokens=this.viewTokens.filter(function(t){return-1!==t.viewIndex})),t=this.project.createChange(g.TasksChangeAction.Remove,h,!0),this.onTasksChanging(t),this.fixTokens(),s)Object.prototype.hasOwnProperty.call(s,f)&&this.fixTaskMembership(l=s[f]);this.onTasksChanged(t)}},p.prototype.clear=function(t){for(var e,n,i,s,r,u,o,h,a,t,c,f,e=this,n=this.calculateSubTreeRanges(t),i={},s=n.length-1;0<=s;s--)r=n[s],(u=this.tasks[r[0]])&&(i[u.parent.taskNumber]=u.parent);for(o=[],s=n.length-1;0<=s;s--)for(h=(r=n[s])[0];h<=r[1];h++)o.push(h);for(c in a=[],o.forEach(function(t){var n,i,n=e.tasks[t];n&&(a.push(e.project.cloneTask(n)),e.tasks[t]=null,n.L0(),i={taskNumber:n.taskNumber,viewIndex:n.viewIndex},e.tokens[t]=i,e.viewTokens)&&(e.viewTokens[n.viewIndex]=i)}),t=this.project.createChange(g.TasksChangeAction.Replace,a,!0),this.onTasksChanging(t),i)Object.prototype.hasOwnProperty.call(i,c)&&this.fixTaskMembership(f=i[c]);this.onTasksChanged(t)},p.prototype.renew=function(t,n){for(var i,e,s,r,u,o,h,h,o,u,a,c,f,i={},e=[],s=0;s<t.length;s++)r=t[s],u=n[s],o=this.tasks[r],e.push(this.project.cloneTask(o)),h=this.getLevel(r),u.q2t(h),this.tasks[r]=u,o&&o.L0(),h=this.tokens[r],(o=u.kU).taskNumber=h.taskNumber,o.viewIndex=h.viewIndex,this.tokens[r]=o,this.viewTokens&&(this.viewTokens[o.viewIndex]=o),(u=this.findParentTask(r))&&(i[u.taskNumber]=u);for(c in a=this.project.createChange(g.TasksChangeAction.Replace,e,!0),this.onTasksChanging(a),i)Object.prototype.hasOwnProperty.call(i,c)&&this.fixTaskMembership(f=i[c]);this.onTasksChanged(a)},p.prototype.validateLevel=function(t,n){var t,t,t=this.findPreviousTask(t),t=t?t.level:0;return!(n<=0||t+1<n)},p.prototype.getLevel=function(t){var n=this.tasks[t];return n?n.level:this.calcRowLevel(t)},p.prototype._ji=function(t,n){var t,i,t=t.parent;if(t&&0!==(i=t.taskNumber))return n[i]||this._ji(t,n)},p.prototype.calcRowLevel=function(t){var n,t,i,n=this.findPreviousTask(t),t=this.findNextTask(t);if(!n)return 1;if(i=this.project.host,t)return n.isSummary?n.level+1:(i&&i.outline.isRowCollapsed(this.tokens[n.taskNumber].viewIndex)?t:n).level;for(;i&&i.outline.isRowCollapsed(this.tokens[n.taskNumber].viewIndex);)n=n.parent;return Math.max(n.level,1)},p.prototype.findPreviousTask=function(t){for(var n,i,n=t-1;0<n;n--)if(i=this.tasks[n],!l(i))return i;return null},p.prototype.findNextTask=function(t,n){for(var i,e,s,i,e=n?t+1:t;e<this.tasks.length;e++)if(s=this.tasks[e],!l(s))return s;return null},p.prototype.findParentTask=function(t){var n,i,e,s,n=this.tasks[t];if(n)for(i=n.level,e=t-1;0<=e;e--)if(s=this.tasks[e],!l(s)&&s.level<i)return s;return null},p.prototype.changeTasksLevel=function(t,n){var i,e,s,r,u,o,h,a,c,f,t,t,l,d,A,v,i=this,e=this.tasks.length;if(0!==(t=t.filter(function(t){return 0<t&&t<e&&i.tasks[t]instanceof b}).sort(function(t,n){return t-n})).length){for(r={},u=[],o=(s=this.calculateSubTreeRanges(t)).length-1;0<=o;o--)if(a=(h=s[o])[0],(c=this.tasks[a])&&!1!==this.validateLevel(a,c.level+n))for(r[c.parent.taskNumber]=c.parent,f=h[0];f<=h[1];f++)u.push(f);for(u.forEach(function(t){var t=i.tasks[t];t&&t.q2t(t.level+n)}),t=s.map(function(t){return{task:i.getTask(t[0]),delta:n}}),t=this.project.createChange(g.TasksChangeAction.Level,t,!0),this.onTasksChanging(t),o=s.length-1;0<=o;o--)h=s[o],(l=this.tasks[h[0]])&&(r[(d=this.findParentTask(h[0])).taskNumber]=d,n<0)&&(r[h[0]]=l);for(A in r)Object.prototype.hasOwnProperty.call(r,A)&&this.fixTaskMembership(v=r[A]);this.project.suspendSchedule(),this.project.oyi.onTasksMembershipChanged(),this.adjustManuallyParentMode(r),this.project.resumeSchedule(),this.onTasksChanged(t)}},p.prototype.adjustManuallyParentMode=function(t){var t,n,i,e,s,r,e,r,r,t=this.getManuallyParentForAdjust(t);if(!(t.length<=0))for(n=0,i=t;n<i.length;n++)s=(e=i[n])[0],r=e[1],e=e[2],"Auto"===r?s.mode="Auto":"Manual"===r&&("DurationOnly"===e?s.start=this.getChildrenDate(s,!0):"StartOnly"===e?(r=this.getChildrenDate(s,!1))>s.start&&(s.finish=r):"FinishOnly"===e&&(r=this.getChildrenDate(s,!0))<s.finish&&(s.start=r))},p.prototype.getChildrenDate=function(t,n){for(var i,e,s,r,r,i=null,e=0,s=t.Fpi();e<s.length;e++)r=s[e],r=n?r.startDisplayed:r.finishDisplayed,i=l(i)?r.valueOf():n?Math.min(i,r.valueOf()):Math.max(i,r.valueOf());return l(i)?null:new Date(i)},p.prototype.getManuallyParentForAdjust=function(t){var n,i,e,s,n=[];for(i in t)Object.prototype.hasOwnProperty.call(t,i)&&"Manual"===(e=t[i]).mode&&e.Fpi().length&&("None"===(s=a.ScheduleManager.getScheduleDataType({start:e.start,finish:e.finish,duration:e.duration}))?n.push([e,"Auto",null]):"DurationOnly"!==s&&"StartOnly"!==s&&"FinishOnly"!==s||n.push([e,"Manual",s]));return n},p.prototype.calculateSubTreeRanges=function(t){var n,i,e,s,r,u,n=this,i=t.map(function(t){return n.getSubTreeRange(t)}),e=[];for(0<i.length&&e.push(i[0]),s=1;s<i.length;s++)(r=i[s])[0]<=(u=e[e.length-1])[1]||e.push(r);return e},p.prototype.getSubTreeRange=function(t){var n,i,e,s,r,n=this.tasks[t];if(l(n))return[t,t];for(i=n.level,s=(e=t)+1;s<this.tasks.length;s++)if(r=this.tasks[s]){if(!(r.level>i))break;e=s}return[t,e]},p.prototype.fixTaskMembership=function(t){var n,i,e,n=t.Fpi();for(n.length=0,i=t.taskNumber+1;i<this.tasks.length;i++)if(e=this.tasks[i],!l(e)){if(e.level<=t.level)break;e.level===t.level+1&&(n.push(e),e.lyi(t))}},p.prototype.fixTokens=function(){this.tokens&&this.tokens.forEach(function(t,n){return t.taskNumber=n}),this.viewTokens?this.viewTokens.forEach(function(t,n){return t.viewIndex=n}):this.tokens.forEach(function(t,n){return t.viewIndex=n})},Object.defineProperty(p.prototype,"sorted",{get:function(){return!l(this.viewTokens)},enumerable:!1,configurable:!0}),p.prototype.sort=function(t,n,i){var e,s,e=this.project.createChange(g.TasksChangeAction.Sort,[],!1);this.onTasksChanging(e),l(t)?(this.viewTokens=null,this.fyi=null):(s=h.GanttSortService.sort(this.tokens,this.tasks,t,n,i),this.viewTokens=s,this.fyi={fields:t,ascendingStates:n,keepStructure:i}),this.fixTokens(),this.onTasksChanged(e)},p.prototype.renumberTaskNumbers=function(t){var n,t,n=this;this.viewTokens&&(t=this.project.createChange(g.TasksChangeAction.Renumber,this.tasks,!0,t),this.onTasksChanging(t),this.tasks=this.viewTokens.map(function(t){return n.tasks[t.taskNumber]}),this.tokens=r([],this.viewTokens,!0),this.viewTokens=null,this.fixTokens(),this.tasks.forEach(function(t){var t=t?t.Fpi():null;t&&t.sort(function(t,n){return t.taskNumber-n.taskNumber})}),this.fyi=null,this.onTasksChanged(t))},p.prototype.toJSON=function(){var t,n,i,e,s,r,s,t={},n=this.project.taskManager.getPrimaryKeyField();if(n)for(i=0,e=this.tasks;i<e.length;i++)s=e[i],r=this.project.taskManager.getTaskValue(s,n.name),(s=s.style)&&(t[r]={style:s});return t},p.prototype.fromJSON=function(t){t&&(this.Qji=t)},p.prototype.Wji=function(){var t,n,i,e,i,t=this.Qji;for(n in t)(i=t[n])&&(e=i.task,i=i.style,e)&&i&&(e.style=i)},n.TaskCollectionView=p},"./dist/plugins/gantt/project/timescales.js":function(t,n,i){var h,e,s,a,r,u,i,i,o,c,f,l,d,A,v,g,b;function m(){}function p(t){this.DU=1,this.Myi="Left",this.xyi=!0,this.IOProps=["count","formatter","unit","labelAlign","showTickLines","formatter"],this.sft=t}function y(t){this.Syi="Behind",this._x="#F7F7F7",this.Ox="solidFill",this.IOProps=["color","drawMode","pattern"],this.project=t}function w(t){this.iq=!1,this.Dyi=!1,this.Cyi=u.TimescaleTierMode.middleBottom,this.Eyi=!0,this.Ryi=new Date(Date.UTC(2020,0,1,0,0,0)),this.Fyi=new Date(Date.UTC(2030,0,1,0,0,0)),this.Nyi=32,this.IOProps=["topTier","middleTier","bottomTier","nonWorkingTime","tierMode","maxDate","minDate","pixelPerDay"],this.project=t,this.Byi=new v(this),this.Byi.unit=u.TimescaleUnit.days,this.Byi.labelAlign="Center",this.Iyi=new v(this),this.Iyi.unit=u.TimescaleUnit.weeks,this.Uyi=new v(this),this.Uyi.unit=u.TimescaleUnit.years,this.Lyi=new g(this.project);var t=new Date;t.setHours(0,0,0,0),this.cyi=a.Calendar.localToUTC(t),this.zoomAuto(),this.iq=!0,this.MAi=new r.TimescaleCellType}Object.defineProperty(n,"__esModule",{value:!0}),n.Timescale=n.NonWorkingTimeStyle=n.TimescaleTier=void 0,h=i("Common"),e=i("Core"),s=i("./dist/plugins/gantt/gantt-json.js"),a=i("./dist/plugins/gantt/project/calendar.js"),r=i("./dist/plugins/gantt/celltypes/timescales.js"),u=i("./dist/plugins/gantt/gantt.enum.js"),i=i("./dist/plugins/gantt/gantt.ns.js"),i=new h.Common.ResourceManager(i.SR,"GanttSheet"),o=i.getResource.bind(i),c=h.Common.lt.ht,f=e.q.Wt,d=[{pixel:1/(l=32),units:[u.TimescaleUnit.years,u.TimescaleUnit.years,u.TimescaleUnit.years],counts:[50,20,5],formats:["yyyy","yyyy","yyyy"]},{pixel:1/8,units:[u.TimescaleUnit.years,u.TimescaleUnit.years,u.TimescaleUnit.halfYears],counts:[10,1,1],formats:["yyyy","yyyy",'"H"{!HALF_YEAR}']},{pixel:.5,units:[u.TimescaleUnit.years,u.TimescaleUnit.years,u.TimescaleUnit.quarters],counts:[5,1,1],formats:["yyyy","yyyy",'"Q"{!QUARTER}']},{pixel:1,units:[u.TimescaleUnit.years,u.TimescaleUnit.halfYears,u.TimescaleUnit.months],counts:[1,1,1],formats:["yyyy",'yyyy, "Half" {!HALF_YEAR}',"mmmmm"]},{pixel:2,units:[u.TimescaleUnit.years,u.TimescaleUnit.quarters,u.TimescaleUnit.months],counts:[1,1,1],formats:["yyyy",'yyyy "Qtr" {!QUARTER}',"mmm"]},{pixel:4,units:[u.TimescaleUnit.years,u.TimescaleUnit.months,u.TimescaleUnit.weeks],counts:[1,1,1],formats:["yyyy","'yy mmm","d"]},{pixel:8,units:[u.TimescaleUnit.quarters,u.TimescaleUnit.months,u.TimescaleUnit.days],counts:[1,1,5],formats:['yyyy "Qtr" {!QUARTER}',"yyyy mmmm","d"]},{pixel:16,units:[u.TimescaleUnit.quarters,u.TimescaleUnit.months,u.TimescaleUnit.days],counts:[1,1,2],formats:['yyyy "Qtr" {!QUARTER}',"yyyy mmmm","d"]},{pixel:32,units:[u.TimescaleUnit.months,u.TimescaleUnit.weeks,u.TimescaleUnit.days],counts:[1,1,1],formats:["yyyy mmmm","'yy mmm d",'{!DAY_OF_WEEK("S","M","T","W","T","F","S")}']},{pixel:128,units:[u.TimescaleUnit.weeks,u.TimescaleUnit.days,u.TimescaleUnit.hours],counts:[1,1,6],formats:["yyyy mmmm d","ddd mmm d","h"]},{pixel:256,units:[u.TimescaleUnit.weeks,u.TimescaleUnit.days,u.TimescaleUnit.hours],counts:[1,1,2],formats:["yyyy mmmm d","ddd mmm d","h"]},{pixel:512,units:[u.TimescaleUnit.weeks,u.TimescaleUnit.days,u.TimescaleUnit.hours],counts:[1,1,1],formats:["yyyy mmmm d","ddd mmm d","h"]},{pixel:4096,units:[u.TimescaleUnit.days,u.TimescaleUnit.hours,u.TimescaleUnit.minutes],counts:[1,1,15],formats:["ddd mmm d","ddd mmm d, h","{!MINUTE}"]}],m.buildFormatter=function(u){var o=this;return u?function(t,n){for(var i,e,s,r,e,i=u;e=i.match(o.searchExpReg);)s=e[0],r=e[1],e=e[2],i=i.replace(s,o.getReplaceValue(r,e,a.Calendar.localToUTC(t),n));return new h.Formatter.GeneralFormatter(i).format(t)}:function(){return""}},m.getDefaultFormatter=function(t){var n,i,n=this.defaultFormatter[t];return c(n)&&(i=this.defaultFormatterText[t]||"",n=this.buildFormatter(i),this.defaultFormatter[t]=n),n},m.getReplaceValue=function(t,n,i,e){return this.keywordFunctionMap[t]?this.keywordFunctionMap[t](i,e,n):t},m.calcDiff_year=function(t,n){var n=n.getUTCFullYear()-t.getUTCFullYear();return this.fixDiffCount(n)},m.calcDiff_half_year=function(t,n){var n=2*n.getUTCFullYear()+(n.getUTCMonth()<6?0:1)-(2*t.getUTCFullYear()+(t.getUTCMonth()<6?0:1));return this.fixDiffCount(n)},m.calcDiff_quarter=function(t,n){var n=4*n.getUTCFullYear()+Math.floor(n.getUTCMonth()/3)-(4*t.getUTCFullYear()+Math.floor(t.getUTCMonth()/3));return this.fixDiffCount(n)},m.calcDiff_month=function(t,n){var n=12*n.getUTCFullYear()+n.getUTCMonth()-(12*t.getUTCFullYear()+t.getUTCMonth());return this.fixDiffCount(n)},m.calcDiff_week=function(t,n,i){var i,t,i,i=t.getUTCDay()-i.calendarSettings.weekStartOn;return i<0&&(i+=7),t=new Date(Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()-i)),i=Math.floor(a.Calendar.diffDaysUtc(t,n)/7),this.fixDiffCount(i)},m.calcDiff_day=function(t,n){var i,t,n,e,i=864e5,t=Math.floor(t.valueOf()/i),n=Math.floor(n.valueOf()/i),e;return this.fixDiffCount(n-t)},m.calcDiff_hour=function(t,n){var i,t,n,e,i=36e5,t=Math.floor(t.valueOf()/i),n=Math.floor(n.valueOf()/i),e;return this.fixDiffCount(n-t)},m.calcDiff_minute=function(t,n){var i,t,n,e,i=6e4,t=Math.floor(t.valueOf()/6e4),n=Math.floor(n.valueOf()/6e4),e;return this.fixDiffCount(n-t)},m.fixDiffCount=function(t){return 0<=t&&(t+=1),'"'.concat(t.toFixed(),'"')},m.calcIndex_half_year=function(t,n){var t=t.getUTCMonth()<6?0:1;return this.getParams(n,["1","2"])[t]},m.calcIndex_quarter=function(t,n){var t=Math.floor(t.getUTCMonth()/3);return this.getParams(n,["1","2","3","4"])[t]},m.calcIndex_thirds_of_month=function(t,n){var t=Math.floor((t.getUTCDate()-1)/10);return this.getParams(n,["B","M","E"])[t]},m.calcIndex_week_of_year=function(t,n){var n,i,n,n,n=n.calendarSettings.weekStartOn,i=new Date(Date.UTC(t.getUTCFullYear(),0,1)),n=n-i.getUTCDay();return n<0&&(n+=7),n<4?i.setUTCDate(i.getUTCDate()+n):i.setUTCDate(i.getUTCDate()+n-7),n=a.Calendar.diffDaysUtc(i,t),'"'.concat(Math.floor(n/7)+1,'"')},m.calcIndex_day_of_week=function(t,n){var t=t.getUTCDay();return this.getParams(n,["Sun","Mon","Tue","Wed","Thu","Fri","Sat"])[t]},m.calcIndex_day_of_year=function(t){var n,n,n=new Date(Date.UTC(t.getUTCFullYear(),0,1)),n=Math.floor(a.Calendar.diffDaysUtc(n,t))+1;return'"'.concat(n,'"')},m.calcIndex_minute=function(t){return'"'.concat(t.getUTCMinutes(),'"')},m.getParams=function(t,n){var i,t,i=n.length;return t&&(t=t.slice(1,t.length-1).split(",")).length>=i?t.slice(0,i):n},m.defaultFormatterText=["","yyyy",'"Half" {!HALF_YEAR}','"Qtr" {!QUARTER}',"mmm",'{!THIRDS_OF_MONTH("B","M","E")}',"m/d","ddd","h","{!MINUTE}"],m.defaultFormatter=[],m.searchExpReg=new RegExp("{!([^}\\(]*)(\\([^\\)]*\\))?}"),m.keywordFunctionMap={YEAR_FROM_START:function(t,n,i){return m.calcDiff_year(n.startDateUtc,t)},YEAR_FROM_END:function(t,n,i){return m.calcDiff_year(t,n.finishDateUtc)},HALF_YEAR:function(t,n,i){return m.calcIndex_half_year(t,i)},HALF_YEAR_FROM_START:function(t,n,i){return m.calcDiff_half_year(n.startDateUtc,t)},HALF_YEAR_FROM_END:function(t,n,i){return m.calcDiff_half_year(t,n.finishDateUtc)},QUARTER:function(t,n,i){return m.calcIndex_quarter(t,i)},QUARTER_FROM_START:function(t,n,i){return m.calcDiff_quarter(n.startDateUtc,t)},QUARTER_FROM_END:function(t,n,i){return m.calcDiff_quarter(t,n.finishDateUtc)},MONTH_FROM_START:function(t,n,i){return m.calcDiff_month(n.startDateUtc,t)},MONTH_FROM_END:function(t,n,i){return m.calcDiff_month(t,n.finishDateUtc)},THIRDS_OF_MONTH:function(t,n,i){return m.calcIndex_thirds_of_month(t,i)},WEEK_OF_YEAR:function(t,n,i){return m.calcIndex_week_of_year(t,n)},DAY_OF_WEEK:function(t,n,i){return m.calcIndex_day_of_week(t,i)},WEEK_FROM_START:function(t,n,i){return m.calcDiff_week(n.startDateUtc,t,n)},WEEK_FROM_END:function(t,n,i){return m.calcDiff_week(t,n.finishDateUtc,n)},DAY_OF_YEAR:function(t,n,i){return m.calcIndex_day_of_year(t)},DAY_FROM_START:function(t,n,i){return m.calcDiff_day(n.startDateUtc,t)},DAY_FROM_END:function(t,n,i){return m.calcDiff_day(t,n.finishDateUtc)},HOUR_FROM_START:function(t,n,i){return m.calcDiff_hour(n.startDateUtc,t)},HOUR_FROM_END:function(t,n,i){return m.calcDiff_hour(t,n.finishDateUtc)},MINUTE:function(t,n,i){return m.calcIndex_minute(t)},MINUTE_FROM_START:function(t,n,i){return m.calcDiff_minute(n.startDateUtc,t)},MINUTE_FROM_END:function(t,n,i){return m.calcDiff_minute(t,n.finishDateUtc)}},A=m,Object.defineProperty(p.prototype,"unit",{get:function(){return this.l6n},set:function(t){this.l6n=t,this.sft.Pyi()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"count",{get:function(){return this.DU},set:function(t){var t=Number(t);0<t&&t%1==0&&(this.DU=t),this.sft.Pyi()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"labelAlign",{get:function(){return this.Myi},set:function(t){this.Myi=t,this.sft.Pyi()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"showTickLines",{get:function(){return this.xyi},set:function(t){this.xyi=t,this.sft.Pyi()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"formatter",{get:function(){return this.bbt},set:function(t){this.Hyi="string"==typeof t?A.buildFormatter(t):t,this.bbt=t,this.sft.Pyi()},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"realFormatter",{get:function(){return c(this.Hyi)?A.getDefaultFormatter(this.l6n):this.Hyi},enumerable:!1,configurable:!0}),p.prototype.formatDate=function(t){var n=this.realFormatter;return"function"==typeof n?n(t,this.sft.project):""},p.prototype.toJSON=function(){return s.GanttSheetJsonConverter.toJSON(this,this.IOProps)},p.prototype.fromJSON=function(t){s.GanttSheetJsonConverter.fromJSON(this,t,this.IOProps)},v=p,n.TimescaleTier=v,Object.defineProperty(y.prototype,"drawMode",{get:function(){return this.Syi},set:function(t){this.Syi=t,this.project.VAi.invoke()},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"color",{get:function(){return this._x},set:function(t){this._x=t,this.project.VAi.invoke()},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"pattern",{get:function(){return this.Ox},set:function(t){this.Ox=t,this.project.VAi.invoke()},enumerable:!1,configurable:!0}),Object.defineProperty(y.prototype,"calendar",{get:function(){return this.syi||this.project.calendar},set:function(t){this.syi=t,this.project.VAi.invoke()},enumerable:!1,configurable:!0}),y.prototype.toJSON=function(){return s.GanttSheetJsonConverter.toJSON(this,this.IOProps)},y.prototype.fromJSON=function(t){s.GanttSheetJsonConverter.fromJSON(this,t,this.IOProps)},g=y,n.NonWorkingTimeStyle=g,Object.defineProperty(w,"initialDate",{get:function(){return a.Calendar.utcToLocal(this.Yyi)},set:function(t){this.Yyi=a.Calendar.localToUTC(t)},enumerable:!1,configurable:!0}),Object.defineProperty(w,"initialDateUtc",{get:function(){return this.Yyi},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"minDateUtc",{get:function(){return this.Ryi},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"minDate",{get:function(){return this.Ryi},set:function(t){this.Ryi=t},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"maxDateUtc",{get:function(){return this.Fyi},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"maxDate",{get:function(){return this.Fyi},set:function(t){this.Fyi=t},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"currentDate",{get:function(){return a.Calendar.utcToLocal(this.cyi)},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"currentDateUtc",{get:function(){return this.cyi},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"tierMode",{get:function(){return this.Cyi},set:function(t){this.Cyi=t,this.project.Vmi.invoke()},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"showScaleSeparator",{get:function(){return this.Eyi},set:function(t){this.Eyi=t,this.project.Wmi.invoke()},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"topTier",{get:function(){return this.Uyi},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"middleTier",{get:function(){return this.Iyi},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"bottomTier",{get:function(){return this.Byi},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"nonWorkingTime",{get:function(){return this.Lyi},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"pixelPerDay",{get:function(){return this.Nyi},set:function(t){this.Nyi=t},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"zoomFactor",{get:function(){return this.pixelPerDay/32},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"timescaleTopTierTextStyle",{get:function(){return this.MAi.topTierTextStyle},set:function(t){this.MAi.topTierTextStyle=t,this.project.Wmi.invoke()},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"timescaleMiddleTierTextStyle",{get:function(){return this.MAi.middleTierTextStyle},set:function(t){this.MAi.middleTierTextStyle=t,this.project.Wmi.invoke()},enumerable:!1,configurable:!0}),Object.defineProperty(w.prototype,"timescaleBottomTierTextStyle",{get:function(){return this.MAi.bottomTierTextStyle},set:function(t){this.MAi.bottomTierTextStyle=t,this.project.Wmi.invoke()},enumerable:!1,configurable:!0}),w.prototype.update=function(t,n){var i,e;if(!c(t)){if(isNaN(t.valueOf()))throw new Error(o().GANTT_INVALID_OPERATION);i=this.getDateUtcRange(this.minDateUtc),e=this.getDateUtcRange(this.maxDateUtc),t<i[1]?this.cyi=i[0]:t>e[1]?this.cyi=e[1]:this.cyi=t}c(n)||(n=Math.min(n,65536),n=Math.max(n,1/32),this.Nyi=n),this.project.Wmi.invoke()},w.prototype.scroll=function(t){var n,t;0!==t&&(n=this.getDateUtcRange(this.getDateUtcByOffset(t)),(t=t<0?n[1]:n[0]).valueOf()!==this.currentDateUtc.valueOf())&&this.update(t)},w.prototype.scrollOneTick=function(t){var n=this.tierMode===u.TimescaleTierMode.middle?this.middleTier:this.bottomTier;this.scrollBy(t?n.count:-n.count,n.unit)},w.prototype.scrollBy=function(t,n){var n,n=0<t?this.getDateUtcRange(this.currentDateUtc,n,t)[1]:this.getDateUtcRange(new Date(this.currentDateUtc.valueOf()-w.millisecondsPerMinute),n,-t)[0];this.update(n)},w.prototype.scrollTo=function(t,n){var i,t,i;void 0===n&&(n=0),t&&(i=this.project.host?this.project.host.getTaskbarAreaVisibleSize():500,t=a.Calendar.localToUTC(t).valueOf()-i/this.pixelPerDay*w.millisecondsPerDay*n,i=this.getDateUtcRange(new Date(t))[0],this.update(i))},w.prototype.getDateUtcByOffset=function(t,n){var i,t,t,i=n=n||this.currentDateUtc;return 0!==t&&(t=t/this.pixelPerDay,t=Math.ceil(24*t*60*60*1e3),i=new Date(n.valueOf()+t)),i},w.prototype.getOffsetByDateUtc=function(t){return a.Calendar.diffDaysUtc(this.currentDateUtc,t)*this.pixelPerDay},w.prototype.zoomTo=function(t,n){var t,i;void 0===n&&(n=!0),isNaN(t)||t<=0||(t=32*t,i=null,n&&(this.adjustTierUnit(t),i=this.getDateUtcRange(this.currentDateUtc)[0]),this.update(i,t))},w.prototype.log2=function(t){return Math.log(t)/Math.log(2)},w.prototype.getCurrentZoomLevel=function(){var t,n,t=this.log2(this.pixelPerDay),n;return t=this.log2(32)<t?Math.floor(t):Math.ceil(t)},w.prototype.zoomIn=function(t){var n,i;void 0===t&&(t=!0),n=Math.pow(2,this.getCurrentZoomLevel()+1),i=null,t&&(this.adjustTierUnit(n),i=this.getDateUtcRange(this.currentDateUtc)[0]),this.update(i,n)},w.prototype.zoomOut=function(t){var n,i;void 0===t&&(t=!0),n=Math.pow(2,this.getCurrentZoomLevel()-1),i=null,t&&(this.adjustTierUnit(n),i=this.getDateUtcRange(this.currentDateUtc)[0]),this.update(i,n)},w.prototype.zoomToRange=function(t,n,i){var e,t,n,s,s,i,n,i,n,t;void 0===i&&(i=!0),t.valueOf()===n.valueOf()?this.scrollTo(t,.1):(e=this.project.host?this.project.host.getTaskbarAreaVisibleSize():500,t=a.Calendar.localToUTC(t),n=a.Calendar.localToUTC(n),s=a.Calendar.diffDaysUtc(t,n),s=Math.ceil(e/s),i&&this.adjustTierUnit(s),i=this.getDateUtcRange(t)[0],n=this.getDateUtcRange(n)[1],i=e/a.Calendar.diffDaysUtc(i,n)*.9,n=t.valueOf()-e/s*w.millisecondsPerDay*.05,t=this.getDateUtcRange(new Date(n))[0],this.update(t,i))},w.prototype.adjustTierUnit=function(t){var n,i,e,s,r,u;try{for(this.Dyi=!0,r=s=0;r<d.length&&!(d[r].pixel>t);r++)s=r;(u=d[s])&&(n=u.units,this.topTier.unit=n[0],this.middleTier.unit=n[1],this.bottomTier.unit=n[2],i=u.counts,this.topTier.count=i[0],this.middleTier.count=i[1],this.bottomTier.count=i[2],e=u.formats,this.topTier.formatter=e[0],this.middleTier.formatter=e[1],this.bottomTier.formatter=e[2])}finally{this.Dyi=!1}},w.prototype.zoomAuto=function(){var t,n,i,e,s,t=this.getSuitablePixelPerDayForTier(this.bottomTier),n=this.getSuitablePixelPerDayForTier(this.middleTier),i=this.getSuitablePixelPerDayForTier(this.topTier);switch(this.tierMode){case u.TimescaleTierMode.middle:e=n;break;case u.TimescaleTierMode.middleBottom:e=Math.max(n,t);break;case u.TimescaleTierMode.topMiddleBottom:e=Math.max(t,n,i)}c(e)||(s=this.getDateUtcRange(this.currentDateUtc)[0],this.update(s,e))},w.prototype.getSuitablePixelPerDayForTier=function(t){var n,n,n,i,n=new Date(2020,8,30,11,11,59,59),n=t.formatDate(n),n=f(n,"16px Calibri");return(n=1.5*n+3)/((i=this.convertUnitToDay(t.unit))*t.count)},w.prototype.convertUnitToDay=function(t){return w.TimescaleUnitValueMap[t]},w.prototype.dateUtcToUnitValue=function(t,n){var i,i;switch(n){case u.TimescaleUnit.years:return t.getUTCFullYear();case u.TimescaleUnit.halfYears:return 2*t.getUTCFullYear()+(6<=t.getUTCMonth()?1:0);case u.TimescaleUnit.quarters:return 4*t.getUTCFullYear()+Math.floor(t.getUTCMonth()/3);case u.TimescaleUnit.months:return 12*t.getUTCFullYear()+t.getUTCMonth();case u.TimescaleUnit.thirdsOfMonth:return i=20<(i=t.getUTCDate())?2:10<i?1:0,36*t.getUTCFullYear()+3*t.getUTCMonth()+i;case u.TimescaleUnit.weeks:return Math.floor((Math.floor(t.valueOf()/w.millisecondsPerDay)+4-this.project.calendarSettings.weekStartOn)/7);case u.TimescaleUnit.days:return Math.floor(t.valueOf()/w.millisecondsPerDay);case u.TimescaleUnit.hours:return Math.floor(t.valueOf()/w.millisecondsPerHour);case u.TimescaleUnit.minutes:return Math.floor(t.valueOf()/w.millisecondsPerMinute)}},w.prototype.unitValueToDateUtc=function(t,n){switch(n){case u.TimescaleUnit.years:return new Date(Date.UTC(t,0,1));case u.TimescaleUnit.halfYears:return new Date(Date.UTC(Math.floor(t/2),t%2*6,1));case u.TimescaleUnit.quarters:return new Date(Date.UTC(Math.floor(t/4),t%4*3,1));case u.TimescaleUnit.months:return new Date(Date.UTC(Math.floor(t/12),t%12,1));case u.TimescaleUnit.thirdsOfMonth:return new Date(Date.UTC(Math.floor(t/36),Math.floor(t%36/3),t%3*10+1));case u.TimescaleUnit.weeks:return new Date((7*t-4+this.project.calendarSettings.weekStartOn)*w.millisecondsPerDay);case u.TimescaleUnit.days:return new Date(t*w.millisecondsPerDay);case u.TimescaleUnit.hours:return new Date(t*w.millisecondsPerHour);case u.TimescaleUnit.minutes:return new Date(t*w.millisecondsPerMinute)}},w.prototype.getDateUtcRange=function(t,n,i){var e,e,t;return c(n)&&c(i)&&(n=(e=this.tierMode===u.TimescaleTierMode.middle?this.middleTier:this.bottomTier).unit,i=e.count),e=this.dateUtcToUnitValue(t,n),1===i?[this.unitValueToDateUtc(e,n),this.unitValueToDateUtc(e+1,n)]:(t=this.dateUtcToUnitValue(w.initialDateUtc,n),this.unitValueToDateUtc(t,n)<w.initialDateUtc&&t++,e=Math.floor((e-t)/i)*i+t,[this.unitValueToDateUtc(e,n),this.unitValueToDateUtc(e+i,n)])},w.prototype.Pyi=function(){this.iq&&!this.Dyi&&this.zoomAuto()},w.prototype.toJSON=function(){return s.GanttSheetJsonConverter.toJSON(this,this.IOProps)},w.prototype.fromJSON=function(t){this.iq=!1,s.GanttSheetJsonConverter.fromJSON(this,t,this.IOProps),t.currentDate&&(this.cyi=a.Calendar.localToUTC(new Date(t.currentDate))),this.iq=!0},w.Yyi=a.Calendar.localToUTC(new Date(1984,1,1)),w.TimescaleUnitValueMap=[NaN,365,182,90,28,8,7,1,1/24,1/1440],w.millisecondsPerMinute=6e4,w.millisecondsPerHour=36e5,w.millisecondsPerDay=864e5,n.Timescale=w},"./dist/plugins/gantt/taskbar/action.js":function(I,t,n){var i,u,e,B,g,r,b,L,o,h,s,n,a,n,c,f,l,n,d,P,A,v,m,p,y,w,j,U,H,G,Q,T,O,k,S,M;function W(t){return-1<["task","manualTask","durationOnly"].indexOf(t.name)}function Y(t){return"startOnly"===t.name}function V(t){return"finishOnly"===t.name}function K(t){return-1<["milestone","manualMilestone","startOnlyMilestone","finishOnlyMilestone","durationOnlyMilestone"].indexOf(t.name)}function z(t){return"progress"===t.name||"manualProgress"===t.name}function _(){this.scrollingDistanceCache=0,this.scrollInterval=100,this.Qyi=!0}function Z(t){var n=G.call(this)||this;return n.hyi=t,n}function X(t){var n=Q.call(this)||this;return n.Wyi=10,n.Mf=t,n.Mf.parent.options.scrollByPixel=!0,n.Mf.parent.options.scrollPixel=n.Wyi,n}function x(t,n,i,e){this.tipHeight=65,this.tipWidth=160,this.actionStatus=s.ActionStatus.NotStart,this.startInfo=i,this.cursorStyle=e,this.sheet=i.hitInfo.sheet,this.project=t,this.cellType=n,this.minMoveX=i.hitInfo.cellRect.x-i.hitInfo.x,this.maxMoveX=i.hitInfo.cellRect.x+i.hitInfo.cellRect.width-i.hitInfo.x,this.project&&(this.timescaleScrollTimer=new d(this.project.timescale))}function D(t,n,i){var t=T.call(this,t,n,i,s.CursorStyle.Move)||this;return t.tipHeight=65,t.tipWidth=200,t.command="Move",t.Gyi=n,t}function E(t,n,i){var t=O.call(this,t,n,i,s.CursorStyle.RightStretch)||this;return t.command="Stretch",t}function C(t,n,i){var t=k.call(this,t,n,i,s.CursorStyle.ProcessDrag)||this;return t.tipWidth=210,t.tipHeight=50,t.command="ProgressStretch",t}function F(t,n,i){var t=S.call(this,t,n,i,s.CursorStyle.LinkLine)||this;return t.command="Link",t.ck=new P(t.sheet),t.init(),t}function N(t,n,i){var t=M.call(this,t,n,i,s.CursorStyle.Default)||this;return t.tipHeight=85,t.command="New",t}function R(){}function q(){}i=this&&this.__extends||(H=function(t,n){return(H=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}H(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(t,"__esModule",{value:!0}),t.ActionPendingInfo=t.BarActionBuilder=t.BarNewAction=t.BarLinkAction=t.ProgressStretchAction=t.BarStretchAction=t.BarMoveAction=t.BarAction=void 0,u=n("Common"),e=n("Core"),B=n("./dist/plugins/gantt/gantt-sheet.js"),g=n("./dist/plugins/gantt/gantt-renderer.js"),r=n("./dist/plugins/gantt/project/calendar.js"),b=n("./dist/plugins/gantt/project/tasks.js"),L=n("./dist/plugins/gantt/project/dependency.js"),o=n("./dist/plugins/gantt/project/schedule.js"),h=n("./dist/plugins/gantt/celltypes/taskbar.js"),s=n("./dist/plugins/gantt/gantt.enum.js"),n=n("./dist/plugins/gantt/gantt.ns.js"),a=u.Common.lt.ht,n=new u.Common.ResourceManager(n.SR,"GanttSheet"),c=n.getResource.bind(n),f=u.Common.zf,l=e.GC$,_.prototype.start=function(t){var n=this;this.direction=t,this.Qyi=!1,this.timer=window.setInterval(function(){n.scrolling()},this.scrollInterval)},_.prototype.scrolling=function(){},_.prototype.stop=function(){this.timer&&(window.clearInterval(this.timer),delete this.timer),this.Qyi=!0},_.prototype.isStopped=function(){return this.Qyi},_.prototype.getScrollDistance=function(){return this.scrollingDistanceCache},i(Z,G=n=_),Z.prototype.scrolling=function(){var t,t,t=this.hyi.currentDateUtc;this.hyi.scrollOneTick(this.direction===s.ScrollDirection.Positive),t=-this.hyi.getOffsetByDateUtc(t),this.scrollingDistanceCache+=t,this.onTimescaleScroll&&this.onTimescaleScroll()},d=Z,i(X,Q=n),X.prototype.scrolling=function(){var t,n,i,t=this.Wyi*this.direction,n=this.Mf.ly,i=this.Mf.getViewportTopRow(1);this.Mf.scroll(t,0),n===this.Mf.ly&&i===this.Mf.getViewportTopRow(1)||(this.scrollingDistanceCache+=t,this.onSheetVerticalScroll&&this.onSheetVerticalScroll())},P=X,x.prototype.doMouseMove=function(t){this.pending(this.getHitInfoByMouseEvent(t));var t=this.getMovingRepaintRect();this.sheet.repaint(t),j.updateCursorStyle(this.sheet.Dg(),this.cursorStyle),this.tipSettings=this.getTipDefaultSettings(),this.triggerEvent(),this.showTips()},x.prototype.doMouseUp=function(t){this.process(this.getHitInfoByMouseEvent(t)),this.unhandleDocumentMouseMove(),this.sheet.repaint(),this.triggerEvent(),this.dispose(),this.actionStatus=s.ActionStatus.NotStart,j.updateCursorStyle(this.sheet.Dg(),s.CursorStyle.Default)},x.prototype.getHitInfoByMouseEvent=function(t){var n,i,t,n,e,n=this.sheet.uw(),i=t.pageX-n.left,t=t.pageY-n.top,n=this.sheet.hitTest(i,t),e;return{x:n.x,y:n.y,row:n.row,col:n.col,sheet:this.sheet,cellRect:n.cellTypeHitInfo?n.cellTypeHitInfo.cellRect:void 0,sheetArea:n.cellTypeHitInfo?n.cellTypeHitInfo.sheetArea:void 0}},x.prototype.handleDocumentMouseMove=function(){var n=this;l(document).bind("mousemove.ganttSheet.baraction",function(t){n.doMouseMove(t)}).bind("mouseup.ganttSheet.baraction",function(t){n.doMouseUp(t)})},x.prototype.unhandleDocumentMouseMove=function(){l(document).unbind("mousemove.ganttSheet.baraction").unbind("mouseup.ganttSheet.baraction")},x.prototype.getMovedX=function(t){var n,n;return this.currentInfo&&this.startInfo?(n=Math.max(this.minMoveX,this.currentInfo.hitInfo.x-this.startInfo.hitInfo.x),n=Math.min(this.maxMoveX,n),this.timescaleScrollTimer&&!t&&(n+=this.timescaleScrollTimer.getScrollDistance()),n):0},x.prototype.getMovedY=function(){return this.currentInfo&&this.startInfo?this.currentInfo.hitInfo.y-this.startInfo.hitInfo.y:0},x.prototype.checkScrolling=function(){var t,n,t=this;this.currentInfo.hitInfo.x-this.startInfo.hitInfo.cellRect.x<=0&&(n=s.ScrollDirection.Negative),void 0!==(n=0<=this.currentInfo.hitInfo.x-(this.startInfo.hitInfo.cellRect.x+this.startInfo.hitInfo.cellRect.width)?s.ScrollDirection.Positive:n)?this.timescaleScrollTimer&&this.timescaleScrollTimer.isStopped()&&(this.timescaleScrollTimer.start(n),this.timescaleScrollTimer.onTimescaleScroll=function(){t.triggerEvent(),t.showTips()}):this.timescaleScrollTimer&&this.timescaleScrollTimer.stop()},x.prototype.showTips=function(){var t,t;!this.tipSettings||(t=this.startInfo.hitInfo.cellStyle?this.startInfo.hitInfo.cellStyle.cellType:null)instanceof h.TaskbarCellType&&!t.showDefaultTips||((t=this.sheet.parent).R3||(this.sheet.parent.Tw(this.tipSettings.getContent(),0,0),t.R3.style.whiteSpace="normal",t.R3.style.zIndex="1000",this.tipPosition=this.calcTipPosition()),this.tipPosition&&this.sheet.parent.ny(this.tipSettings.getContent(),this.tipPosition.x,this.tipPosition.y))},x.prototype.hideTips=function(){var t=this.startInfo.hitInfo.cellStyle?this.startInfo.hitInfo.cellStyle.cellType:null;t instanceof h.TaskbarCellType&&!t.showDefaultTips||(this.sheet.parent.iy(),delete this.tipPosition,delete this.tipSettings)},x.prototype.calcTipPosition=function(){if(this.startInfo.barBounds&&this.sheet.parent.R3)return{x:this.startInfo.hitInfo.x-this.tipWidth/2-2,y:this.startInfo.barBounds.y-this.tipHeight-10}},x.prototype.start=function(){this.handleDocumentMouseMove(),j.updateCursorStyle(this.sheet.Dg(),this.cursorStyle)},x.prototype.pending=function(t){this.currentInfo=j.getBarHitInfo(this.project,this.cellType,t),this.checkScrolling(),(Math.abs(this.getMovedX())>x.actionStartOffset||Math.abs(this.getMovedY())>x.actionStartOffset)&&(this.actionStatus=s.ActionStatus.InProgress)},x.prototype.process=function(t){this.currentInfo=j.getBarHitInfo(this.project,this.cellType,t),this.actionStatus===s.ActionStatus.InProgress&&(this.actionStatus=s.ActionStatus.Finish)},x.prototype.triggerEvent=function(){var t;this.actionStatus===s.ActionStatus.Finish?this.sheet.ki(s.GanttSheetEvent.Event_BarAction_End,this.getTriggerData()):this.actionStatus===s.ActionStatus.InProgress&&((t=this.getTriggerData()).tip=this.tipSettings,this.sheet.ki(s.GanttSheetEvent.Event_BarAction_Pending,t))},x.prototype.dispose=function(){this.timescaleScrollTimer&&this.timescaleScrollTimer.stop(),this.hideTips();var t=this.sheet.getCellType(this.startInfo.hitInfo.row,this.startInfo.hitInfo.col);t.barAction===this&&(t.barAction=void 0)},x.prototype.getBarPendingInfo=function(){return{partName:s.BarPartName.Middle,styleRule:this.startInfo.style,task:this.startInfo.task,name:this.command+"_P",movedX:this.getMovedX(),movedY:this.getMovedY(),colIndex:this.startInfo.hitInfo.col,rowIndex:this.startInfo.hitInfo.row}},x.prototype.getTipDefaultSettings=function(){return null},x.prototype.getTriggerData=function(){return{command:this.command}},x.prototype.getMovingRepaintRect=function(){return this.sheet.getCellRect(this.startInfo.hitInfo.row,this.startInfo.hitInfo.col)},x.prototype.getDateChangeUnit=function(t){var n,i,i=(n=this.project.timescale).tierMode===s.TimescaleTierMode.middle?n.middleTier:n.bottomTier;if(!(t=void 0===t?!1:t))return i.unit;switch(i.unit){case s.TimescaleUnit.minutes:return s.TimescaleUnit.minutes;case s.TimescaleUnit.hours:case s.TimescaleUnit.days:case s.TimescaleUnit.weeks:case s.TimescaleUnit.thirdsOfMonth:case s.TimescaleUnit.months:case s.TimescaleUnit.quarters:case s.TimescaleUnit.halfYears:case s.TimescaleUnit.years:return 1===i.count?i.unit+1:i.unit}},x.actionStartOffset=4,t.BarAction=A=x,i(D,T=A),D.prototype.pending=function(t){var t;T.prototype.pending.call(this,t),this.isTryToLink(t)?(this.unhandleDocumentMouseMove(),(t=j.getActionInstance("Link",this.project,this.Gyi,this.startInfo))&&(this.Gyi.barAction=t).start()):this.actionStatus===s.ActionStatus.InProgress&&(this.cursorStyle=s.CursorStyle.TaskDrag)},D.prototype.process=function(t){var t,n,i,i;T.prototype.process.call(this,t),this.actionStatus===s.ActionStatus.Finish&&(t=this.startInfo.task,"FinishOnly"===(n=o.ScheduleManager.getScheduleDataType({start:t.start,finish:t.finish,duration:t.duration}))?(i=this.getTargetDate(this.getBarEndPosition()),t.finishDisplayed.valueOf()!==i.valueOf()&&(t.finish=i)):(i=this.getTargetDate(this.getBarStartPosition()),t.startDisplayed.valueOf()!==i.valueOf()&&(t.start=i)))},D.prototype.getTipDefaultSettings=function(){var t,n,i,e,t,s,r,t,t=this.startInfo.style.name,n=new u.Formatter.GeneralFormatter(this.project.layout.tipDateFormat),i=this.startInfo.task,e=new h.TipSettings("gc-gantt-bar-action-"+this.command);return e.title=t||"",e.body=[],"StartOnly"===(t=o.ScheduleManager.getScheduleDataType({start:i.start,finish:i.finish,duration:i.duration}))?(s=this.getTargetDate(this.getBarStartPosition()),e.body.push([c().GANTT_ACTION_TASK_START,"".concat(n.format(s))])):"FinishOnly"===t||i.isMilestone?(r=this.getTargetDate(this.getBarEndPosition()),e.body.push([c().GANTT_ACTION_TASK_FINISH,"".concat(n.format(r))])):(s=this.getTargetDate(this.getBarStartPosition()),e.body.push([c().GANTT_ACTION_TASK_START,"".concat(n.format(s))]),(t=i.duration)&&(r=this.project.calendar.addDuration(s,t,!0,!1,this.project.calendarSettings),e.body.push([c().GANTT_ACTION_TASK_FINISH,"".concat(n.format(r))]))),2===e.body.length?this.tipHeight=65:this.tipHeight=45,e},D.prototype.getBarStartPosition=function(){return this.startInfo.barBounds.x-this.startInfo.hitInfo.cellRect.x},D.prototype.getBarEndPosition=function(){return this.startInfo.barBounds.x+this.startInfo.barBounds.w-this.startInfo.hitInfo.cellRect.x},D.prototype.getTriggerData=function(){var t=this.startInfo.task;return{command:this.command,targetTask:t,start:this.getTargetDate(this.getBarStartPosition()),finish:this.getTargetDate(this.getBarEndPosition())}},D.prototype.isTryToLink=function(t){return!(!this.timescaleScrollTimer.isStopped()||0!==this.timescaleScrollTimer.getScrollDistance())&&(void 0!==t.row&&t.row!==this.startInfo.hitInfo.row||this.actionStatus===s.ActionStatus.NotStart&&Math.abs(this.getMovedX())<=A.actionStartOffset&&Math.abs(this.getMovedY())>A.actionStartOffset)},D.prototype.getTargetDate=function(t){var n,n,i,e,i,t,n=this.startInfo.task;if(n)return n=n.project.timescale,i=this.getMovedX(!0),e=this.getDateChangeUnit(),i=n.getDateUtcRange(n.getDateUtcByOffset(i+t,n.currentDateUtc),e,1)[0],e<=s.TimescaleUnit.days&&(t=this.project.calendarSettings,i.setUTCHours(t.defaultStartTime.hour,t.defaultStartTime.minute,0,0)),r.Calendar.utcToLocal(i)},D.prototype.getBarPendingInfo=function(){var t=T.prototype.getBarPendingInfo.call(this);return t.styleRule.style.taskbarStyle.middleShape?t.partName=s.BarPartName.Middle:t.styleRule.style.taskbarStyle.startShape?t.partName=s.BarPartName.Start:t.styleRule.style.taskbarStyle.endShape&&(t.partName=s.BarPartName.End),t},v=D,t.BarMoveAction=v,i(E,O=A),E.prototype.process=function(t){var t,n;O.prototype.process.call(this,t),this.actionStatus===s.ActionStatus.Finish&&(t=this.startInfo.task,(n=this.getStretchToDate())<t.start?t.finish=t.start=n:t.finish=n)},E.prototype.getStretchToDate=function(){var t,n,t,i,n,t=this.startInfo.task,n=this.getMovedX(!0),t=t.project.timescale,i=this.startInfo.barBounds.x+this.startInfo.barBounds.w-this.startInfo.hitInfo.cellRect.x,n=t.getDateUtcRange(t.getDateUtcByOffset(n+i,t.currentDateUtc),this.getDateChangeUnit(!0),1)[0];return r.Calendar.utcToLocal(n)},E.prototype.getBarPendingInfo=function(){var t=O.prototype.getBarPendingInfo.call(this);return t.styleRule.style.taskbarStyle.endShape?t.partName=s.BarPartName.End:t.styleRule.style.taskbarStyle.middleShape?(t.partName=s.BarPartName.Middle,t.movedX=0,t.stretchX=this.getMovedX()):t.styleRule.style.taskbarStyle.startShape&&(t.partName=s.BarPartName.Start),t},E.prototype.getTipDefaultSettings=function(){var t,n,i,e,s,s,e,t=this.startInfo.style.name,n=this.getStretchToDate(),i=new u.Formatter.GeneralFormatter(this.project.layout.tipDateFormat),e=this.startInfo.task.duration,s="Manual"===this.startInfo.task.mode,s=this.project.calendar.calcDurationUtc(r.Calendar.localToUTC(this.startInfo.task.startDisplayed),r.Calendar.localToUTC(n),s,this.project.calendarSettings,e?e.unit:null),e=new h.TipSettings("gc-gantt-bar-action-"+this.command);return e.title="".concat(t),e.body=[[c().GANTT_ACTION_FINISH,"".concat(i.format(n))],[c().GANTT_ACTION_DURATION,"".concat(this.project.formatDuration(s))]],e},E.prototype.getTriggerData=function(){return{command:this.command,targetTask:this.startInfo.task,finish:this.getStretchToDate()}},m=E,t.BarStretchAction=m,i(C,k=A),C.prototype.process=function(t){var t,n;k.prototype.process.call(this,t),t=this.startInfo.task,a(t.start)&&(t.start=t.startDisplayed),n=this.gAe(),this.project.taskManager.setTaskValue(t,"complete",n,!0)},C.prototype.getCompleteThroughDate=function(){var t,n,n,n,t=this.startInfo.task,n=t.project.timescale,n=n.getDateUtcRange(n.getDateUtcByOffset(this.currentInfo.hitInfo.x-this.startInfo.hitInfo.cellRect.x,n.currentDateUtc),this.getDateChangeUnit(!0),1)[0],n=r.Calendar.utcToLocal(n);return n.valueOf()>t.finishDisplayed.valueOf()?n=t.finishDisplayed:n.valueOf()<t.startDisplayed.valueOf()&&(n=t.startDisplayed),n},C.prototype.gAe=function(){var t,n,i,e,t,s,i,t=this.sheet.NMi.gji,n=this.getBarPendingInfo().stretchX,i=this.startInfo.task,e=i.complete,t=t.nAe(i),s,i=Math.round((t*e+n)/t*100)/100;return i=i<0?0:i},C.prototype.getBarPendingInfo=function(){var t=k.prototype.getBarPendingInfo.call(this);if(z(t.styleRule)){if(t.styleRule.style.taskbarStyle.endShape)return t.partName=s.BarPartName.End,t;t.movedX=0,t.stretchX=this.getMovedX()}else{if(t.styleRule.style.taskbarStyle.startShape)return t.partName=s.BarPartName.Start,t;t.movedX=0,t.stretchX=this.getMovedX()-this.startInfo.barBounds.w}return t},C.prototype.getTipDefaultSettings=function(){var t,n,i,t=this.startInfo.style.name,n=this.gAe(),i=new h.TipSettings("gc-gantt-bar-action-"+this.command);return i.title="".concat(t),i.body=[[c().GANTT_TASK_BAR_COMPLETE,"".concat(Math.round(100*n),"%")]],i},C.prototype.getTriggerData=function(){return{command:this.command,targetTask:this.startInfo.task,completeThroughDate:this.getCompleteThroughDate()}},p=C,t.ProgressStretchAction=p,i(F,S=A),F.prototype.init=function(){var t,n,n,t,n=this.startInfo.hitInfo.sheet.NMi;n instanceof B.GanttSheet&&n.project===this.project&&(n=this.sheet.getRangeRect(1,2,{row:-1,col:this.startInfo.hitInfo.col,rowCount:-1,colCount:1}),this.Vyi=new e.Rect(n.x,n.y,n.width,n.height)),this.zyi=this.startInfo.hitInfo.cellRect},F.prototype.checkScrolling=function(){var t,n,i,t=this;this.Vyi&&(this.currentInfo.hitInfo.y<=this.Vyi.y?n=s.ScrollDirection.Negative:this.currentInfo.hitInfo.y>=this.Vyi.y+this.Vyi.height&&(n=s.ScrollDirection.Positive),void 0!==n?this.ck.isStopped()&&(this.ck.start(n),this.ck.onSheetVerticalScroll=function(){t.sheet.repaint(t.sheet.j1(new e.Range(-1,t.startInfo.hitInfo.col,-1,1)))}):this.ck.stop()),this.currentInfo.hitInfo.x-this.startInfo.hitInfo.cellRect.x<=0&&(i=s.ScrollDirection.Negative),void 0!==(i=0<=this.currentInfo.hitInfo.x-(this.startInfo.hitInfo.cellRect.x+this.startInfo.hitInfo.cellRect.width)?s.ScrollDirection.Positive:i)?this.ck.isStopped()&&this.timescaleScrollTimer.isStopped()&&this.timescaleScrollTimer.start(i):this.timescaleScrollTimer.stop()},F.prototype.process=function(t){var t,n,t;S.prototype.process.call(this,t),t=this.startInfo.task,n=this.currentInfo.task,t&&n&&t.taskNumber!==n.taskNumber&&(t=new L.TaskDependency(t,n),this.project.Ayi([t]))&&this.project.addDependency(t)},F.prototype.getMovingRepaintRect=function(){return this.sheet.j1(new e.Range(-1,this.startInfo.hitInfo.col,-1,1))},F.prototype.dispose=function(){S.prototype.dispose.call(this),this.ck.stop()},F.prototype.calcTipPosition=function(){if(this.sheet.parent.R3)return this.Vyi?{x:this.Vyi.x-this.tipWidth-6,y:this.zyi.y-this.tipHeight-10}:{x:this.zyi.x-this.tipWidth-6,y:this.zyi.y-this.tipHeight-10}},F.prototype.getPendingLinkInfo=function(){var t,n,t=this.startInfo.hitInfo.x-this.timescaleScrollTimer.getScrollDistance(),n=this.startInfo.hitInfo.y-this.ck.getScrollDistance();return n=this.Vyi?(t=Math.min(this.Vyi.x+this.Vyi.width,Math.max(t,this.Vyi.x)),Math.min(this.Vyi.y+this.Vyi.height,Math.max(n,this.Vyi.y))):(t=Math.min(document.body.clientWidth,Math.max(t,0)),Math.min(document.body.clientHeight,Math.max(n,0))),{name:this.command+"_L",movedX:this.currentInfo.hitInfo.x-t,movedY:this.currentInfo.hitInfo.y-n,startX:t,startY:n,task:this.startInfo.task,colIndex:this.startInfo.hitInfo.col,rowIndex:this.startInfo.hitInfo.row}},F.prototype.getPendingFromTaskInfo=function(){var t,n,n=this.startInfo.style;return n&&(n.style.taskbarStyle.middleShape?t=s.BarPartName.Middle:n.style.taskbarStyle.startShape?t=s.BarPartName.Start:n.style.taskbarStyle.endShape&&(t=s.BarPartName.End)),{partName:t,styleRule:this.startInfo.style,task:this.startInfo.task,name:this.command+"_S",movedX:0,movedY:0,colIndex:this.startInfo.hitInfo.col,rowIndex:this.startInfo.hitInfo.row}},F.prototype.getPendingToTaskInfo=function(){var t,n,n=this.currentInfo.style;return n&&(n.style.taskbarStyle.middleShape?t=s.BarPartName.Middle:n.style.taskbarStyle.startShape?t=s.BarPartName.Start:n.style.taskbarStyle.endShape&&(t=s.BarPartName.End)),{partName:t,styleRule:this.currentInfo.style,task:this.currentInfo.task,name:this.command+"_E",movedX:0,movedY:0,colIndex:this.currentInfo.hitInfo.col,rowIndex:this.currentInfo.hitInfo.row}},F.prototype.getTipDefaultSettings=function(){var t,n,t,i,t="FS",n="S"===t[0]?c().GANTT_ACTION_START_LINK:c().GANTT_ACTION_FINISH_LINK,t="S"===t[1]?c().GANTT_ACTION_START_LINK:c().GANTT_ACTION_FINISH_LINK,i=new h.TipSettings("gc-gantt-bar-action-"+this.command);return i.title=f.I5(c().GANTT_ACTION_LINE_TIP_TITLE,[n,t]),i.body=[[f.I5(c().GANTT_ACTION_FROM_OF,[n]),c().GANTT_ACTION_TASK+" "+this.startInfo.task.taskNumber],[f.I5(c().GANTT_ACTION_TO_OF,[t]),"".concat(this.currentInfo.task?c().GANTT_ACTION_TASK+" "+this.currentInfo.task.taskNumber:"")]],i},F.prototype.getTriggerData=function(){return{command:this.command,fromTask:this.startInfo.task,toTask:this.currentInfo.task}},y=F,t.BarLinkAction=y,i(N,M=A),N.prototype.pending=function(t){var t,t,n;M.prototype.pending.call(this,t),this.actionStatus===s.ActionStatus.InProgress&&!this.Kyi&&this.project&&(t=this.project.timescale,this.timescaleScrollTimer=new d(t),t=r.Calendar.utcToLocal(t.getDateUtcByOffset(this.startInfo.hitInfo.x-this.startInfo.hitInfo.cellRect.x)),this.Kyi=this.createNewTask(t,t,this.startInfo.hitInfo.row),this.cursorStyle=s.CursorStyle.Crosshair)},N.prototype.createNewTask=function(t,n,i){var e=b.Task.ZX(null);return Object.defineProperty(e,"viewIndex",{get:function(){return i}}),Object.defineProperty(e,"start",{get:function(){return t}}),Object.defineProperty(e,"startDisplayed",{get:function(){return t}}),Object.defineProperty(e,"finish",{get:function(){return n}}),Object.defineProperty(e,"finishDisplayed",{get:function(){return n}}),e},N.prototype.calcTipPosition=function(){var t,n;if(this.Kyi&&this.sheet.parent.R3)return n=(t=this.sheet.NMi.gji).getTaskRect(this.Kyi,this.project.Omi.rules.getRule("task"),this.startInfo.hitInfo.cellRect),{x:this.startInfo.hitInfo.x-this.tipWidth/2-2,y:n.y-this.tipHeight-10}},N.prototype.process=function(t){var t,n,i;M.prototype.process.call(this,t),this.Kyi&&(t=this.getNewTaskBuildInfo(),n=this.project,(i=this.cellType.cAi(this.startInfo.hitInfo))>=n.count)&&n.addTasks({name:c().GANTT_NEW_TASK,start:t.start,finish:t.finish,duration:t.duration})},N.prototype.getNewTaskBuildInfo=function(){var t,n,i,e,i,n,t,i,i,t=this.project.timescale,n=this.Kyi.startDisplayed,i=r.Calendar.utcToLocal(t.getDateUtcByOffset(this.currentInfo.hitInfo.x-this.startInfo.hitInfo.cellRect.x)),e={};return i<n?(e.start=i,e.finish=n):n<i?(e.start=n,e.finish=i):e.finish=e.start=n,i=this.getDateChangeUnit(),n=t.getDateUtcRange(r.Calendar.localToUTC(e.start),i,1)[0],t=t.getDateUtcRange(r.Calendar.localToUTC(e.finish),i,1)[1],i<=s.TimescaleUnit.days&&(i=this.project.calendarSettings,n.setUTCHours(i.defaultStartTime.hour,i.defaultStartTime.minute,0,0),t.setUTCDate(t.getUTCDate()-1),t.setUTCHours(i.defaultFinishTime.hour,i.defaultFinishTime.minute,0,0)),i="Manual"===this.project.defaultMode,e.start=r.Calendar.utcToLocal(n),e.finish=r.Calendar.utcToLocal(t),e.duration=this.project.calendar.calcDurationUtc(n,t,i,this.project.calendarSettings),e},N.prototype.getBarPendingInfo=function(){var t=M.prototype.getBarPendingInfo.call(this);return this.Kyi&&(t.task=this.Kyi,t.styleRule=this.project.Omi.rules.getRule("task"),t.movedX=0,t.stretchX=this.getMovedX()),t},N.prototype.getTipDefaultSettings=function(){var t,n,i;if(this.Kyi)return t=new u.Formatter.GeneralFormatter(this.project.layout.tipDateFormat),n=this.getNewTaskBuildInfo(),(i=new h.TipSettings("gc-gantt-bar-action-"+this.command)).title="Create Task",i.body=[[c().GANTT_ACTION_START,"".concat(t.format(n.start))],[c().GANTT_ACTION_FINISH,"".concat(t.format(n.finish))],[c().GANTT_ACTION_DURATION,"".concat(this.project.formatDuration(n.duration))]],i},N.prototype.getTriggerData=function(){var t=this.getNewTaskBuildInfo(),n=t.start,i=t.finish,t=t.duration;return{command:this.command,start:n,finish:i,duration:t}},w=N,t.BarNewAction=w,R.getBarHitInfo=function(t,n,i){var e,s,n,r,u,o,h,a,c,f,l,d,A,v,l,e={hitInfo:i,area:"outOfBar"},s=i&&i.sheet,n=n.cAi(i),r=t.getTaskByRow(n);if(i&&r&&r instanceof b.Task&&i.cellRect&&(u=r.getBarStyleRules()))for(o=u.length-1;0<=o;o--)if(h=u[o],a=this.getTaskbarBounds(t,r,h,i.cellRect,s),c=g.GanttRenderer.getTaskbarStartBounds(a),f=g.GanttRenderer.getTaskbarEndBounds(a),l=a.x,d=a.y,A=a.w,v=a.h,l=c.x,A=f.x+f.w-c.x,this.isHitInBounds(i,{x:l,y:d,w:A,h:v}))return e.task=r,e.style=h,l=(e.barBounds=a).w>=2*c.w?c.w/4:c.w/2,c.w-=l,f.x+=l,f.w-=l,this.isHitInBounds(i,c)?e.area="aroundLeft":this.isHitInBounds(i,f)?e.area="aroundRight":e.area="insideBar",e;return e},R.isHitInBounds=function(t,n){return!!(n&&t.x>=n.x&&t.x<n.x+n.w&&t.y>=n.y&&t.y<n.y+n.h)},R.getHitAction=function(t,n,i){var e,s,s,r,u,e=i.hitInfo,s=n.cAi(e);if(!t.getTaskByRow(s))return this.getActionInstance("New",t,n,i);if((s=i.task)&&0!==s.taskNumber){if(r="Manual"===s.mode,u=i.style,r&&(K(u)||Y(u)||V(u)))return this.getActionInstance("Move",t,n,i);if("aroundLeft"===i.area)return z(u)?this.getActionInstance("ProgressStretch",t,n,i):W(u)?(s.bAe=!0,i=R.getBarHitInfo(t,n,e),s.bAe=!1,this.getActionInstance("ProgressStretch",t,n,i)):void 0;if("aroundRight"===i.area){if(z(u))return this.getActionInstance("ProgressStretch",t,n,i);if(W(u))return this.getActionInstance("Stretch",t,n,i)}return"insideBar"===i.area?r?this.getActionInstance("Move",t,n,i):this.getActionInstance("Link",t,n,i):void 0}},R.getActionInstance=function(t,n,i,e){var s,r,u,o,r,u=e.hitInfo.sheet.NMi;switch(t){case"Move":i&&i.allowMoveOrResizeTask&&(s=new v(n,i,e));break;case"Stretch":i&&i.allowMoveOrResizeTask&&(s=new m(n,i,e));break;case"Link":i&&i.allowLinkTask&&(o=n.taskManager.isFieldEnabled("predecessors"))&&(s=new y(n,i,e));break;case"New":if(i&&i.allowDragNewTask){if(u.uiOptions&&!1===u.uiOptions.allowAddTask)return;s=new w(n,i,e)}break;case"ProgressStretch":i&&i.allowChangeProgress&&(o=n.taskManager.isFieldEnabled("complete"))&&(s=new p(n,i,e));break;default:return}return s},R.getTaskbarBounds=function(t,n,i,e,s){var r;if(!a(i))return s.NMi.gji.getTaskRect(n,i,e)},R.updateCursorByBarHitInfo=function(t,n,i,e){var n=this.getHitAction(n,i,e);n?this.updateCursorStyle(t,n.cursorStyle):this.updateCursorStyle(t,null)},R.updateCursorStyle=function(t,n){switch(n){case s.CursorStyle.TaskDrag:return void(t.style.cursor="url(data:image/ico;base64,AAACAAEAICAAABAACQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAgAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////////////////////////////////7//f/84Bz/+O/cf/Dv3D/gD8Af8O/cP/jv3H/84Bz//v/9///////////////////////////////////////////////////////////8=) 15 15,auto");case s.CursorStyle.ProcessDrag:return void(t.style.cursor="url(data:image/ico;base64,AAACAAEAICAAABAACQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAgAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////////////////////////////////////////////x///77t///e7P//7ux///ccP//7/D///fx//478//93ff//d7///3ff//+P7/////////////////////////////////////////////////8=) 15 15,auto");case s.CursorStyle.Move:return void(t.style.cursor="move");case s.CursorStyle.LeftStretch:return void(t.style.cursor="w-resize");case s.CursorStyle.RightStretch:return void(t.style.cursor="url(data:image/ico;base64,AAACAAEAICAAABAACQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAgAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//////////////////////////////////////////////////////////////////n////5v///+Z////mP///4B///+Af///mP///5n///+b////n///////////////////////////////////////////////////////8=) 15 15,auto");case s.CursorStyle.LinkLine:return void(t.style.cursor="url(data:image/ico;base64,AAACAAEAICAAABAACQAwAQAAFgAAACgAAAAgAAAAQAAAAAEAAQAAAAAAgAAAAAAAAAAAAAAAAgAAAAIAAAAAAAAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAPx+AAGAAwABX/UAAYADAAD8fgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//////////////////////////////////////////////////////////////////////8Dgf/+AQD//AAAf/wAAH/8AAB//gEA//8Dgf////////////////////////////////////////////////////////////////8=) 15 15,auto");case s.CursorStyle.Crosshair:return void(t.style.cursor="crosshair");default:return void(t.style.cursor="default")}},j=R,t.BarActionBuilder=j,t.ActionPendingInfo=q},"./dist/plugins/gantt/taskbar/layout.js":function(t,n,i){var e,s,r;function u(t){this.Xyi="toTop",this.Zyi=12,this.qyi=s.DefaultDateFormatter,this.$yi=s.DefaultDateFormatter,this.Jyi=!0,this.IOProps=["barHeight","barTextDateFormat","linkLineMode","roundBarsToWholeDays","tipDateFormat"],this.uAi=t}Object.defineProperty(n,"__esModule",{value:!0}),n.TaskbarLayout=void 0,e=i("./dist/plugins/gantt/gantt-json.js"),s=i("./dist/plugins/gantt/utils/util.js"),Object.defineProperty(u.prototype,"linkLineMode",{get:function(){return this.Xyi},set:function(t){this.Xyi=t,this.uAi.VAi.invoke()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"barHeight",{get:function(){return this.Zyi},set:function(t){this.Zyi=t,this.uAi.Rmi.invoke()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"barTextDateFormat",{get:function(){return this.qyi},set:function(t){this.qyi=t,this.uAi.Rmi.invoke()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"tipDateFormat",{get:function(){return this.$yi},set:function(t){this.$yi=t,this.uAi.VAi.invoke()},enumerable:!1,configurable:!0}),Object.defineProperty(u.prototype,"roundBarsToWholeDays",{get:function(){return this.Jyi},set:function(t){this.Jyi=t,this.uAi.VAi.invoke()},enumerable:!1,configurable:!0}),u.prototype.toJSON=function(){return e.GanttSheetJsonConverter.toJSON(this,this.IOProps)},u.prototype.fromJSON=function(t){e.GanttSheetJsonConverter.fromJSON(this,t,this.IOProps)},n.TaskbarLayout=u},"./dist/plugins/gantt/taskbar/renderer.js":function(t,n,i){var e,a,c,f,s,r;function u(){}function l(){}Object.defineProperty(n,"__esModule",{value:!0}),n.BarPainter=n.BarEndPainter=void 0,e=i("Common"),a=i("Core"),c=i("./dist/plugins/gantt/utils/util.js"),f=e.Common.lt.ht,u.draw=function(t,n,i,e,s){if(!f(n)){var r=s.x,u=s.y,o=s.w,h=s.h;switch(s=c.GanttUtil.fixPixelAlignment(r,u,o,h),n){case"houseUp":this.drawHouseUp(t,s,i,e);break;case"houseDown":this.drawHouseDown(t,s,i,e);break;case"diamond":this.drawDiamond(t,s,i,e);break;case"circleDiamond":this.drawCircleDiamond(t,s,i,e);break;case"triangleUp":this.drawTriangleUp(t,s,i,e);break;case"triangleDown":this.drawTriangleDown(t,s,i,e);break;case"triangleLeft":this.drawTriangleLeft(t,s,i,e);break;case"triangleRight":this.drawTriangleRight(t,s,i,e);break;case"circleTriangleUp":this.drawCircleTriangleUp(t,s,i,e);break;case"circleTriangleDown":this.drawCircleTriangleDown(t,s,i,e);break;case"arrowUp":this.drawArrowUp(t,s,i,e);break;case"arrowDown":this.drawArrowDown(t,s,i,e);break;case"circleArrowUp":this.drawCircleArrowUp(t,s,i,e);break;case"circleArrowDown":this.drawCircleArrowDown(t,s,i,e);break;case"caretDownTop":this.drawCaretDownTop(t,s,i,e);break;case"caretUpBottom":this.drawCaretUpBottom(t,s,i,e);break;case"lineShape":this.drawLine(t,s,i,e);break;case"square":this.drawSquare(t,s,i,e);break;case"circle":this.drawCircle(t,s,i,e);break;case"star":this.drawStar(t,s,i,e);break;case"leftBracket":this.drawLeftBracket(t,s,i,e);break;case"rightBracket":this.drawRightBracket(t,s,i,e);break;case"leftFade":this.drawLeftFade(t,s,i,e);break;case"rightFade":this.drawRightFade(t,s,i,e)}}},u.paintWithStyle=function(t,n,i){switch(n){case"solid":t.strokeStyle=i,t.stroke(),t.fillStyle=i,t.fill();break;case"framed":t.strokeStyle=i,t.stroke();break;case"dashed":t.setLineDash([4,2]),t.strokeStyle=i,t.stroke(),t.setLineDash([])}},u.drawLine=function(t,n,i,e){var s=n.x,r=n.y,u=n.w,n=n.h;t.beginPath(),t.moveTo(s+u/2-1,r),t.lineTo(s+u/2+2,r),t.lineTo(s+u/2+2,r+n),t.lineTo(s+u/2-1,r+n),t.lineTo(s+u/2-1,r),t.closePath(),this.paintWithStyle(t,i,e)},u.drawDiamond=function(t,n,i,e){var s=n.x,r=n.y,u=n.w,n=n.h;t.beginPath(),t.moveTo(s+u/2,r),t.lineTo(s+u,r+n/2),t.lineTo(s+u/2,r+n),t.lineTo(s,r+n/2),t.closePath(),this.paintWithStyle(t,i,e)},u.drawHouseUp=function(t,n,i,e){var s=n.x,r=n.y,u=n.w,n=n.h;t.beginPath(),t.moveTo(s+u/2,r),t.lineTo(s,r+n/2),t.lineTo(s,r+n),t.lineTo(s+u,r+n),t.lineTo(s+u,r+n/2),t.lineTo(s+u/2,r),t.closePath(),this.paintWithStyle(t,i,e)},u.drawHouseDown=function(t,n,i,e){var s=n.x,r=n.y,u=n.w,n=n.h;t.beginPath(),t.moveTo(s,r),t.lineTo(s,r+n/2),t.lineTo(s+u/2,r+n),t.lineTo(s+u,r+n/2),t.lineTo(s+u,r),t.lineTo(s,r),t.closePath(),this.paintWithStyle(t,i,e)},u.drawWhiteFillCircle=function(t,n,i,e){var s=n.x,r=n.y,u=n.w,n=n.h;t.beginPath(),t.arc(s+u/2,r+n/2,n/2,0,2*Math.PI),t.closePath(),"dashed"===e&&t.setLineDash([2,2]),t.strokeStyle=i,t.stroke(),t.fillStyle="white",t.fill(),t.setLineDash([])},u.drawCircleDiamond=function(t,n,i,e){this.drawWhiteFillCircle(t,n,e,i);var s=n.x,r=n.y,u=n.w,n=n.h;t.beginPath(),t.lineTo(s+u/2,r+n/4),t.lineTo(s+u/4,r+n/2),t.lineTo(s+u/2,r+3*n/4),t.lineTo(s+3*u/4,r+n/2),t.lineTo(s+u/2,r+n/4),t.closePath(),this.paintWithStyle(t,i,e)},u.drawTriangleUp=function(t,n,i,e){var s=n.x,r=n.y,u=n.w,n=n.h;t.beginPath(),t.moveTo(s+u/2,r),t.lineTo(s,r+n),t.lineTo(s+u,r+n),t.lineTo(s+u/2,r),t.closePath(),this.paintWithStyle(t,i,e)},u.drawTriangleDown=function(t,n,i,e){var s=n.x,r=n.y,u=n.w,n=n.h;t.beginPath(),t.moveTo(s,r),t.lineTo(s+u/2,r+n),t.lineTo(s+u,r),t.lineTo(s,r),t.closePath(),this.paintWithStyle(t,i,e)},u.drawTriangleLeft=function(t,n,i,e){var s=n.x,r=n.y,u=n.w,n=n.h;t.beginPath(),t.moveTo(s,r+n/2),t.lineTo(s+u,r+n),t.lineTo(s+u,r),t.lineTo(s,r+n/2),t.closePath(),this.paintWithStyle(t,i,e)},u.drawTriangleRight=function(t,n,i,e){var s=n.x,r=n.y,u=n.w,n=n.h;t.beginPath(),t.moveTo(s,r),t.lineTo(s,r+n),t.lineTo(s+u,r+n/2),t.lineTo(s,r),t.closePath(),this.paintWithStyle(t,i,e)},u.drawCircleTriangleUp=function(t,n,i,e){this.drawWhiteFillCircle(t,n,e,i);var s=n.x,r=n.y,u=n.w,n=n.h;t.beginPath(),t.moveTo(s+u/2,r+n/4),t.lineTo(s+u/4,r+3*n/4),t.lineTo(s+3*u/4,r+3*n/4),t.lineTo(s+u/2,r+n/4),t.closePath(),this.paintWithStyle(t,i,e)},u.drawCircleTriangleDown=function(t,n,i,e){this.drawWhiteFillCircle(t,n,e,i);var s=n.x,r=n.y,u=n.w,n=n.h;t.beginPath(),t.moveTo(s+u/4,r+n/4),t.lineTo(s+u/2,r+3*n/4),t.lineTo(s+3*u/4,r+n/4),t.lineTo(s+u/4,r+n/4),t.closePath(),this.paintWithStyle(t,i,e)},u.drawArrowUp=function(t,n,i,e){var s=n.x,r=n.y,u=n.w,n=n.h;t.beginPath(),t.moveTo(s+u/2,r),t.lineTo(s,r+n/2),t.lineTo(s+u/4,r+n/2),t.lineTo(s+u/4,r+n),t.lineTo(s+3*u/4,r+n),t.lineTo(s+3*u/4,r+n/2),t.lineTo(s+u,r+n/2),t.lineTo(s+u/2,r),t.closePath(),this.paintWithStyle(t,i,e)},u.drawArrowDown=function(t,n,i,e){var s=n.x,r=n.y,u=n.w,n=n.h;t.beginPath(),t.moveTo(s+u/4,r),t.lineTo(s+u/4,r+n/2),t.lineTo(s,r+n/2),t.lineTo(s+u/2,r+n),t.lineTo(s+u,r+n/2),t.lineTo(s+3*u/4,r+n/2),t.lineTo(s+3*u/4,r),t.lineTo(s+u/4,r),t.closePath(),this.paintWithStyle(t,i,e)},u.drawCircleArrowUp=function(t,n,i,e){this.drawWhiteFillCircle(t,n,e,i);var s=n.x,r=n.y,u=n.w,n=n.h;this.drawArrowUp(t,{x:s+1,y:r+1,w:u-2,h:n-2},i,e)},u.drawCircleArrowDown=function(t,n,i,e){this.drawWhiteFillCircle(t,n,e,i);var s=n.x,r=n.y,u=n.w,n=n.h;this.drawArrowDown(t,{x:s+1,y:r+1,w:u-2,h:n-2},i,e)},u.drawCaretDownTop=function(t,n,i,e){var s=n.x,r=n.y,u=n.w,n=n.h;t.beginPath(),t.moveTo(s,r+3*n/4),t.lineTo(s,r+n),t.lineTo(s+u,r+n),t.lineTo(s+u,r+3*n/4),t.lineTo(s+u/2,r+n/2),t.lineTo(s,r+3*n/4),t.closePath(),this.paintWithStyle(t,i,e)},u.drawCaretUpBottom=function(t,n,i,e){var s=n.x,r=n.y,u=n.w,n=n.h;t.beginPath(),t.moveTo(s,r),t.lineTo(s,r+n/4),t.lineTo(s+u/2,r+n/2),t.lineTo(s+u,r+n/4),t.lineTo(s+u,r),t.lineTo(s,r),t.closePath(),this.paintWithStyle(t,i,e)},u.drawSquare=function(t,n,i,e){var s=n.x,r=n.y,u=n.w,n=n.h;t.beginPath(),t.moveTo(s+u/4,r+n/4),t.lineTo(s+u/4,r+3*n/4),t.lineTo(s+3*u/4,r+3*n/4),t.lineTo(s+3*u/4,r+n/4),t.lineTo(s+u/4,r+n/4),t.closePath(),this.paintWithStyle(t,i,e)},u.drawCircle=function(t,n,i,e){var s=n.x,r=n.y,u=n.w,n=n.h;t.beginPath(),t.arc(s+u/2,r+n/2,n/2,0,2*Math.PI),t.closePath(),this.paintWithStyle(t,i,e)},u.drawStar=function(t,n,i,e){var s,r,u,n,s=n.x,r=n.y,u,n=n.h/4;t.beginPath(),t.moveTo(s+2*n,r),t.lineTo(s+5*n/2,r+3*n/2),t.lineTo(s+4*n,r+3*n/2),t.lineTo(s+14*n/5,r+12*n/5),t.lineTo(s+10*n/3,r+4*n),t.lineTo(s+2*n,r+3*n),t.lineTo(s+2*n/3,r+4*n),t.lineTo(s+6*n/5,r+12*n/5),t.lineTo(s,r+3*n/2),t.lineTo(s+3*n/2,r+3*n/2),t.lineTo(s+2*n,r),t.closePath(),this.paintWithStyle(t,i,e)},u.drawLeftBracket=function(t,n,i,e){var s=n.x,r=n.y,u=n.w,n=n.h;t.beginPath(),t.moveTo(s+u/2,r),t.lineTo(s+u,r),t.lineTo(s+u,r+n/8),t.lineTo(s+5*u/8,r+n/8),t.lineTo(s+5*u/8,r+7*n/8),t.lineTo(s+u,r+7*n/8),t.lineTo(s+u,r+n),t.lineTo(s+u/2,r+n),t.lineTo(s+u/2,r),t.closePath(),this.paintWithStyle(t,i,e)},u.drawRightBracket=function(t,n,i,e){var s=n.x,r=n.y,u=n.w,n=n.h;t.beginPath(),t.moveTo(s+u/2,r),t.lineTo(s,r),t.lineTo(s,r+n/8),t.lineTo(s+3*u/8,r+n/8),t.lineTo(s+3*u/8,r+7*n/8),t.lineTo(s,r+7*n/8),t.lineTo(s,r+n),t.lineTo(s+u/2,r+n),t.lineTo(s+u/2,r),t.closePath(),this.paintWithStyle(t,i,e)},u.drawLeftFade=function(t,n,i,e){var s,r,u,n,o,s=n.x,r=n.y,u=n.w,n=n.h;--s,--r,u+=2,t.lineWidth=n+=2,(o=t.createLinearGradient(s+u/2,r,s+u,r)).addColorStop(0,e),o.addColorStop(1,"rgba(255,255,255,0)"),t.fillStyle=o,t.fillRect(s+u/2,r,u/2,n),t.lineWidth=1,t.beginPath()},u.drawRightFade=function(t,n,i,e){var s,r,u,n,o,s=n.x,r=n.y,u=n.w,n=n.h;--s,--r,u+=2,t.lineWidth=n+=2,(o=t.createLinearGradient(s,r,s+u/2,r)).addColorStop(0,"rgba(255,255,255,0)"),o.addColorStop(1,e),t.fillStyle=o,t.fillRect(s,r,u/2,n),t.lineWidth=1},n.BarEndPainter=u,l.draw=function(t,n,i,e,s){var r,u,o,h,r,u,o,h,s;void 0===s&&(s=!0),e&&(2===e.h?(t.beginPath(),t.fillStyle=i,t.fillRect(e.x,e.y,e.w,e.h),t.closePath()):(r=e.x,u=e.y,o=e.w,h=e.h,a.W.setFillStyle(t,l.getBackColor(i,n),r,u,o,h,l.getFillFunction(t,r,u,o,h,n)),s&&(u=(r=c.GanttUtil.fixPixelAlignment(e.x,e.y,e.w,e.h)).x,o=r.y,h=r.w,s=r.h,l.DrawBorder(t,i,{x:u,y:o,w:h,h:s},"dashedBorder"!==n))))},l.getBackColor=function(t,n){var i={type:a.PatternType.solid,patternColor:t,backgroundColor:"white"};switch(n){case"hollow":i.patternColor="white";break;case"solidFill":break;case"lightFill":i.type=a.PatternType.lightGray;break;case"mediumFill":i.type=a.PatternType.mediumGray;break;case"darkFill":i.type=a.PatternType.darkGray;break;case"diagonalRight":i.type=a.PatternType.lightDown;break;case"diagonalLeft":i.type=a.PatternType.lightUp;break;case"diagonalCross":i.type=a.PatternType.lightTrellis;break;case"lineVertical":i.type=a.PatternType.lightVertical;break;case"lineHorizontal":i.type=a.PatternType.lightHorizontal;break;case"lineCross":i.type=a.PatternType.lightGrid}return i.type===a.PatternType.solid?i.patternColor:i},l.getFillFunction=function(t,n,i,e,s,r){var u,o,u=new a.Rect(n,i,e,s),o=function(){t.fillRect(n,i,e,s)};if(l.paintPatternResetOrigin)switch(r){case"hollow":case"solidFill":break;case"mediumFill":case"diagonalCross":case"lineVertical":case"lineHorizontal":case"lineCross":case"dashedBorder":o=function(){l.FillPattern(t,0,0,u)};break;case"lightFill":case"darkFill":o=function(){l.FillPattern(t,1,0,u)};break;case"diagonalRight":case"diagonalLeft":o=function(){l.FillPattern(t,2,0,u)}}return o},l.FillPattern=function(t,n,i,e){t.save(),t.translate(e.x-n,e.y-i),t.fillRect(n,i,e.width,e.height),t.restore()},l.DrawBorder=function(t,n,i,e){var s=i.x,r=i.y,u=i.w,i=i.h;e||t.setLineDash([2,2]),t.strokeStyle=n,t.strokeRect(s,r,u,i),t.setLineDash([])},l.paintPatternResetOrigin=!0,n.BarPainter=l},"./dist/plugins/gantt/taskbar/style.js":function(I,t,n){var i,e,n,s,n,r,u,o,h,a,c,f,l,d,A,v,B,L,P,U,H,g,G,Q,W,Y,V,K,z,Z,X,q,J,$,tt,nt,it;function b(t){return t.start&&t.finish&&!!t.duration}function et(t){return!t.start&&!t.finish&&!!t.duration}function st(t){return t.start&&!t.finish&&!t.duration}function rt(t){return!t.start&&t.finish&&!t.duration}function m(t){return t.startDisplayed.valueOf()!==t.finishDisplayed.valueOf()}function p(t){this.tji=new e.EventList,this.Zc=t}function y(){var t=G.call(this,"task")||this;return t.style={taskbarStyle:{middlePattern:"solidFill",middleShape:"rectangleBar",middleColor:"#8abbed"}},t}function w(){var t=Q.call(this,"milestone")||this;return t.style={taskbarStyle:{startColor:"#636363",startShape:"diamond",startType:"solid",rightText:"finish"}},t}function j(){var t=W.call(this,"summary")||this;return t.style={taskbarStyle:{startColor:"#545454",startShape:"lineShape",startType:"solid",middleColor:"#545454",middlePattern:"solidFill",middleShape:"lineTop",endShape:"lineShape",endType:"solid",endColor:"#545454"}},t}function T(){var t=Y.call(this,"progress")||this;return t.style={taskbarStyle:{middleColor:"#3B87D4",middleShape:"rectangleMiddle",middlePattern:"solidFill"}},t}function O(){var t=V.call(this,"projectSummary")||this;return t.style={taskbarStyle:{startColor:"#B6B6B6",startShape:"lineShape",startType:"solid",middleColor:"#B6B6B6",middlePattern:"solidFill",middleShape:"lineTop",endShape:"lineShape",endType:"solid",endColor:"#B6B6B6"}},t}function k(){var t=K.call(this,"manualTask")||this;return t.style={taskbarStyle:{startColor:"#2BA3AD",startShape:"lineShape",startType:"solid",middleColor:"#74CCD4",middlePattern:"solidFill",middleShape:"rectangleBar",endShape:"lineShape",endType:"solid",endColor:"#2BA3AD"}},t}function S(){var t=z.call(this,"manualSummary")||this;return t.style={taskbarStyle:{startColor:"#545454",startShape:"lineShape",startType:"solid",middleColor:"#545454",middlePattern:"solidFill",middleShape:"lineTop",endShape:"lineShape",endType:"solid",endColor:"#545454"}},t}function M(){var t=Z.call(this,"manualProgress")||this;return t.style={taskbarStyle:{middleColor:"#2BA3AD",middleShape:"rectangleMiddle",middlePattern:"solidFill"}},t}function _(){var t=X.call(this,"manualMilestone")||this;return t.style={taskbarStyle:{startColor:"#2BA3AD",startShape:"diamond",startType:"solid",rightText:"finish"}},t}function x(){var t=q.call(this,"durationOnly")||this;return t.style={taskbarStyle:{startColor:"#FFFFFF",startShape:"leftFade",startType:"solid",middleColor:"#74CCD4",middlePattern:"solidFill",middleShape:"rectangleBar",endShape:"rightFade",endType:"solid",endColor:"#FFFFFF"}},t}function D(){var t=J.call(this,"startOnly")||this;return t.style={taskbarStyle:{startColor:"#2BA3AD",startShape:"leftBracket",startType:"solid"}},t}function E(){var t=$.call(this,"finishOnly")||this;return t.style={taskbarStyle:{endShape:"rightBracket",endType:"solid",endColor:"#2BA3AD"}},t}function C(){var t=tt.call(this,"durationOnlyMilestone")||this;return t.style={taskbarStyle:{startColor:"#CED9E8",startShape:"diamond",startType:"solid",rightText:"finishDisplayed"}},t}function F(){var t=nt.call(this,"startOnlyMilestone")||this;return t.style={taskbarStyle:{startColor:"#CED9E8",startShape:"diamond",startType:"solid",rightText:"start"}},t}function N(){var t=it.call(this,"finishOnlyMilestone")||this;return t.style={taskbarStyle:{startColor:"#CED9E8",startShape:"diamond",startType:"solid",rightText:"finish"}},t}function R(t){this.uAi=t,this.uAi.Lmi.attach(this.invalidateTextStates,this),this.qK=new e.Collection([new r,new u,new o,new a,new c,new d,new A,new f,new v,new B,new L,new P,new U,new h,new l]),this.qK.nji.attach(this.onRulesChanged,this)}i=this&&this.__extends||(g=function(t,n){return(g=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}g(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(t,"__esModule",{value:!0}),t.TaskbarStyleManager=t.TaskbarStyleRule=void 0,e=n("./dist/plugins/gantt/utils/foundation.js"),n=n("Common"),s=n.Common.lt.ht,Object.defineProperty(p.prototype,"name",{get:function(){return this.Zc},enumerable:!1,configurable:!0}),Object.defineProperty(p.prototype,"style",{get:function(){return this.RN},set:function(t){this.RN=t,this.tji.invoke()},enumerable:!1,configurable:!0}),p.prototype.match=function(t){return!1},p.prototype.getFromDate=function(t){return t.startDisplayed},p.prototype.getToDate=function(t){return t.finishDisplayed},p.prototype.getScale=function(t){return 1},p.prototype.toJSON=function(){return{name:this.name,style:this.style}},p.prototype.fromJSON=function(t){this.style=t.style},t.TaskbarStyleRule=n=p,i(y,G=n),y.prototype.match=function(t){return t.isNormal&&!t.isManuallyScheduled&&m(t)},r=y,i(w,Q=n),w.prototype.match=function(t){return t.isMilestone&&!t.isManuallyScheduled},w.prototype.getFromDate=function(t){return t.finishDisplayed},u=w,i(j,W=n),j.prototype.match=function(t){return t.isSummary&&0<t.taskNumber&&!t.isManuallyScheduled&&m(t)},o=j,i(T,Y=n),T.prototype.match=function(t){return t.isNormal&&!t.isManuallyScheduled&&0<t.complete||t.bAe},T.prototype.getScale=function(t){return t.complete},h=T,i(O,V=n),O.prototype.match=function(t){return 0===t.taskNumber&&m(t)},a=O,i(k,K=n),k.prototype.match=function(t){return t.isNormal&&t.isManuallyScheduled&&b(t)&&m(t)},c=k,i(S,z=n),S.prototype.match=function(t){return t.isSummary&&0<t.taskNumber&&t.isManuallyScheduled&&b(t)&&m(t)},f=S,i(M,Z=n),M.prototype.match=function(t){return t.isNormal&&t.isManuallyScheduled&&0<t.complete},M.prototype.getToDate=function(t){return t.completeThrough},l=M,i(_,X=n),_.prototype.match=function(t){return t.isMilestone&&t.isManuallyScheduled&&b(t)},_.prototype.getFromDate=function(t){return t.finishDisplayed},d=_,i(x,q=n),x.prototype.match=function(t){return!t.isMilestone&&t.isManuallyScheduled&&et(t)&&m(t)},A=x,i(D,J=n),D.prototype.match=function(t){return!t.isMilestone&&t.isManuallyScheduled&&st(t)},D.prototype.getToDate=function(t){return t.startDisplayed},v=D,i(E,$=n),E.prototype.match=function(t){return!t.isMilestone&&t.isManuallyScheduled&&rt(t)},E.prototype.getFromDate=function(t){return t.finishDisplayed},B=E,i(C,tt=n),C.prototype.match=function(t){return t.isMilestone&&t.isManuallyScheduled&&et(t)},C.prototype.getFromDate=function(t){return t.finishDisplayed},L=C,i(F,nt=n),F.prototype.match=function(t){return t.isMilestone&&t.isManuallyScheduled&&st(t)},F.prototype.getToDate=function(t){return t.startDisplayed},P=F,i(N,it=n),N.prototype.match=function(t){return t.isMilestone&&t.isManuallyScheduled&&rt(t)},N.prototype.getFromDate=function(t){return t.finishDisplayed},U=N,Object.defineProperty(R.prototype,"rules",{get:function(){return this.qK},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"hasTopText",{get:function(){return this.getTextStates().hasTopText},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"hasLeftText",{get:function(){return this.getTextStates().hasLeftText},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"hasBottomText",{get:function(){return this.getTextStates().hasBottomText},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"hasRightText",{get:function(){return this.getTextStates().hasRightText},enumerable:!1,configurable:!0}),Object.defineProperty(R.prototype,"hasInsideText",{get:function(){return this.getTextStates().hasInsideText},enumerable:!1,configurable:!0}),R.prototype.getBarStyleRuleForTask=function(h){var a,t,a=this,t;return this.getMatchedRulesForTask(h).map(function(t){var n,i,e,s,r,u,o,n=t.name,i=t.match,e=t.getFromDate,s=t.getToDate,r=t.getScale,u=h.style?h.style[t.name]:null,o;return{name:n,match:i,getFromDate:e,getToDate:s,getScale:r,style:a.mergeStyle(u,t.style)}})},R.prototype.mergeStyle=function(t,n){return{taskbarStyle:this.mergeCustomToRuleStyle(null==t?void 0:t.taskbarStyle,null==n?void 0:n.taskbarStyle),gridStyle:this.mergeCustomToRuleStyle(null==t?void 0:t.gridStyle,null==n?void 0:n.gridStyle)}},R.prototype.mergeCustomToRuleStyle=function(t,n){var i,e,i=Object.assign({},t||{},n||{});if(!s(t))for(e in t)s(t[e])||(i[e]=t[e]);return i},R.prototype.getMatchedRulesForTask=function(n){return this.rules.all().filter(function(t){return t.match(n)})},R.prototype.onRulesChanged=function(){this.eji=null,this.uAi.Rmi.invoke()},R.prototype.invalidateTextStates=function(){this.eji=null},R.prototype.getTextStates=function(){var t;return s(this.eji)&&(t=this.getAllStyles(),this.eji={hasTopText:t.some(function(t){var t;return!(null==(t=null==t?void 0:t.taskbarStyle)||!t.topText)}),hasBottomText:t.some(function(t){var t;return!(null==(t=null==t?void 0:t.taskbarStyle)||!t.bottomText)}),hasRightText:t.some(function(t){var t;return!(null==(t=null==t?void 0:t.taskbarStyle)||!t.rightText)}),hasLeftText:t.some(function(t){var t;return!(null==(t=null==t?void 0:t.taskbarStyle)||!t.leftText)}),hasInsideText:t.some(function(t){var t;return!(null==(t=null==t?void 0:t.taskbarStyle)||!t.insideText)})}),this.eji},R.prototype.getAllStyles=function(){var n=[];return this.uAi.Vp.forEach(function(t){var t,t,t=t.getBarStyleRules()[0];t&&(t=t.style)&&n.push(t)}),(n=n.concat(this.rules.all().map(function(t){return t.style}))).filter(function(t){return!!t})},t.TaskbarStyleManager=R},"./dist/plugins/gantt/utils/foundation.js":function(t,n,i){var i,e,s,r;function u(){var t=this;this.invoke=function(){var n=arguments;e(t.sji)||t.sji.forEach(function(t){return t.handler.apply(t.target,n)})},this.invokeSome=function(){var n=arguments;return!e(t.sji)&&t.sji.some(function(t){return t.handler.apply(t.target,n)})}}function o(t){this.nji=new s,this.inner=t||[]}Object.defineProperty(n,"__esModule",{value:!0}),n.Collection=n.EventList=void 0,i=i("Common"),e=i.Common.lt.ht,u.prototype.attach=function(t,n){this.sji=this.sji||[],this.sji.push({handler:t,target:n})},u.prototype.detach=function(t){var t;this.sji&&0<=(t=this.sji.map(function(t){return t.handler}).indexOf(t))&&this.sji.splice(t,1)},s=u,n.EventList=s,o.prototype.add=function(t){this.bji(this.inner.length,t)},o.prototype.insert=function(t,n){this.bji(t,n)},o.prototype.remove=function(t){var t=this.getIndexByItem(t);this.mji(t)},o.prototype.removeAt=function(t){this.mji(t)},o.prototype.getItemAt=function(t){return this.inner[t]},o.prototype.getRule=function(t){for(var n,i,e,n=0,i=this.inner;n<i.length;n++)if((e=i[n]).name&&e.name===t)return e;return null},o.prototype.setItemAt=function(t,n){this.yji(t,n)},o.prototype.clear=function(){this.pji()},Object.defineProperty(o.prototype,"length",{get:function(){return this.inner.length},enumerable:!1,configurable:!0}),o.prototype.getIndexByItem=function(t){return this.inner.indexOf(t)},o.prototype.all=function(){return this.inner},o.prototype.bji=function(t,n){this.inner.splice(t,0,n),this.vji()},o.prototype.mji=function(t){this.inner.splice(t,1),this.vji()},o.prototype.pji=function(){this.inner=[],this.vji()},o.prototype.yji=function(t,n){this.inner[t]=n,this.vji()},o.prototype.vji=function(){this.nji.invoke()},o.prototype.toJSON=function(){for(var t,n,i,e,t=[],n=0,i=this.inner;n<i.length;n++)e=i[n],t.push(e.toJSON());return t},o.prototype.fromJSON=function(t){for(var n,i,e,s,n=0,i=t;n<i.length;n++)(e=i[n]).name&&this.getRule(e.name)&&(s=this.getRule(e.name)).fromJSON&&"function"==typeof s.fromJSON&&s.fromJSON(e)},n.Collection=o},"./dist/plugins/gantt/utils/mapping.js":function(t,n,i){var e,s;function r(t){this.project=t}Object.defineProperty(n,"__esModule",{value:!0}),n.GanttMapping=void 0,e=i("./dist/plugins/gantt/utils/util.js"),r.prototype.getDefaultMapping=function(t,n){var i,e,i=this,e=n?n.dateFormat:null;return"taskNumber"===t||"level"===t?[t,null,function(t){return i.parseInt(t)},null]:"name"===t||"predecessors"===t||"successors"===t?[t,null,null,null]:"start"===t||"finish"===t?[t,null,function(t){return i.parseDate(t,e)},null]:"duration"===t?["duration",null,function(t){return i.parseDuration(t)},null]:"mode"===t?[t,null,function(t){return i.parseMode(t)},null]:"isMilestone"===t?["isMilestone",null,function(t){return i.parseBoolean(t)},null]:"complete"===t?["complete",null,function(t){return i.parseFloat(t)},null]:void 0},r.prototype.parseFloat=function(t){return e.ValueHelper.parseNumber(t,!1)},r.prototype.parseInt=function(t){return e.ValueHelper.parseNumber(t,!0)},r.prototype.formatInt=function(t){return e.ValueHelper.formatNumber(t)},r.prototype.parseDate=function(t,n,i){return e.ValueHelper.parseDate(t,n,i)},r.prototype.formatDate=function(t,n,i){return e.ValueHelper.formatDate(t,n,i)},r.prototype.parseDuration=function(t){return this.project.parseDuration(t)},r.prototype.formatDuration=function(t){return this.project.formatDuration(t)},r.prototype.parseBoolean=function(t){return e.ValueHelper.parseBoolean(t,!0)},r.prototype.formatBoolean=function(t){return e.ValueHelper.formatBoolean(t)},r.prototype.parseMode=function(t){return e.ValueHelper.parseStringEnumValues(t,["Auto","Manual"])},r.prototype.formatMode=function(t){return e.ValueHelper.parseStringEnumValues(t,["Auto","Manual"])},n.GanttMapping=r},"./dist/plugins/gantt/utils/util.js":function(t,r,n){var u,o,f,i,l,h,e,s;function a(){}function c(){}u=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var e=0,s=n.length,r;e<s;e++)!r&&e in n||((r=r||Array.prototype.slice.call(n,0,e))[e]=n[e]);return t.concat(r||Array.prototype.slice.call(n))},Object.defineProperty(r,"__esModule",{value:!0}),r.ValueHelper=r.GanttUtil=r.DefaultDateFormatter=void 0,o=n("Common"),f=n("./dist/plugins/gantt/project/dependency.js"),i=n("./dist/plugins/gantt/gantt-sheet.js"),l=o.Common.lt.ht,h=function(t){return isNaN(t.valueOf())},r.DefaultDateFormatter="yyyy/mm/dd hh:mm",a.range=function(t,n){for(var i,e,i=new Array(n),e=0;e<n;e++)i[e]=t+e;return i},a.repeat=function(t,n){for(var i,e,i=new Array(n),e=0;e<n;e++)i[e]=t;return i},a.convertIndexToRange=function(t){var t,n,i,e,s,r,t=u([],t,!0);for(t.sort(function(t,n){return t-n}),n=[],i=null,e=0,s=t;e<s.length;e++)r=s[e],i&&r===i[0]+i[1]?i[1]++:n.push(i=[r,1]);return n},a.encodeHtml=function(t){var n;return t?((n=document.createElement("div")).innerText=t,n.innerHTML):""},a.fixPixelAlignment=function(t,n,i,e){return t%1==0&&(t+=.5),n%1==0&&(n+=.5),{x:t,y:n,w:i=i%1!=0?Math.floor(i):i,h:e=e%1!=0?Math.floor(e):e}},a.getSelectedTasks=function(t){for(var n,i,e,s,r,u,n=[],i=t.getSelections(),e=0;e<i.length;e++)for(r=(s=i[e]).row;r<s.row+s.rowCount;r++)(u=t.getTaskByRow(r))&&n.push(u);return n},a.getSelectedTaskNumbers=function(t){for(var n,i,e,s,r,u,n=[],i=t.getSelections(),e=0;e<i.length;e++)for(r=(s=i[e]).row;r<s.row+s.rowCount;r++)(u=t.getTaskByRow(r))&&n.push(u.taskNumber);return n},a.getSelectedRowIndexes=function(t){for(var n,i,e,s,r,n=[],i=t.getSelections(),e=0;e<i.length;e++)for(r=(s=i[e]).row;r<s.row+s.rowCount;r++)n.push(r);return n},a.getGanttSheet=function(t){var t=t.getActiveSheetTab();if(t&&t instanceof i.GanttSheet)return t},a.lji=function(t){return/^\/OADate\(\d+(\.\d+)?\)\//.test(t)},a.traverseChildren=function(t,n){var t,i,e,s,t=t.children;if(t&&0<t.length)for(i=0,e=t;i<e.length;i++)s=e[i],n&&(n(s),this.traverseChildren(s,n))},r.GanttUtil=a,c.parseBoolean=function(t,n){return"boolean"==typeof t||("string"==typeof t&&(t=this.parseStringEnumValues(t,["true","false"],[!0,!1])),n&&null==t)?t:!!t},c.formatBoolean=function(t){return t?"true":"false"},c.parseNumber=function(t,n){var i=NaN;if("string"==typeof t?i=n?parseInt(t,10):parseFloat(t):"number"==typeof t&&(i=t),!isNaN(i))return i},c.formatNumber=function(t){return"number"!=typeof t||isNaN(t)?void 0:t.toString()},c.parseDate=function(t,n,i){var e,s,e=null;if(t instanceof Date&&(e=t),"string"==typeof t&&(n=n||r.DefaultDateFormatter,e=(s=new o.Formatter.GeneralFormatter(n,i)).parse(t)),e&&e instanceof Date&&!h(e))return e},c.formatDate=function(t,n,i){var e;return!t||isNaN(t.valueOf())?null:(n=n||r.DefaultDateFormatter,new o.Formatter.GeneralFormatter(n,i).format(t))},c.parseString=function(t){return"string"==typeof t?t:l(t)?"":"function"==typeof t.toString?t.toString():void 0},c.parseStringEnumValues=function(t,n,i){var e,s,e=this.parseString(t);if(!l(e))for(s=0;s<n.length;s++)if(e.toLowerCase()===n[s].toLowerCase())return(i||n)[s]},c.compareString=function(t,n,i){var t,n;return void 0===i&&(i=!0),t=this.parseString(t),n=this.parseString(n),i?t.toLowerCase()===n.toLowerCase():t===n},c.compareTaskDependency=function(t,n){var t,n,i,e,s,r,u,o,h,o,a,c,a,h,c,t="string"==typeof t?t:null,n="string"==typeof n?n:null,i=l(t)||0===t.length,e=l(n)||0===n.length;if(i)return e?0:-1;if(e)return 1;for(s=f.TaskDependency.parseText(t),r=f.TaskDependency.parseText(n),u=0;u<Math.max(s.length,r.length);u++){if(l(s[u]))return-1;if(l(r[u]))return 1;if(h=(o=s[u]).taskNumber,o=o.type,c=(a=r[u]).taskNumber,a=a.type,h!==c)return h-c;if((h="FS"===o?"":o)!==(c="FS"===a?"":a))return h<c?-1:1}return 0},r.ValueHelper=c},Common:function(t){t.exports=n.Spread},Core:function(t){t.exports=n.Spread.Sheets},ContextMenu:function(t){t.exports=n.Spread.Sheets.ContextMenu},Filters:function(t){t.exports=n.Spread.Sheets.Filter},FloatingObject:function(t){t.exports=n.Spread.Sheets.FloatingObjects},TableSheet:function(t){t.exports=n.Spread.Sheets.TableSheet}},e={},t=s("./dist/plugins/gantt/gantt.entry.js"),(((n=void 0===n?{}:n).Spread=n.Spread||{}).Sheets=n.Spread.Sheets||{}).GanttSheet=t}()});