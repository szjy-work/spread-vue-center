/*!
 * 
 * SpreadJS Library 17.0.10
 *
 * Copyright(c) GrapeCity Software inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * info.xa@grapecity.com
 * https://www.grapecity.com.cn/developer/spreadjs
 *
 */
!function(t){"object"==typeof module&&"object"==typeof module.exports?module.exports=t(require("@grapecity-software/spread-sheets")):"function"==typeof define&&define.amd?define(["@grapecity-software/spread-sheets"],t):"object"==typeof exports?exports.Spread=t(require("@grapecity-software/spread-sheets")):t(GC)}(function(e){function n(t){var i,i,i=o[t];return void 0!==i||(i=o[t]={exports:{}},r[t].call(i.exports,i,i.exports,n)),i.exports}var r,o,t;r={"./dist/plugins/pivot/lr.gcn.js":function(t,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.wmk2=i.wmk1=void 0,i.wmk1=["6563908988","706e0fc668"],i.wmk2=["6563908988","706e0fc668"]},"./dist/plugins/pivot/pivot-all-entry.js":function(t,i,n){(e=e||{}).Pivot=n("./node_modules_local/@spreadjs/js-pivot/dist/gc.pivot.js"),e.Spread=e.Spread||{},e.Spread.Pivot=n("./dist/plugins/pivot/pivot-table-entry.js"),t.exports=e.Spread.Pivot},"./dist/plugins/pivot/pivot-core/pivot-core-entry.js":function(t,i,n){"use strict";var e,r,e=this&&this.__createBinding||(Object.create?function(t,i,n,e){void 0===e&&(e=n);var r=Object.getOwnPropertyDescriptor(i,n);r&&("get"in r?i.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return i[n]}}),Object.defineProperty(t,e,r)}:function(t,i,n,e){t[e=void 0===e?n:e]=i[n]}),r=this&&this.__exportStar||function(t,i){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(i,n)||e(i,t,n)};Object.defineProperty(i,"__esModule",{value:!0}),r(n("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),i),r(n("./dist/plugins/pivot/pivot-core/pivot-view.js"),i)},"./dist/plugins/pivot/pivot-core/pivot-core-interface.js":function(t,i){"use strict";var n,e,r,o,a,s,u,c,l,f,h,v,d,p,m,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b;Object.defineProperty(i,"__esModule",{value:!0}),i.top10CompareTypeExcel=i.dateCompareTypeExcel=i.valueCompareTypeExcel=i.captionCompareTypeExcel=i.overlapCheck=i.PivotAreaReference=i.PivotPanelLayoutType=i.PivotPanelSection=i.SerializeIndex=i.DisplayFields=i.CalcItemAggregation=i.SubtotalsPosition=i.GrandTotalPosition=i.PivotAreaAxisType=i.PivotAreaType=i.PivotTableLayoutType=i.PivotPanelDirectionEnum=i.PivotChartFieldType=i.PivotTableFieldType=void 0,(b=n=i.PivotTableFieldType||(i.PivotTableFieldType={}))[b.filterField=0]="filterField",b[b.rowField=1]="rowField",b[b.columnField=2]="columnField",b[b.valueField=3]="valueField",(b=e=i.PivotChartFieldType||(i.PivotChartFieldType={}))[b.filterField=0]="filterField",b[b.axisField=1]="axisField",b[b.legendField=2]="legendField",b[b.valueField=3]="valueField",(b=r=i.PivotPanelDirectionEnum||(i.PivotPanelDirectionEnum={}))[b.fieldAndAreaStacked=0]="fieldAndAreaStacked",b[b.fieldAndAreaBySide=1]="fieldAndAreaBySide",b[b.fieldOnly=2]="fieldOnly",b[b.areaOnlyGrid=3]="areaOnlyGrid",b[b.areaOnlyTable=4]="areaOnlyTable",(b=o=i.PivotTableLayoutType||(i.PivotTableLayoutType={}))[b.compact=0]="compact",b[b.outline=1]="outline",b[b.tabular=2]="tabular",(b=a=i.PivotAreaType||(i.PivotAreaType={}))[b.all=0]="all",b[b.button=1]="button",b[b.data=2]="data",b[b.none=3]="none",b[b.normal=4]="normal",b[b.corner=5]="corner",b[b.topEnd=6]="topEnd",b[b.topRight=7]="topRight",(b=s=i.PivotAreaAxisType||(i.PivotAreaAxisType={}))[b.row=0]="row",b[b.col=1]="col",(b=u=i.GrandTotalPosition||(i.GrandTotalPosition={}))[b.none=0]="none",b[b.row=1]="row",b[b.col=2]="col",b[b.both=3]="both",(b=c=i.SubtotalsPosition||(i.SubtotalsPosition={}))[b.none=0]="none",b[b.top=1]="top",b[b.bottom=2]="bottom",(b=l=i.CalcItemAggregation||(i.CalcItemAggregation={}))[b.include=0]="include",b[b.exclude=1]="exclude",(b=f=i.DisplayFields||(i.DisplayFields={}))[b.downThenOver=0]="downThenOver",b[b.overThenDown=1]="overThenDown",(b=h=i.SerializeIndex||(i.SerializeIndex={}))[b.fields=1]="fields",b[b.options=2]="options",b[b.filter=4]="filter",b[b.sort=8]="sort",b[b.layout=16]="layout",b[b.showValueAs=32]="showValueAs",b[b.group=64]="group",b[b.styles=128]="styles",b[b.collapse=256]="collapse",b[b.theme=512]="theme",b[b.position=1024]="position",b[b.showNoData=2048]="showNoData",(b=v=i.PivotPanelSection||(i.PivotPanelSection={}))[b.fields=1]="fields",b[b.area=2]="area",b[b.viewList=4]="viewList",(b=d=i.PivotPanelLayoutType||(i.PivotPanelLayoutType={}))[b.stack=0]="stack",b[b.flow=1]="flow",(b=p=i.PivotAreaReference||(i.PivotAreaReference={}))[b.cellReference=0]="cellReference",b[b.getPivotData=1]="getPivotData",(b=m=i.overlapCheck||(i.overlapCheck={}))[b.pt=1]="pt",b[b.value=2]="value",b[b.table=4]="table",i.captionCompareTypeExcel={captionEqual:0,captionNotEqual:1,captionBeginsWith:2,captionNotBeginsWith:3,captionEndsWith:4,captionNotEndsWith:5,captionContains:6,captionNotContains:7,captionGreaterThan:8,captionGreaterThanOrEqual:9,captionLessThan:10,captionLessThanOrEqual:11,captionBetween:12,captionNotBetween:13},i.valueCompareTypeExcel={valueEqual:0,valueNotEqual:1,valueGreaterThan:2,valueGreaterThanOrEqual:3,valueLessThan:4,valueLessThanOrEqual:5,valueBetween:6,valueNotBetween:7},i.dateCompareTypeExcel={dateEqual:0,dateNotEqual:1,dateOlderThan:2,dateOlderThanOrEqual:3,dateNewerThan:4,dateNewerThanOrEqual:5,dateBetween:6,dateNotBetween:7,tomorrow:10,today:8,yesterday:9,nextWeek:17,thisWeek:15,lastWeek:16,nextMonth:14,thisMonth:12,lastMonth:13,nextQuarter:18,thisQuarter:19,lastQuarter:20,nextYear:21,thisYear:22,lastYear:23,yearToDate:40,Q1:24,Q2:25,Q3:26,Q4:27,M1:28,M2:29,M3:30,M4:31,M5:32,M6:33,M7:34,M8:35,M9:36,M10:37,M11:38,M12:39},i.top10CompareTypeExcel={count:0,percent:1,sum:2}},"./dist/plugins/pivot/pivot-core/pivot-fields-model.js":function(L,w,t){"use strict";var c,E,B,M,g,D,i,u,n,y,b,l,o,m,t,C,n,A,f,N,k,R,G,I,d,T,V,S,U,x,h,j,Q,O,W,z,Z,Y,H,J,q,K,p,v,t;function _(t,n,i){var e,t,e=-1,t=B([],t,!0);return i&&t.splice(i.valuePositionIndex,0,i),(0,M.o)(t,function(t,i){if(-1===e&&t.Zc===n)return e=i,!0}),e}function X(t,n){var e;return(0,M.o)(t,function(t,i){if(t.Zc===n)return e=t,!0}),e}function $(t,n){var e;return(0,M.o)(t,function(t,i){if(t.a===n)return e=t,!0}),e}function e(){this.Pq={}}function r(t,i,n){var e=this;t&&t.textItem&&this.updateLabelTextItem(t.textItem,n.allowMultipleFiltersPerField),t&&t.condition&&this.updateLabelCondition(t.condition,n.allowMultipleFiltersPerField),i&&this.updateValueCondition(i),e.selectMultipleItems=n||{allowMultipleFiltersPerField:!0},e.u=!1}function a(t,i,n,e){var r=this;r.a=i,k(n)?r.Zc=i:r.Zc=n,r.l=t.p(i),r.bbt=e,r.g(t)}function tt(t,i,n,e,r,o,a,s,u,c){var l,f,o,h,v,d,p;return void 0===u&&(u=!1),e&&e.valueFilter&&(l=e.valueFilter),f=1===o||2===o,o=2===o,e&&e.C(u)?(v=void 0,p=d=!1,m(a.A)||k(s)||!k(a.N)||(d=!0,p=a.T instanceof Date),{isDim:f,isHeader:o,sourceName:i,displayName:t,items:(v=d?(p?et:nt)(e,a,s,u):it(e,a,u)).rs,filterItems:v.ds,index:n,isALL:!1,valueFilter:l,sortInfo:r,isShowSubtotalTop:c}):{isDim:f,isHeader:o,sourceName:i,displayName:t,items:h,filterItems:null,index:n,isALL:!0,valueFilter:l,sortInfo:r,isShowSubtotalTop:c}}function it(n,t,e){var r,o,i,a,s,r=[],o=[],i=t.getFieldsItemList(),a=t.M(),s=!m(a);return(0,M.o)(i,function(t){var i=s?a[t]:t;(n.isMatchedLabelItem(t,e)?r:o).push(i)}),{rs:r,ds:o}}function nt(n,e,t,r){var i,o,t,a,s,u,i=[],o=[],t=t.D,a=e.getFieldsItemList(),s={};for(u in(0,M.o)(t,function(t){var i=e.S(t);r||n.evaluateLabelCondition(t+"")?s[i]=!0:!0!==s[i]&&(s[i]=!1)}),(0,M.o)(a,function(t){n.isInLabelFilterItem(t+"")&&s[t]||(s[t]=!1)}),s)(s.hasOwnProperty(u)&&s[u]?i:o).push(u);return{rs:i,ds:o}}function et(n,e,t,r){var i,o,a,s,u,c,l,f,i=[],o=[],a=t.D,s=e.getFieldsItemList(),u=t.k,c=t.P,l={};for(f in(0,M.o)(s,function(t){l[t]=[]}),(0,M.o)(a,function(t){var i=e.S(t);(r||n.evaluateLabelCondition(t+""))&&(l[i]=(0,M.F)(l[i],u[c[t]]))}),(0,M.o)(s,function(t){n.isInLabelFilterItem(t+"")||(l[t].length=0)}),l)l.hasOwnProperty(f)&&(0<l[f].length?i:o).push(l[f]);return{rs:i,ds:o}}function rt(t){var i,t,i={filterType:1};return i.isBottom=-1===t.type?1:0,i.percent=1===t.compareType?1:0,t=t.expected?1:0,k(t)||(i.value=t,i.filterValue=t),i}function ot(t,i){var n,e,r,o,a;if(void 0===i&&(i=!1),!k(t.compareType))return n={filterType:4,filter1:{}},o=r=void 0,6===(e=t.compareType)?(r=5,o=3,n.and=!0):o=r=!i||4!==e&&2!==e?e:a=4===e?2:4,n.filter1.operator=r,t.item1&&!k(t.item1.expected)&&(n.filter1.value=t.item1.expected),t.item2&&!k(t.item2.expected)&&(n.filter2={},n.filter2.operator=o,n.filter2.value=t.item2.expected),n}function at(t){var i,n,e;if(k(t.value1)?k(t.item1)||(i=t.item1.expected):i=t.value1,k(t.value2)?k(t.item2)||(n=t.item2.expected):n=t.value2,n)return 12===t.compareType?{filterType:4,filter1:{operator:3,value:i},filter2:{operator:5,value:n}}:13===t.compareType?{filterType:4,filter1:{operator:4,value:i},filter2:{operator:2,value:n}}:void 0;switch(e=-1,t.compareType){case 0:return{filterType:3,filter:[i]};case 1:e=1;break;case 2:i+="*";break;case 3:e=1,i+="*";break;case 4:i="*"+i;break;case 5:e=1,i="*"+i;break;case 6:i="*"+i+"*";break;case 7:e=1,i="*"+i+"*";break;case 8:e=2;break;case 9:e=5;break;case 10:e=4;break;case 11:e=3}return{filterType:4,filter1:{operator:e,value:i}}}function st(t){var i,n,e,r,o,a,s,a,s,a,s,i=new Date,n=i.getDay(),e=i.getDate(),r=new Date(i),o=new Date(i);switch(t){case 11:r.setDate(e-6);break;case 9:r.setDate(e-1);break;case 8:break;case 10:r.setDate(e+1);break;case 16:r.setDate(e-n-7),o.setDate(e-n-1);break;case 15:r.setDate(e-n),o.setDate(e-n+6);break;case 17:r.setDate(e-n+7),o.setDate(e-n+13);break;case 13:r.setDate(1),r.setMonth(r.getMonth()-1),o.setDate(0);break;case 12:r.setDate(1),o.setMonth(o.getMonth()+1),o.setDate(0);break;case 14:r.setDate(1),r.setMonth(r.getMonth()+1),o.setMonth(o.getMonth()+2),o.setDate(0);break;case 18:s=3+(a=r.getMonth()-r.getMonth()%3+1+3)+3,r.setDate(1),r.setMonth(a),o.setMonth(s),o.setDate(0);break;case 19:s=3+(a=r.getMonth()-r.getMonth()%3+1),r.setDate(1),r.setMonth(a),o.setMonth(s),o.setDate(0);break;case 20:s=3+(a=r.getMonth()-r.getMonth()%3+1-3),r.setDate(1),r.setMonth(a),o.setMonth(s),o.setDate(0);break;case 21:r.setDate(1),r.setMonth(1),r.setFullYear(r.getFullYear()+1),o.setFullYear(o.getFullYear()+2),o.setMonth(0),o.setDate(0);break;case 22:r.setDate(1),r.setMonth(1),o.setFullYear(o.getFullYear()+1),o.setMonth(0),o.setDate(0);break;case 23:r.setDate(1),r.setMonth(1),r.setMonth(r.getFullYear()-1),o.setMonth(0),o.setDate(0);break;case 40:r.setMonth(0,1),r.setHours(0,0,0,0),o.setHours(23,59,59,999)}return r.setHours(0),r.setMinutes(0),r.setSeconds(0),o.setHours(23),o.setMinutes(59),o.setSeconds(59),{from:l.o0(r),to:l.o0(o)}}function ut(t,i){var n,e,r,n=k(t.compareType)?t.operator:t.compareType;if(8<=n&&n<=23||40===n)e={filterType:2,type:i},(r=st(n)).from&&r.to&&(e.value=r.from,e.maxValue=r.to);else if(24<=n&&n<=39)e={filterType:2,type:i};else if(0<=n&&n<=7)return ot(t,!0);return e}function ct(t,i){var n=t.conType;return 3===n?rt(t):2===n?ot(t):0===n?at(t):1===n?ut(t,i):void 0}function lt(t,o){var i,n,a,u,i={n_:"autoFilter",ref:"A1"},a=[];return t&&(t.forEach(function(t){var i,n,e,t,r;t&&(e={},t=ct(n=(i=t.conditions)[0],o),k(t)||(1===(r=t.filterType)?e.top10=t:2===r?e.dynamicFilter=t:4===r?e.customFilters=t:3===r&&(e.filters=t)),a.push(e))}),u=[],a.forEach(function(t){var i,n,e,r,o,o,e,a,r,o,s,i={n_:"filterColumn",colId:0};k(t.hiddenButton)||(i.hiddenButton=t.hiddenButton?1:0),(t.colorFilter||t.top10||t.filters||t.dynamicFilter||t.customFilters)&&(i.c_=[],n=void 0,k(t.top10)?k(t.dynamicFilter)?k(t.customFilters)?k(t.filters)||(n={n_:"filters"},(o=t.filters).blank&&(n.blank=1),k(o.dateGroupItem)&&k(o.filter)||(s=n.c_=[]),o.filter&&o.filter.forEach(function(t){D.StringEx.Xi(t)||s.push({n_:"filter",val:h(t)})}),o.dateGroupItem&&o.dateGroupItem.forEach(function(t){var i={n_:"dateGroupItem"};0<t.year&&(i.year=t.year),0<=t.month&&t.month<12&&(i.month=t.month),0<t.day&&t.day<32&&(i.day=t.day),t.hour<24&&(i.hour=t.hour),t.minute<60&&(i.minute=t.minute),t.second<60&&(i.second=t.second),i.dateTimeGrouping=t.day,s.push(i)}),i.c_.push(n)):(o=t.customFilters,k(o.filter1)&&k(o.filter2)||(n={n_:"customFilters"},o.and&&(n.and=1),e=void 0,k(o.filter1)&&k(o.filter2)||(e=n.c_=[]),k(o.filter1)||(a={n_:"customFilter"},"none"!==(r=y.PivotComparisonOperators[o.filter1.operator])&&(a.operator=r),a.val=o.filter1.value+"",e.push(a)),k(o.filter2)||(a={n_:"customFilter"},"none"!==(r=y.PivotComparisonOperators[o.filter2.operator])&&(a.operator=r),a.val=o.filter2.value+"",e.push(a)),i.c_.push(n))):(r=t.dynamicFilter,k(r.type)||(n={n_:"dynamicFilter"},(o=r.type)&&(n.type=o),k(r.value)||(n.val=r.value),k(r.maxValue)||(n.maxVal=r.maxValue),i.c_.push(n))):(n={n_:"top10"},(e=t.top10).isBottom&&(n.top="0"),e.percent&&(n.percent="1"),isNaN(e.value)||(n.val=e.value+""),isNaN(e.filterVal)||(n.filterVal=e.filterVal+""),i.c_.push(n))),u.push(i)}),i.c_=u),i}function F(t,i,n,e){var r,t,r=this;r.Zc=t,r.L=i,r.Ti=n,r.Qy=e,r.B=[],r.R=[],r.G=[],r.Q=[],r.z=[],r.Z={},r.nrt={},r.Y=[],r.H={allowMultipleFiltersPerField:!0},r.K=new K,r.X={},t=r.Ti&&r.Ti.getPivotCacheByName(i),r.si=t&&t.getAllFieldsNames(),F.et(r,"init")}function ft(t){switch(t){case"average":return M.SubtotalType.average;case"count":return M.SubtotalType.count;case"countNums":return M.SubtotalType.countNums;case"max":return M.SubtotalType.max;case"min":return M.SubtotalType.min;case"product":return M.SubtotalType.product;case"stdDev":return M.SubtotalType.stdDev;case"stdDevp":return M.SubtotalType.stdDevp;case"var":return M.SubtotalType.varr;case"varp":return M.SubtotalType.varp;default:return M.SubtotalType.sum}}function ht(t){switch(t){case M.SubtotalType.average:return"average";case M.SubtotalType.count:return"count";case M.SubtotalType.countNums:return"countNums";case M.SubtotalType.max:return"max";case M.SubtotalType.min:return"min";case M.SubtotalType.product:return"product";case M.SubtotalType.stdDev:return"stdDev";case M.SubtotalType.stdDevp:return"stdDevp";case M.SubtotalType.varr:return"var";case M.SubtotalType.varp:return"varp";default:return"sum"}}function vt(t){return-1<t.indexOf("caption")&&!k(g.captionCompareTypeExcel[t])?{conType:0,compareType:g.captionCompareTypeExcel[t]}:-1<t.indexOf("value")&&!k(g.valueCompareTypeExcel[t])?{conType:2,compareType:g.valueCompareTypeExcel[t]}:k(g.dateCompareTypeExcel[t])?k(g.top10CompareTypeExcel[t])?void 0:{conType:3,compareType:g.top10CompareTypeExcel[t]}:{conType:1,compareType:g.dateCompareTypeExcel[t]}}function dt(t){return!t||" "===t}function pt(t,i){return!k(i.Z[t])&&3!==i.Z[t]}function mt(t,i){var n,e,e,e,e,t,t,n={filter:[]};return n.blank=t.blank,(e=t.c_)[0]?(e=x(e[0].val),s(i.conType,0,e,n.blank)):(n.dateGroupItem=[],(e=[].concat(t.dateGroupItem))[0]?(t=e[0],(e={}).day=T(t.day,1),e.hour=T(t.hour,0),e.minute=T(t.minute,0),e.month=T(t.month,0),e.second=T(t.second,0),e.year=T(t.year,0),t=new Date(e.year,0<e.month?e.month-1:e.month,e.day,e.hour,e.minute,e.second),s(i.conType,0,t,!n.blank)):void 0)}function bt(t,i){var n,e,e,t,t,n={},e=t.and;return dt(e)||(n.and="1"===e),0<(e=t.c_).length&&((t=n.filter1={}).operator=e[0].operator,t.value=e[0].val),1<e.length&&((t=n.filter2={}).operator=e[1].operator,t.value=e[1].val),yt(n,i)}function gt(t,i){var n,e,t,n={};return n.type=Z[t.type],e=t.val,t=t.maxVal,dt(e)||(n.value=e),dt(t)||(n.maxValue=t),Ct(n,i)}function wt(t,i){var n={};return n.value=V(t.val,NaN),n.percent=d(t.percent,!1),n.top=d(t.top,!0),At(n,i)}function s(t,i,n,e,r,o,a,s,u,c){var l={};return l.conType=t,k(i)||(l.compareType=i),k(n)||(l.expected=n),k(e)||(l.ignoreBlank=e),k(r)||(l.type=r),k(o)||(l.isPercent=o),k(a)||(l.item1=a),k(s)||(l.item2=s),k(u)||(l.ranges=u),k(c)||(l.expectTypeId=c),2===t&&(l.ignoreCase=!0),l}function yt(t,r){function i(t){var i,t,n,e,t=t.value,n=t.indexOf("*"),e=t.lastIndexOf("*");return-1!==n?i=n===t.length-1&&0!==n?s(r.conType,r.compareType,t.substring(0,t.length-1)):0===n&&n===e?s(r.conType,r.compareType,t.substring(1)):(-1!==n&&-1!==e&&(t=t.substr(1,t.length-2)),s(r.conType,r.compareType,t)):k(r)||(i=s(r.conType,r.compareType,t)),i}var n;return t.filter1&&(n=i(t.filter1)),n=t.filter2?s(r.conType,r.compareType,o,o,o,o,n,i(t.filter2)):s(r.conType,r.compareType,o,o,o,o,n,o)}function Ct(t,i){var n,e,e;return n=1===i.conType?s(1,i.compareType,o):n}function At(t,i){var n=t.top?1:-1;return s(3,i.compareType,t.value,o,n,t.percent)}function P(t,i,n){for(var e,r,o,e=0;e<i.length;e++)(o=(r=i[e]).nrt)&&n(o)&&t.setSortInfo(r.Zc,I)}function Nt(a,s,u,c){for(var l,l,l,t,i,t=function(t){var t,i,n,i,i,e,r,n,i,o,t=a[t];return t.rpi&&(n=(i=t.rpi).sortType,i=i.pivotArea,i=c?u.excelPivotAreaSJSToSheetPivotArea(i):u.excelPivotAreaToSheetPivotArea(i),e=s.getFieldInfoByName(null==(l=null==(l=null==(l=i.references)?void 0:l[0])?void 0:l.items)?void 0:l[0]))?(r=2===s.Z[t.Zc],n={sortType:n,sortValueFieldName:e.Zc},1<i.references.length&&(i=i.references.slice(1),o=(r?s.B:s.R).map(function(t){return t.Zc}),i.sort(function(t,i){return o.indexOf(t.fieldName)-o.indexOf(i.fieldName)}),n.sortByPivotReferences=i.map(function(t){return{fieldName:s.X[t.fieldName],items:t.items}})),n.sortByHeader=r,n.cacheName=e.a,n.sortValueSubtotalText=M.SubtotalType[e.Ar],t.setSortInfo(n),void(s.nrt[t.Zc]=n)):"continue"},i=0;i<a.length;i++)t(i)}function It(t,i){var n,t,n={references:[{fieldName:C().Values,items:[t.sortValueFieldName]}]};return t.sortByPivotReferences&&0<t.sortByPivotReferences.length&&(t=t.sortByPivotReferences.map(function(t){return{fieldName:i.getFieldNameBySourceName(t.fieldName),items:t.items}}),n.references=n.references.concat(t)),n}function Tt(t,i){for(var n,e,n=t.sortByPivotReferences,e=0;e<n.length;e++)if(n[e].fieldName!==i[e])return}function St(t){return t&&(t.sumSubtotal=I,t.avgSubtotal=I,t.maxSubtotal=I,t.minSubtotal=I,t.varSubtotal=I,t.varPSubtotal=I,t.countSubtotal=I,t.countASubtotal=I,t.stdDevSubtotal=I,t.stdDevPSubtotal=I,t.productSubtotal=I),t}c=this&&this.__assign||function(){return(c=Object.assign||function(t){for(var i,n,e,r,n=1,e=arguments.length;n<e;n++)for(r in i=arguments[n])Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r]);return t}).apply(this,arguments)},E=this&&this.__rest||function(t,i){var n,e,r,n={};for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&i.indexOf(e)<0&&(n[e]=t[e]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols)for(r=0,e=Object.getOwnPropertySymbols(t);r<e.length;r++)i.indexOf(e[r])<0&&Object.prototype.propertyIsEnumerable.call(t,e[r])&&(n[e[r]]=t[e[r]]);return n},B=this&&this.__spreadArray||function(t,i,n){if(n||2===arguments.length)for(var e=0,r=i.length,o;e<r;e++)!o&&e in i||((o=o||Array.prototype.slice.call(i,0,e))[e]=i[e]);return t.concat(o||Array.prototype.slice.call(i))},Object.defineProperty(w,"__esModule",{value:!0}),w.PivotFieldsModel=w.getPivotDateExConditionRange=w.getCellValuePivotFilter=w.toPivotViewQueryField=w.PivotViewField=w.PivotViewFilter=w.PivotViewFilterManager=w.in=w.Caption_Compare_Type_Excel=w.throwError=void 0,M=t("Pivot"),g=t("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),D=t("Core"),i=t("@spreadjs/js-sheets-common"),u=t("./dist/plugins/pivot/pivot-table/pivot-table.js"),n=t("./dist/plugins/pivot/pivot.ns.js"),y=t("./dist/plugins/pivot/pivot-util.js"),b=i.Common.kh,l=i.Common.ct,o=null,m=D.GC$.isEmptyObject,t=new i.Common.ResourceManager(n.SR,"PivotTables"),C=t.getResource.bind(t),n=i.Common.ct,A=n.o0,f=n.Y0,N=null,k=i.Common.lt.ht,R=Math.min,G=Math.max,I=void 0,d=D.NodeHelper.ur,T=D.NodeHelper.sr,V=D.NodeHelper.ar,S=D.Util.io,U=D.Util.pr,x=D.mt.n1,h=D.mt.vo,j=D.mt.xr,Q=D.mt.f1,O=D.mt.xr,W=D.mt.go,w.throwError=z=function(t){throw new Error(t)},Z={null:-1,aboveAverage:100,belowAverage:101,tomorrow:2,today:0,yesterday:1,nextWeek:9,thisWeek:7,lastWeek:8,nextMonth:6,thisMonth:4,lastMonth:5,nextQuarter:10,thisQuarter:11,lastQuarter:12,nextYear:13,thisYear:14,lastYear:15,yearToDate:16,Q1:17,Q2:18,Q3:19,Q4:20,M1:21,M2:22,M3:23,M4:24,M5:25,M6:26,M7:27,M8:28,M9:29,M10:30,M11:31,M12:32},Y=function(t){var i,n,n,e,r,o,i,e=N,r=t.autoFilter&&t.autoFilter.filterItemMap&&t.autoFilter.filterItemMap[0]&&t.autoFilter.filterItemMap[0].conditions&&t.autoFilter.filterItemMap[0].conditions[0];if(r){switch(r.conType){case 0:r.item1||r.item2?(o=(i=[r.item1&&r.item1.expected,r.item2&&r.item2.expected])[0],i=i[1]):o=r.expected,e={conType:M.PivotConditionType.caption,operator:r.compareType,val:[o,i]};break;case 1:i=(n=[r.item1&&r.item1.expected,r.item2&&r.item2.expected])[1],!(o=n[0])||o instanceof Date||(o=f(o)),!i||i instanceof Date||(i=f(i)),e={conType:M.PivotConditionType.date,val:[o,i],operator:r.compareType,isWholeDay:r.isWholeDay},r.compareType===M.PivotDateFilterOperator.dateToDate&&(e.isParallel=r.isParallel,e.isDynamicEndDate=r.isDynamicEndDate,e.by=r.by);break;case 3:e={conType:M.PivotConditionType.top10,val:r.expected,type:r.compareType,operator:r.type};break;case 2:o=(n=[r.item1&&r.item1.expected,r.item2&&r.item2.expected])[0],i=n[1],e={conType:M.PivotConditionType.value,val:r.expected?[r.expected]:[o,i],operator:r.compareType}}return e}},H=function(t,i){var n,n,n,t,e,t,r,o,a,s,t,u,c,l,t=j(t,"autoFilter");if(t){switch(r=void 0,(t=(e=W(t,"filterColumn"))[0])&&(o=O(t,"filters"),a=O(t,"customFilters"),s=O(t,"dynamicFilter"),t=O(t,"top10"),o?r=mt(o,i):a?r=bt(a,i):s?r=gt(s,i):t&&(r=wt(t,i))),u=N,l=c=void 0,i.conType){case 0:r.item1||r.item2?(c=(n=[r.item1&&r.item1.expected,r.item2&&r.item2.expected])[0],l=n[1]):c=r.expected,u={conType:M.PivotConditionType.caption,operator:r.compareType,val:[c,l]};break;case 1:l=(n=[r.item1&&r.item1.expected,r.item2&&r.item2.expected])[1],!(c=n[0])||c instanceof Date||(c=f(c)),!l||l instanceof Date||(l=f(l)),u={conType:M.PivotConditionType.date,val:[c,l],operator:r.compareType,isWholeDay:r.isWholeDay},r.compareType===M.PivotDateFilterOperator.dateToDate&&(u.isParallel=r.isParallel,u.isDynamicEndDate=r.isDynamicEndDate,u.by=r.by);break;case 3:u={conType:M.PivotConditionType.top10,val:r.expected,type:r.compareType,operator:r.type};break;case 2:c=(n=[r.item1&&r.item1.expected,r.item2&&r.item2.expected])[0],l=n[1],u={conType:M.PivotConditionType.value,val:r.expected?[r.expected]:[c,l],operator:r.compareType}}return u}},J=function(t){var i,n,e,n,e,n,e,n,e,n,i=N;switch(t.conType){case M.PivotConditionType.caption:e=(n=t.val)[0],n=n[1],i=new M.PivotFilterCaptionCondition(t.operator,e,n);break;case M.PivotConditionType.date:n=(e=t.val)[0],e=e[1],i=t.operator===M.PivotDateFilterOperator.dateToDate?new M.PivotFilterDateCondition(t.operator,t.isWholeDay,n,e,t.isDynamicEndDate,t.isParallel,t.by):new M.PivotFilterDateCondition(t.operator,t.isWholeDay,n,e);break;case M.PivotConditionType.top10:i=new M.PivotFilterTop10Condition(t.operator,t.type,t.val);break;case M.PivotConditionType.value:e=(n=t.val)[0],n=n[1],i=new M.PivotFilterValueCondition(t.operator,e,n)}return i},q=["difference","index","normal","percent","percentDiff","percentOfCol","percentOfRow","percentOfTotal","runTotal"],w.Caption_Compare_Type_Excel=[["captionEqual","captionNotEqual","captionBeginsWith","captionNotBeginsWith","captionEndsWith","captionNotEndsWith","captionContains","captionNotContains","captionGreaterThan","captionGreaterThanOrEqual","captionLessThan","captionLessThanOrEqual","captionBetween","captionNotBetween"],["dateEqual","dateNotEqual","dateOlderThan","dateOlderThanOrEqual","dateNewerThan","dateNewerThanOrEqual","dateBetween","dateNotBetween","today","yesterday","tomorrow",I,"thisMonth","lastMonth","nextMonth","thisWeek","lastWeek","nextWeek","nextQuarter","thisQuarter","lastQuarter","nextYear","thisYear","lastYear","Q1","Q2","Q3","Q4","M1","M2","M3","M4","M5","M6","M7","M8","M9","M10","M11","M12","yearToDate"],["valueEqual","valueNotEqual","valueGreaterThan","valueGreaterThanOrEqual","valueLessThan","valueLessThanOrEqual","valueBetween","valueNotBetwee"],["count","percent","sum"]],w.in=_,e.prototype.add=function(t,i){!this.get(t)&&i&&(this.Pq[t]=i)},e.prototype.get=function(t){return this.Pq[t]},e.prototype.set=function(t,i,n){var e=this.get(t);!k(n)&&k(i)?(k(e)&&(e={}),1===n?e.labelFilter=N:2===n?e.valueFilter=N:this.remove(t)):e=i,e&&k(e.labelFilter)&&k(e.valueFilter)&&this.remove(t)},e.prototype.isFilter=function(t){var t=this.get(t);return!!t&&(t.C()||t.on())},e.prototype.remove=function(t){this.get(t)&&delete this.Pq[t]},e.prototype.dispose=function(){for(var t,i,n,e,t=0,i=Object.keys(this.Pq);t<i.length;t++)n=i[t],(e=this.Pq[n]).L0()},K=e,w.PivotViewFilterManager=K,r.prototype.C=function(t){var i,n=this.labelFilter;if(n){if(n.textItem&&!n.textItem.isAll)return!0;if(!t&&n.condition)return!0}return!1},r.prototype.getSlicerItemInfo=function(){var t,i,n,e,r,t=this.selectMultipleItems,i=this.labelFilter,n=!1,e="";return i&&i.textItem&&i.textItem.list&&(1===(r=i.textItem.list.length)?e=i.textItem.list[0]:1<r&&(n=!0)),{selectMultipleItems:t.allowMultipleFiltersPerField,hasMoreThanOneSelect:n,text:e}},r.prototype.on=function(){return!!this.valueFilter},r.prototype.evaluateLabelCondition=function(t){var i,n,e,i=this;return!i.labelFilter||!i.labelFilter.condition||(e=t,(n=i.labelFilter.condition).sn===M.PivotConditionType.date&&(e=(0,M.parseStringToDate)(t)||t),i.labelFilter.condition.evaluate(e))},r.prototype.isInLabelFilterItem=function(t){var i=this;return!i.labelFilter||!i.labelFilter.textItem||-1<i.labelFilter.textItem.list.indexOf(t)},r.prototype.updateLabelCondition=function(t,i){var n=this;k(n.labelFilter)&&(n.labelFilter={}),k(t)?n.labelFilter.condition=N:n.labelFilter.condition=J(t),i||(n.labelFilter.textItem=N),n.u=!0},r.prototype.updateLabelTextItem=function(t,i){var n=this;k(n.labelFilter)&&(n.labelFilter={}),k(t)||(n.labelFilter.textItem=t),i||(n.labelFilter.condition=N),n.u=!0},r.prototype.updateValueCondition=function(t){var i=this;k(i.valueFilter)&&(i.valueFilter={}),i.valueFilter.condition=J(t.condition),i.valueFilter.conditionByName=t.conditionByName},r.prototype.isMatchedLabelItem=function(t,i){return(i||this.evaluateLabelCondition(t+""))&&this.isInLabelFilterItem(t)},r.prototype.L0=function(){var t=this;t.labelFilter=N,t.valueFilter=N,t.selectMultipleItems=N},p=r,w.PivotViewFilter=p,a.prototype.ln=function(t){this.g(t)},a.prototype.g=function(t){var i,n,e,e,i=this,n=i.a,e=t.fn(n);i.DV=e.startValue,i.mn=e.endValue,i.lp=t.kn(n),i.ie=t.Le(n),e=t.tr(n),i.W5=t.hr(n),i._items=i.br(t.yr(n),e)},a.prototype.br=function(t,i){for(var n,e,r,o,a,s,n,e=[],r=this.ie,a=0;a<t.length;a++)s=a,o=!1,r&&0<r.length&&(s=r[t[a]]),i&&i[t[a]]&&(o=!0),e.push({indexValue:s,value:t[a],calculatedMember:o});return e},a.prototype.getSubTotalType=function(){return this.Ar},a.prototype.setSubTotalType=function(t){this.Ar!==t&&(this.Ar=t)},a.prototype.getSortInfo=function(){return this.nrt},a.prototype.setSortInfo=function(t){this.nrt=t,this.kr=t&&t.sortType},a.prototype.toPivotViewSubTotalFields=function(){var t,i,n,t=N;return this.Or&&(i=this.a,n=E(this.Or,[]),t=c({subtotalType:this.Ar,cacheName:i,fieldName:this.Zc},n)),{subTotalType:this.Ar,cacheName:this.a,valueFieldName:this.Zc,index:this.lp,showDataAs:t}},a.prototype.toPivotViewQueryField=function(t,i,n,e,r){return tt(this.Zc,this.a,this.lp,t,this.nrt,i,n,e,r,this.Spi)},a.prototype.Br=function(t){},a.prototype.do=function(t){switch(t){case g.PivotTableFieldType.rowField:return"axisRow";case g.PivotTableFieldType.columnField:return"axisCol";case g.PivotTableFieldType.filterField:return"axisPage";case g.PivotTableFieldType.valueField:return"axisValues"}},a.prototype.ea=function(t){for(var i,n,e,r,i,n=this._items,e=0;e<n.length;e++)if((r=n[e])&&r.indexValue===t)return r},a.prototype.es=function(t){for(var i,n,e,r,i,n=this._items,e=0;e<n.length;e++)if((r=n[e])&&r.value===t)return r},a.prototype.cs=function(t,i){for(var n,e,r,o,n,e=i||this._items,r=0;r<e.length;r++)if((o=e[r])&&o.value===t)return r},a.prototype.gs=function(t,i,n,e){for(var r,o,a,s,u,c,l,f,f,h,v,r=this,o=[],a=!1,s=t.length,u=[],c=0;c<s;c++)f=(l=t[c]).indexValue,k(f)||(f=r.ea(f),k(f))||(k(l.childItems)||(f.childItems=l.childItems),k(l.expanded)||(f.expanded=l.expanded),k(l.drillAcross)||(f.drillAcross=l.drillAcross),k(l.calculatedMember)||(f.calculatedMember=l.calculatedMember),!0===l.hidden?a=!0:o.push(f.value),k(l.missing)||(f.missing=l.missing),k(l.caption)||(f.caption=l.caption),k(l.character)||(f.character=l.character),!0===l.collapse&&n.setCollapse(i,f.value,!0),k(l.type)||(f.type=l.type),u.push(f));r._items=u,a&&(h=n.getFilterInfo(r.a),k(h)&&(h=new p(N,N,n.H),n.K.add(r.a,h)),h.updateLabelTextItem(v={isAll:!1,list:o},n.H.allowMultipleFiltersPerField),n.K.set(r.a,h))},a.prototype.Bs=function(t,i,n,e){for(var r,o,a,s,u,c,l,f,f,h,v,r=this,o=[],a=!1,s=+t.count,u=[],c=0;c<s;c++)l=t.c_[c],f=T(l.x),k(f)||(f=r.ea(f),k(f))||(k(l.c)||(f.childItems=d(l.c)),k(l.d)||(f.expanded=d(l.d)),k(l.e)||(f.drillAcross=d(l.e)),k(l.f)||(f.calculatedMember=d(l.f)),!0===d(l.h)?a=!0:o.push(f.value),k(l.m)||(f.missing=d(l.m)),k(l.n)||(f.caption=l.n),k(l.s)||(f.character=d(l.s)),!1===d(l.sd)&&n.setCollapse(i,f.value,!0),k(l.t)||(f.type=l.t),u.push(f));r._items=u,a&&(h=n.getFilterInfo(r.a),k(h)&&(h=new p(N,N,n.H),n.K.add(r.a,h)),h.updateLabelTextItem(v={isAll:!1,list:o},n.H.allowMultipleFiltersPerField),n.K.set(r.a,h))},a.prototype.fromJson=function(t,i){var n,e,r,o,o,a,s,u,n=this;n.cft=St(t),k(t.name)||(n.Zc=t.name),r=(e=i.Ti.getPivotCacheByName(i.L)).getField(n.a),k(t.items)||(o=r&&2===r.W5&&!k(r.Rs),n.gs(t.items,n.Zc,i,o)),k(t.sortType)||(o=t.sortType,a={},s=t.autoSortScope,u=void 0,"ascending"===o?u=M.SortType.asc:"descending"===o&&(u=M.SortType.desc),s?n.rpi={sortType:u,pivotArea:s}:(a.sortType=u,n.nrt=a,n.kr=a.sortType)),k(t.fld)||(n.lp=t.fld),k(t.baseField)||(n.baseField=t.baseField),k(t.measureFilter)||(n.nc=t.measureFilter),k(t.numberFormat)||(n.bbt=t.numberFormat),k(t.showAll)||(n.rc=t.showAll,i.ac[r.Zc]=n.rc)},a.prototype.yh=function(t,i,n){var e,r,o,a,s,r,s,u,c,r,u,r,c,s,e=this;e.sc=St(i),k(i.name)||(e.Zc=S(x(i.name))),r=O(i,"items")||[],s=(a=(o=n.Ti.getPivotCacheByName(n.L)).getField(e.a))&&2===a.W5&&!k(a.Rs),e.Bs(r,e.Zc,n,s),k(i.sortType)||(r=i.sortType,s={},u=j(i,"autoSortScope"),c=void 0,"ascending"===r?c=M.SortType.asc:"descending"===r&&(c=M.SortType.desc),u?(r=W(u,"pivotArea"))&&0<r.length&&(e.rpi={sortType:c,pivotArea:r[0]}):(s.sortType=c,e.nrt=s,e.kr=s.sortType)),k(i.fld)||(e.lp=+i.fld),k(i.baseField)||(e.baseField=T(i.baseField)),k(i.measureFilter)||(e.nc=d(i.measureFilter)),u=d(i.showAll,!0),e.rc=n.ac[a.Zc]=u,(s=(c=(r=O(i,"extLst"))&&O(r,"ext"))&&O(c,"pivotField"))&&s.fillDownLabels&&(t.options.fillDownLabels=d(s.fillDownLabels))},a.prototype.cc=function(t,i,n,e,r,o,a){var s,u,c,l,f,h,v,s,u=a||this._items,c=[],l=0;for(e&&r&&u&&u[0]&&u[0].value!=="<"+(0,y.formatDateToString)(r)&&(c.push({indexValue:0}),l=1),f=0;f<u.length;f++)h=u[f],v={},k(h)||(k(h.childItems)||(v.childItems=h.childItems),k(h.expanded)||(v.expanded=h.expanded),k(h.drillAcross)||(v.drillAcross=h.drillAcross),k(h.calculatedMember)||(v.calculatedMember=h.calculatedMember),!0===n[h.value]&&(v.hidden=!0),k(h.missing)||(v.missing=h.missing),k(h.caption)||(v.caption=h.caption),k(h.character)||(v.character=h.character),i&&!0===i[h.value]&&(v.collapse=!0),k(h.type)||(v.type=h.type),k(h.indexValue)||(v.indexValue=e?h.indexValue+l:h.indexValue),c.push(v));return e&&o&&u&&u[u.length-1]&&u[u.length-1].value!==">"+(0,y.formatDateToString)(o)&&c.push({indexValue:c.length}),t&&c.push({type:"default"}),c},a.prototype.mc=function(t,i,n,e,r,o,a){var s,u,c,l,f,h,v,s,u=a||this._items,c=[],l=0;for(e&&r&&u&&u[0]&&u[0].value!=="<"+(0,y.formatDateToString)(r)&&(c.push({n_:"item",x:0}),l=1),f=0;f<u.length;f++)h=u[f],v={n_:"item"},k(h)||(h.childItems&&(v.c="1"),!1===h.expanded&&(v.d="0"),!1===h.drillAcross&&(v.e="0"),h.calculatedMember&&(v.f="1"),!0===n[h.value]&&(v.h="1"),h.missing&&(v.m="1"),k(h.caption)||(v.n=h.caption),h.character&&(v.s="1"),i&&!0===i[h.value]&&(v.sd="0"),k(h.type)||(v.t=h.type),k(h.indexValue)||(v.x=e?h.indexValue+l:h.indexValue),c.push(v));return e&&o&&u&&u[u.length-1]&&u[u.length-1].value!==">"+(0,y.formatDateToString)(o)&&c.push({n_:"item",x:c.length}),t&&c.push({n_:"item",t:"default"}),c},a.prototype.tl=function(t){var i,t,n,e,r,o,a,s,u,i,t=t.bl(this.a),n=t&&t.sf();if(n)for(s in e=[],r=t.sh,o=t.getFieldsItemList(),a=0,n)n.hasOwnProperty(s)&&(e[u=n[s]]={indexValue:a,value:o[s],calculatedMember:!!r[o[s]]},a+=1);return e},a.prototype.toJson=function(t){var i,n,e,r,e,e,e,e,e,o,e,a,s,u,c,r,i=this,n=i.cft||{},e=t.layoutType(),r=t.dh;switch(e){case g.PivotTableLayoutType.outline:n.compact=!1,delete n.outline;break;case g.PivotTableLayoutType.tabular:n.compact=!1,n.outline=!1;break;case g.PivotTableLayoutType.compact:delete n.outline,delete n.compact}if(e=t.dh,n.axis=i.do(e.Z[i.Zc]),k(t.options.subTotalsPosition)||(n.defaultSubtotal=t.options.subTotalsPosition!==g.SubtotalsPosition.none&&I),n.insertBlankRow=t.options.insertBlankLineAfterEachItem,k(i.nc)||(n.measureFilter=i.nc),0<=e.Q.indexOf(i)?n.name=i.a:k(i.Zc)||(n.name=i.Zc),k(i.kr)||(e=void 0,i.kr===M.SortType.asc?e="ascending":i.kr===M.SortType.desc&&(e="descending"),n.sortType=e),(e=i.nrt)&&e.sortValueFieldName&&(e=It(e,r),n.autoSortScope=t.sheetPivotAreaToExcelPivotArea(e)),n.subtotalTop=!1!==i.Spi&&I,k(i.lp)||(n.fld=i.lp),k(i.bbt)||(n.numberFormat=i.bbt),n.showAll=t.showNoData(i.a),o=(e=r.getLabelFilterInfo(i.a))&&e.textItem&&e.textItem.list,!k(i._items)&&(pt(i.Zc,r)||o)&&0<i._items.length){if(e=r.dv&&r.dv[i.Zc],a={},o&&0<o.length){for(s=0;s<i._items.length;s++)a[i._items[s].value]=!0;for(s=0;s<o.length;s++)a[o[s]]=!1}(u=r.bl(i.a))&&(c=2===u.W5&&!k(u.Rs),r=i.tl(r),n.items=i.cc(t.options.subTotalsPosition!==g.SubtotalsPosition.none,e,a,c,u.T,u.gd,r))}return n},a.prototype.wh=function(t){var i,n,e,r,e,e,o,a,e,o,s,e,u,c,o,l,f,e,o,l,f,e,i=this,n=i.sc||{n_:"pivotField"},e=t.layoutType(),r=t.dh;switch(e){case g.PivotTableLayoutType.outline:n.compact="0",delete n.outline;break;case g.PivotTableLayoutType.tabular:n.compact="0",n.outline="0";break;case g.PivotTableLayoutType.compact:delete n.outline,delete n.compact}if(0<=r.Q.indexOf(i)?n.name=h(U(i.a)):k(i.Zc)||(n.name=h(U(i.Zc))),e=t.dh,n.axis=i.do(e.Z[i.Zc]),k(t.options.subTotalsPosition)||(n.defaultSubtotal=t.options.subTotalsPosition===g.SubtotalsPosition.none?"0":I),t.options.insertBlankLineAfterEachItem&&(n.insertBlankRow="1"),i.nc&&(n.measureFilter="1"),!1===i.Spi?n.subtotalTop="0":delete n.subtotalTop,k(i.bbt)||(o=(e=D.ExtendedNumberFormatHelper.getFormatId(i.bbt)).id,(a=e.isBuiltIn)?n.numFmtId=o:((e={}).numberFormat=new D.ExcelNumerFormat(o,i.bbt),n.numFmtId=e.numberFormat.numberFormatId)),!1===t.showNoData(i.a)&&(n.showAll="0"),s=(o=r.getLabelFilterInfo(i.a))&&o.textItem&&o.textItem.list,!k(i._items)&&(pt(i.Zc,r)||s)&&0<i._items.length){if(e=r.dv&&r.dv[i.Zc],u={},s&&0<s.length){for(c=0;c<i._items.length;c++)u[i._items[c].value]=!0;for(c=0;c<s.length;c++)u[s[c]]=!1}(o=r.bl(i.a))&&(l=2===o.W5&&!k(o.Rs),f=i.tl(r),e=i.mc(t.options.subTotalsPosition!==g.SubtotalsPosition.none,e,u,l,o.T,o.gd,f),n.c_=[{n_:"items",count:e.length+"",c_:e}])}return k(i.nrt)||(l=void 0,(o=i.nrt).sortType===M.SortType.asc?l="ascending":o.sortType===M.SortType.desc&&(l="descending"),n.sortType=l,o.sortValueFieldName&&(f=It(o,r),e={n_:"autoSortScope",c_:[t.sheetPivotAreaToSJSPivotArea(f)]},n.c_.push(e))),!0===t.options.fillDownLabels&&(n.c_=n.c_||[],n.c_.push({n_:"extLst",c_:[{n_:"ext",r_:[63,1],c_:[{n_:"pivotField",fillDownLabels:"1"}]}]})),n},a.prototype.eG=function(){var t=this;t.nrt=N,t._items=N,t.ie=N,t.bbt=N,t.Or=N,t.cft=N,t.sc=N,t.rc=N},v=a,w.PivotViewField=v,w.toPivotViewQueryField=tt,w.getCellValuePivotFilter=ot,w.getPivotDateExConditionRange=st,F.prototype.a1=function(t,i){var n,e,n,t,n=this,e=n.ac;return k(e)&&(n.ac={},e=n.ac),t=(n=n.bl(t))&&(n.y1||n.Zc),k(i)?e[t]||!1:!i!=!e[t]?(e[t]=!!i,!0):void 0},F.prototype.x1=function(t,i,n,e){var r=this,o=r.L,a=this.Ti,s;try{s=a.getPivotCacheByName(o).updateCalcItem(t,i,n,e,r.P1())}catch(t){(0,w.throwError)(C().PivotTableErrorFormula)}return s&&(r.q1=!0),s},F.prototype.up=function(t){var i,n=this.L,e;return this.Ti.getPivotCacheByName(n).getCalcItems(t)},F.prototype.Rp=function(t,i){var n,e,r,e,i,n=this,e=n.L,r,e=this.Ti.getPivotCacheByName(e).removeCalcItem(t,i),i=n.Up(t)[0];return i&&e&&(n.sm(t,!0),i.ln(n),n.q1=!0),e},F.prototype.Db=function(t,i,n){for(var e,r,o,a,s,u,c,l,c,f,e=this,r,a=0,s=e.Up(t);a<s.length;a++)if(u=s[a],e.Z[u.Zc]!==g.PivotTableFieldType.valueField){o=u;break}if(k(o)||!e.lg(o.Zc,i))return!1;c=e.L,c=(l=this.Ti).getPivotCacheByName(c);try{f=c.addCalcItem(t,i,n,e.P1())}catch(t){(0,w.throwError)(C().PivotTableErrorFormula)}return!1!==f&&(e.q1=!0,e.sm(t),o)&&o.ln(e),f},F.prototype.P1=function(){for(var t,i,n,e,r,o,t=this,i,n=[],e=0,r=t.nw(g.PivotTableFieldType.rowField).concat(t.nw(g.PivotTableFieldType.columnField));e<r.length;e++)o=r[e],n.push(o.a);return n},F.prototype.lw=function(t){var i,n,e,n,i,n=this.L,e,n=this.Ti.getPivotCacheByName(n);if(!k(n))return k(t)?n.aggregateCalcItem():n.aggregateCalcItem(t===g.CalcItemAggregation.include)},F.prototype.tr=function(t){for(var i,n,e,r,o,a,s,u,c,i,n=this.L,e,r,o,a={},s=0,u=this.Ti.getPivotCacheByName(n).getField(t).ty;s<u.length;s++)a[c=u[s]]=!0;return a},F.prototype.sm=function(t,i){var n,t,e,n=this,t=n.sy(t);t&&(e=t.textGroup&&t.textGroup.fieldName,n.cy(e,null,!0),i&&n.modifyGroupInfoByCalcItem(t),n.dy(t))},F.prototype.modifyGroupInfoByCalcItem=function(t){var i,n,e,r,o,e,a,s,n,u,c,l,f,h,v,d,p,m,b,i,n=t.originFieldName,e=this.L,r,o,e=this.Ti.getPivotCacheByName(e).getField(n);if(e&&(a=e.M()||{},n=(s=t.textGroup&&t.textGroup.groupItems)&&Object.keys(s),!(k(n)||n.length<1))){for(c=0,l=n;c<l.length;c++){for(u=s[f=l[c]],h=0;h<u.length;)k(a[u[h]])?u.splice(h,1):h++;0===u.length&&delete s[f]}if(0===Object.keys(s).length){for(v={},p=0,m=d=Object.keys(a);p<m.length;p++)v[b=m[p]]=b;t.textGroup.groupItems=v}}},F.prototype.lg=function(t,i){var n=this;return n.checkGroup(t)&&n.checkSubTotal()&&n.checkField(t)&&n.checkFieldItem(t,i)},F.prototype.checkField=function(t){var i,n,t,e,r,o,a,s,u,i=this,n;if(i.Z[t]===g.PivotTableFieldType.filterField)return!1;if(e={},(t=i.nw(g.PivotTableFieldType.valueField))&&1<t.length)for(r=0,o=t;r<o.length;r++)e[(a=o[r]).a]?(0,w.throwError)(C().PivotTableCalcItemHasMultipleDataField):e[a.a]=!0;for(s=0,u=t;s<u.length;s++)a=u[s],1<i.Up(a.a).length&&(0,w.throwError)(C().PivotTableCalcItemHasTowCacheField);return!0},F.prototype.checkSubTotal=function(t){var i,n,n,t,i=this,n=i.nw(g.PivotTableFieldType.valueField);if(n&&n.length)switch(n=n[0],t=k(t=t)?i.xy(n.Zc):t){case M.SubtotalType.average:case M.SubtotalType.stdDev:case M.SubtotalType.stdDevp:case M.SubtotalType.varr:case M.SubtotalType.varp:(0,w.throwError)(C().PivotTableSubtotalType)}return!0},F.prototype.checkFieldItem=function(t,i){var n,t,n,e,n,r,t,n,n=this,t=n.getFieldInfoByName(t);return!k(t)&&(n=n.L,t=(r=(n=(e=this.Ti).getPivotCacheByName(n).getField(t.a)).getFieldsItemList()).indexOf(i),n=n.up(),0<=t&&n.indexOf(i)<0&&(0,w.throwError)(C().PivotTableHasSameItemName),!0)},F.prototype.checkGroup=function(t){for(var i,n,e,r,o,e,a,i=this,n,r=0,o=i.ky();r<o.length;r++)e=o[r],e=i.rC(e.name),k(e)||k(e.dateGroups)&&k(e.numberGroup)||(0,w.throwError)(C().PivotTableHasNumberOrDateGroup);return(a=i.FC(t)).cC()&&(0,w.throwError)(C().PivotTableHasNumberOrDateGroup),!0},F.prototype.cC=function(t){var i,t,i,t=this.bl(t);if(t)return!!t.y1},F.prototype.NA=function(t){var i,n,e,r,i,n=this.L,e,r;return this.Ti.getPivotCacheByName(n).getField(t).hasCalcItem()},F.prototype.DA=function(){var t,i,n,i,e,r,o,t=this,i=t.L,n,i=this.Ti.getPivotCacheByName(i).getHeaderList();if(i&&i.length)for(e=0,r=i;e<r.length;e++)if(o=r[e],t.NA(o.name))return!0;return!1},F.prototype.Up=function(t){for(var i,n,e,r,o,a,i,n=[],e,r=0,o=this.nw();r<o.length;r++)(a=o[r]).a===t&&n.push(a);return n},F.prototype.LN=function(){var t=this,i;return t.Ti.getPivotCacheByName(t.L).getDataRefer()},F.prototype.ky=function(){var t,t,i,t=this,t=t.Ti.getPivotCacheByName(t.L),i=[];return i=t?t.getHeaderList():i},F.prototype.y2=function(t,i,n){var e,r,o,e,r=this.Y,o=r.indexOf(t);-1<o&&r.splice(o,1),i&&(k(n)?r.push(t):r.splice(n,0,t))},F.prototype.setSigmaValuePosition=function(t,i){var n,e,r,e,n=this,e=n.getSigmaValuePosition(),r=e.positionType,e=e.positionIndex;k(t)||t!==M.DataPosition.row&&t!==M.DataPosition.col||(n.x2=t),!k(i)&&0<=i&&(n.P2=i),n.DT({position:r,valuesIndex:e,type:"updateValuePosition"})},F.prototype.getSigmaValuePosition=function(){var t,i,n,t=this,i=1<t.Q.length,n=t.P2;return{positionType:t.x2,positionIndex:n,display:i}},F.prototype.xy=function(t,i){var n,e,r,o,a,n=this,e=n.getFieldInfoByName(t);if(e){if(r=e.getSubTotalType(),1===arguments.length)return r;if(r!==i){for(o in n.DA()&&!k(i)&&n.checkSubTotal(i),e.setSubTotalType(i),n.nrt)!n.nrt.hasOwnProperty(o)||k(n.nrt[o])||(a=n.nrt[o]).cacheName!==e.a&&a.sortValueFieldName!==e.Zc||(a.sortValueSubtotalText=M.SubtotalType[i]);n.q1=!0,this.DT({fieldName:t,subtotalType:r,type:"subTotalType"})}}},F.prototype.VT=function(t){var i,n,e,r,o,a,s,u,c,l,f,h,v,i=this;if(!k(t)){for(n=t.fieldsInfo,e=0;e<=3;e++)i.RM(e);for(i.setSigmaValuePosition(t.valueInfo.positionType,t.valueInfo.positionIndex),r=0;r<4;r++)for(o=n[r],a=0;a<o.length;a++)u=(s=o[a]).sourceName,c=s.displayName,l=s.subtotal,i.addFieldByName(u,c,r,l);for(e=0;e<4;e++)for(o=n[e],a=0;a<o.length;a++)u=(s=o[a]).sourceName,f=s.valueFilter,h=s.labelFilter,v=s.sortInfo,!h||k(h.condition)&&k(h.textItem)||i.setLabelFilterInfo(u,h),f&&!k(f.condition)&&i.setValueFilterInfo(u,f),k(v)||i.setSortInfo(u,v)}},F.prototype.UM=function(){for(var t,i,n,e,r,o,a,s,u,t=this,i=[],n=t.getSigmaValuePosition(),e=0;e<4;e++){for(r=t.nw(e),o=[],a=0;a<r.length;a++)(u={sourceName:(s=r[a]).a,displayName:s.Zc}).subtotal=s.Ar,u.labelFilter=t.getLabelFilterInfo(s.Zc),u.valueFilter=t.getValueFilterInfo(s.Zc),u.sortInfo=s.nrt,o.push(u);i[e]=o}return{fieldsInfo:i,valueInfo:n}},F.prototype.KM=function(t){var i,n,e,r,o,a,s,u,c,l,f,h,v,d,p,m,i=this,e=i.tx,o=e.sx,a={},s=[],u=!0,c={},f={},h=i.Ti.getPivotCacheByName(i.L);if(!k(e)){if((0,M.o)(t,function(t){n=i.FC(t.fieldName),k(n)||(f[t.fieldName]=n.W5,c[t.fieldName]=k(n.y1)?n.D:n.cx,a[t.fieldName]=t.fieldItem)}),k(a))r=!0;else{for(v=0,d=e.tx;v<d.length;v++){for(m in u=!0,l=(p=d[v]).path,a)if(b(a,m)&&c[m][l[o[m]]]!==a[m]){u=!1;break}u&&(s=s.concat(p.indexes))}r=!1}return h.dx(s,r)}},F.prototype.FC=function(t){var i=this,t=i.getFieldInfoByName(t);if(!k(t))return i.bl(t.a)},F.prototype.kx=function(t){var i,n,e,r,t,i=this,n=i.L,e=i.Ti.getPivotCacheByName(n),r=i.Zc,t={cmd:"updatePivotCache",sheetName:t.name(),cmdOption:{pivotCacheName:n,pivotCache:e,ptName:r}};i.Qy.execute(t),i.Pq=I,F.et(i,"updatePivotCache")},F.prototype.LS=function(){var t=this;t.ok(),t.q1=!0,t.q3()},F.prototype.ok=function(){for(var t,i,n,e,r,o,t=this,i=t.nw(),n=i.length,e=t.L,r=t.Ti.getPivotCacheByName(e),o=0;o<n;o++)r.zRt(i[o].a)?i[o].ln(t):(t.CF(i[o].Zc),t.IF(i[o].Zc))},F.prototype.IF=function(t){var i,n,e,i,n=this.Pq;if(n&&0<n.length)for(e=n.length-1;0<=e;e--)n[e].Zc===t&&n.splice(e,1)},F.prototype.getName=function(){return this.Zc},F.prototype.getAllFieldNameList=function(){var t=this.Ti.getPivotCacheByName(this.L);return t?t.getAllFieldsNames():[]},F.prototype.getAllFieldNameListWithoutCalcField=function(t){var i,n,e,r,o,i=this.Ti.getPivotCacheByName(this.L),n=[];if(i)for(r in e=i.Pq)e.hasOwnProperty(r)&&(o=e[r],!k(o.D5)||t&&(2!==o.W5||!k(o.y1)&&o.y1!==o.Zc)||n.push(r));return n},F.prototype.clone=function(){var t,i,n,e,r,o,a,t=this,i=new F(t.Zc,t.L,t.Ti,t.Qy),n=(0,D.RF)(t.B),e=(0,D.RF)(t.R),r=(0,D.RF)(t.G),o=(0,D.RF)(t.Q),a=(0,D.RF)(t.Z);return i.B=n||[],i.R=e||[],i.G=r||[],i.Q=o||[],i.Z=a||[],i.z=[].concat(t.z),i.x2=t.x2,i.P2=t.P2,i},F.prototype.getAllFieldInfo=function(){var n,t,e,n=this,t=n.getAllFieldNameList(),e=[];return(0,M.o)(t,function(t){var i=n.v_(t);e.push(i?{fieldName:i.Zc,sourceName:t,isFilter:n.K.isFilter(i.a),isDims:!0}:{fieldName:t,sourceName:t,isFilter:n.K.isFilter(t),isDims:!1})}),e},F.prototype.getFieldInfoByName=function(t){var i=this,n=i.Z[t],i=i.nw(n);return i?X(i,t):N},F.prototype.DB=function(t){var i,n,e,r,i,n=this.Pq;if(n)for(e=n.length,r=0;r<e;r++)if(t===n[r].Zc)return n[r]},F.prototype.v_=function(t){var i,n=this.nw();return n?$(n,t):N},F.prototype.addPivotView=function(t){this.z.push(t),this.q3()},F.prototype.removePivotView=function(t){for(var i,n,i=0;i<this.z.length;i++)if((n=this.z[i])===t)return void this.z.splice(i,1);0===this.z.length&&this.dispose()},F.prototype.q3=function(t,i,n,e){for(var r,o,a,r=0;r<this.z.length;r++)a=(o=this.z[r])instanceof u.PivotTable,t&&a||a&&0<o.Xst||o.paint(t,i,n,e)},F.prototype.sR=function(){for(var t,i,t=0;t<this.z.length;t++)(i=this.z[t])instanceof u.PivotTable&&i.adjustRange()},F.prototype.OR=function(t,i){var n,t,n,t=this.Ti.getPivotCacheByName(this.L).zRt(t);return i=k(t)?i:t.Zc},F.prototype.FG=function(t,i,n){var e,t,e,t=this.Ti.getPivotCacheByName(this.L).zRt(t);return k(n)&&(n=t.W5===M.PivotDataType.number?M.SubtotalType.sum:M.SubtotalType.count),k(t)||(i=t.Zc),C()["SubtotalType_Prefix_"+n]+i},F.prototype.PV=function(t){var i,n,i,n;return this.Ti.getPivotCacheByName(this.L).zRt(t).W5===M.PivotDataType.number?M.SubtotalType.sum:M.SubtotalType.count},F.prototype.getSortInfo=function(t){return this.nrt[t]},F.prototype.setSortInfo=function(t,i){var e,n,r,o,a,s,u,c,l,f,h,v,d,d,v,p,m,b,g,w,e=this,n=(0,D.RF)(e.nrt[t]),r=e.getFieldInfoByName(t);if(i&&i.sortValueFieldName&&(o=e.getFieldInfoByName(i.sortValueFieldName),!k(o))){if(i.sortByPivotReferences){if(a=i.sortByPivotReferences,(u=2===(s=e.Z[t]))||(c=1===s)){if(l=u?e.B.map(function(t){return t.Zc}):e.R.map(function(t){return t.Zc}),f=u?e.B.map(function(t){return t.a}):e.R.map(function(t){return t.a}),a.length>l.length)return;for(h=0;h<l.length&&h<a.length;h++){if(d=(v=a[h]).fieldName,!v||k(v)||k(v.items)||0===v.items.length||l[h]!==d&&-1===f.indexOf(d))return;if(d=e.FC(d)||e.bl(d),v=v.items,p=d.DH(),1!==v.length)return;for(m=0,b=v;m<b.length;m++)if(g=b[m],-1===p.indexOf(g))return}}i.sortByPivotReferences=a.map(function(t){var i,n,i=t.fieldName,n=e.X[i];return{fieldName:n=n||-1===e.si.indexOf(i)?n:i,items:t.items}}),i.sortByHeader=u}i.cacheName=o&&o.a,i.sortValueSubtotalText=M.SubtotalType[o.Ar]}k(r)||(e.nrt[t]=i,r.setSortInfo(i),(w=this.Ti.getPivotCacheByName(this.L)).setSortInfo(r.a,!0),this.q1=!0,e.DT({type:"setSortInfo",fieldName:t,sortInfo:n}))},F.prototype.clearSortInfo=function(t){var i,n,e,r,i=this,n=i.getFieldInfoByName(t);k(n)||(e=(0,D.RF)(i.nrt[t]),delete i.nrt[t],n.setSortInfo(N),(r=this.Ti.getPivotCacheByName(this.L)).setSortInfo(n.a,!1),this.q1=!0,i.DT({type:"setSortInfo",fieldName:t,sortInfo:e}))},F.prototype.setCollapse=function(t,i,n){var e,r,e=this.dv;(e=e||(this.dv={}))[t]||(e[t]={}),r=e[t][i],e[t][i]=n,this.DT({fieldName:t,item:i,isCollapse:r,type:"setCollapse"})},F.prototype.getCollapse=function(t,i){var n=this.dv;return n&&n[t]?n[t][i]:N},F.prototype.addField=function(t,i,n){var e,r,o,a;(3<i||i<0)&&(0,w.throwError)("wrong area code"),r=(e=this).nw(i),e.FV(t.Zc)&&i!==g.PivotTableFieldType.valueField||(k(n)?n=r.length:(o=this.getSigmaValuePosition(),a={1:M.DataPosition.row,2:M.DataPosition.col},o.display&&a[i]===o.positionType&&(n<=o.positionIndex?e.setSigmaValuePosition(o.positionType,o.positionIndex+1):n--)),e.sz(r,t,i,n),e.Z[t.Zc]=i,e.X[t.Zc]=t.a,0!==i&&(e.q1=!0))},F.prototype.dz=function(t){var i,n,e,r,o,i=2,n=this;if(!k(t)){for(e=t.substr(t.length-1,1),r="_",isNaN(+e)&&(r=""),o=t;n.Z[t]&&!(100<i);)t=o+r+i,i++;return t}},F.prototype.getFilterInfo=function(t){return this.K.get(t)},F.prototype.isFilter=function(t){return this.K.isFilter(t)},F.prototype.changeFieldName=function(t,i){var n,e,r,t,n=this,e=t.Zc,r=n.Z[t.Zc];return!(k(i)||""===i||!i||(n.Z[e]===g.PivotTableFieldType.valueField&&(n.changeValueFilterName(e,i),n.changeFieldsValueSortInfo(e,i)),n.changeValueArray(e,i),e&&i&&0<i.length&&(n.nrt[e]&&(n.nrt[i]=n.nrt[e],delete n.nrt[e]),t.Zc=i,delete n.Z[e],n.Z[t.Zc]=r,t=n.X[e],delete n.X[e],n.X[i]=t),n.DT({fieldName:i,oldFieldName:e,type:"changeFieldName"}),0))},F.prototype.changeValueArray=function(n,e){var t,r=this.Y;(0,M.o)(r,function(t,i){t===n&&(r[i]=e)})},F.prototype.changeValueFilterName=function(i,n){for(var t,e,r,t=this,r=0;r<4;r++)(e=t.nw(r)).forEach(function(t){t._filterInfo&&t._filterInfo.valueFilter&&t._filterInfo.valueFilter.conditionByName===i&&(t._filterInfo.valueFilter.conditionByName=n)})},F.prototype.changeFieldsValueSortInfo=function(i,n){for(var t,e,r,t=this,r=1;r<3;r++)(e=t.nw(r)).forEach(function(t){t.nrt&&t.nrt.sortValueFieldName&&t.nrt.sortValueFieldName===i&&(t.nrt.sortValueFieldName=n)})},F.prototype.isFieldExist=function(t){return!k(this.Z[t])},F.prototype.isFieldActualExist=function(t){var i,n,i=this,n=i.getAllFieldNameList();return i.si||(i.si=n),-1<i.si.indexOf(t)||-1<n.indexOf(t)&&(i.si=n,!0)},F.prototype.rBt=function(t){var i=this.getFieldInfoByName(t);return this.hr(i?i.a:t)},F.prototype.hr=function(t){var t=this.bl(t);return t&&t.W5},F.prototype.Kz=function(t){var t,i,t=this.getFieldInfoByName(t),i;return this.bl(t.a).DH()},F.prototype.refreshShowDataAs=function(t,i,n){for(var e,r,o,a,s,e,r,o=0,a=this.z;o<a.length;o++)(s=a[o])instanceof u.PivotTable&&s.sq(t,i,n)},F.prototype.changeFieldArea=function(t,i,n){var e,r,o,a,a,s,u,s,c,u,s,l,l,f,h,v,s,d,u,h,p,e=this,r=e.Z[t],o=e.getFieldInfoByName(t);if(k(o))return!1;(a=e.FC(t))&&!k(a.D5)&&i!==g.PivotTableFieldType.valueField||r<0||k(r)||e.FV(t)&&i!==g.PivotTableFieldType.valueField||(a.hasCalcItem()&&i===g.PivotTableFieldType.filterField&&(0,w.throwError)(C().PivotTableMoveCalcItemFieldToReport),a=i!==r,i in g.PivotTableFieldType&&a&&(u=-1!==(s=[g.PivotTableFieldType.rowField,g.PivotTableFieldType.columnField]).indexOf(i),s=-1!==s.indexOf(r),u)&&s&&(a=!1),u=_(c=e.nw(r),t),(s=e.getSigmaValuePosition()).display&&s.positionType===i-1&&s.positionIndex===u&&u===n&&r===i?e.setSigmaValuePosition(s.positionType,s.positionIndex+1):(o&&e.refreshShowDataAs(t,!1,i),i===g.PivotTableFieldType.valueField&&r!==g.PivotTableFieldType.valueField&&(l=e.dz(e.FG(o.a,t)),e.changeFieldName(o,l),t=l,e.xy(o.Zc,e.PV(o.a))),i!==g.PivotTableFieldType.valueField&&r===g.PivotTableFieldType.valueField&&(e.clearValueFilterOfValueField(o.Zc),e.xy(o.Zc,N)),l=e.Z[t],f=o.nrt,o=e.CF(t),h=(s=e.getSigmaValuePosition()).display,v=s.positionType,s=s.positionIndex,i===r&&u<n&&(d=R(u,n),u=G(u,n),h)&&v===i-1&&s<=d&&u<s&&n--,i!==g.PivotTableFieldType.valueField&&r===g.PivotTableFieldType.valueField&&(o.Zc=o.a),e.addField(o,i,n),f&&l!==i&&f.sortByPivotReferences&&e.setSortInfo(t,I),l!==g.PivotTableFieldType.rowField&&l!==g.PivotTableFieldType.columnField||(h=l===g.PivotTableFieldType.columnField?e.B:e.R,p=(l===g.PivotTableFieldType.rowField?e.B:e.R).map(function(t){return e.X[t.Zc]}),P(e,h,function(t){var i,n;if(t.sortByPivotReferences)for(i=t.sortByPivotReferences,n=0;n<i.length;n++)if(i[n].fieldName!==p[n])return 1})),e.q1=a,i===g.PivotTableFieldType.filterField&&e.sR()))},F.prototype.removeFieldOrSigmaByName=function(i){var t,n,e,r,o,a,t=this;return i===C().sigmaValue?(e=t.B.concat(t.R),P(t,e,function(t){return!k(t.sortValueFieldName)}),t.RM(g.PivotTableFieldType.valueField),C().sigmaValue):((n=t.getFieldInfoByName(i))&&(t.refreshShowDataAs(i,!0),r=n.a,3===(o=t.Z[i])?(e=t.B.concat(t.R),P(t,e,function(t){return t.cacheName===r||t.sortValueFieldName===i||t.sortValueFieldName===r})):1!==o&&2!==o||((a=n.getSortInfo())&&delete t.nrt[n.Zc],P(t,e=1===o?t.R:t.B,function(t){var t;return null!=(t=t.sortByPivotReferences)&&t.some(function(t){return t.fieldName===r})}))),t.CF(i))},F.prototype.CF=function(t){var i,n,e,r,o,a,i=this,n=i.Z[t],e,r=_(i.nw(n),t);if(!(k(n)||r<0))return o=i.getSigmaValuePosition(),a={1:M.DataPosition.row,2:M.DataPosition.col},o.display&&o.positionType===a[n]&&o.positionIndex>r&&i.setSigmaValuePosition(o.positionType,o.positionIndex-1),i.MK(t)},F.prototype.MK=function(t){var i=this,n=i.Z[t],e,r=_(i.nw(n),t);return delete i.Z[t],i.q1=!0,i.OK(n,r)},F.prototype.C$=function(t){var n=this,i=n.nw(g.PivotTableFieldType.valueField);(0,M.o)(i,function(i){i.Or&&i.Or.baseFieldName===t&&((0,M.o)(n.z,function(t){0===t.T$&&(0,y.R$)(t,i.Zc,i.Or.showDataAs)}),delete i.Or)})},F.prototype.clearValueFilterOfValueField=function(t){for(var i,n,e,r,i=this,e=g.PivotTableFieldType.rowField;e<=g.PivotTableFieldType.columnField;e++)for(r=(n=i.nw(e)).length-1;0<=r;r--)k(n[r]._filterInfo)||k(n[r]._filterInfo.valueFilter)||n[r]._filterInfo.valueFilter.conditionByName!==t||i.clearFilterInfo(n[r].Zc,2);i.q1=!0},F.prototype.RM=function(t){var i,n,e,i=this,n=i.nw(t);if(!k(n)&&0<n.length){for(e=n.length-1;0<=e;e--)i.refreshShowDataAs(n[e].Zc,!0),i.CF(n[e].Zc);i.q1=!0}},F.prototype.sz=function(t,i,n,e){var r,o,r=this;k(e)?t.push(i):(o=t.length,e=R(o,e),e=G(0,e),t.splice(e,0,i)),n===g.PivotTableFieldType.valueField&&(k(r.x2)&&(r.x2=M.DataPosition.col),k(r.P2))&&(r.P2=0),r.DT({fieldName:i.Zc,area:n,index:e,type:"removeField"})},F.prototype.OK=function(t,i){var n,e,e,r,o,a,n=this,e=n.nw(t);if(!(k(i)||i<0||i>=e.length))return e=e.splice(i,1)[0],k(e)||(o=r=void 0,(a=e._filterInfo)&&(a.labelFilter&&(r=a.labelFilter.condition?a.labelFilter.condition.toJSON():{textItem:c({},a.labelFilter.textItem)}),o=a.valueFilter?{conditionByName:a.valueFilter.conditionByName,condition:a.valueFilter.condition.toJSON()}:N),n.DT({fieldName:e.Zc,sourceName:e.a,labelFilter:r,valueFilter:o,sortInfo:(0,D.RF)(e.nrt),subtotalType:e.Ar,valueFilterIndex:this.Y.indexOf(e.Zc),area:t,index:i,type:"addField"})),e},F.prototype.fit=function(t){var i=this,n;i.Ti.getPivotCacheByName(i.L).removeCalcField(t),i.q1=!0},F.prototype.nw=function(t){var i=this;switch(t){case 0:return i.G;case 1:return i.B;case 2:return i.R;case 3:return i.Q;default:return[].concat(this.B,this.R,this.G,this.Q)}},F.prototype.getLabelQueryField=function(){var o,t,a,s,u,o=this,t=o.bit(),a=o.getAllFieldNameList(),s=[],u=o.Ti.getPivotCacheByName(o.L);return(0,M.o)(t,function(t){var i,n,e,r,i=u.zRt(t.a),n=k(i.y1)?void 0:u.zRt(i.y1),e=o.getFilterInfo(t.a);e&&e.u&&(o.q1=!0,e.u=!1),-1!==(r=a.indexOf(t.a))&&a.splice(r,1),s.push(t.toPivotViewQueryField(e,o.Z[t.Zc],i,n))}),(0,M.o)(a,function(t){var i,n,e,i=o.getFilterInfo(t);i&&i.labelFilter&&(n=u.zRt(t),e=k(n.y1)?void 0:u.zRt(n.y1),s.push(tt(t,t,-1,i,I,-1,n,e)))}),s},F.prototype.Get=function(){var i={};return(0,M.o)(this.B,function(t){var t=t.Zc;i[t]=1}),(0,M.o)(this.R,function(t){var t=t.Zc;i[t]=2}),i},F.prototype.getSubtotalQueryField=function(){var t,i,n,t=this.rot(),i=[],n={};return(0,M.o)(t,function(t){i.push(t.toPivotViewSubTotalFields()),n[t.Zc]=t.getSubTotalType()}),{valueFieldsSubtotalMap:n,queryFields:i}},F.prototype.getSortMap=function(t){var f=this,h={},v={};return(0,M.o)(t,function(t){var i,t,n,e,r,o,a,s,u,c,l,i=t.sourceName,t=t.sortInfo,n={};if(!k(t))if(e=t.customSortCallback||t.customSortInfo){if(o=(r=f.bl(i)).W5,a=r.DH(),s=r.M(),(u=e(a.concat(),{sortType:M.SortType.custom,isDate:o===M.PivotDataType.date}))&&0<u.length){for(c=0,l=u.length;c<l;c++)n[s[u[c]]]=c;h[i]=n}}else v[i]=t.sortType}),{customSortMap:h,normalSortMap:v}},F.prototype.bit=function(){return[].concat(this.B,this.R,this.G)},F.prototype.rot=function(){return this.Q},F.prototype.kn=function(t){return this.Ti.getPivotCacheByName(this.L).zRt(t).lp},F.prototype.p=function(t){var t=this.Ti.getPivotCacheByName(this.L).zRt(t);return t.l||t.lp},F.prototype.fn=function(t){var t=this.Ti.getPivotCacheByName(this.L).zRt(t);return k(t)?{}:{startValue:t.T,endValue:t.gd}},F.prototype.yr=function(t){return this.Ti.getPivotCacheByName(this.L).zRt(t).getFieldsItemList()},F.prototype.Le=function(t){var i,n,i=this.bl(t),n=i.P;return!k(n)&&0!==Object.keys(n).length||this.Ti.getPivotCacheByName(this.L).dot([t]),i.P},F.prototype.bl=function(t){var i=this.Ti.getPivotCacheByName(this.L);return i&&i.zRt(t)},F.prototype.sat=function(t){var i,n,e,r,o,a,s,u,c,u,i=this,n=i.ac,e={};if(!k(t)&&0!==t.length&&!k(n))for(r=i.Ti.getPivotCacheByName(this.L),o=0,a=t;o<a.length;o++)(n[u=(s=a[o]).sourceName]||(u=(c=r.getField(u)).y1,!k(u)&&n[u]))&&(e[s.displayName]=!0);return e},F.prototype.xpi=function(t){var i,n,e,r,o,i={};if(!k(t)&&0!==t.length)for(n=0,e=t;n<e.length;n++)i[o=(r=e[n]).displayName]=!!r.isShowSubtotalTop;return i},F.prototype.queryItem=function(){var t,i,n,e,n,r,o,a,s,a,u,c,l,c,f,h,c,l,t=this,i=t.getLabelQueryField(),n=t.getSubtotalQueryField(),e=n.valueFieldsSubtotalMap,n=n.queryFields,r=t.sat(i),o=t.xpi(i),a=t.getSortMap(i),s=a.customSortMap,a=a.normalSortMap,u=t.L,c=t.Ti,l=t.getSigmaValuePosition();return(t.q1||k(t.tx))&&(t.tx=c.queryItem(u,i,n,l),t.q1=!1,F.et(t,"rebuild",{})),f=(c=t.lat(i)).list,h=c.header,c=c.rowHeader,l={valuePositionInfo:l,subTotalsPosition:t.Dpi,valueFieldLength:n.length},t.tx&&t.tx.out(t.Ti.cut[u],f,h,c,i,l,t.alt(),e,t.Y,this.toShowDataAsContextList(n),s,a,r,o)},F.prototype.getLabelSortMap=function(){return this.getSortMap(this.getLabelQueryField())},F.prototype.toShowDataAsContextList=function(t){var l,f,h,l=this,f=[],h=this.Ti.getPivotCacheByName(this.L);return(0,M.o)(t,function(t){var t,i,n,e,r,o,a,t,s,u,c,u;if(t.showDataAs){if(i=(t=t.showDataAs).showDataAs,n=t.cacheName,e=t.baseFieldItemType,r=t.baseFieldName,o=t.baseFieldItem,a=t.fieldName,t=t.subtotalType,s=void 0,r&&o){if(u=l.getFieldInfoByName(r),k(u))return;s=(u=(c=h.zRt(u.a)).M())?u[o]:o}f.push({showDataAs:i,cacheName:n,fieldName:a,baseFieldName:r,baseFieldItemType:e,baseFieldItem:o,subtotalType:t,baseFieldItemShared:s})}}),f},F.prototype.alt=function(){var t,i,n,e,r,e,o,a,s,u,t=this,i={};for(n in t.dv)if(t.dv.hasOwnProperty(n)&&(e=t.Ti.getPivotCacheByName(t.L),!k(e))&&(r=t.getFieldInfoByName(n),!k(r))&&(e=e.zRt(r.a),!k(e)))if(o=e.M(),a=t.dv[n],s=void 0,k(o))i[n]=c({},a);else{for(u in a)a.hasOwnProperty(u)&&((s=s||{})[o[u]]=a[u]);i[n]=s}return i},F.prototype.lat=function(t){var e=[],r=[],o=[];return(0,M.o)(t,function(t){var i=t.displayName,n=t.isDim,t=t.isHeader;n&&(e.push(i),t||o.push(i)),t&&r.push(i)}),{list:e,header:r,rowHeader:o}},F.prototype.spt=function(t,i){var n,e,r,n,e,r=this.Ti.getPivotCacheByName(this.L);return i?0<(0,M.amt)([r.pVt(t),r.bVt(i)]).length:0<r.pVt(t).length},F.prototype.wVt=function(t){var i=t.cmdOption.pivotName,i=this.yVt(i);if(k(i)||k(i.Ti))return!1;t.sheetName=i.Ti.name(),this.Qy.execute(t)},F.prototype.yVt=function(t){for(var i,n,e,r,i,n=0,e=this.z;n<e.length;n++)if((r=e[n]).Zc===t&&r instanceof u.PivotTable)return r;return N},F.prototype.CVt=function(){for(var t,i,t=this.z,i=0;i<t.length;i++)if(t[i]instanceof u.PivotTable)return{sheet:t[i].Ti,ptName:t[i].Zc}},F.prototype.IVt=function(){var t,i,n,e,r,o,a,t=this,i=t.getAllFieldInfo().slice(0),n=t.nw(0).slice(0),e,r,o,a;return{allField:i,rowField:t.nw(1).slice(0),colField:t.nw(2).slice(0),valueField:t.nw(3).slice(0),filterField:n,valuePosition:t.getSigmaValuePosition()}},F.prototype.adjustHasCalcItem=function(t,i,n){var e,r,o,r,a,s,u,c,e=this,r=e.L,o,r=this.Ti.getPivotCacheByName(r).getField(t);if(e.DA()){if(i===g.PivotTableFieldType.filterField)r.hasCalcItem()&&(0,w.throwError)(C().PivotTableMoveCalcItemFieldToReport);else for(s=0,u=a=e.nw();s<u.length;s++)(c=u[s]).a===t&&(e.Z[c.Zc]===g.PivotTableFieldType.valueField&&(0,w.throwError)(C().PivotTableCalcItemHasMultipleDataField),(0,w.throwError)(C().PivotTableCalcItemHasTowCacheField));if(i===g.PivotTableFieldType.valueField)return e.checkSubTotal(n)}return!0},F.prototype.addFieldByName=function(t,i,n,e,r,o){var a,s,u,c,l,u,o,i,f,a=this;for((3<n||n<0)&&(0,w.throwError)("wrong area code"),u=a.bl(t),c=g.PivotTableFieldType.columnField;c>=g.PivotTableFieldType.filterField;c--)if(l=$(s=a.nw(c),t),!k(l)&&n!==g.PivotTableFieldType.valueField)return void a.changeFieldArea(l.Zc,n,r);if(a.adjustHasCalcItem(t,n,e),!k(u)&&i!==C().sigmaValue)return u=new v(a,t,i,o),n!==g.PivotTableFieldType.valueField&&(a.Dpi===g.SubtotalsPosition.top?u.Spi=!0:a.Dpi===g.SubtotalsPosition.bottom?u.Spi=!1:delete u.Spi),n===g.PivotTableFieldType.valueField&&(!k(i)&&k(a.Z[i])||(o=a.FG(t,i,e),i=a.dz(o),a.changeFieldName(u,i)),k(e)?u.setSubTotalType(a.PV(t)):u.setSubTotalType(e)),r<a.nw(n).length&&(n===g.PivotTableFieldType.rowField||n===g.PivotTableFieldType.columnField)&&P(a,f=n===g.PivotTableFieldType.columnField?a.B:a.R,function(t){return!k(t.sortByPivotReferences)&&0<t.sortByPivotReferences.length}),a.addField(u,n,r),n===g.PivotTableFieldType.filterField&&a.sR(),u},F.prototype.AVt=function(t,i,n,e,r,o){var a,s,s,o,i,a=this,s=a.bl(t);k(s)||i===C().sigmaValue||(s=new v(a,t,i,o),n!==g.PivotTableFieldType.valueField&&(a.Dpi===g.SubtotalsPosition.top?s.Spi=!0:a.Dpi===g.SubtotalsPosition.bottom?s.Spi=!1:delete s.Spi),!k(i)&&k(a.Z[i])||(o=a.FG(t,i,e),i=a.dz(o),a.changeFieldName(s,i)),k(e)?s.setSubTotalType(a.PV(t)):s.setSubTotalType(e),a.addField(s,n,r))},F.prototype.AP=function(t){var i,n,e,n,r,e,n,o,a,s,u,c,l,f,n,h,h,l;switch(k(this.copyFieldsModel)||(this.copyFieldsModel=this.clone()),i=t.type){case"updateValuePosition":n=t.position,e=t.valuesIndex,this.setSigmaValuePosition(n,e);break;case"subTotalType":this.xy(t.fieldName,t.subtotalType);break;case"setSortInfo":k(t.sortInfo)?this.clearSortInfo(t.fieldName):this.setSortInfo(t.fieldName,t.sortInfo);break;case"setCollapse":this.setCollapse(t.fieldName,t.item,t.isCollapse);break;case"changeFieldName":(n=this.getFieldInfoByName(t.fieldName))&&(this.changeFieldName(n,t.oldFieldName),this.q1=!0);break;case"removeField":(r=this.OK(t.area,t.index))&&(delete this.Z[t.fieldName],this.q1=!0);break;case"addField":e=t.fieldName,n=t.sourceName,o=t.labelFilter,a=t.valueFilter,s=t.sortInfo,u=t.subtotalType,c=t.area,l=t.index,f=t.valueFilterIndex,n=new v(this,n,e),h=this.nw(c),this.sz(h,n,c,l),this.Z[e]=c,this.xy(e,u),this.Z[n.Zc]=c,k(o)||this.setLabelFilterInfo(e,o),k(a)||this.setValueFilterInfo(e,a,f),k(s)||this.setSortInfo(t.fieldName,t.sortInfo),0!==c&&(this.q1=!0);break;case"setLabelFilter":k(t.filterInfo)?this.clearFilterInfo(t.sourceName,1):this.setLabelFilterInfo(t.sourceName,t.filterInfo);break;case"setValueFilter":k(t.filterInfo)?this.clearFilterInfo(t.sourceName,2):this.setValueFilterInfo(t.sourceName,t.filterInfo,t.index);break;case"group":h=t.oldGroupInfo,l=t.groupSourceFieldName,h?this.dy(h):this.cy(l);break;case"ungroup":this.dy(t.groupInfo);break;case"addValueFilter":k(t.filter)?this.clearFilterInfo(t.fieldName,2):this.setValueFilterInfo(t.fieldName,t.filter,t.index)}},F.prototype.DT=function(t){var i,i,n,e,r,i=this.CVt(),i=i&&i.sheet;i&&(n=i.getParent(),(0,M.o)(this.z,function(t){if(t instanceof u.PivotTable)return e=t,!0}),k(n.NVt)&&e&&e.getRange&&(n.NVt={range:e&&e.getRange()}),(r=i.Ut).TVt(this,t))},F.prototype.getLabelFilterInfo=function(t){var t,t,i,n,t=this.K.get(t);if(!k(t)&&(t=t.labelFilter,!k(t)))return{condition:i=t&&t.condition?t.condition.toJSON():i,textItem:n=t&&t.textItem?t.textItem:n}},F.prototype.setLabelFilterInfo=function(t,i){var n,e,r,o,n=this,e=n.K;!k(i)&&Object.keys(i).length<1||((r=n.getFilterInfo(t))&&r.labelFilter&&(o={},r.labelFilter.condition&&(o.condition=r.labelFilter.condition.toJSON()),r.labelFilter.textItem)&&(o.textItem=c({},r.labelFilter.textItem)),k(i)?(r&&r.labelFilter&&r.labelFilter.condition&&1===r.labelFilter.condition.sn&&n.MVt(t,N),e.set(t,N,1)):(r||(r=new p(i,N,n.H),n.K.add(t,r)),i.condition?(1===i.condition.conType&&n.MVt(t,i),r.updateLabelCondition(i.condition,n.H.allowMultipleFiltersPerField)):r.labelFilter&&(r.labelFilter.condition&&1===r.labelFilter.condition.sn&&n.MVt(t,N),delete r.labelFilter.condition),i.textItem?r.updateLabelTextItem(i.textItem,n.H.allowMultipleFiltersPerField):r.labelFilter&&delete r.labelFilter.textItem,n.K.get(t).on()&&!n.H.allowMultipleFiltersPerField&&e.set(t,N,2)),n.q1=!0,this.DT({type:"setLabelFilter",sourceName:t,filterInfo:o}),F.et(n,"setSlicerFilter",{sourceName:t,textItem:i&&i.textItem,condition:i&&i.condition,oldTextItem:o&&o.textItem,oldCondition:o&&o.condition}))},F.prototype.MVt=function(t,i){var n,e,r,o,a,s,u,n=this,e=n.Ti.getPivotCacheByName(n.L);if(!k(e)&&(r=e.xVt(t),!k(r))&&0<r.length)for(o=0,a=r.length;o<a;o++)s=n.getFieldInfoByName(r[o].Zc),k(s)||((u=n.K.get(s.a))||(u=new p(i,N,n.H),n.K.add(s.a,u)),u.updateLabelCondition(i&&i.condition,n.H.allowMultipleFiltersPerField))},F.prototype.getValueFilterInfo=function(t){var i,n,t,t=this.K.get(t);if(t&&t.valueFilter&&t.valueFilter.condition)return{condition:i=t.valueFilter.condition.toJSON(),conditionByName:n=t.valueFilter.conditionByName}},F.prototype.getSourceNameByFieldName=function(t){if(t)return this.X[t]},F.prototype.getFieldNameBySourceName=function(t){var t;if(t)return(t=this.v_(t))&&t.Zc},F.prototype.setValueFilterInfo=function(t,i,n){var e,r,o,a,i,e=this,r=e.K,o=r.get(t);!k(i)&&Object.keys(i).length<1||(k(n)&&(n=-1===this.Y.indexOf(t)?N:this.Y.indexOf(t)),o&&o.valueFilter&&(a={conditionByName:o.valueFilter.conditionByName,condition:o.valueFilter.condition.toJSON()}),k(i)?(r.set(t,N,2),e.y2(t,!1)):(o?o.updateValueCondition(i):(o=new p(N,i,e.H),r.add(t,o)),o.valueFilter.conditionBySourceName=this.getFieldInfoByName(i.conditionByName).a,e.y2(t,!0,n),o.C()&&!e.H.allowMultipleFiltersPerField&&r.set(t,N,1)),(i=X(this.Pq||this.nw(),t))&&(i.nc=!0),this.q1=!0,this.DT({type:"setValueFilter",sourceName:t,index:n,filterInfo:a}))},F.prototype.clearFilterInfo=function(t,i){var n=this,e=n.v_(t);n.getFilterInfo(t)&&(1===i?n.setLabelFilterInfo(t,N):2===i?n.setValueFilterInfo(t,N,N):(n.setValueFilterInfo(t,N,N),n.setLabelFilterInfo(t,N)),e&&(e.nc=!1),n.q1=!0)},F.prototype.DVt=function(t){this.H.allowMultipleFiltersPerField=t},F.prototype.refresh=function(t){this.q3(t)},F.prototype.fromJson=function(t,i){var n,e,r,o,e,a,s,s,n=this,e=n.Ti,r=(n.cft=t).fields;for(n.Pq=[],o=null,(e=e.getPivotCacheByCacheId(+t.cacheId))&&(n.L=e.Zc,o=e.getAllFieldsNames()),o||(o=[],r.forEach(function(t){o.push(t.name)})),n.ac={},!t.multipleFieldFilters&&t.multipleFieldFilters!==I||(n.H.allowMultipleFiltersPerField=!0),n.Z={},n.X={},n.B=[],n.R=[],n.G=[],n.Q=[],a=0;a<o.length;a++)r[a]&&!k(o[a])&&((s=new v(n,o[a],r[a]&&r[a].name)).fromJson(r[a],n),k(r[a].subtotalTop)?s.Spi=!0:s.Spi=r[a].subtotalTop,r[a].name=s.Zc,n.X[s.Zc]=s.a,n.Pq.push(s),s=s.getSortInfo())&&(n.nrt[r[a].name]=s);n.SVt(t,i),Nt(n.Pq,n,i,!1),k(t.pivotFilters)||n.kVt(t.pivotFilters)},F.prototype.yh=function(t,i){var n,e,r,o,r,a,s,u,u,e,r,n=this,e=n.Ti;for(n.sc=t,n.ac={},o=(r=O(t,"pivotFields"))&&r.c_,n.Pq=[],r=e.getPivotCacheByCacheId(+t.cacheId),n.L=r.Zc,a=r.getAllFieldsNames(),d(t.multipleFieldFilters,!0)&&(n.H.allowMultipleFiltersPerField=!0),s=0;s<a.length;s++)(u=new v(n,a[s],o[s]&&o[s].name)).yh(i,o[s],n),k(o[s].subtotalTop)?u.Spi=!0:u.Spi=d(o[s].subtotalTop),o[s].name=S(x(u.Zc)),n.X[u.Zc]=u.a,n.Pq.push(u),(u=u.getSortInfo())&&(n.nrt[o[s].name]=u);n.jVt(t,i),Nt(n.Pq,n,i,!0),(e=t.lossless&&t.lossless.losslessPivotFilters)&&n.kVt(e),r=O(t,"filters"),k(r)||n.OVt(r)},F.prototype.kVt=function(t){for(var i,n,e,r,o,o,a,e,s,s,i=this,n=0;n<t.length;n++)e=t[n],(r=i.Pq&&i.Pq[e.fld])&&(o=e.iMeasureFld||0,o=i.Q&&i.Q[o],a=e.conType,e=Y(e),s=o&&o.Zc,k(e)&&k(s)||(s={condition:e,conditionByName:o&&o.Zc},0===a||1===a?i.setLabelFilterInfo(r.a,s):2!==a&&3!==a||i.setValueFilterInfo(r.a,s)))},F.prototype.OVt=function(t){var i,n,e,r,o,a,a,s,r,u,u,r,i=this;if(!k(t))for(n=t.c_,e=0;e<n.length;e++)r=n[e],(o=i.Pq&&i.Pq[T(r.fld)])&&(a=T(r.iMeasureFld)||0,a=i.Q&&i.Q[a],s=void 0,k(r.type)||(s=vt(r.type)),r=H(r,s),u=a&&a.Zc,k(r)&&k(u)||(u={condition:r,conditionByName:a&&a.Zc},0===(r=s.conType)||1===r?i.setLabelFilterInfo(o.a,u):2!==r&&3!==r||i.setValueFilterInfo(o.a,u)))},F.prototype.SVt=function(t,i){var n,e,r,o,a,s,u,c,c,l,f,h,v,d,p,n=this,e={columnFields:g.PivotTableFieldType.columnField,rowFields:g.PivotTableFieldType.rowField};for(r in e)if(e.hasOwnProperty(r))for(o=t[r],a=0;a<o.length;a++)-2!==o[a]?(s=n.Pq[o[a]])&&n.addField(s,e[r]):(n.x2="columnFields"===r?M.DataPosition.col:M.DataPosition.row,n.P2=a);for(u=t.pageFields,a=0;a<u.length;a++)c=u[a],(c=n.Pq[c.fld])&&n.addField(c,g.PivotTableFieldType.filterField);for(l=t.dataFields,f=n.Ti.getPivotCacheByName(n.L).getAllFieldsNames(),a=0;a<l.length;a++)h=l[a],n.AVt(f[h.fld],h.name,g.PivotTableFieldType.valueField,ft(h.subtotal),I,h.numberFormat),h.showDataAs&&(p={showDataAs:d=M.PivotShowDataAs[h.showDataAs]},(v=void 0,y.applyShowDataAsStyle)(i,h.name,d),k(h.baseField)||(v=n.v_(f[h.baseField]),k(v))||(p.baseFieldName=v.Zc),k(h.baseItem)||(1048828===h.baseItem?p.baseFieldItemType=M.PivotShowDataAsBaseItemType.previous:1048829===h.baseItem?p.baseFieldItemType=M.PivotShowDataAsBaseItemType.next:!k(h.baseItem)&&v&&v._items&&(p.baseFieldItemType=M.PivotShowDataAsBaseItemType.item,p.baseFieldItem=v._items[h.baseItem]&&v._items[h.baseItem].value)),n.getFieldInfoByName(h.name).Or=p)},F.prototype.jVt=function(t,s){var u,i,n,e,r,o,a,a,c,l,f,f,c,h,v,d,p,m,b,u=this,i={colFields:g.PivotTableFieldType.columnField,rowFields:g.PivotTableFieldType.rowField};for(n in i)if(i.hasOwnProperty(n)&&(e=O(t,n)))for(r=e.c_,o=0;o<r.length;o++)-2!==(a=T(r[o].x))?(a=u.Pq[a])&&u.addField(a,i[n]):(u.x2="colFields"===n?M.DataPosition.col:M.DataPosition.row,u.P2=o);if(c=O(t,"pageFields"))for(l=c.c_,o=0;o<l.length;o++)f=l[o],(f=u.Pq[T(f.fld)])&&u.addField(f,g.PivotTableFieldType.filterField);if(c=O(t,"dataFields"))for(h=u.Ti.getPivotCacheByName(u.L).getAllFieldsNames(),d=function(t){var i,n,e,r,o,e,a,e,i=S(x(t.name));u.AVt(h[T(t.fld)],i,g.PivotTableFieldType.valueField,ft(t.subtotal),I,t.numberFormat),n=t.showDataAs,(e=O(t,"extLst"))&&(r=e.c_).forEach(function(t){var t=O(t,"dataField");t&&(n=t.pivotShowAs)}),k(n)||(a={showDataAs:e=M.PivotShowDataAs[n]},(o=void 0,y.applyShowDataAsStyle)(s,i,e),o=T(t.baseField),k(o)||(o=u.v_(h[o]),k(o))||(a.baseFieldName=o.Zc),e=T(t.baseItem),k(e)||(1048828===e?a.baseFieldItemType=M.PivotShowDataAsBaseItemType.previous:1048829===e?a.baseFieldItemType=M.PivotShowDataAsBaseItemType.next:!k(e)&&o&&o._items&&(a.baseFieldItemType=M.PivotShowDataAsBaseItemType.item,a.baseFieldItem=o._items[e]&&o._items[e].value)),u.getFieldInfoByName(i).Or=a)},p=0,m=v=c.c_;p<m.length;p++)d(b=m[p])},F.prototype.PVt=function(){var n,e,t,r,n=this,e=n.Pq,t=n.getAllFieldNameList();k(e)&&(e=n.Pq=[]),r={},(0,M.o)(e,function(t){r[t.Zc]=t}),(0,M.o)(t,function(t){var i=n.v_(t);k(i)&&(i=new v(n,t,t,r[t]&&r[t].bbt)),e[i.lp]=i})},F.prototype.toJson=function(t,i){var n,e,r,o,n=this;if(k(n.L)||(e=n.Ti.getPivotCacheByName(n.L))&&(i.cacheId=e.FVt+""),r=n.Pq,i.fields=[],r)for(o=0;o<r.length;o++)i.fields.push(r[o].toJson(t));n.toPivotFiltersOOModel(t,i),n._Vt(t,i)},F.prototype.toPivotLabelFiltersOOModel=function(t,i,n,e){var r,o,a,n,e,i,r,s,e,o=[],a={};a.fld=n,a.id=++e,a.evalOrder=-1,n=i.condition,k(n)||(e=n.LVt,i=n.getConditionType(),a.operator=e,r=n.eX,s=n.iX,1===(a.conType=i)&&(r=r&&A(r),s=s&&A(s),n.LVt===M.PivotDateFilterOperator.dateToDate)&&(a.isParallel=n.EVt,a.isDynamicEndDate=n.BVt,a.by=n.Rs),e={compareType:e,conType:i,item1:{expected:a.stringValue1=r},item2:{expected:a.stringValue2=s},ignoreCase:!(a.iMeasureFld=0)},n.LVt!==M.PivotDateFilterOperator.dateToDate&&n.LVt!==M.PivotDateFilterOperator.last7Days||(e.isParallel=n.EVt,e.isDynamicEndDate=n.BVt,e.by=n.Rs),r={conditions:[e]}),k(r)||(o.push(r),a.autoFilter={filterItemMap:o},t.push(a))},F.prototype.toPivotValueFiltersOOModel=function(t,i,n,e){var r,e,o,a,n,e,i,r,r=this,o=[],a={};a.fld=n,a.id=++e,a.evalOrder=-1,n=i.condition,e=i.conditionByName,a.iMeasureFld=r.RVt(e)||0,i=n.getConditionType(),r=n.LVt,a.operator=r,e=3===(a.conType=i)?(a.operator=n.uit,{conditions:[{conType:i,expected:n.GVt,type:n.LVt,compareType:n.uit}]}):{conditions:[{compareType:r,conType:i,item1:{expected:n.eX},item2:{expected:n.iX}}]},k(e)||(o.push(e),a.autoFilter={filterItemMap:o},t.push(a))},F.prototype.toPivotFiltersOOModel=function(t,i){var n,e,r,o,a,s,s,u,s,n=this,e=n.Pq,r=[],o=1;if(e)for(a=0;a<e.length;a++)s=e[a],u=(s=n.K.get(s.a))&&s.labelFilter,s=s&&s.valueFilter,k(u)&&k(s)||(k(u)||n.toPivotLabelFiltersOOModel(r,u,a,1),k(s))||n.toPivotValueFiltersOOModel(r,s,a,1);0<r.length?i.pivotFilters=r:delete i.pivotFilters},F.prototype._Vt=function(t,i){var n,e,r,o,a,s,u,c,l,f,h,v,d,p,m,b,g,w,n=this,e={R:"columnFields",B:"rowFields"};for(r in e)if(e.hasOwnProperty(r))for(o=n[r],i[e[r]]=[],a=0;a<o.length;a++)i[e[r]].push(o[a].lp);for(n.Q&&1<n.Q.length&&(n.x2===M.DataPosition.row?i.rowFields.splice(n.P2,0,-2):n.x2===M.DataPosition.col&&i.columnFields.splice(n.P2,0,-2)),s=n.G,u=i.pageFields=[],a=0;a<s.length;a++)c=s[a].toJson(t),u.push(c);for(l=n.Q,f=i.dataFields=[],a=0;a<l.length;a++)if(h=l[a],(v={}).name=h.Zc,v.subtotal=ht(h.Ar),v.numberFormat=h.bbt,f.push(v),d=l[a].lp,i.fields&&i.fields[d]&&(i.fields[v.fld=d].dataField=!0),(p=h.Or)&&(p.showDataAs&&(v.showDataAs=M.PivotShowDataAs[p.showDataAs]),p.baseFieldName)&&(m=n.getFieldInfoByName(p.baseFieldName),v.baseField=m.lp,b=p.baseFieldItemType,!k(b)))if(b===M.PivotShowDataAsBaseItemType.previous)v.baseItem=1048828;else if(b===M.PivotShowDataAsBaseItemType.next)v.baseItem=1048829;else if(b===M.PivotShowDataAsBaseItemType.item)for(g=m.tl(n)||m._items,w=0;w<g.length;w++)if(p.baseFieldItem===g[w].value){v.baseItem=w;break}},F.prototype.wh=function(t,i){var n,e,r,o,a,n=this;if(k(n.L)||(e=n.Ti.getPivotCacheByName(n.L))&&(i.cacheId=e.FVt+""),o=[],r=n.Pq)for(a=0;a<r.length;a++)o.push(r[a].wh(t));i.c_.push({n_:"pivotFields",count:o.length+"",c_:o}),n.VVt(t,i),n.UVt(t,i)},F.prototype.VVt=function(t,i){var n,e,r,o,a,s,u,u,c,u,l,f,h,v,d,p,m,c,b,g,c,n=this,e=n.Pq,r=[],o=[],a=1;if(e)for(s=0;s<e.length;s++)u=e[s],c=(u=n.K.get(u.a))&&u.labelFilter,u=u&&u.valueFilter,h=f=l=void 0,k(c)&&k(u)||(k(c)||(d=void 0,(v={n_:"filter",fld:s+"",evalOrder:"-1"}).id=""+ ++a,p=c.condition,k(p)||(m=p.getConditionType(),l=p.LVt,1===m&&l===M.PivotDateFilterOperator.dateToDate||1===m&&l===M.PivotDateFilterOperator.last7Days?n.toPivotLabelFiltersOOModel(o,c,s,a):((h=w.Caption_Compare_Type_Excel[m]&&w.Caption_Compare_Type_Excel[m][l])!==I&&(v.type=h),c=p.eX,b=p.iX,1===m&&(c=c&&A(c),b=b&&A(b)),v.stringValue1=c,v.stringValue2=b,v.iMeasureFld="0",d={conditions:[g={compareType:l,conType:m,item1:{expected:c},item2:{expected:b},ignoreCase:!0}]})),k(d))||(v.c_=[lt([d],h)],r.push(v)),k(u))||(d=void 0,(v={n_:"filter",fld:s+"",evalOrder:"-1"}).id=""+ ++a,p=u.condition,c=u.conditionByName,v.iMeasureFld=""+(n.RVt(c)||0),m=p.getConditionType(),l=p.LVt,d=3===m?(l=p.uit,{conditions:[{conType:m,expected:p.GVt,type:p.LVt,compareType:p.uit}]}):{conditions:[{compareType:l,conType:m,item1:{expected:p.eX},item2:{expected:p.iX}}]},(h=w.Caption_Compare_Type_Excel[m]&&w.Caption_Compare_Type_Excel[m][l])!==I&&(v.type=h),k(d))||41===l||42===l||(v.c_||(v.c_=[]),v.c_.push(lt([d],h)),r.push(v));0<r.length?i.c_.push({n_:"filters",count:r.length+"",c_:r}):Q(i.c_,{},"filters"),0<o.length&&(i.lossless||(i.lossless={}),i.lossless.losslessPivotFilters=o)},F.prototype.UVt=function(t,i){var n,e,r,o,a,s,u,c,l,f,h,v,d,p,u,m,b,g,w,y,C,w,y,A,w,N,I,T,S,x,n=this,e={R:"columnFields",B:"rowFields"},r={};for(o in e)if(e.hasOwnProperty(o))for(a=n[o],r[e[o]]=[],s=0;s<a.length;s++)r[e[o]].push(a[s].lp);for(u=r.rowFields,c=r.columnFields,n.Q&&1<n.Q.length&&(n.x2===M.DataPosition.row?u.splice(n.P2,0,-2):n.x2===M.DataPosition.col&&c.splice(n.P2,0,-2)),0<u.length&&(l=[],u.forEach(function(t){l.push({n_:"field",x:t})}),i.c_.push({n_:"rowFields",count:l.length+"",c_:l})),0<c.length&&(f=[],c.forEach(function(t){f.push({n_:"field",x:t})}),i.c_.push({n_:"colFields",count:f.length+"",c_:f})),h=n.G,v=[],s=0;s<h.length;s++)v.push({n_:"pageField",fld:h[s].lp});for(0<v.length&&i.c_.push({n_:"pageFields",count:v.length+"",c_:v}),d=n.Q,p=[],m=(u=j(i,"pivotFields"))&&u.c_,s=0;s<d.length;s++)if(b=d[s],(g={n_:"dataField"}).name=b.Zc,g.subtotal=ht(b.Ar),k(b.bbt)||(y=(w=D.ExtendedNumberFormatHelper.getFormatId(b.bbt)).id,(C=w.isBuiltIn)?g.numFmtId=y:((w={}).numberFormat=new D.ExcelNumerFormat(y,b.bbt),g.numFmtId=w.numberFormat.numberFormatId)),p.push(g),y=d[s].lp,m&&m[y]&&(g.fld=""+y,m[y].dataField="1"),(A=b.Or)&&(w=void 0,A.showDataAs&&(w=M.PivotShowDataAs[A.showDataAs]),(N=-1===q.indexOf(w))?g.c_=[{n_:"extLst",c_:[{n_:"ext",r_:[28,1],c_:[{n_:"dataField",pivotShowAs:w}]}]}]:g.showDataAs=w,A.baseFieldName)&&(I=n.getFieldInfoByName(A.baseFieldName),g.baseField=I.lp,T=A.baseFieldItemType,!k(T)))if(T===M.PivotShowDataAsBaseItemType.previous)g.baseItem="1048828";else if(T===M.PivotShowDataAsBaseItemType.next)g.baseItem="1048829";else if(T===M.PivotShowDataAsBaseItemType.item)for(S=I.tl(n)||I._items,x=0;x<S.length;x++)if(A.baseFieldItem===S[x].value){g.baseItem=""+x;break}0<p.length&&i.c_.push({n_:"dataFields",count:p.length+"",c_:p})},F.prototype.RVt=function(t){for(var i,n,i=this.Q,n=0;n<i.length;n++)if(t===i[n].Zc)return n},F.prototype.dy=function(t){var i,n,e,r,i,o,r,i=this,n=i.L,e=this.Ti,r=e.cut[i.L].Pq;return i.DA()&&(t.dateGroups||t.numberGroup)&&(0,w.throwError)(C().PivotTableHasNumberOrDateGroup),i=t.textGroup?(o=t.textGroup.fieldName,(0,M.o)(Object.keys(r),function(t){if(t===o)return C().PivotTableErrorMessage_DuplicatedFieldName}),o):t.originFieldName,(r=this.sy(t.originFieldName))&&this.cy(t.originFieldName,!0),e.addGroup(n,t)?(this.DT({oldGroupInfo:r,groupSourceFieldName:i,type:"group"}),this.q1=!0):C().PivotTableErrorMessage_InvalidGroup},F.prototype.QVt=function(t,i){var n,e=this.L,r;this.Ti.getPivotCacheByName(e).addCalcField(t,i)},F.prototype.WVt=function(){for(var t,i,n,e,r,o,a,t=this,i=t.L,n,e=this.Ti.getCalcFields(i),r=[],o=0;o<e.length;o++)a=t.v_(e[o].Zc),r.push(a?{fieldName:a.Zc,formula:e[o].D5}:{fieldName:e[o].Zc,formula:e[o].D5});return r},F.prototype.FV=function(t){var i,n,e,r,o,a,i=this,n=i.L,e=this.Ti,r=i.getFieldInfoByName(t)&&i.getFieldInfoByName(t).a||t,o=e.getCalcFields(n);if(!k(r))for(a=0;a<o.length;a++)if(o[a].Zc===r)return!0;return!1},F.prototype.zVt=function(t,i,n){var e,r,o,a,r,e=this;return!(k(n)||(r=n.textGroup,o=n.numberGroup,a=n.dateGroups,!(r&&r.fieldName===t||o&&n.originFieldName===t||a&&(r=e.Ti.getPivotCacheByName(e.L).zRt(t))&&r.y1===i)))},F.prototype.cy=function(i,t,n){var e,r,o,a,s,u,c,l,f,f,h,v,d,f,p,e=this,r=e.Ti.getPivotCacheByName(e.L),o=e.v_(i),a=r.getField(i),s=r.ZVt;for(c in s)if(b(s,c)&&(l=s[c],e.zVt(i,c,l))){u=(0,D.RF)(l);break}if(!k(a)&&((f=(f=e.getFilterInfo(i))&&f.labelFilter)&&f.textItem&&(k(f.condition)&&k(f.conditionByName)?f=I:f.textItem=I,e.setLabelFilterInfo(i,f)),h=r.YVt(a.Zc),!n)&&h&&0<h.length)for(v=0;v<h.length;v++)e.HVt(h[v]);o&&((d=o.nrt)&&delete e.nrt[o.Zc],1!==(f=e.Z[o.Zc])&&2!==f||P(e,p=1===f?e.R:e.B,function(t){var t;return null!=(t=t.sortByPivotReferences)&&t.some(function(t){return t.fieldName===i})})),e.q1=!0,n||F.et(e,"updatePivotCache"),t||this.DT({groupInfo:u,type:"ungroup",pivotTable:e})},F.prototype.JVt=function(){for(var t,i,n,e,r,o,t=this,i=t.nw(),n=t.Ti.getPivotCacheByName(t.L),e=0,r=i;e<r.length;e++)o=r[e],k(n.getField(o.a))&&t.removeFieldOrSigmaByName(o.Zc);t.q1=!0},F.prototype.rC=function(t){var i,n,e,r,o,a,i=this,n,e=i.Ti.getPivotCacheByName(i.L).ZVt;for(o in e)if(b(e,o)&&(a=e[o],i.zVt(t,o,a))){r=(0,D.RF)(a);break}return r},F.prototype.HVt=function(t){for(var i,n,e,r,i=this,e=g.PivotTableFieldType.valueField;e>=g.PivotTableFieldType.filterField;e--)for(r=(n=i.nw(e)).length-1;0<=r;r--)n[r].a===t&&(e===g.PivotTableFieldType.valueField&&i.clearValueFilterOfValueField(n[r].Zc),i.removeFieldOrSigmaByName(n[r].Zc))},F.prototype.qVt=function(t){var i,n,e,i,i,i=this,n,e,i=this.Ti.getPivotCacheByName(this.L).Pq[t].W5===M.PivotDataType.number?(i=i.FG(t),this.addFieldByName(t,i,g.PivotTableFieldType.valueField,M.SubtotalType.sum)):this.addFieldByName(t,t,g.PivotTableFieldType.rowField,N);return i},F.prototype.KVt=function(n){var e,t,i,r,e=this,t=this;if(t.Z[n]===g.PivotTableFieldType.valueField)for(r=0;r<4;r++)(i=t.nw(r)).forEach(function(t){var i;t._filterInfo&&t._filterInfo.valueFilter&&t._filterInfo.valueFilter.conditionByName===n&&(i=t._filterInfo.valueFilter.toJSON(),t._filterInfo.valueFilter=N,e.DT({fieldName:t.Zc,filter:i,type:"addValueFilter"}))})},F.prototype.sy=function(t){var i,n,e,r,o,a,i=this,n,e=i.Ti.getPivotCacheByName(i.L).ZVt;for(o in e)if(b(e,o)&&((a=e[o]).textGroup&&a.originFieldName===t||k(a.textGroup)&&a.originFieldName===t)){r=(0,D.RF)(a);break}return r},F.prototype.XVt=function(t,i){var n,e,n=this,e;return n.Ti.getPivotCacheByName(n.L).$Vt(t,i)},F.prototype.tQt=function(t){var i,n,i=this,n;return i.Ti.getPivotCacheByName(i.L).tQt(t)},F.prototype.iQt=function(t){var i,n,i=this,n;return i.Ti.getPivotCacheByName(i.L).nQt(t)},F.prototype.eQt=function(){var t,i,t=this,i;return t.Ti.getPivotCacheByName(t.L).eQt()},F.prototype.rQt=function(){var t,i,t=this,i;return t.Ti.getPivotCacheByName(t.L).rQt()},F.prototype.dispose=function(){var t,i,n,e,r,t=this;if(t.nrt=N,t.dv=N,t.Pq=N,t.cft=N,t.sc=N,t.Y=N,t.H=N,t.Z=N,t.Ti=N,t.Qy=N,!k(t.z)){for(i=0,n=t.z;i<n.length;i++)(e=n[i])&&e.dispose();t.z=N}for(k(t.tx)||t.tx.L0(),k(t.copyFieldsModel)||t.copyFieldsModel.dispose(),r=0;r<t.B.length;r++)t.B[r].eG();for(r=0;r<t.R.length;r++)t.R[r].eG();for(r=0;r<t.G.length;r++)t.G[r].eG();for(r=0;r<t.Q.length;r++)t.Q[r].eG();t.K.dispose(),t.K=N,t.H=N,t.ac=N},w.PivotFieldsModel=t=F,(0,D.$e)(t)},"./dist/plugins/pivot/pivot-core/pivot-view.js":function(t,i){"use strict";var n;function r(t,i,n){var e=this;e.Zc=t,e.dh=i instanceof r?i.dh:i,e.Ti=n}Object.defineProperty(i,"__esModule",{value:!0}),i.PivotView=void 0,r.prototype.getName=function(){return this.Zc},r.prototype.paint=function(){this.GY.render()},r.prototype.dispose=function(){var t=this;t.dh=null,t.GY&&t.GY.dispose()},i.PivotView=r},"./dist/plugins/pivot/pivot-definition.js":function(){},"./dist/plugins/pivot/pivot-filter-diagram/slicer-base/pivot-slicer-caches.js":function(L,r,t){"use strict";var i,l,g,n,w,f,h,m,u,e,o,v,t,b,a,s,E,B,R,G,V,U,t,c,n,y,d,Q,p,C,A,t,N,W,z,I,T,S,x,M,D;function k(t,i){var n,e,r;if((0,f.ht)(t.P))for(t.k={},t.P={},t.D=[],n=i.oQt,e=t.lp,r=0;r<n.length;r++)n[r][e]=t.aQt(n[r][e],r,!1);t.sQt||t.uQt()}function Z(t){return t.replace(/[^A-Za-z0-9_\.\\\?\u0080-\uFFFF]+$/g,"").replace(/[^A-Za-z0-9_\.\\\?\u0080-\uFFFF]+/g,"_")}function Y(t,i){return(i=void 0===i?!1:i)?+t.state.pivotCacheId:+t.data.tabular.pivotCacheId}function H(t,n){var e=[];return g.GC$.each(t,function(t,i){var i,i,i=i.slicerCacheDefinition||i.timelineCacheDefinition;i&&i.pivotTables&&-1!==n.indexOf(i.name)&&(i=i.pivotTables.pivotTable,g.GC$.each(i,function(t,i){var i=+i.tabId;-1===e.indexOf(i)&&e.push(i)}))}),e}function J(n,t){var e=[];return g.GC$.each(t,function(t,i){-1!==n.indexOf(+i.sheetId)&&e.push(i.name)}),e}function q(t,n,e){var r=[];return t&&0<t.length&&g.GC$.each(t,function(t,i){var i,i,i;i.Type===e&&(i=g.Util.vr(i.Target),i=n[i])&&g.GC$.each(i.c_||(null==(i=null==i?void 0:i.slicers)?void 0:i.slicer),function(t,i){-1===r.indexOf(i.cache)&&r.push(i.cache)})}),r}function K(t,i,n,e){var r,o,a,i,o,t,s,r=i.slicers,o=i.slicerCaches,a=i.timelines,i=i.timelineCaches;if(r&&0!==r.length)return J(s=H(o,t=q(o=t&&t[n],r,g.RelationshipConstants.yc).concat(q(o,a,g.RelationshipConstants.Nc))).concat(H(i,t)),e)}function X(t,i){var n,e,t,r,o,a,s,r,i;if(!(0,f.ht)(t.filter1)||!(0,f.ht)(t.filter2))return n={},t.and&&(n.and="1"),e=t.filter1,t=t.filter2,a=!(0,f.ht)(e),s=!(0,f.ht)(t),a&&(r="none"!==(r=i[e.operator])?{operator:r,val:e.value}:{val:e.value}),s&&(o="none"!==(i=i[e.operator])?{operator:i,val:t.value}:{val:t.value}),a&&s?n.customFilter=[r,o]:a?n.customFilter=r:s&&(n.customFilter=o),n}function $(t){var i,n,e,t,i=t.getConditionType(),n=t.LVt,e=t.eX,t=t.iX;return 1===i&&(e=e&&c(e),t=t&&c(t)),{compareType:n,conType:i,item1:{expected:e},item2:{expected:t},ignoreCase:!0}}function tt(t,i){var n,e,r,r,n=(0,f.ht)(t.compareType)?t.LVt:t.compareType;if(8<=n&&n<=23||40===n)e={filterType:2,type:i},(r=(0,h.getPivotDateExConditionRange)(n)).from&&r.to&&(e.value=r.from,e.maxValue=r.to);else if(24<=n&&n<=39)e={filterType:2,type:i};else if(0<=n&&n<=7)return r=$(t),(0,h.getCellValuePivotFilter)(r);return e}function j(t){this.vpt=t,this.cQt=[],this.lQt=[]}function O(t,i,n,e){var t,i,t=x.call(this,t,i,n,e)||this;return t.slicerCacheType=y.pivotTimeline,t.selectionLevel=d.months,t.level=d.months,(i=t).bounds=i.buildBounds(),i.selection=m.keyword_undefined,t}function _(t,i,n,e){var t=M.call(this,t,i,n,e)||this;return t.slicerCacheType=y.pivotSlicer,t.fQt=g.SortState.ascending,t.hQt=!0,t.vQt=!0,t.dQt=!0,t.fQt=g.SortState.ascending,t.items=t.initItems(),t}function F(t,i,n,e){var e=D.call(this,e,n)||this;return e.Ti=t,e.pivotCache=i,e.pivotTables=[],e}function it(t,i){var n,e,r,o,a,s,n=g.util.xr(t.workbook,g.XFileConstants.Au);for((0,f.ht)(n)&&(n={n_:g.XFileConstants.Au,c_:[]},t.workbook.c_.push(n)),e=[],r=0,o=i;r<o.length;r++)a=o[r],e.push({n_:"x14:slicerCache","r:id":a});(s=n.c_).unshift({n_:"ext",r_:[54,55],c_:[{n_:"x14:slicerCaches",c_:e}]})}function nt(t,i){var n,e,r,o,a,s,n=g.util.xr(t.workbook,g.XFileConstants.Au);for((0,f.ht)(n)&&(n={n_:g.XFileConstants.Au,c_:[]},t.workbook.c_.push(n)),e=[],r=0,o=i;r<o.length;r++)a=o[r],e.push({n_:"x15:timelineCacheRef","r:id":a});(s=n.c_).push({n_:"ext",r_:[56,32],c_:[{n_:"x15:timelineCacheRefs",c_:e}]})}function et(t){var i,n,i,n;g.util.xr(t.workbook,g.XFileConstants.Au).c_.push({n_:"ext",r_:[57,58],c_:[{n_:"x14:workbookPr",c_:[{}]}]},{n_:"ext",r_:[59,32],c_:[{n_:"x15:workbookPr",chartTrackingRefBase:"1"}]})}function rt(t,i,n){var e,r,o,a,s,u,c,l,f,f,e=t.timelineCaches,r=0;for(e?r=Object.keys(e).length:e=t.timelineCaches={},o=[],a=t.workbook.rels,s=0,u=i;s<u.length;s++)(c=u[s]).slicerCacheType===w.SlicerCacheType.pivotTimeline&&(l=r+=1,f=E(a),a.c_.push({n_:"Relationship",Id:f="rId"+f,Type:g.RelationshipConstants.kc,Target:B("timelineCaches/timelineCache"+l)}),e[g.XFileConstants.pu+l]={timelineCacheDefinition:c.wh(n)},o.push(f));nt(t,o)}function ot(t,i,n,e){for(var r,o,a,s,u,c,l,f,h,v,d,p,r=t.timelines,o=Object.keys(r).length,a=0,s=n;a<s.length;a++)if(0<(c=(u=s[a]).slicers.all().filter(function(t){return"timeline"===t.ma})).length)for(l=r[g.XFileConstants.gu+(o+=1)]={timelines:{r_:[60,14,30,43],timeline:[]}},t.drawings||(t.drawings={}),f=0,h=c;f<h.length;f++)v=h[f],p=(d=G(t,R(t,u.name()))).c_,v.wh(l.timelines.timeline,p,e),v.style().wh(!0,!1,e);w.adi(t,i,w.SlicerCacheType.pivotTimeline),at(n,t)}function at(t,i){for(var i,n,e,r,o,a,s,u,c,l,f,h,i=i.styles,n=new g.SimpleSharedStrings,e=new g.SimpleSharedStrings,r=new g.SharedDxfs(n,e),o=[],a=0,s=t;a<s.length;a++)for(l=0,f=c=(u=s[a]).slicers.all().filter(function(t){return"timeline"===t.ma});l<f.length;l++)(h=f[l]).style().wh(!1,!0,m.keyword_undefined,{x15dxfsRecords:r,timelineStyleNodes:o});i.extLst||(i.extLst={}),g.GC$.extend(i.extLst,{x15dxfsRecords:r.iv(),timelineSharedColors:n.wh(),timelineCommonSharedStrings:e.wh(),timelineStyleNodes:o})}function st(t,i,n){for(var e,r,o,e=0,r=t.sheets;e<r.length;e++)ut(o=r[e],i,n)}function ut(t,i,n){var e,r,o,t,e=n.sheetRelsMap,r=t.name(),o=t.Uw(),t=K(e,n,r,i);g.GC$.each(t,function(t,i){o.addReferenceSheetName(i)})}function P(t,i,n,e,r){t.LQt(r=void 0===r?!1:r),t.yh(i,n,m.keyword_undefined,e),t.updateSlicerCaches()}i=this&&this.__extends||(S=function(t,i){return(S=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}S(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),l=this&&this.__spreadArray||function(t,i,n){if(n||2===arguments.length)for(var e=0,r=i.length,o;e<r;e++)!o&&e in i||((o=o||Array.prototype.slice.call(i,0,e))[e]=i[e]);return t.concat(o||Array.prototype.slice.call(i))},Object.defineProperty(r,"__esModule",{value:!0}),r.PivotSlicerCacheManager=r.PivotTimelineSlicerCache=r.PivotItemSlicerCache=void 0,g=t("Core"),n=t("@spreadjs/js-sheets-common"),w=t("Slicers"),f=t("Pivot"),h=t("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),m=t("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),u=t("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-list.js"),e=t("./dist/plugins/pivot/pivot-filter-diagram/slicer/pivot-item-slicer.js"),o=t("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-slicer.js"),v=t("./dist/plugins/pivot/pivot-util.js"),t=new n.Common.ResourceManager(f.SR,"PivotEngine"),b=t.getResource.bind(t),a="Slicer_",s="NativeTimeline_",E=g.Util.wr,B=g.Util.Mr,R=g.Util.ho,G=g.Util.Er,V=g.mt.vo,U=g.mt.n1,t=n.Common.ct,c=t.o0,w&&(n=w.SlicerCacheBase,y=w.SlicerCacheType,d=w.TimelineLevel,Q=w.rSe,p=w.loadSheetSlicers,C=w.encodeSlicerName,A=w.decodeSlicerName,i(F,D=n),F.prototype.pQt=function(t){for(var i,n,i=-1,n=0;n<this.pivotTables.length;n++)this.pivotTables[n].name()===t.name()&&(i=n);return i},F.prototype.mQt=function(){return this.Ti.mQt()},F.prototype.beforeSetFilter=function(){var t=this;D.prototype.beforeSetFilter.call(this),t.Ti.qCe()},F.prototype.afterSetFilter=function(){var t=this;D.prototype.afterSetFilter.call(this),t.Ti.$Ce(),t.refreshSlicers()},F.prototype.CAe=function(t){this.Ti.NAe(t,this.sourceName)},F.prototype.IAe=function(t){return this.Ti.IAe(t,this.sourceName)},F.prototype.SAe=function(){for(var t,i,n,e,r,t=this,i,n=0,e=t.pivotTables;n<e.length;n++)if(r=e[n],t.IAe(r.name()))return!1;return!0},F.prototype.bQt=function(i){var n,e;return void 0===i&&(i=!1),(n=this).gQt&&0<Object.keys(n.gQt).length&&(e=n.Ti.mQt(),g.GC$.each(n.gQt,function(t){var t=e.wQt(t);if(!t)return!1;i=!0,n.pivotTables.push(t)})),n.gQt&&n.pivotTables.length===Object.keys(n.gQt).length&&(n.gQt=m.keyword_null),i&&n.updateCache(),!0},F.prototype.isConnectedPivotTable=function(t){for(var i=0;i<this.pivotTables.length;i++)if(this.pivotTables[i].name()===t)return!0;return!1},F.prototype.connect=function(t,i){var n,e,r,n=this,e;t.dh.Ti.getPivotCacheByName(t.dh.L).yQt!==n.pivotCache.yQt||-1!==n.pQt(t)||((r=n.Ti.getExistedSlicerCache(t,n.sourceName,n.slicerCacheType))?n.Ti.CQt(n,r):n.pivotTables.push(t),i)||n.setSingleFilter(t)},F.prototype.disconnect=function(t){var i,t,i;t.dh.Ti.getPivotCacheByName(t.dh.L).yQt===this.pivotCache.yQt&&-1!==(t=this.pQt(t))&&this.pivotTables.splice(t,1)},F.prototype.onWorkSheetDisposing=function(t){var i,n,e,i=this;for(D.prototype.onWorkSheetDisposing.call(this,t),n=i.pivotTables.length-1;-1<n;n--)(e=i.pivotTables[n]).Ti&&e.Ti.name()!==t||i.pivotTables.splice(n,1)},F.prototype.clearSelfFilter=function(){},F.prototype.clearFilter=function(){var t,i,n,e,t=this;if(t.canUpdate()&&!t.filterCleared()){for(t.clearSelfFilter(),t.beforeSetFilter(),i=0;i<this.pivotTables.length;i++)(e=(n=this.pivotTables[i]).dh).wVt({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:t.sourceName,pivotName:n.name(),commandName:"ClearFilter",clearType:1,labelType:t.slicerCacheType===y.pivotSlicer?1:2}});t.afterSetFilter()}},F.prototype.setFilter=function(){},F.prototype.setSingleFilter=function(t){},F.prototype.toJSON=function(){var t,n,i,t=this,n=t.Ti.mQt(),i=t.pivotTables.map(function(t){var i=t.Ti;return{tabId:n.getSheetIndex(i.name())+1,name:t.Zc}});return{name:t.name,sourceName:t.sourceName,pivotCacheId:t.pivotCache.yQt,pivotTables:i}},F.prototype.wh=function(){for(var t,i,n,e,r,o,a,s,t=this,i={r_:t.slicerCacheType===y.pivotSlicer?[42,14,30,43]:[60,32,14],name:C(t.name),sourceName:C(t.sourceName),pivotTables:{pivotTable:[]}},n=t.Ti.mQt(),e=i.pivotTables.pivotTable,r=t.pivotTables,o=0;o<r.length;o++)s=(a=r[o]).Ti,e.push({tabId:n.getSheetIndex(s.name())+1+"",name:C(a.Zc)});return i},F.prototype.fromJSON=function(t){var n,e,n=this;D.prototype.fromJSON.call(this,t),n.pivotTables=[],e=n.Ti.mQt(),(0,f.o)(t.pivotTables,function(t){var i=e.wQt(t.name);i?n.pivotTables.push(i):(n.gQt||(n.gQt={}),n.gQt[t.name]=!0)})},F.prototype.preFromSJSFormat=function(t){var e,r,t,t,e=this;e.disposeAllSlicers(),e.IQt=[],e.pivotTables=[],e.name=A(t.name),e.sourceName=A(t.sourceName),r=e.Ti.mQt(),t=t.pivotTables&&t.pivotTables.pivotTable,t=Array.isArray(t)?t:[t],g.GC$.each(t,function(t,i){var i,n,i=U(i.name),n=r.wQt(i);n?e.pivotTables.push(n):(e.gQt||(e.gQt={}),e.gQt[i]=!0)})},F.prototype.yh=function(t,i,n){},F.prototype.dispose=function(){var t=this;D.prototype.dispose.call(this),t.Ti=m.keyword_null,t.pivotCache=m.keyword_null,t.pivotTables=m.keyword_null},i(_,M=t=F),_.prototype.filterCleared=function(){for(var t,i,t=this,i=0;i<t.items.length;i++)if(!1===t.items[i].selected)return!1;return!0},_.prototype.add=function(t,i){var n,i,n=this,i=new e.PivotTableItemSlicer(i,t,n);return n.IQt.push(i),i},_.prototype.sortState=function(t){var i=this;if(0===arguments.length)return i.fQt;(0,f.ht)(t)||t===i.fQt||(i.fQt=t,i.refreshSlicers())},_.prototype.showNoDataItems=function(t){var i=this;if(0===arguments.length)return i.hQt;(t=!!t)!==i.hQt&&(i.hQt=t,i.refreshSlicers())},_.prototype.showNoDataItemsInLast=function(t){var i=this;if(0===arguments.length)return i.vQt;(t=!!t)!==i.vQt&&(i.vQt=t,i.refreshSlicers())},_.prototype.visuallyNoDataItems=function(t){var i=this;if(0===arguments.length)return i.dQt;(t=!!t)!==i.dQt&&(i.dQt=t,i.refreshSlicers())},_.prototype.initItems=function(){var t,i,n,e,r,o,a,t=this.pivotCache.getField(this.sourceName);for(e in k(t,this.pivotCache),i=[],n=t.DH(),t.sQt)t.sQt.hasOwnProperty(e)&&(r=t.sQt[e],a=n[o=parseInt(e,10)],0!==t.W5||isNaN(+a)||(a=+a),i[r]={text:a,selected:!0,noData:!0});return i},_.prototype.buildItems=function(t){var i,t,n,e,r,o,a,s,e,u,c,l,f,h,v,d,p,i=this;if(0===i.pivotTables.length)return this.items||this.initItems();for(h in t=(t||i.pivotTables[0]).dh,n=i.sourceName,r=(e=i.pivotCache).getField(n),o=b().blank,a=r.sf(),k(r,e),s=i.TQt(i.MQt()).NQt,c=(u=(e=t.getFilterInfo(n))&&e.labelFilter&&e.labelFilter.textItem)||{isAll:!0,list:m.keyword_undefined},l=[],f=r.DH(),a)a.hasOwnProperty(h)&&(v=a[h],p=f[d=parseInt(h,10)],0!==r.W5||isNaN(+p)||(p=+p),l[v]={text:p,selected:c.isAll||!!c.list&&-1!==c.list.indexOf(p),noData:s[d]===m.keyword_undefined||p===o});return l},_.prototype.TQt=function(t){var i=this,n;return i.Ti.mQt().fMt.TQt(i.pivotCache.getName(),t,i.sourceName)},_.prototype.MQt=function(){var a,s,t,u,c,l,a=this,s=a.pivotTables[0].dh,t=s.bit(),u=s.getAllFieldNameList(),c=[],l=s.Ti.getPivotCacheByName(s.L);return u.splice(u.indexOf(a.sourceName),1),(0,f.o)(t,function(t){var i,n,e,r,o,o,r,t,i,i=l.zRt(t.a),n,e=!(0,f.ht)(i.y1)?l.zRt(i.y1):void 0;i.Zc!==a.sourceName&&((r=s.getFilterInfo(t.a))&&r.u&&(s.q1=!0,r.u=!1),-1!==(o=u.indexOf(t.a))&&u.splice(o,1),r=(o=t.toPivotViewQueryField(r,s.Z[t.Zc],i,e,!0)).items,t=o.sourceName,i=o.isALL,c.push({items:r,sourceName:t,isALL:i}))}),(0,f.o)(u,function(t){var i,n,e,i,n,e,i=s.getFilterInfo(t);i&&i.labelFilter&&i.labelFilter.textItem&&!1===i.labelFilter.textItem.isAll&&(n=l.zRt(t),e=(0,f.ht)(n.y1)?void 0:l.zRt(n.y1),n=(i=(0,h.toPivotViewQueryField)(t,t,-1,i,m.keyword_undefined,-1,n,e)).items,e=i.isALL,c.push({items:n,sourceName:t,isALL:e}))}),c},_.prototype.updateItems=function(t){this.items=this.buildItems(t)},_.prototype.updateCache=function(t){var i,n,e,r,i=this;if(i.canUpdate()&&i.SAe()){if(i.updateItems(t),t)for(n=0,e=i.pivotTables;n<e.length;n++)(r=e[n])!==t&&i.setSingleFilter(r,t);i.refreshSlicers()}},_.prototype.clearSelfFilter=function(){var t,i,t,i=this.items;(0,f.o)(i,function(t){t.selected=!0})},_.prototype.setSingleFilter=function(t,i){var n,e,r,o,r,n=this;n.canUpdate()&&(e=t.name(),n.IAe(e)||(r=n.items,o=[],(0,f.o)(r,function(t){o.push({status:t.selected,value:t.text})}),r=t.dh,n.suspendUpdate(),r.wVt({cmd:"filterFieldLabelValue",sheetName:"",cmdOption:{fieldName:n.sourceName,pivotName:e,slicerCacheName:n.name,dataOfListBox:o}}),n.CAe(e),n.resumeUpdate()))},_.prototype.setFilter=function(t){var i,n,e,r,o,a,i=this;if(i.canUpdate()&&(t||!i.filterCleared())){for(t=t||i.items,n=[],(0,f.o)(t,function(t){n.push({status:t.selected,value:t.text})}),i.beforeSetFilter(),e=0;e<i.pivotTables.length;e++)o=(r=i.pivotTables[e]).name(),i.IAe(o)||((a=r.dh).wVt({cmd:"filterFieldLabelValue",sheetName:"",cmdOption:{fieldName:i.sourceName,pivotName:r.name(),slicerCacheName:i.name,dataOfListBox:n}}),i.CAe(o));i.afterSetFilter()}},_.prototype.toJSON=function(){var t,i,n,e,r,t=this,i=M.prototype.toJSON.call(this),n=t.pivotCache.getField(t.sourceName);return n&&(r=n.getFieldsItemList(),e=t.items.map(function(t){return{x:r.indexOf(t.text),s:t.selected,nd:t.noData}})),{name:i.name,sourceName:i.sourceName,pivotCacheId:i.pivotCacheId,pivotTables:i.pivotTables,items:e,sortOrder:t.fQt===g.SortState.descending?g.SortState.descending:g.SortState.ascending,showNoDataItems:t.hQt,showNoDataItemsInLast:t.vQt,visuallyNoDataItems:t.dQt}},_.prototype.wh=function(t){var i,n,t,e,t,r,i,o,a,s,u,c,i=this,n=i.items,t=(null==t?void 0:t.fileType)===g.OpenSaveFileType.excel,e=M.prototype.wh.call(this);if(e.data={tabular:{pivotCacheId:i.pivotCache.yQt+"",items:{count:n.length,i:[]}}},i.fQt===g.SortState.descending&&(e.data.tabular.sortOrder="descending"),!1===i.dQt?e.data.tabular.crossFilter="none":!1===i.vQt&&(e.data.tabular.crossFilter="showItemsWithNoData"),!1===i.hQt&&(t&&delete e.data.tabular.crossFilter,e.extLst={ext:[{r_:[33,44],slicerCacheHideItemsWithNoData:{}}]}),t=i.pivotCache.getField(i.sourceName)){for(r=t.getFieldsItemList(),i=e.data.tabular.items.i,o=[],a=[],s=0;s<n.length;s++)u=n[s],c={x:r.indexOf(u.text)},u.selected&&(c.s="1"),(u.noData?(c.nd="1",a):o).push(c);i.push.apply(i,l(l([],o,!1),a,!1))}return e},_.prototype.fromJSON=function(t){var i,n,e,i=this;M.prototype.fromJSON.call(this,t),k(n=this.pivotCache.getField(this.sourceName),i.pivotCache),t.items?(e=n.DH(),i.items=t.items.map(function(t){var i;return{text:e[+t.x],selected:!!t.s,noData:!!t.nd}})):i.items=i.buildItems(),(0,f.ht)(t.sortOrder)||(i.fQt=t.sortOrder),(0,f.ht)(t.showNoDataItems)||(i.hQt=t.showNoDataItems),(0,f.ht)(t.showNoDataItemsInLast)||(i.vQt=t.showNoDataItemsInLast),(0,f.ht)(t.visuallyNoDataItems)||(i.dQt=t.visuallyNoDataItems)},_.prototype.preFromSJSFormat=function(t){var i,n,e,n,e,i=this;M.prototype.preFromSJSFormat.call(this,t),n=t.extLst&&t.extLst.ext,(0,f.ht)(n)||(e=!1,Array.isArray(n)?e=0<n.filter(function(t){return t.slicerCacheHideItemsWithNoData}).length:n.slicerCacheHideItemsWithNoData&&(e=!0),e&&(i.hQt=!1)),n=t.data.tabular,(0,f.ht)(n.sortOrder)||(i.fQt="descending"===n.sortOrder?g.SortState.descending:g.SortState.ascending),"none"===(e=n.crossFilter)?i.dQt=!1:"showItemsWithNoData"===e&&(i.vQt=!1)},_.prototype.yh=function(t,i,n){},_.prototype.dispose=function(){var t=this;M.prototype.dispose.call(this),t.items=m.keyword_null},N=_,W=[f.PivotDateFilterOperator.equalsTo,f.PivotDateFilterOperator.Between,f.PivotDateFilterOperator.tomorrow,f.PivotDateFilterOperator.today,f.PivotDateFilterOperator.yesterday,f.PivotDateFilterOperator.nextWeek,f.PivotDateFilterOperator.thisWeek,f.PivotDateFilterOperator.lastWeek,f.PivotDateFilterOperator.nextMonth,f.PivotDateFilterOperator.thisMonth,f.PivotDateFilterOperator.lastMonth,f.PivotDateFilterOperator.nextQuarter,f.PivotDateFilterOperator.thisQuarter,f.PivotDateFilterOperator.lastQuarter,f.PivotDateFilterOperator.nextYear,f.PivotDateFilterOperator.thisYear,f.PivotDateFilterOperator.lastYear,f.PivotDateFilterOperator.yearToDate,f.PivotDateFilterOperator.dateToDate],z=[f.PivotDateFilterOperator.before,f.PivotDateFilterOperator.beforeEqualsTo,f.PivotDateFilterOperator.after,f.PivotDateFilterOperator.afterEqualsTo,f.PivotDateFilterOperator.Between,f.PivotDateFilterOperator.notBetween],i(O,x=t),Object.defineProperty(O.prototype,"canShowRange",{get:function(){return(0,f.ht)(this.filterType)||this.isValidFilterType},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"isValidFilterType",{get:function(){var t=this.filterType,i=this.getFilterCondition();return-1!==W.indexOf(t)&&(t!==f.PivotDateFilterOperator.dateToDate||!i.EVt)},enumerable:!1,configurable:!0}),Object.defineProperty(O.prototype,"filterType",{get:function(){var t,t,t=this;return 0===t.pivotTables.length&&t.selection?f.PivotDateFilterOperator.Between:(t=t.getFilterCondition())&&t.LVt},enumerable:!1,configurable:!0}),O.prototype.getFilterCondition=function(t){var i,t,i,i=this;return 0!==i.pivotTables.length&&(i=(t=(t||i.pivotTables[0]).dh.getFilterInfo(i.sourceName))&&t.labelFilter&&t.labelFilter.condition&&t.labelFilter.condition)&&i.sn===f.PivotConditionType.date?i:m.keyword_undefined},O.prototype.filterCleared=function(){var t=this;return!(!(0,f.ht)(t.filterType)&&!t.isValidFilterType||t.selection&&(t.selection.startDate!==t.bounds.startDate||t.selection.endDate!==t.bounds.endDate))},O.prototype.buildBounds=function(){var t=this.pivotCache.getField(this.sourceName);return{startDate:t.T,endDate:t.gd}},O.prototype.buildSelections=function(t){var i,n,e,i,r,o,a,s,i=this;if(!i.isValidFilterType)return m.keyword_undefined;if(0===i.pivotTables.length)return this.selection||this.bounds||this.buildBounds();if(!(n=i.getFilterCondition(t)))return m.keyword_undefined;switch(e=n.xQt,i=new Date,r=(0,f.DQt)(i),o=(0,f.DQt)(i),a=(0,f.SQt)(e,n.eX),s=(0,u.getQuarter)(r),n.LVt){case f.PivotDateFilterOperator.equalsTo:r=new Date(a),o=new Date(a);break;case f.PivotDateFilterOperator.dateToDate:case f.PivotDateFilterOperator.Between:r=new Date(a),o=new Date((0,f.SQt)(e,n.iX));break;case f.PivotDateFilterOperator.tomorrow:r.setDate(r.getDate()+1),o.setDate(o.getDate()+1);break;case f.PivotDateFilterOperator.today:break;case f.PivotDateFilterOperator.yesterday:r.setDate(r.getDate()-1),o.setDate(o.getDate()-1);break;case f.PivotDateFilterOperator.nextWeek:r.setDate(r.getDate()-r.getDay()+7),o.setDate(o.getDate()-o.getDay()+14);break;case f.PivotDateFilterOperator.thisWeek:r.setDate(r.getDate()-r.getDay()),o.setDate(o.getDate()-o.getDay()+6);break;case f.PivotDateFilterOperator.lastWeek:r.setDate(r.getDate()-r.getDay()-7),o.setDate(o.getDate()-o.getDay());break;case f.PivotDateFilterOperator.nextMonth:r.setDate(1),r.setMonth(r.getMonth()+1),o.setMonth(o.getMonth()+1),o.setDate((0,u.getLastDateOfMonth)(o));break;case f.PivotDateFilterOperator.thisMonth:r.setDate(1),o.setDate((0,u.getLastDateOfMonth)(o));break;case f.PivotDateFilterOperator.lastMonth:r.setDate(1),r.setMonth(r.getMonth()-1),o.setMonth(o.getMonth()-1),o.setDate((0,u.getLastDateOfMonth)(o));break;case f.PivotDateFilterOperator.nextQuarter:r.setDate(1),r.setMonth(3*s),o.setMonth(3*(s+1)-1),o.setDate((0,u.getLastDateOfMonth)(o));break;case f.PivotDateFilterOperator.thisQuarter:r.setDate(1),r.setMonth(3*(s-1)),o.setMonth(3*s-1),o.setDate((0,u.getLastDateOfMonth)(o));break;case f.PivotDateFilterOperator.lastQuarter:r.setDate(1),r.setMonth(3*(s-2)),o.setMonth(3*(s-1)-1),o.setDate((0,u.getLastDateOfMonth)(o));break;case f.PivotDateFilterOperator.nextYear:r.setDate(1),r.setMonth(0),r.setFullYear(r.getFullYear()+1),o.setFullYear(o.getFullYear()+1),o.setMonth(11),o.setDate(31);break;case f.PivotDateFilterOperator.thisYear:r.setDate(1),r.setMonth(0),o.setMonth(11),o.setDate(31);break;case f.PivotDateFilterOperator.lastYear:r.setDate(1),r.setMonth(0),r.setFullYear(r.getFullYear()-1),o.setFullYear(o.getFullYear()-1),o.setMonth(11),o.setDate(31);break;case f.PivotDateFilterOperator.yearToDate:r.setDate(1),r.setMonth(0)}return{startDate:r,endDate:o}},O.prototype.updateCache=function(t){var i,n,e,r,i=this;if(0!==i.pivotTables.length&&i.canUpdate()&&i.SAe()){if(i.bounds=i.buildBounds(),i.selection=i.buildSelections(t),t)for(n=0,e=i.pivotTables;n<e.length;n++)(r=e[n])!==t&&i.setSingleFilter(r,t);i.refreshSlicers()}},O.prototype.clearSelfFilter=function(){this.selection=m.keyword_null},O.prototype.setSingleFilter=function(t,i){var n,e,r,i,o,i,o,i,n=this;n.canUpdate()&&(e=t.name(),n.IAe(e)||(r=t.dh,i?(i=i.labelFilter(n.sourceName),(o=t.labelFilter(n.sourceName)||{}).condition=null==i?void 0:i.condition,o.condition||o.textItem||o.conditionByName||(o=m.keyword_null),n.suspendUpdate(),r.wVt({cmd:"doPivotTableFilter",sheetName:"",cmdOption:{labelFilter:o,fieldName:n.sourceName,pivotName:e,slicerCacheName:n.name}}),n.CAe(e),n.resumeUpdate()):n.filterCleared()||(o=(i=n.selection).startDate,i=i.endDate,n.suspendUpdate(),r.wVt({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:n.sourceName,pivotName:t.name(),slicerCacheName:n.name,command:"6",isWholeDay:!0,value1:o,value2:i}}),n.CAe(e),n.resumeUpdate())))},O.prototype.setFilter=function(t){var i,t,n,e,r,o,a,s,i=this;if(i.canUpdate()&&(t||!i.filterCleared())){for(t&&(i.selection=t),n=(t=i.selection).startDate,e=t.endDate,i.beforeSetFilter(),r=0;r<i.pivotTables.length;r++)a=(o=i.pivotTables[r]).name(),i.IAe(a)||((s=o.dh).wVt({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:i.sourceName,pivotName:o.name(),slicerCacheName:i.name,command:"6",isWholeDay:!0,value1:n,value2:e}}),i.CAe(a));i.afterSetFilter()}},O.prototype.add=function(t,i){var n,i,n=this,i=new o.PivotTableTimelineSlicer(i,t,n);return n.IQt.push(i),i},O.prototype.toJSON=function(){var t,i,t,i=this,t=x.prototype.toJSON.call(this);return{name:t.name,sourceName:t.sourceName,pivotCacheId:t.pivotCacheId,pivotTables:t.pivotTables,selectionStartDate:i.selection&&i.selection.startDate.toString(),selectionEndDate:i.selection&&i.selection.endDate.toString(),boundsStartDate:i.bounds.startDate.toString(),boundsEndDate:i.bounds.endDate.toString(),filterType:i.filterType,filterCondition:null==(t=i.getFilterCondition())?void 0:t.toJSON()}},O.prototype.wh=function(t){var i,n,e,r,o,a,s,u,c,a,e,r,c,a,e,i,i=this,n=x.prototype.wh.call(this),e=i.selection,r=i.bounds,o=i.filterType,a=(0,f.ht)(o),s=h.Caption_Compare_Type_Excel[1][o],u=i.isValidFilterType,c=n.state={minimalRefreshVersion:"6",lastRefreshVersion:"6",pivotCacheId:i.pivotCache.yQt+""};return a||u||(c.singleRangeFilterState="0"),c.filterType=a||!s?"unknown":s,u&&e&&(c.selection={startDate:(0,f.kQt)(e.startDate),endDate:(0,f.kQt)(e.endDate)}),r&&(a=new Date("1900/01/01"),e=new Date("1900/01/01"),a.setFullYear(r.startDate.getFullYear()),e.setFullYear(r.endDate.getFullYear()+1),c.bounds={startDate:(0,f.kQt)(a),endDate:(0,f.kQt)(e)}),(r=i.getFilterCondition())&&(c=tt(r,s),a=-1!==z.indexOf(o),e="0",c&&!(0,f.ht)(c.isWholeDay)&&(e=c.isWholeDay?"1":"0"),i={useWholeDay:e=a?"1":e,fld:"1",id:"1",autoFilter:{ref:"A1",filterColumn:{r_:[43],colId:"0"}}},u&&c?(2===c.filterType&&(i.autoFilter.filterColumn.dynamicFilter=(0,v.writePivotDynamicFilter)(c)),n.timelinePivotFilter=i):a&&(i.autoFilter.filterColumn.customFilters=X(c,v.PivotComparisonOperators),n.timelinePivotFilter=i)),n},O.prototype.fromJSON=function(t){var i=this;x.prototype.fromJSON.call(this,t),t.selectionStartDate&&t.selectionEndDate&&(i.selection={startDate:new Date(t.selectionStartDate),endDate:new Date(t.selectionEndDate)}),i.bounds={startDate:new Date(t.boundsStartDate),endDate:new Date(t.boundsEndDate)}},O.prototype.preFromSJSFormat=function(t){var i,t,n,t,i=this;x.prototype.preFromSJSFormat.call(this,t),(t=t.state)&&(n=t.selection,t=t.bounds,n&&n.startDate&&n.endDate&&(i.selection={startDate:new Date(n.startDate),endDate:new Date(n.endDate)}),t)&&t.startDate&&t.endDate&&(i.bounds={startDate:new Date(t.startDate),endDate:new Date(t.endDate)})},O.prototype.yh=function(t,i,n){},O.prototype.dispose=function(){x.prototype.dispose.call(this)},I=O,j.prototype.jQt=function(t){var i,n,e,r,o,i=this,n=i.vpt;if(i.get(t)||n.getCustomName(t))return!1;for(e=n.sheets,r=0;r<e.length;r++)if((o=e[r]).getCustomName(t))return!1;return!0},j.prototype.OQt=function(t,i){var n,e,r,n=this,e=t+Z(i);if(n.jQt(e))return e;for(r=1;!n.jQt(e+r);)r+=1;return e+r},j.prototype.mQt=function(){return this.vpt},j.prototype.PQt=function(i,n,e){var r=[];return(0,f.o)(this.cQt,function(t){t.pivotCache.getName()!==i||n&&t.slicerCacheType!==n||e&&t.sourceName!==e||r.push(t)}),r},j.prototype.getPTConnectedSlicers=function(n){var e=[];return(0,f.o)(this.cQt,function(t){for(var i=0;i<t.pivotTables.length;i++)t.pivotTables[i]===n&&(e=e.concat(t.IQt))}),e},j.prototype.getExistedSlicerCache=function(n,e,r){var o=m.keyword_null;return(0,f.o)(this.cQt,function(t){if(t.sourceName===e&&t.slicerCacheType===r)for(var i=0;i<t.pivotTables.length;i++)if(t.pivotTables[i]===n)return o=t,!0}),o},j.prototype.CQt=function(i,t){var n=this;i.pivotTables=i.pivotTables.concat(t.pivotTables),(0,f.o)(t.IQt,function(t){i.IQt.push(t),t.FQt=i}),t.pivotTables=[],t.IQt=[],n.remove(t.name),i.setFilter()},j.prototype.get=function(t){for(var i,n,e,i=this,n=0;n<i.cQt.length;n++)if((e=i.cQt[n]).name===t)return e;return m.keyword_undefined},j.prototype.add=function(t,i,n){var e,r,r,e;return void 0===n&&(n=y.pivotSlicer),e=this,r=t.dh.L,(r=t.dh.Ti.getPivotCacheByName(r))&&(e=e.getExistedSlicerCache(t,i,n)||e._Qt(r.yQt,i,n))?(e.connect(t,!0),1===e.pivotTables.length&&e.updateCache(),e):m.keyword_undefined},j.prototype._Qt=function(t,i,n){var e,t,n;return void 0===n&&(n=y.pivotSlicer),(t=(e=this).mQt().fMt.getPivotCacheByPivotCacheId(+t))&&t.getField(i)?(n=n===y.pivotSlicer?new N(e,t,i,e.OQt(a,i)):new I(e,t,i,e.OQt(s,i)),e.cQt.push(n),n):m.keyword_undefined},j.prototype.remove=function(t){for(var i,n,e,i=this,n=0;n<i.cQt.length;n++)if((e=i.cQt[n]).name===t){e.dispose(),i.cQt.splice(n,1);break}},j.prototype.getSlicer=function(i){var t,n,t;return(0,f.o)(this.cQt,function(t){var t=t.get(i);if(t)return n=t,!0}),n},j.prototype.getAllSlicers=function(i){var t,n,t,n=[];return(0,f.o)(this.cQt,function(t){(0,f.o)(t.IQt,function(t){!(0,f.ht)(i)&&t.sheet().name()!==i||n.push(t)})}),n},j.prototype.removeSlicer=function(n){var e,r,e=this;return(0,f.o)(e.cQt,function(t){var i=t.get(n);if(i)return(r={}).slicerJSON=i.toJSON(),t.remove(n),0===t.IQt.length&&(r.cacheJSON=t.toJSON(),e.remove(t.name)),!0}),r},j.prototype.undoAddingPivotTable=function(t){for(var i,n,e,r,o,i=this,n=i.cQt,e=0;e<n.length;e++)-1!==(o=(r=n[e]).pivotTables.indexOf(t))&&(i.lQt.push({cacheName:r.name,ptName:t.name()}),r.pivotTables.splice(o,1))},j.prototype.undoRemovingPivotTable=function(t){for(var i,n,e,r,o,o,i=this,n=i.lQt,e=t.name(),r=n.length-1;-1<r;r--)(o=n[r]).ptName===e&&(-1===(o=i.get(o.cacheName)).pivotTables.indexOf(t)&&o.pivotTables.push(t),n.splice(r,1))},j.prototype.onWorksheetDisposing=function(t){for(var i,n,e,r,i=this,n=i.cQt,e=n.length-1;-1<e;e--)(r=n[e]).onWorkSheetDisposing(t),0===r.IQt.length&&i.remove(r.name)},j.prototype.updateSlicerCaches=function(t,i){for(var n,e,r,o,n=this,e=n.cQt,r=0;r<e.length;r++)-1===(o=e[r]).pivotCache.getAllFieldsNames().indexOf(o.sourceName)?n.remove(o.name):t&&!o.isConnectedPivotTable(t.name())||o.updateCache(i?t:m.keyword_undefined)},j.prototype.LQt=function(i){var n,e;void 0===i&&(i=!1),e=[],(0,f.o)((n=this).cQt,function(t){t.bQt(i)||e.push(t.name)}),e.forEach(function(t){n.remove(t)})},j.prototype.qCe=function(){this.MAe?this.xAe+=1:(this.MAe={},this.xAe=0)},j.prototype.$Ce=function(){--this.xAe,this.xAe<=0&&delete this.MAe},j.prototype.NAe=function(t,i){var n=this.MAe;n&&(n[t]||(n[t]={}),n[t][i]=!0)},j.prototype.IAe=function(t,i){var n=this.MAe;return!(!n||!n[t]||!n[t][i])},j.prototype.toJSON=function(){var t,i,t,i=[];return(0,f.o)(this.cQt,function(t){i.push(t.toJSON())}),i},j.prototype.fromJSON=function(t){var n=this;0<t.length&&((0,f.o)(this.cQt,function(t){t.dispose()}),n.cQt=[],n.lQt=[],(0,f.o)(t,function(t){var i,i,i=(0,f.ht)(t.boundsStartDate)?y.pivotSlicer:y.pivotTimeline,i=n._Qt(t.pivotCacheId,t.sourceName,i);i&&i.fromJSON(t)}))},j.prototype.preFromSJSFormat=function(t,i,n){var e,r,r,o,r,n,a,s,u,c,l,f,h,v,t,d,p,m,b,e=this;if(e.cQt.forEach(function(t){t.dispose()}),e.cQt=[],r=t.slicerCaches,g.GC$.each(r,function(t,i){var i,n,n,i=i.slicerCacheDefinition;i.pivotTables&&(n=Y(i),n=e._Qt(n,A(i.sourceName),y.pivotSlicer))&&n.preFromSJSFormat(i)}),r=t.timelineCaches,g.GC$.each(r,function(t,i){var i,n,n,i=i.timelineCacheDefinition,n=Y(i,!0),n=e._Qt(n,A(i.sourceName),y.pivotTimeline);n&&n.preFromSJSFormat(i)}),!(o=n&&!1===n.includeStyles)&&(n=(r=t.styles).extLst,a=g.NodeHelper.cr(r.tableStyles&&r.tableStyles.c_),n)&&(s=n.x15dxfsRecords,u=n.timelineStylesNode,c=n.timelineStyleNodes,l=n.timelineSharedColors,f=n.timelineCommonSharedStrings,u||c))for(t=v=h=void 0,u?(h=!0,v=g.NodeHelper.cr(u.timelineStyle),t=u.kSt&&u.kSt.defaultTimelineStyle||"TimeSlicerStyleLight1"):(h=!1,v=c,t="TimeSlicerStyleLight1",l=new g.SimpleSharedStrings(l),f=new g.SimpleSharedStrings(f)),d=i.styleManager,(p=new g.SharedDxfs(l,f)).rv(s),d.addDefaultStyleName("defaultTimelineStyle",t),m=function(t){var t,i,t,n,e,r,t=v[t];if(!t)return"continue";i=h?t.kSt&&t.kSt.name:t.name,t=h?g.NodeHelper.lr(t,"timelineStyleElements.timelineStyleElement"):t.styleElements,n=void 0,a&&(n=(e=a.filter(function(t){return t.name===i})[0])&&g.NodeHelper.lr(e,"c_")),(r=new w.TimelineStyle).yh(i,d,p,t,n)},b=0;b<v.length;b++)m(b)},j.prototype.yh=function(t,i,n,e){var r,o,a,s,u,c,l,f,h,v,d,r=this,o=!!e,a=r.mQt(),s=t.slicers,u=t.timelines,c=t.drawings,l=t.styleManager,f=Q(a,e);if(o)p(r,f,s,e.name(),c,t,l,i,w.SlicerType.pivotTable),p(r,f,u,e.name(),c,t,l,i,w.SlicerType.pivotTimeline);else for(h=0,v=Object.keys(f);h<v.length;h++)d=v[h],p(r,f,s,d,c,t,l,i,w.SlicerType.pivotTable),p(r,f,u,d,c,t,l,i,w.SlicerType.pivotTimeline)},j.prototype.dispose=function(){(0,f.o)(this.cQt,function(t){t.dispose()}),this.lQt=m.keyword_null,this.cQt=m.keyword_null,this.vpt=m.keyword_null},T=j,g.Workbook.ch("SlicerCaches",{init:function(){var t;this.EQt=new T(this)},dispose:function(){var t=this;t.EQt&&(t.EQt.dispose(),t.EQt=m.keyword_undefined)},preFromJson:function(t,i,n){var e=this;e.EQt.dispose(),e.EQt=new T(e),t.slicerCaches&&0!==t.slicerCaches.length&&e.EQt.fromJSON(t.slicerCaches)},fromJson:function(t,i,n){var e=this;t.slicerCaches&&0!==t.slicerCaches.length&&(e.EQt.LQt(!1),e.EQt.updateSlicerCaches())},preFromSJSFormat:function(t,i,n){var e=this;e.EQt.dispose(),e.EQt=new r.PivotSlicerCacheManager(e),(t.slicerCaches&&0<Object.keys(t.slicerCaches).length||t.timelineCaches&&0<Object.keys(t.timelineCaches).length)&&e.EQt.preFromSJSFormat(t,i,n)},yh:function(t,i,n){var e=this;(t.slicerCaches&&0<Object.keys(t.slicerCaches).length||t.timelineCaches&&0<Object.keys(t.timelineCaches).length)&&(g.Util.wo(n,e.v2)?st(this,g.util.xr(t.workbook,"sheets").c_,i):P(e.EQt,i,n))},toJson:function(t,i){var n,e,n,e=this.EQt.toJSON();e&&0<e.length&&(t.slicerCaches=e)},wh:function(t,i,n){var e,i,r,o,a,s,u,c,e=this,i=i.styleManager,r=e.EQt;if(r&&!(o=n&&!1===n.includeStyles)&&(s=a=!1,u=r.cQt)&&0<u.length){for(c=0;c<u.length&&(u[c].slicerCacheType===y.pivotSlicer&&(a=!0),u[c].slicerCacheType===y.pivotTimeline&&(s=!0),!a||!s);c++);a&&w.fdi(t,u,it,n),s&&rt(t,u,n),a&&(t.slicers||(t.slicers={}),w.cdi(t,u,e.sheets,i,"pivot",y.pivotSlicer)),s&&(t.timelines||(t.timelines={}),ot(t,u,e.sheets,i)),(a||s)&&et(t)}}}),g.Worksheet.ch("SlicerCaches",{priority:1800,yh:function(t,i,n){var e=this.parent;n&&g.Util.wo(n,e.v2)&&P(e.EQt,i,n,this)},afterRefSheetLazyLoaded:function(t,i,n){n&&g.Util.wo(n,this.parent.v2)&&(0<this.pivotTables.all().length||0<this.slicers.all().length)&&P(this.parent.EQt,i,n,this)},dispose:function(t){!1!==t.clearCache&&this.parent&&this.parent.EQt.onWorksheetDisposing(this.name())}}),g.GC$.extend(g.Workbook.prototype,{getSameSourcePivotTablesBySlicer:function(t){var i,t,n,e,r,o,a,s,u,c,c,c,i=this,t=t.FQt,n=i.EQt.PQt(t.pivotCache.getName(),t.slicerCacheType,t.sourceName),e=t.pivotCache.Zc,r={},o=[],a="__NO__CACHE__";for((0,f.o)(n,function(t){0<t.pivotTables.length&&(r[t.name]=t.pivotTables.map(function(t){return{ptName:t.name(),sheetName:t.getHost().name()}}),o=o.concat(t.pivotTables.map(function(t){return t.dh.getName()})))}),s=0,u=Object.keys(i.BQt);s<u.length;s++)c=u[s],-1===o.indexOf(c)&&(c=i.BQt[c]).L===e&&(r[a]||(r[a]=[]),c=(0,m.getPivotTableByFieldsModel)(c),r[a].push({ptName:c.name(),sheetName:c.getHost().name()}));return r},getSameSourceSlicersByPivotTable:function(t){var i,t,i,n,i=this,t=t.dh.Ti.getPivotCacheByName(t.dh.L),i=i.EQt.PQt(t.getName()),n={};return(0,f.o)(i,function(t){0<t.IQt.length&&(n[t.name]=t.IQt.slice())}),n}}),r.PivotItemSlicerCache=N,r.PivotTimelineSlicerCache=I,r.PivotSlicerCacheManager=T)},"./dist/plugins/pivot/pivot-filter-diagram/slicer-base/pivot-slicer-shape.js":function(t,u,i){"use strict";var n,e,c,i,r,o,i,n,a,l,s;function f(t,i,n,e,r,o,a){var i,s,i=l.call(this,t,i,void 0,e,r,o,a)||this;return i.yCe="Timeline: Works in Excel 2013 or higher. Do not move or resize.",i.ma=c.SlicerType.pivotTimeline,(s=i).ytV=new u.TimelineShapeData(t,s.ytV.Name,"pivotTimeline",e||0,r||0,o||200,a||160),n&&s.tnV(),i}function h(){return null!==s&&s.apply(this,arguments)||this}n=this&&this.__extends||(a=function(t,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}a(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(u,"__esModule",{value:!0}),u.TimelineShape=u.TimelineShapeData=void 0,e=i("Shapes"),c=i("Slicers"),e&&c&&(i=c.SlicerShapeDataBase,r=c.SlicerShapeBase,o=c.encodeSlicerDrawingName,n(h,s=i),h.prototype.ToSJSCT_ShapeBase=function(t){var i,n,i=this,n={};return n.nvGraphicFramePr=i.ToSJSCT_GraphicFrameNonVisual(),n.xfrm=i.ToSJSCT_Transform2D(),n.graphic={graphicData:{uri:"http://schemas.microsoft.com/office/drawing/2012/timeslicer",timeslicer:{r_:[36],name:o(i.Name)}}},n.nvGraphicFramePr.cNvPr.extLst={ext:{uri:"{FF2B5EF4-FFF2-40B4-BE49-F238E27FC236}",creationId:{"xmlns:a16":"http://schemas.microsoft.com/office/drawing/2014/main",id:"{729A7851-DBA1-4F10-BB7B-BEC1E3EEDA64}"}}},n},h.prototype.ToCT_ShapeBase=function(){var t,i,n,t=this.ToCT_GraphicFrameNonVisual(),i=this.ToCT_Transform2D(),n;return{shapeType:e.CT_ShapeType.CT_SlicerShape,nvGraphicFramePr:t,xfrm:i,graphic:{graphicData:{timeslicer:{}}}}},i=h,n(f,l=r),f.prototype.XiV=function(t,i,n,e,r,o){l.prototype.XiV.call(this,t,i,n,e,r),t.AlternateContent.Choice.r_=[36,37]},f.prototype.WiV=function(t){return new f(t,c.s1i(t.parent,this.name()))},n=f,u.TimelineShapeData=i,u.TimelineShape=n)},"./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js":function(t,h,i){"use strict";var n,e,v,r,d,o,p,a,s,u,m,b,g,w,c,l,f,y;function C(t,i){return t.EQt.getSlicer(i)}function A(t){for(var i,n,i=0;i<t.z.length;i++)if((n=t.z[i])instanceof a.PivotTable)return n;return h.keyword_null}function N(t,i){var t,n,t=A(t);t&&t.Ti&&t.Ti.parent&&(n=t.Ti.parent).EQt.updateSlicerCaches(t,i)}function I(t){return t&&(t.ma===d.SlicerType.pivotTable||t.ma===d.SlicerType.pivotTimeline)}function T(t){return t&&t.graphic.graphicData.timeslicer}function S(t,i){var i=i.BQt[t];return i?A(i):h.keyword_null}function x(t,i,n){var t=y.call(this,t,i,n)||this;return t.captionName(t.sourceName(),!1),t}n=this&&this.__extends||(f=function(t,i){return(f=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}f(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(h,"__esModule",{value:!0}),h.VQt=h.getPivotTableByPTName=h.getPivotTableByFieldsModel=h.PivotSlicer=h.NAME=h.keyword_undefined=h.keyword_null=void 0,e=i("Core"),v=i("Pivot"),r=i("Shapes"),d=i("Slicers"),o=i("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),p=i("./dist/plugins/pivot/pivot-table-entry.js"),a=i("./dist/plugins/pivot/pivot-table/pivot-table.js"),s=i("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/pivot-slicer-shape.js"),h.keyword_null=null,h.keyword_undefined=void 0,h.NAME="name",h.PivotSlicer="PivotSlicer",h.getPivotTableByFieldsModel=A,h.getPivotTableByPTName=S,d&&r&&(u=r.CT_ShapeType,m=d.SlicerType,b=d.SlicerCacheType,g=d.ItemSlicerCacheProperties,w=d.s1i,c=d.decodeSlicerName,d.SlicerShapeBase.ch(h.PivotSlicer,{fireEvents:function(n){var e,r,o,a,t,e=n.sheet,r=n.sheetName,o=n.propertyName,a=n.shape,t=e.slicers.all();(0,v.o)(t,function(t){if(I(t)){var i=t.GQt;if(i&&i.RQt===a&&i.RQt[o])return n.stopThisFire=!0,t.ki({sheet:e,sheetName:r,slicer:t,propertyName:o}),!0}})},createSlicerWhenShapePasting:function(t){var i,n,e,r,o,a,t,s,i,u,e,c,l,f,i=t.toSheetName,n=t.slicerJSON,e=t.slicerCacheName,r=t.cacheJSON,o=t.slicerName,a=t.isCut,t=t.isCopy;n.type!==m.pivotTable&&n.type!==m.pivotTimeline||(i=(s=this.Mf.parent).getSheetFromName(i),!(e=(u=s.EQt).get(e))&&r&&(c=n.type===m.pivotTable?b.pivotSlicer:b.pivotTimeline,(e=u._Qt(r.pivotCacheId,r.sourceName,c)).fromJSON(r)),l=e.add(i,this.name()),i.slicers.WB(l),d.SlicerBaseProperties.forEach(function(t){var t=t[0];void 0!==n[t]&&l[t](n[t])}),I(l)&&(f=l.ma===m.pivotTable?d.ItemSlicerProperties:p.PivotTimelineSlicerProperties).forEach(function(t){var t=t[0];n[t]!==h.keyword_undefined&&l[t](n[t])}),l.style().fromJSON(n.style),l.CCe=this,l.init(),a&&l.name(o),t&&l.name(w(s,o)),l.CCe=null)},createChildShape:function(t){var i=t.shapeData;i instanceof s.TimelineShapeData&&(t.shape=new s.TimelineShape(t.sheet,i.Name,!1))}}),e.Worksheet.ch(h.PivotSlicer,{slicerAdding:function(t){var i,n,e,r,o,a,s,u,c,o,u,i,i,i=this;if((t.type===m.pivotTable||t.type===m.pivotTimeline)&&(n=i.parent&&i.parent.EQt)){if(e=t.type===m.pivotTable?b.pivotSlicer:b.pivotTimeline,r=t.slicerName,o=t.targetName,a=t.itemName,s=t.sheet,u=t.slicerCacheName)c=n.get(u);else{if(!(u=i.parent.wQt(o)))return;if(!(o=(i=u.dh).getSourceNameByFieldName(a))){if(-1===i.getAllFieldNameList().indexOf(a))return;o=a}c=n.add(u,o,e)}(i=c.add(s,r)).init(),t.slicer=i}},slicerRemoved:function(t){var i,t,n,i,i=this.parent,t=t.slicer.name(),n=C(i,t);if(n){if(n.isSelected(!1),i=i.EQt.removeSlicer(t),n.GQt){if(n.GQt.UQt)return;n.GQt.UQt=!0}this.Ut.n1i(n,"undoRemove",i)}},slicerRenamed:function(t){var i=t.newName,t=t.slicer;I(t)&&t.name(i)},getAllSlicers:function(t){var i,o,a,s,i=this,o=t.slicers,a=t.targetName,s=t.itemName;i.slicers&&e.GC$.each(i.slicers.z1i,function(t,i){var n,e,r;if(I(i))if(a){if((n=i.getAllConnectedPivotTables())&&0<n.length)for(e=0;e<n.length;e++)if((r=n[e]).name()===a&&(!s||r.getField(i.sourceName()).fieldName===s)){o.push(i);break}}else o.push(i)})},slicerFromJson:function(t){var i,n,e,r,o,t,a,s,t,u,c,l,f,c,f,h,l,i=t.slicerJSON,n=t.cacheJSON;if((i.type===m.pivotTable||i.type===m.pivotTimeline)&&this.parent&&(e=i.pivotName,r=i.sourceName,o=i.slicerCacheName,t=t.sheetName,a=this.parent)&&(s=a.getSheetFromName(t))){if(t=a.EQt,(0,v.ht)(e)){if(!o)return;i.cloneSheetArgs?(l=(c=i.cloneSheetArgs).newPTs,f=c.pivotCacheId,c=c.cacheType,(u=t._Qt(f,i.cloneSheetArgs.sourceName,c)).gQt=l,u.bQt()):n?(c=i.type===m.pivotTable?b.pivotSlicer:b.pivotTimeline,(u=t._Qt(n.pivotCacheId,n.sourceName,c)).fromJSON(n)):u=a.EQt.get(o)}else{if(!(f=this.parent.wQt(e)))return;if(-1===(h=f.dh).getAllFieldNameList().indexOf(r))return;u=a.EQt.add(f,r),g.forEach(function(t){(0,v.ht)(i[t])||(u["_"+t]=i[t])})}u&&((l=(l=u.get(i.name))||u.add(s,i.name)).init(),l.fromJSON(i),this.slicers.WB(l))}}}),o.PivotFieldsModel.ch(h.PivotSlicer,{setSlicerFilter:function(t){var i=t.textItem,n=t.oldTextItem,e=t.condition,t=t.oldCondition;(i||n)&&(i&&!n||!i&&n||i.list&&0<i.list.filter(function(t){return-1===n.list.indexOf(t)}).length||n.list&&0<n.list.filter(function(t){return-1===i.list.indexOf(t)}).length)&&N(this,!0),(e||t)&&N(this,!0)},updatePivotCache:function(t){N(this)},rebuild:function(){N(this)}}),r.ShapeCollection.ch(h.PivotSlicer,{createShapeWhenFromSJSFormat:function(t){var i,n,e,n,n,i=t.sheet,n=t.anchorData;n.graphicFrame?e=n.graphicFrame:n.AlternateContent&&(n=n.AlternateContent.Choice)&&n.graphicFrame&&(e=n.graphicFrame),T(e)&&(n=new s.TimelineShape(i,c(e.nvGraphicFramePr.cNvPr.name),!1),t.shape=n,t.drawingData=e)},createShapeWhenFromJSON:function(t){var i,n,i,i=t.sheet,n=t.json;n&&n.shapeType===u.CT_SlicerShape&&n.slicerType===m.pivotTimeline&&(i=new s.TimelineShape(i,c(n.name),!1),t.shape=i)},shapeRemoving:function(t){var i,n,e,r,o,r,a,s,u,c,u,u,i=t.sheet,n=t.shape,e=t.ignoreModel,r=t.isGroup;if(!r&&(o=i.parent,r=d.getSlicerByShape(o,n,I))){for(a=0,s=r;a<s.length;a++)c=(u=s[a]).slicer,u=u.sheetIndex,u=o.sheets[u],c.GQt.UQt=!0,u.slicers.DK(c.name(),e);t.cancelEvent=!0}}}),r.DrawingBaseData.ch(h.PivotSlicer,{createChildShapeDataBySJSNode:function(t){var i=t.node.graphicFrame;T(i)&&(t.shapeData=new s.TimelineShapeData(t.sheet,h.keyword_undefined,"pivotTimeline"),t.childNode=i)},createChildShapeDataBySSJSON:function(t){var i;t.node.shapeType===u.CT_SlicerShape&&T(t.node)&&(t.shapeData=new s.TimelineShapeData(t.sheet,h.keyword_undefined,"pivotTimeline"))}}),e.GC$.extend(a.PivotTable.prototype,{getAllSlicers:function(){return this.Ti.parent.EQt.getPTConnectedSlicers(this)},connectSlicer:function(t){var t=C(this.Ti.parent,t);t&&t.connectPivotTable(this.name())},disconnectSlicer:function(t){var t=C(this.Ti.parent,t);t&&t.disconnectPivotTable(this.name())},isConnectedSlicer:function(t){var t=C(this.Ti.parent,t);if(t)return-1!==t.getConnectedPivotTableNameList().indexOf(this.name())}}),y=d.SlicerBase,n(x,y),x.prototype.sheet=function(){return this.Mf},x.prototype.connectPivotTable=function(t){var i,n,e,r,o;if(!(0,v.ht)(t)&&(n=(i=this).Mf&&i.Mf.parent&&i.Mf.parent.sheets)&&0<n.length)for(e=0;e<n.length;e++)if(o=(r=n[e]).pivotTables.get(t))return void i.FQt.connect(o)},x.prototype.disconnectPivotTable=function(t){var i,t,i=this;i.isConnectedPivotTable(t)&&(t=S(t,i.Mf.parent))&&i.FQt.disconnect(t)},x.prototype.isConnectedPivotTable=function(t){if(t)return this.FQt.isConnectedPivotTable(t)},x.prototype.getAllPivotTables=function(){var t,i,n,e,r,o,a,s,u,t=this,i,n=t.FQt.mQt();if(n){for(e=[],r=n.getSameSourcePivotTablesBySlicer(t),o=0,a=Object.keys(r);o<a.length;o++)(u=r[s=a[o]]).forEach(function(t){var i,t,t,t,i=t.ptName,t=t.sheetName,t=n.getSheetFromName(t);t&&(t=t.pivotTables.get(i))&&e.push(t)});return e}},x.prototype.getAllConnectedPivotTables=function(){var t;return this.FQt.pivotTables},x.prototype.getConnectedPivotTableNameList=function(){return this.getAllConnectedPivotTables().map(function(t){return t.name()})},x.prototype.ACe=function(t,i){for(var n,e,r,o,a,s,u,c,e,n,e=this.FQt,r,o={},a=!1,s=0,u=e.pivotTables;s<u.length;s++)c=u[s],(0,v.ht)(c.Eqt)||(o[c.Eqt]=a=!0);a&&(e={newPTs:o,pivotCacheId:e.pivotCache.yQt,sourceName:e.sourceName,cacheType:e.slicerCacheType},t.cloneSheetArgs=e)},h.VQt=x)},"./dist/plugins/pivot/pivot-filter-diagram/slicer/pivot-item-slicer.js":function(t,i,n){"use strict";var e,o,r,a,s,u,c,l,f,h,v,d,p,m,b,g,w;function y(t,i,n){var t,e,t=w.call(this,t,i,n)||this;return t.ma=f.pivotTable,t.RN=l.light1(),t}e=this&&this.__extends||(g=function(t,i){return(g=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}g(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTableItemSlicer=void 0,o=n("Core"),r=n("Slicers"),a=n("Shapes"),s=n("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),u=n("./dist/plugins/pivot/pivot-filter-diagram/slicer/pivot-slicer-view-model.js"),c=o.mt.vo,r&&a&&(l=r.SlicerStyles,f=r.SlicerType,h=r.defSlicerProperty,v=r.ItemSlicerProperties,d=r.SlicerChangeType,p=r.afterPropertyChanged,m=r.encodeSlicerName,w=s.VQt,e(y,w),y.prototype.getItems=function(){return this.FQt.items},y.prototype.getOptionsSet=function(){var t,i,i=this;return{nameInFormula:i.nameInFormula(),sourceName:i.sourceName(),name:null!=(t=i.name())?t:i.iSe,captionName:i.captionName(),showNoDataItems:i.showNoDataItems(),showNoDataItemsInLast:i.showNoDataItemsInLast(),visuallyNoDataItems:i.visuallyNoDataItems(),showHeader:i.showHeader(),sortState:i.sortState(),columnCount:i.columnCount(),multiSelect:i.multiSelect(),itemHeight:i.itemHeight(),filterCleared:i.filterCleared(),isLocked:i.isLocked(),CCe:i.CCe}},y.prototype.QQt=function(){var t;this.FQt.updateItems()},y.prototype.setFilterWithItems=function(t){var i;this.FQt.setFilter(t)},y.prototype.sortState=function(t){var i,n,i=this;if(0===arguments.length)return i.FQt.sortState();t!==(n=i.FQt.sortState())&&(i.FQt.sortState(t),p.call(i,"sortState",n))},y.prototype.showNoDataItems=function(t){var i,n,i=this;if(0===arguments.length)return i.FQt.showNoDataItems();(t=!!t)!==(n=i.FQt.showNoDataItems())&&(i.FQt.showNoDataItems(t),p.call(i,"showNoDataItems",n))},y.prototype.showNoDataItemsInLast=function(t){var i,n,i=this;if(0===arguments.length)return i.FQt.showNoDataItemsInLast();(t=!!t)!==(n=i.FQt.showNoDataItemsInLast())&&(i.FQt.showNoDataItemsInLast(t),p.call(i,"showNoDataItemsInLast",n))},y.prototype.visuallyNoDataItems=function(t){var i,n,i=this;if(0===arguments.length)return i.FQt.visuallyNoDataItems();(t=!!t)!==(n=i.FQt.visuallyNoDataItems())&&(i.FQt.visuallyNoDataItems(t),p.call(i,"visuallyNoDataItems",n))},y.prototype.initSlicerUI=function(){var n=this;n.GQt=new u.PivotTableItemSlicerViewModel(n.Mf,n.getOptionsSet.bind(n),n.getItems.bind(n)),n.GQt.setStyle(n.RN),n.GQt.bind("valueChanged",function(t){n.setFilterWithItems(t)}),n.GQt.bind("clearFilter",function(){n.clearFilter()}),n.GQt.bind("propertyChanged",function(t){var i=t.propName,t=t.value;n[i]&&n[i](t)})},y.prototype.fromJSON=function(i){var n;i&&(w.prototype.fromJSON.call(this,i),n=this,v.forEach(function(t){var t=t[0];i[t]!==s.keyword_undefined&&n[t](i[t])}))},y.prototype.yh=function(t,i,n,e){var i;t&&(w.prototype.yh.call(this,t,i,n,e),i=this,t.rowHeight!==s.keyword_undefined&&i.itemHeight(o.ExcelHelper.emuToPixles(+t.rowHeight)-4),t.lossless&&t.lossless.multiSelect!==s.keyword_undefined&&i.multiSelect(t.lossless.multiSelect),t.columnCount!==s.keyword_undefined)&&i.columnCount(+t.columnCount)},y.prototype.toJSON=function(t){var i,n,i=this,n=w.prototype.toJSON.call(this,t);return v.forEach(function(t){var t=t[0];n[t]=i[t]()}),n},y.prototype.wh=function(t,i,n){var e,r,e=this,r={name:m(e.name()),cache:m(e.FQt.name),caption:m(e.captionName()),columnCount:e.columnCount(),style:c(e.RN.name()),rowHeight:o.ExcelHelper.pixelToEMU(e.itemHeight()+4),lossless:{multiSelect:e.multiSelect()}};e.showHeader()||(r.showCaption=a.SJS_False),e.disableResizingAndMoving()&&(r.lockedPosition=a.SJS_True),t.push(r)},b=y,v.forEach(function(t){b.prototype[t[0]]=h(t[0],t[1],t[2],t[3])}),i.PivotTableItemSlicer=b)},"./dist/plugins/pivot/pivot-filter-diagram/slicer/pivot-slicer-view-model.js":function(t,i,n){"use strict";var e,r,n,c,l,o,r,a,s,u;function f(t,i,n){return u.call(this,t,i,n)||this}e=this&&this.__extends||(s=function(t,i){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}s(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTableItemSlicerViewModel=void 0,r=n("Shapes"),n=n("Slicers"),r&&n&&n.SlicerViewModelBase&&(c=n.getSlicerSizePosInfo,l=n.ItemSlicerShape,o=n.SlicerChangeType,r=n.SlicerViewModelBase,e(f,u=r),f.prototype.WQt=function(){var e,t,i,n,r,o,a,s,u,o,t,e=this,i=this,n=i.Mf;n.shapes&&(r=i.updateOptionsCallback(),a=(o=c(n,!0)).left,s=o.top,u=o.width,o=o.height,(t=null!=(t=r.CCe)?t:n.shapes.get(r.name))||(t=new l(n,r.name,!0,a,s,u,o),n.shapes.ZP(t),t.allowResize(!0),t.allowMove(!0),t.dynamicSize(!1),t.dynamicMove(!0)),t.drawingType="Slicer",i.zQt=t.GtV,i.RQt=t,i.zQt.xT&&i.resetFormControl(t),i.refreshFormControl(),i.zQt.addEventListener("valueChanged",function(t,i){var n=e.updateValuesCallback();n.forEach(function(t){return t.selected=-1!==i.indexOf(t.text)}),e.ki("valueChanged",n)}),i.zQt.addEventListener("clearFilter",function(t,i){e.ki("clearFilter",{})}),i.zQt.addEventListener("propertyChanged",function(t,i){e.ki("propertyChanged",i)}))},f.prototype.refreshFormControl=function(){var t,i;u.prototype.refreshFormControl.call(this),(i=(t=this).zQt).setItems(t.updateValuesCallback())},i.PivotTableItemSlicerViewModel=f)},"./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-dropdown.js":function(t,i,n){"use strict";var e,r,o,a,n,r,s,u,c,l,f,h,v,d;function p(t,i,n){var t=d.call(this,t,i)||this;return t.onChange=n,t}e=this&&this.__extends||(v=function(t,i){return(v=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}v(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTimelineDropdown=void 0,r=n("@spreadjs/js-sheets-common"),o=n("Core"),a=n("Slicers"),n=n("./dist/plugins/pivot/pivot.ns.js"),r=new r.Common.ResourceManager(n.SR,"PivotTables"),s=r.getResource.bind(r),u="gc-timeline-level-dropdown",c="gc-timeline-level-block",l="gc-timeline-level-text",f="gc-timeline-selected-level",a&&(d=o.zc,e(p,d),p.prototype.init=function(t,i,n){d.prototype.Hc.call(this);var t=this.initHTMLStr(t);this.open(i,n,t)},p.prototype.initHTMLStr=function(t){for(var i,n,e,i="",n=["",s().TIME_LEVEL_YEARS,s().TIME_LEVEL_QUARTERS,s().TIME_LEVEL_MONTHS,s().TIME_LEVEL_DAYS],e=1;e<=4;e++)i+=this.ZQt(n[e],t===e,e);return i},p.prototype.ZQt=function(t,i,n){var i=i?"\u221a":"";return' <div class="'.concat(c,'" level="').concat(n,'">\n                        <div class="').concat(f,'">\n                            ').concat(i,'\n                        </div>\n                        <div class="').concat(l,'">\n                            ').concat(t,"\n                        </div>\n                    </div>")},p.prototype.WX=function(t,i){var n,e,n=this.Xc(),e=(0,o.GC$)(".".concat(u));return(e=0===e.length?(0,o.GC$)(o.mt.En("div")):e).css(["left","top"],[t,i]),e.addClass(u),e.appendTo(n),e},p.prototype.open=function(t,i,n){var e;this.WX(t,i).html(n),this.$c()},p.prototype.aY=function(){var i=this;(0,o.GC$)("."+c).bind("click",function(t){var t,t,t=t.target;t.className!==f&&t.className!==l||(t=t.parentElement),(t=parseInt(t.getAttribute("level"),10))&&(i.onChange(t),i.close())})},p.prototype.$c=function(){d.prototype.$c.call(this),this.aY()},p.prototype.KX=function(){(0,o.GC$)("."+c).unbind("click")},p.prototype.close=function(){this.KX(),d.prototype.close.call(this)},i.PivotTimelineDropdown=p)},"./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-list.js":function(L,t,i){"use strict";var I,n,l,r,e,T,f,i,h,o,n,a,v,s,S,u,c,d,E,B,R,p,m,G,g,x,b,M,D,w,y,k,C,V,i;function A(){var t=o.Fe(o.culture()).DateTimeFormat;return t&&t.abbreviatedMonthNames||[]}function N(){this.YQt=10.25,this.HQt=30.75,this.JQt=0,this.qQt=!1,this.KQt=-1,this.ywt=-1,this.lit=-1,this.aCi=-1,this.XQt=!1,this.$Qt=!1,this.needDrawDragRect=!1,this.sCi=!1,this.tWt={containerSize:{w:300,h:100},selection:T.keyword_null,bounds:T.keyword_null,scrollPosition:T.keyword_null,offset:{top:0,left:0},level:T.keyword_null,selectionLevel:T.keyword_null,canShowRange:!0,filterCleared:!0,showScrollbar:!0,showHeader:!0,showSelectionLabel:!0,showLevel:!0,onSelectionChanged:function(){},onItemClick:function(){},getStyle:function(t){return T.keyword_null},getThemeColor:function(){return""},refresh:function(){},setCursor:function(){},onScrollPositionChanged:function(){},getPointerRelativeControl:function(t){return{x:0,y:0}}},this.initScrollbar()}function j(t){return Math.floor((t.getMonth()+3)/3)}function O(t){return _(t.getFullYear(),t.getMonth())}function _(t,i){var t=new Date(t,i);return t.setMonth(t.getMonth()+1),t.setDate(1),t.setDate(t.getDate()-1),t.getDate()}function F(t,i,n){var e,r,o,a;i&&(t.save(),t.fillStyle=p,e=i.x,r=i.y,o=i.width,a=i.height,t.beginPath(),t.moveTo(e+5,r),t.lineTo(e+o-(n?0:5),r),t.quadraticCurveTo(e+o,r,e+o,r+(n?0:5)),t.lineTo(e+o,r+a-(n?0:5)),t.quadraticCurveTo(e+o,r+a,e+o-(n?0:5),r+a),t.lineTo(e+(n?5:0),r+a),t.quadraticCurveTo(e,r+a,e,r+a-(n?5:0)),t.lineTo(e,r+(n?5:0)),t.quadraticCurveTo(e,r,e+(n?5:0),r),t.closePath(),t.fill(),t.fillStyle=m,t.fillRect(i.x+2,i.y+4.5,2,2),t.fillRect(i.x+2,i.y+8,2,2),t.fillRect(i.x+2,i.y+11.5,2,2),t.restore())}function U(t){if(t&&"string"==typeof t){var t=t.toUpperCase();if(t===f.WHITE||"#FFF"===t||"#FFFFFF"===t||"RGB(255, 255, 255)"===t)return 1}}function P(t,i,n){var t=new Date(t.toDateString());return i&&(n?(t.setMonth(0),t.setDate(1)):(t.setMonth(11),t.setDate(31))),t.getTime()}Object.defineProperty(t,"__esModule",{value:!0}),t.getMonthLength=t.getLastDateOfMonth=t.getQuarter=t.PivotTimelineList=t.getMonthMap=void 0,I=i("Core"),n=i("@spreadjs/js-sheets-common"),l=i("Pivot"),r=i("Slicers"),e=i("Shapes"),T=i("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),f=i("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-view.js"),i=i("./dist/plugins/pivot/pivot.ns.js"),h=n.Common.ft,o=n.Common.CultureManager,n=new n.Common.ResourceManager(i.SR,"PivotTables"),a=n.getResource.bind(n),t.getMonthMap=A,v=I.mt.yt,s="M",S="rgba(0, 0, 0, 0.15)",u="rgb(243, 243, 243)",c=1,d=18,E=19,B=75,R=6,p="#9c9c9c",m="#dddddd",G=5,(i=g=g||{})[i.item=0]="item",i[i.scrollBar=1]="scrollBar",i[i.leftScrollButton=2]="leftScrollButton",i[i.rightScrollButton=3]="rightScrollButton",i[i.leftDragButton=4]="leftDragButton",i[i.rightDragButton=5]="rightDragButton",r&&e&&(x=e.drawRoundedRect,b=r.TimelineLevel,M=r.appendBackColorStyle,D=r.Border_Names,w=r.fillText,y=r.getEllipsisText,k=r.paintBorder,C=r.SlicerScrollBar,Object.defineProperty(N.prototype,"props",{get:function(){return this.tWt},set:function(t){this.tWt=t},enumerable:!1,configurable:!0}),N.prototype.initScrollbar=function(){var e,t,i,e=this,t=new C,i=t.props;i.direction="horizontal",i.showButton=!1,i.sliderColor=f.WHITE,i.renderTrack=!1,i.syncSliderHeightWithPageStep=!0,i.refresh=this.refresh.bind(this),i.getPointerRelativeControl=function(t){var t=e.getPointerRelativeControl(t),i,n;return{x:t.x-19,y:t.y-75}},i.setCursor=this.setCursor.bind(this),i.onScroll=this.onScrollBarChange.bind(this),i.finishScroll=this.onScrollBarChanged.bind(this),this.iWt=t},N.prototype.onScrollBarChange=function(){var t,i,t,i=this.iWt.props.value;this.JQt=i},N.prototype.onScrollBarChanged=function(){var t,i,n,e,t=this,n=this._items[0],e=this.iWt.props.value,i=new Date(n.toString());if(0!==e)switch(t.level){case b.years:i.setFullYear(i.getFullYear()+e);break;case b.quarters:i.setMonth(i.getMonth()+3*e);break;case b.months:i.setMonth(i.getMonth()+e);break;case b.days:i.setDate(i.getDate()+e)}t.tWt.onScrollPositionChanged(i),t.setCursor("default")},N.prototype.update=function(){var t=this;try{t.buildItems()}catch(t){return}t.setStartPosition()},N.prototype.setStartPosition=function(){var t,i,n,t=this.scrollPosition;if(t){if(!this._items)try{this.buildItems()}catch(t){return}for(i=this._items,n=0;i[n]<t&&n<i.length;)n++;this.JQt=Math.min(n,this.maxScrollCount)}else this.JQt=0;this.refresh()},N.prototype.onLevelChanged=function(){var t;this.updateScrollPosition()},N.prototype.updateScrollPosition=function(t){var i,n,e,r,t,i=this;if(t=t||i.selection,!(0,l.ht)(t)){for(n=t.startDate,e=this._items,r=0;e[r]<n&&r<e.length;)r++;t=Math.round(r-i.onePageCanDisplayItemsCount/2),i.tWt.onScrollPositionChanged(e[t]||e[0])}},N.prototype.nCi=function(t){var i,n,i=this,n;return t.isRight?i.eWt:i.nWt},N.prototype.B1i=function(t){var i,n,e,i=this,n=i.itemWidth+1,e=i.itemHeight;return{rect:new I.Rect((t-i.JQt)*n,50+(i.showHeader?0:15),n,e),index:t,displayIndex:t-i.JQt}},N.prototype.F1i=function(t){var i,n,e,r,o,a,s,u,i=this,n=i.iWt,e=n.scrollBtnLen,r=n.height,o=i.SCROLLBAR_Y_VALUE,a=i.SCROLLBAR_WIDTH,s=n.scrollSliderOffset,u=n.scrollSliderLen;switch(t.type){case 1:return new I.Rect(0,o,a+2*i.SCROLLBAR_X_VALUE,r);case 2:return new I.Rect(0,o,e,r);case 3:return new I.Rect(e+a,o,e,r);case 4:return new I.Rect(e,o,a,r);case 5:return new I.Rect(e+s,o,u,r);case 6:return new I.Rect(e,o,s,r);case 7:return new I.Rect(e+s+u,o,u,r)}},N.prototype.render=function(t){var i=this;t.save(),i.nWt=T.keyword_null,i.eWt=T.keyword_null,i.renderItems(t),i.renderLeftScrollButton(t),i.renderRightScrollButton(t),i.updateScrollbarProps(),i.renderScrollbar(t),i.needDrawDragRect&&(F(t,i.nWt,!0),F(t,i.eWt,!1)),t.restore()},N.prototype.updateScrollbarProps=function(){var t,i,t=this.SCROLLBAR_WIDTH,i=this.iWt.props;i.containerSize={w:t,h:19},i.max=this.maxScrollCount,i.value=this.JQt,i.pageStep=this.onePageCanDisplayItemsCount,this.iWt.props=i},N.prototype.renderScrollbar=function(t){var i,n,i=this,n=i.SCROLLBAR_X_VALUE;t.save(),t.translate(n,i.SCROLLBAR_Y_VALUE),i.showScrollBar&&i.tWt.canShowRange&&i.renderScrollbarTrack(t,i.width-40),i.needShowScrollbar&&i.iWt.render(t),t.restore()},N.prototype.renderLeftScrollButton=function(t){this.renderScrollBtn(t,this.rWt===g.leftScrollButton,!0)},N.prototype.renderRightScrollButton=function(t){this.renderScrollBtn(t,this.rWt===g.rightScrollButton,!1)},N.prototype.renderScrollBtn=function(i,t,n){var e,r,e,t,o,a,s,e=this,r=n?e.leftBtnRect:e.rightBtnRect,e=t?u:f.WHITE,t=t?"rgb(135, 135, 135)":"rgb(196, 196, 196)",o="rgb(120, 119, 117)",a=3,s=function(){i.save(),i.translate(r.x,r.y),i.translate((r.w-2*a)/2,(r.h-a)/2),i.beginPath();var t=n?-90:90;t&&(i.translate(a,a/2),i.rotate(t/180*Math.PI),i.translate(-a,-a/2)),i.moveTo(0,a),i.lineTo(a,0),i.lineTo(2*a,a),i.strokeStyle=o,i.lineWidth=2,i.stroke(),i.restore()};i.save(),i.beginPath(),i.rect(r.x,r.y,r.w,r.h),i.fillStyle=e,i.fill(),i.strokeStyle=t,i.stroke(),s(),i.restore()},N.prototype.renderScrollbarTrack=function(t,i){var n,e,r,o,a,s,r,u,c,s,s,l,n=this,o=9,a="E6E6E6",s=n.getStyle("selectedTimeBlockStyle"),r=P(n.bounds.startDate,!0,!0),u,c=P(n.bounds.endDate,!0,!1)-r,s=s&&s.backColor();s&&!U(s)&&("string"==typeof s?a=h.YGt(n.getThemeColor(s),.5):"object"==typeof s&&s.stops&&0<s.stops.length&&s.stops[0].color&&(a=h.YGt(n.getThemeColor(s.stops[0].color),.5))),r=n.selection?(e=i*(((s=P(n.selection.startDate))-r)/c),i*(((l=P(n.selection.endDate))-s)/c)):(e=0,i),t.save(),t.fillStyle=a,t.fillRect(e,5,r,9),t.restore()},N.prototype.renderItems=function(t){var i,n,e,r,o,a,s,u,c,l,f,c,i=this;for(i.level!==i.oWt&&(i.buildItems(),i.JQt=0,i.iWt.value=0),i.buildItemWidth(t),n=i.JQt,e=i._items,a=o=r=!1,s=0;s+n<e.length&&(u=e[s+n],t.beginPath(),l=(c=i.isSelectedItem(u,o,a)).selected,o=!(!(f=c.isLeft)||o)||o,a=!(!(c=c.isRight)||a)||a,!i.renderItem(t,u,s,i.aWt(u,0===s),l,r&&l,f,c));s++)r=l},N.prototype.buildItemWidth=function(t){var i,n,n,e,r,r,r,r,i=this,n=new Date("2000-11-11"),n=i.sWt(n),e=i.getWholeStyle(),r=i.getStyle("periodLabel1Style");t.save(),r=r&&r.font()||e&&e.font()||f.TIMELINE_DEFAULT_FONT,t.font=v(r),i.YQt=t.measureText(s).width,r=(r=i.getStyle("periodLabel2Style"))&&r.font()||e&&e.font()||f.TIMELINE_DEFAULT_FONT,t.font=v(r),i.HQt=t.measureText(n).width,t.restore()},N.prototype.buildItems=function(){var t,i,n,i,e,r,o,t=this,i=t.bounds,n=i.startDate,i=i.endDate,e=t.level,r=n.getFullYear(),o=i.getFullYear();switch(e){case b.years:t.buildYearsItems(r,o);break;case b.quarters:t.buildQuartersItems(r,o);break;case b.months:t.buildMonthsItems(r,o);break;case b.days:t.buildDaysItems(r,o)}t.oWt=t.level},N.prototype.buildYearsItems=function(t,i){for(var n,e,n=[],e=t;e<=i;e++)n.push(new Date(e,0));this._items=n},N.prototype.buildQuartersItems=function(t,i){for(var n,e,r,n=[],e=t;e<=i;e++)for(r=0;r<4;r++)n.push(new Date(e,3*r));this._items=n},N.prototype.buildMonthsItems=function(t,i){for(var n,e,r,n=[],e=t;e<=i;e++)for(r=0;r<12;r++)n.push(new Date(e,r));this._items=n},N.prototype.buildDaysItems=function(t,i){for(var n,e,r,o,a,n=[],e=t;e<=i;e++)for(r=0;r<12;r++)for(o=_(e,r),a=1;a<=o;a++)n.push(new Date(e,r,a));this._items=n},N.prototype.aWt=function(t,i){var n,e;switch(this.level){case b.years:return T.keyword_null;case b.quarters:case b.months:return 0===t.getMonth()||i?t.getFullYear()+"":T.keyword_null;case b.days:return 1===t.getDate()||i?"".concat(A()[t.getMonth()].toUpperCase()," ").concat(t.getFullYear()):T.keyword_null;default:return T.keyword_null}},N.prototype.sWt=function(t){var i,n,i,n="";switch(this.level){case b.years:n=t.getFullYear()+"";break;case b.quarters:n=a().QUARTER_MAP[j(t)];break;case b.months:n=A()[t.getMonth()].toUpperCase();break;case b.days:n=t.getDate()+""}return n},N.prototype.isSelectedItem=function(t,i,n){var e,r,o,a,s,u,r,c,e=this,r=e.selection,o=!1,a=!1,s=!1;return e.tWt.canShowRange&&((0,l.ht)(r)?o=!0:(u=r.startDate,r=r.endDate,c=e.uWt(t),e.selectionLevel<=e.level?t<=r&&u<=t&&(o=!0,a=!i&&t<=u,s=!n&&r<=c):c<u||r<t||(o=!0,a=!i&&t<=u,s=!n&&r<=c))),{selected:o,isLeft:a,isRight:s}},N.prototype.isHoveredItem=function(t){return this.KQt===t},N.prototype.renderItem=function(t,i,n,e,r,o,a,s){var u,c,l,f,h,v,d,f,f,p,m,r,b,g,w,y,C,y,y,C,p,A,N,N,u=this,c=u.itemWidth-1,l=u.itemHeight,f=u.showScrollBar,h,v=n*(c+1)+(f?0:22),d=50+(u.showHeader?0:15);if(v>u.width+19)return!0;if(!f){if((f=u.width+19-3)<v)return!0;f<v+c&&(c=f-v)}for(f=u.getStyle("selectedTimeBlockStyle"),p=u.getStyle("unselectedTimeBlockStyle"),m=r?f:p,r=u.getWholeStyle(),b=new I.Rect(v,d,c,l),g=0,w=c,u.selectionLevel&&u.selectionLevel>u.level&&(a||s)?(C=(y=u.cWt(i,a,s)).leftPoint,y=y.rightPoint,y=new I.Rect(v+(g=c*C),d,w=c*(y-C)||2,l),M(t,v,d,c,l,p,r,u.getThemeColor.bind(u)),x(b,0,t),M(t,y.x,y.y,y.width,y.height,f,r,u.getThemeColor.bind(u)),x(y,0,t)):(M(t,v,d,c,l,m,r,u.getThemeColor.bind(u)),x(b,0,t)),a&&(u.nWt=new I.Rect(v+g-6,d,6,l)),s&&(u.eWt=new I.Rect(v+g+w,d,6,l)),u.isHoveredItem(n+u.JQt)&&(t.save(),t.fillStyle=S,x(b,0,t),t.restore()),C=u.getStyle("selectedTimeBlockSpaceStyle"),o&&C&&C.backColor()&&(p=new I.Rect(v-1,d,1,l),t.save(),M(t,p.x,p.y,p.width,p.height,C,T.keyword_null,u.getThemeColor.bind(u)),x(p,0,t),t.restore()),e&&u.paintLabelText1(t,e,v,d-35),u.paintLabelText2(t,i,v,d-20,c,l),0===b.x&&(b.x+=.5,b.width-=.1),0===b.y&&(b.y+=.5,b.height-=.1),A=0;A<4;A++)N=D[A],(N=m&&m[N]())&&k(t,A,b,N,u.getThemeColor.bind(u),0)},N.prototype.uWt=function(t){var i,t,i=new Date(t.toString()),t=864e5;switch(this.level){case b.years:i.setFullYear(i.getFullYear()+1);break;case b.quarters:i.setMonth(i.getMonth()+3);break;case b.months:i.setMonth(i.getMonth()+1);break;case b.days:i.setDate(i.getDate()+1)}return new Date(i.getTime()-t)},N.prototype.cWt=function(t,i,n){var e,r,o,a,e,s,r,e=this,r=e.selection,o=0,a=1;return r&&(e=e.uWt(t),s=r.startDate,r=r.endDate,o=i?+((s.getTime()-t.getTime())/(e.getTime()-t.getTime())).toPrecision(3):0,a=n?+((r.getTime()-t.getTime())/(e.getTime()-t.getTime())).toPrecision(3):1),{leftPoint:o,rightPoint:a}},N.prototype.paintLabelText1=function(t,i,n,e){var r,o,a,s,u,a,r=this,o=r.itemWidth-1;t.save(),a=r.getStyle("periodLabel1Style"),s=r.getWholeStyle(),u=r.getThemeColor(a&&a.foreColor()||s&&s.foreColor()||f.BLACK),a=a&&a.font()||s&&s.font()||f.TIMELINE_DEFAULT_FONT,w(t,y(t,i,2*o),n,e,u,v(a),r.YQt,o),t.restore()},N.prototype.paintLabelText2=function(t,i,n,e,r,o){var a,s,u,c,s,u,a=this,s=a.getStyle("periodLabel2Style"),u=a.getWholeStyle(),c=s&&s.foreColor()||u&&u.foreColor()||f.BLACK,s=v(s&&s.font()||u&&u.font()||f.TIMELINE_DEFAULT_FONT);t.save(),u=a.sWt(i),w(t,y(t,u,r),n,e,a.getThemeColor(c),s,o,r),t.restore()},N.prototype.hitTest=function(t,i){var n,e,r,o,a,s,u,c,o,l,f,h,v,d,p,m,b,n=this,e=this.width,r=n.showScrollBar,o=n.showHeader,a=n.leftBtnRect,s=n.rightBtnRect,u=r?t:t+19+3,c=o?i:i+15,o=function(){return 0<=t&&t<=e-(r?0:7)&&50<=i&&i<50+n.itemHeight},l=function(){return u>=a.x&&u<=a.x+a.w&&c>=a.y&&c<=a.y+a.h},f=function(){return u>=s.x&&u<=s.x+s.w&&c>=s.y&&c<=s.y+s.h},h=function(){return n.needShowScrollbar&&t>=n.scrollButtonSize&&t<=n.width-n.scrollButtonSize&&c>=a.y&&c<=a.y+a.h},v=function(){var t=n.nWt;return t&&u>=t.x&&u<=t.x+t.width&&c>=t.y&&c<=t.y+t.height},d=function(){var t=n.eWt;return t&&u>=t.x&&u<=t.x+t.width&&c>=t.y&&c<=t.y+t.height},b=n.getClickItemIndex(t,i);return v()?(p=g.leftDragButton,m=b):d()?(p=g.rightDragButton,m=b):o()?-1!==b&&(p=g.item,m=b):h()?p=g.scrollBar:l()?p=g.leftScrollButton:f()&&(p=g.rightScrollButton),{target:p,data:m}},N.prototype.onMouseDown=function(t){var i,n,n,e,n,n,i=this,n=i.getPointerRelativeControl(t),n=i.hitTest(n.x,n.y),e=n.target,n=n.data;return e===g.leftDragButton||e===g.rightDragButton?(i.lWt=e,i.sCi=!0,i.qQt=!0):e===g.item?(t.shiftKey?(i.ywt=Math.max(i.lit,i.ywt,n),i.lit=Math.min(i.lit,i.ywt,n),i.aCi=n):(i.aCi=-1,i.lit=n,i.ywt=n),i.sCi=!0,i.$Qt=!0,i.qQt=!0,i.changeSelection(),!0):e===g.scrollBar?(i.iWt.onMouseDown(t),i.qQt=!0):e===g.leftScrollButton||e===g.rightScrollButton?(n=(i.rWt=e)===g.leftScrollButton?-1:1,i.scroll(n),i.startScrollInterval(n),!0):void 0},N.prototype.isInBounding=function(t,i){var n,e,n=this.width,e=this.height;return 0<=t&&t<=n&&0<=i&&i<=e},N.prototype.onMouseMove=function(t){var i,t,n,e,n,r,i=this;return i.iWt.onMouseMove(t),t=i.getPointerRelativeControl(t),e=(n=i.hitTest(t.x,t.y)).target,n=n.data,(r=i.lWt)?i.onDragButtonChanging(r,n,t.x):e===g.item?(i.$Qt?i.ywt!==n&&(-1===i.aCi||-1!==i.aCi&&i.aCi!==n)&&(i.XQt=!0,i.ywt=n,i.aCi=-1,i.changeSelection()):i.KQt=n,i.setCursor("default")):(e===g.leftScrollButton||e===g.rightScrollButton?i.setCursor("default"):e!==g.leftDragButton&&e!==g.rightDragButton||i.setCursor("ew-resize"),i.KQt=-1),i.refresh(),!0},N.prototype.onDragButtonChanging=function(t,i,n){var e,r,r,o,t,a,s,t;(0,l.ht)(i)||-1===i||(r=((r=(e=this).fWt(i)).from+r.to)/2,t===g.leftDragButton?(o=r+e.itemWidth,t=i+1,n<=r?t=i:o<=n&&(t=i+2),e._items[t]&&e._items[t].toLocaleDateString()!==e.selection.startDate.toLocaleDateString()&&e._items[t]<=e.selection.endDate&&(a=new Date(e._items[t].toString()),s=e.selection.endDate,e.selection={startDate:a,endDate:s})):(o=r-e.itemWidth,t=i-1,r<=n?t=i:n<=o&&(t=i-2),e._items[t]&&e._items[t]>=e.selection.startDate&&(a=e.selection.startDate,s=new Date(e._items[t].toString()),e.selection=e.hWt(a,s))))},N.prototype.fWt=function(t){var i=this;return{from:(t-=i.JQt)*i.itemWidth,to:(t+1)*i.itemWidth}},N.prototype.onWindowMouseMove=function(t){var i,t,n,n,n,i=this,t=i.getPointerRelativeControl(t),n=i.itemsAreaWidth-1+i.props.offset.left,n=i.hitTest(n,t.y).target;if(i.sCi){if(n===g.item)i.stopScrollInterval();else{if(void 0!==i.vWt)return;t.x<0?i.startScrollInterval(-1):t.x>i.width&&i.startScrollInterval(1)}i.refresh()}n=i.isInBounding(t.x,t.y),i.needDrawDragRect!==n&&(i.needDrawDragRect=n,i.sCi||i.refresh())},N.prototype.startScrollInterval=function(t){var i,n,e,i=this,n=100,e=function(){i.scroll(t),i.refresh(),i.vWt=window.setTimeout(e,n)};this.vWt=window.setTimeout(e,600)},N.prototype.stopScrollInterval=function(){return void 0!==this.vWt&&(window.clearTimeout(this.vWt),!(this.vWt=void 0))},N.prototype.scroll=function(t){this.scrollTo(this.JQt+t)},N.prototype.scrollTo=function(t){var i,n,i=0,n=this.maxScrollCount;t=Math.min(t,n),t=Math.max(t,0),this.JQt=t},N.prototype.onMouseUp=function(t){var i,t,n,i=this;return i.iWt.onMouseUp(t),t=i.getPointerRelativeControl(t),(n=i.hitTest(t.x,t.y).target)!==g.item&&(this.KQt=-1,this.refresh()),!!i.qQt&&!(i.qQt=!1)},N.prototype.onWindowMouseUp=function(t){var i,t,t,n,t,e,r,e,i=this;i.iWt.onWindowMouseUp(t),t=i.getPointerRelativeControl(t),n=(t=i.hitTest(t.x,t.y)).target,t=t.data,i.lWt?(r=(e=i.selection).startDate,e=e.endDate,i.props.onSelectionChanged({startDate:r,endDate:e})):i.sCi&&(n===g.item&&i.XQt&&(i.XQt=!1,i.ywt=t),i.endSelectOperation()),this.stopScrollInterval()&&this.onScrollBarChanged(),this.clearState()},N.prototype.hWt=function(t,i){var n,e,e=this;if(t&&i){switch(i<t&&(t=(n=[i,t])[0],i=n[1]),e.level){case r.TimelineLevel.years:i.setMonth(11);break;case r.TimelineLevel.quarters:i.setMonth(i.getMonth()+2)}e.level!==r.TimelineLevel.days&&i.setDate(O(i))}return{startDate:t,endDate:i}},N.prototype.changeSelection=function(){var t,i,n,t=this,i=new Date(t._items[t.lit].toString()),n=new Date(t._items[t.ywt].toString());t.selection=t.hWt(i,n)},N.prototype.endSelectOperation=function(){var t,i,n,t=this,i=new Date(t._items[t.lit].toString()),n=new Date(t._items[t.ywt].toString());t.props.onSelectionChanged(t.hWt(i,n))},N.prototype.onWindowKeyUp=function(t){},N.prototype.onWindowMouseWheel=function(t){this.iWt.onWindowMouseWheel(t)},N.prototype.clearState=function(){var t,i,t=this,i=!1;t.qQt&&(i=!(t.qQt=!1)),t.sCi&&(t.KQt=-1,t.$Qt=!1,-1===t.aCi&&(t.ywt=-1),i=!(t.sCi=!1)),t.lWt=T.keyword_null,t.rWt=T.keyword_null,t.stopScrollInterval(),i&&t.refresh()},Object.defineProperty(N.prototype,"width",{get:function(){return this.tWt.containerSize.w-(this.showScrollBar?0:44)},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"height",{get:function(){return this.tWt.containerSize.h},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"scrollPosition",{get:function(){return this.tWt.scrollPosition},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"showScrollBar",{get:function(){return this.tWt.showScrollbar},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"showHeader",{get:function(){return this.tWt.showHeader},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"level",{get:function(){return this.tWt.level},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"bounds",{get:function(){return this.tWt.bounds},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"selection",{get:function(){return this.tWt.selection},set:function(t){this.tWt.selection=t},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"selectionLevel",{get:function(){return this.tWt.selectionLevel},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"itemWidth",{get:function(){return Math.max(2*this.HQt,40)},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"itemHeight",{get:function(){return 18},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"needShowScrollbar",{get:function(){return this.showScrollBar&&this.itemLength>this.onePageCanEntirelyDisplayItemsCount},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"scrollButtonSize",{get:function(){return 25},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"canShowItemsLength",{get:function(){return 10},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"itemsAreaWidth",{get:function(){return Math.min(this.itemLength,this.canShowItemsLength)*this.itemWidth},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"itemLength",{get:function(){if(this._items)return this._items.length;try{return this.buildItems(),this._items.length}catch(t){return 0}},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"maxScrollCount",{get:function(){return Math.max(0,this.itemLength-this.onePageCanEntirelyDisplayItemsCount)},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"onePageCanDisplayItemsCount",{get:function(){return Math.ceil(this.width/this.itemWidth)},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"onePageCanEntirelyDisplayItemsCount",{get:function(){return Math.floor(this.width/this.itemWidth)},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"leftBtnRect",{get:function(){return{x:0,y:76-(this.showScrollBar?0:25)+(this.showHeader?0:15),w:19,h:17}},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"rightBtnRect",{get:function(){return{x:this.width-19+(this.showScrollBar?0:38),y:76-(this.showScrollBar?0:25)+(this.showHeader?0:15),w:19,h:17}},enumerable:!1,configurable:!0}),N.prototype.setCursor=function(t){this.props.setCursor(t)},N.prototype.getStyle=function(t){return this.props.getStyle(t)},N.prototype.getWholeStyle=function(){return this.props.getStyle("wholeSlicerStyle")},N.prototype.getThemeColor=function(t){return this.props.getThemeColor(t)},N.prototype.getPointerRelativeControl=function(t){var t=this.props.getPointerRelativeControl(t);return t.x+=this.props.offset.left,t.y+=this.props.offset.top,t},N.prototype.getClickItemIndex=function(t,i){var n,t,n=this.itemWidth,t=Math.floor(t/n)+this.JQt;return t>=this.itemLength?-1:t},N.prototype.refresh=function(){this.props.refresh()},N.prototype.dispose=function(){this.iWt.dispose(),this._items=T.keyword_null,this.tWt=T.keyword_null},Object.defineProperty(N.prototype,"SCROLLBAR_X_VALUE",{get:function(){return 20},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"SCROLLBAR_Y_VALUE",{get:function(){return 75+(this.showScrollBar?0:15)+(this.showHeader?0:15)},enumerable:!1,configurable:!0}),Object.defineProperty(N.prototype,"SCROLLBAR_WIDTH",{get:function(){return this.width-2*this.SCROLLBAR_X_VALUE},enumerable:!1,configurable:!0}),t.PivotTimelineList=N),t.getQuarter=j,t.getLastDateOfMonth=O,t.getMonthLength=_},"./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-slicer.js":function(t,i,n){"use strict";var e,o,r,a,s,u,n,c,l,f,h,v,n,d,p,m,b,g,w;function y(t){return 1<=t&&t<=4}function C(t){return t instanceof Date&&!isNaN(t.getTime())}function A(t,i,n){var e,r,i,e=this;if(e[t]){if(r=void 0,C(i)?r=i:"string"==typeof i&&C(new Date(i))&&(r=new Date(i)),(0,o.ht)(r))return;e[t](r),e.refresh()}(i=e.sheet())&&(i.Ut.n1i(e,t,n),e.ki({sheet:i,sheetName:i.name(),slicer:e,propertyName:t}))}function N(t,i,n){var t,e,t=w.call(this,t,i,n)||this;return t.ma=f.pivotTimeline,t.RN=h.light1(),t}e=this&&this.__extends||(g=function(t,i){return(g=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}g(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTimelineSlicerProperties=i.PivotTableTimelineSlicer=void 0,o=n("Pivot"),r=n("Slicers"),a=n("Shapes"),s=n("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),u=n("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-view-model.js"),n=n("Core"),c=n.mt.vo,l=n.Util.gr,r&&a&&(f=r.SlicerType,h=r.TimelineStyles,v=r.defSlicerProperty,n=r.onPropertyChanged,d=r.SlicerChangeType,p=r.encodeSlicerName,m=[["level",r.TimelineLevel.months,n,y],["showHorizontalScrollbar",!0,n],["showSelectionLabel",!0,n],["showTimeLevel",!0,n],["scrollPosition",s.keyword_undefined,A]],w=s.VQt,e(N,w),N.prototype.filterType=function(){return this.FQt.filterType},N.prototype.condition=function(){return this.FQt.getFilterCondition()},N.prototype.canShowRange=function(){return this.FQt.canShowRange},N.prototype.selection=function(){return this.FQt.selection},N.prototype.bounds=function(){var t=this.FQt.bounds;return{startDate:new Date(t.startDate.toString()),endDate:new Date(t.endDate.toString())}},N.prototype.selectionLevel=function(){return this.FQt.selectionLevel},N.prototype.getOptionsSet=function(){var t,i,i=this;return{nameInFormula:i.nameInFormula(),sourceName:i.sourceName(),name:null!=(t=i.name())?t:i.iSe,captionName:i.captionName(),showHeader:i.showHeader(),showHorizontalScrollbar:i.showHorizontalScrollbar(),showTimeLevel:i.showTimeLevel(),showSelectionLabel:i.showSelectionLabel(),isLocked:i.isLocked(),CCe:i.CCe}},N.prototype.getValuesSet=function(){var t=this;return{filterCleared:t.filterCleared(),canShowRange:t.canShowRange(),selection:t.selection(),bounds:t.bounds(),level:t.level(),selectionLevel:t.selectionLevel(),scrollPosition:t.scrollPosition(),filterType:t.filterType(),condition:t.condition()}},N.prototype.initSlicerUI=function(){var n=this;n.GQt=new u.PivotTableTimelineSlicerViewModel(n.Mf,n.getOptionsSet.bind(n),n.getValuesSet.bind(n)),n.GQt.setStyle(n.RN),n.GQt.bind("valueChanged",function(t){n.FQt.selectionLevel=n.level(),n.setFilterWithSelection(t)}),n.GQt.bind("clearFilter",function(){n.clearFilter()}),n.GQt.bind("propertyChanged",function(t){var i=t.propName,t=t.value;n[i]&&n[i](t)})},N.prototype.setFilterWithSelection=function(t){var i;this.FQt.setFilter(t)},N.prototype.fromJSON=function(i){var n;i&&(w.prototype.fromJSON.call(this,i),n=this,m.forEach(function(t){var t=t[0];i[t]!==s.keyword_undefined&&("scrollPosition"===t?n.scrollPosition(new Date(i[t])):n[t](i[t]))}))},N.prototype.yh=function(t,i,n,e){var i,e,t;t&&(w.prototype.yh.call(this,t,i,n,e),i=this,t.showHeader!==s.keyword_undefined&&i.showHeader("1"===t.showCaption),t.level!==s.keyword_undefined&&i.level(+t.level+1),t.showHorizontalScrollbar!==s.keyword_undefined&&i.showHorizontalScrollbar("1"===t.showHorizontalScrollbar),t.showSelectionLabel!==s.keyword_undefined&&i.showSelectionLabel("1"===t.showSelectionLabel),t.showTimeLevel!==s.keyword_undefined&&i.showTimeLevel("1"===t.showTimeLevel),t.scrollPosition!==s.keyword_undefined&&i.scrollPosition(new Date(t.scrollPosition)),e=t.style||n.getDefaultStyleName("defaultTimelineStyle"))&&(r.isBuildInTimelineStyle(e)?i.style(h[e.substring("TimeSlicerStyle".length).toLowerCase()]()):(t=n.getTimelineStyle(e))&&i.style(t))},N.prototype.toJSON=function(t){var i,n,i=this,n=w.prototype.toJSON.call(this,t);return m.forEach(function(t){var t=t[0];n[t]=i[t]()}),n.selectionLevel=i.selectionLevel(),n},N.prototype.wh=function(t,i,n){var e,r,e=this,r={name:p(e.name()),cache:p(e.FQt.name),caption:p(e.captionName()),style:c(e.RN.name()),level:e.level()-1,selectionLevel:e.selectionLevel()-1,scrollPosition:(0,o.kQt)(e.scrollPosition())};e.showHeader()||(r.showHeader=a.SJS_False),e.disableResizingAndMoving()&&(r.lockedPosition=a.SJS_True),e.showSelectionLabel()||(r.showSelectionLabel=a.SJS_False),e.showTimeLevel()||(r.showTimeLevel=a.SJS_False),e.showHorizontalScrollbar()||(r.showHorizontalScrollbar=a.SJS_False),t.push(r)},b=N,m.forEach(function(t){b.prototype[t[0]]=v(t[0],t[1],t[2],t[3])}),i.PivotTableTimelineSlicer=b,i.PivotTimelineSlicerProperties=m)},"./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-view-model.js":function(t,i,n){"use strict";var e,r,o,c,a,l,s,f,u,n,h,v,d;function p(t,i,n){return d.call(this,t,i,n)||this}e=this&&this.__extends||(v=function(t,i){return(v=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}v(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTableTimelineSlicerViewModel=void 0,r=n("Shapes"),o=n("Slicers"),c=n("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/pivot-slicer-shape.js"),a=n("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),l=n("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-view.js"),r&&o&&(r.registerCustomFormControl(s="pivotTimeline",l.PivotTableTimelineView),f=o.getSlicerSizePosInfo,u=o.SlicerChangeType,n=o.SlicerViewModelBase,e(p,d=n),p.prototype.scrollPosition=function(t){return a.keyword_null},p.prototype.WQt=function(){var n,t,i,e,r,o,a,s,u,o,t,n=this,i=this,e=i.Mf;e.shapes&&(this.zQt=new l.PivotTableTimelineView,r=i.updateOptionsCallback(),a=(o=f(e,!1)).left,s=o.top,u=o.width,o=o.height,(t=null!=(t=r.CCe)?t:e.shapes.get(r.name))||(t=new c.TimelineShape(e,r.name,!0,a,s,u,o),e.shapes.ZP(t),t.allowResize(!0),t.allowMove(!0),t.dynamicSize(!1),t.dynamicMove(!0)),t.drawingType="Timeline",i.zQt=t.GtV,i.RQt=t,i.zQt.xT&&i.resetFormControl(t),i.refreshFormControl(),i.zQt.addEventListener("valueChanged",function(t,i){n.ki("valueChanged",i)}),i.zQt.addEventListener("clearFilter",function(t,i){n.ki("clearFilter",{})}),i.zQt.addEventListener("propertyChanged",function(t,i){n.ki("propertyChanged",i)}))},p.prototype.refreshFormControl=function(){var t,i;d.prototype.refreshFormControl.call(this),(i=(t=this).zQt).setValue(t.updateValuesCallback()),i.update()},i.PivotTableTimelineSlicerViewModel=p)},"./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-view.js":function(t,v,i){"use strict";var n,d,e,r,p,w,o,u,y,i,i,C,A,e,a,c,s,m,b,l,N,I,f,h;function g(){return null!==h&&h.apply(this,arguments)||this}function T(t,i){var n,e,r,e,o,a,r,s,u,c,l,f,n,h,v,h,v,d,p,t,i,o,a,r,f,n,m,e,u,b,g;if(!(0,w.ht)(t))return n=(0,y.getMonthMap)(),(0,w.ht)(i)?"".concat(n[t.getMonth()]," ").concat(t.getDate(),", ").concat(t.getFullYear()):(r=(e=C.Fe(C.culture())).TimelineDateOrder,e=e.TimelineDateSuffix,o=r.indexOf(1),a=r.indexOf(2),r=r.indexOf(3),s=t.getFullYear(),u=i.getFullYear(),c=t.getMonth(),l=i.getMonth(),f=n[c],n=n[l],h=(0,y.getQuarter)(t),v=(0,y.getQuarter)(i),h=A().QUARTER_MAP[h],v=A().QUARTER_MAP[v],d=t.getDate(),p=i.getDate(),t=1===t.getDate()&&i.getDate()===(0,y.getLastDateOfMonth)(i),i=o<a,o=a<r,a=s+e.year,r=u+e.year,f=f+e.month,n=n+e.month,m=d+e.date,e=p+e.date,s===u?t?0===c&&11===l?s:-1!==N.indexOf(c)&&-1!==I.indexOf(l)?l-c==2?i?"".concat(a," ").concat(h):"".concat(h," ").concat(a):i?"".concat(a," ").concat(h," - ").concat(v):"".concat(h," - ").concat(v," ").concat(a):c===l?i?"".concat(a," ").concat(n):"".concat(n," ").concat(a):i?"".concat(a," ").concat(f," - ").concat(n):"".concat(f," - ").concat(n," ").concat(r):c===l?(u=void 0,u=d===p?o?"".concat(f," ").concat(m):"".concat(m," ").concat(f," "):o?"".concat(f," ").concat(m," - ").concat(e):"".concat(m," - ").concat(e," ").concat(f," "),i?"".concat(a," ").concat(u):"".concat(u," ").concat(a)):(b=o?"".concat(f," ").concat(m):"".concat(m," ").concat(f," "),g=o?"".concat(n," ").concat(e):"".concat(e," ").concat(n," "),i?"".concat(a," ").concat(b," - ").concat(g):"".concat(b," - ").concat(g,", ").concat(r)):t?0===c&&11===l?"".concat(a," - ").concat(r):-1!==N.indexOf(c)&&-1!==I.indexOf(l)?i?"".concat(a," ").concat(h," - ").concat(r," ").concat(v):"".concat(h," ").concat(a," - ").concat(v," ").concat(r):i?"".concat(a," ").concat(f," - ").concat(r," ").concat(n):"".concat(f," ").concat(a," - ").concat(n," ").concat(r):(b=o?"".concat(f," ").concat(m):"".concat(m," ").concat(f," "),g=o?"".concat(n," ").concat(e):"".concat(e," ").concat(n," "),i?"".concat(a," ").concat(b," - ").concat(r," ").concat(g):"".concat(b,", ").concat(a," - ").concat(g,", ").concat(r)))}function S(t,i,n){if((0,w.ht)(t)&&i===w.PivotDateFilterOperator.Between||(0,w.ht)(i))return A().ALL_PERIODS;if(t&&t.startDate&&t.endDate&&t.endDate<t.startDate)return A().INVALID_DATE_SELECTION;switch(i){case w.PivotDateFilterOperator.equalsTo:case w.PivotDateFilterOperator.today:case w.PivotDateFilterOperator.yesterday:case w.PivotDateFilterOperator.tomorrow:return T(t.startDate);case w.PivotDateFilterOperator.Between:case w.PivotDateFilterOperator.nextWeek:case w.PivotDateFilterOperator.thisWeek:case w.PivotDateFilterOperator.lastWeek:case w.PivotDateFilterOperator.nextMonth:case w.PivotDateFilterOperator.thisMonth:case w.PivotDateFilterOperator.lastMonth:case w.PivotDateFilterOperator.nextQuarter:case w.PivotDateFilterOperator.thisQuarter:case w.PivotDateFilterOperator.lastQuarter:case w.PivotDateFilterOperator.nextYear:case w.PivotDateFilterOperator.thisYear:case w.PivotDateFilterOperator.lastYear:case w.PivotDateFilterOperator.yearToDate:return T(t.startDate,t.endDate)}var e=A().TIMELINE_PLACE_HOLDER;switch(i){case w.PivotDateFilterOperator.notEqualsTo:return A().DateNotEqual.replace(e,T(n.eX));case w.PivotDateFilterOperator.before:return A().DateOlderThan.replace(e,T(n.eX));case w.PivotDateFilterOperator.beforeEqualsTo:return A().DateOlderThanOrEqual.replace(e,T(n.eX));case w.PivotDateFilterOperator.after:return A().DateNewerThan.replace(e,T(n.eX));case w.PivotDateFilterOperator.afterEqualsTo:return A().DateNewerThanOrEqual.replace(e,T(n.eX));case w.PivotDateFilterOperator.notBetween:return A().DateNotEqual.replace(e,T(n.eX,n.value2));case w.PivotDateFilterOperator.Q1:return A().AllDatesIn_Quarter1;case w.PivotDateFilterOperator.Q2:return A().AllDatesIn_Quarter2;case w.PivotDateFilterOperator.Q3:return A().AllDatesIn_Quarter3;case w.PivotDateFilterOperator.Q4:return A().AllDatesIn_Quarter4;case w.PivotDateFilterOperator.M1:return A().AllDatesIn_January;case w.PivotDateFilterOperator.M2:return A().AllDatesIn_February;case w.PivotDateFilterOperator.M3:return A().AllDatesIn_March;case w.PivotDateFilterOperator.M4:return A().AllDatesIn_April;case w.PivotDateFilterOperator.M5:return A().AllDatesIn_May;case w.PivotDateFilterOperator.M6:return A().AllDatesIn_June;case w.PivotDateFilterOperator.M7:return A().AllDatesIn_July;case w.PivotDateFilterOperator.M8:return A().AllDatesIn_August;case w.PivotDateFilterOperator.M9:return A().AllDatesIn_September;case w.PivotDateFilterOperator.M10:return A().AllDatesIn_October;case w.PivotDateFilterOperator.M11:return A().AllDatesIn_November;case w.PivotDateFilterOperator.M12:return A().AllDatesIn_December;case w.PivotDateFilterOperator.dateToDate:if(!n.EVt)return T(t.startDate,t.endDate);if(n.Rs===w.PivotAdvancedDateFilterBy.year)return A().PivotPanel_ValueFilterOrLabel_ParallelYearToDate;if(n.Rs===w.PivotAdvancedDateFilterBy.quarter)return A().PivotPanel_ValueFilterOrLabel_ParallelQuarterToDate;if(n.Rs===w.PivotAdvancedDateFilterBy.month)return A().PivotPanel_ValueFilterOrLabel_ParallelMonthToDate}return o.keyword_null}n=this&&this.__extends||(f=function(t,i){return(f=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}f(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(v,"__esModule",{value:!0}),v.PivotTableTimelineView=v.WHITE=v.BLACK=v.TIMELINE_DEFAULT_FONT=v.SELECTION_LABEL_FONT=void 0,d=i("Core"),e=i("@spreadjs/js-sheets-common"),r=i("Shapes"),p=i("Slicers"),w=i("Pivot"),o=i("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),u=i("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-dropdown.js"),y=i("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-list.js"),i=i("./dist/plugins/pivot/pivot.ns.js"),i=new e.Common.ResourceManager(i.SR,"PivotTables"),C=e.Common.CultureManager,A=i.getResource.bind(i),v.SELECTION_LABEL_FONT="normal 10pt calibri",v.TIMELINE_DEFAULT_FONT="normal 9pt calibri",v.BLACK="black",v.WHITE="white",p&&r&&(e=p.SlicerViewBase,a=p.SlicerChangeType,c=p.SlicerUIType,s=p.paintBorder,m=p.fillText,b=p.getEllipsisText,n(g,h=e),g.prototype.init=function(t){h.prototype.init.call(this,t),this.y4={canShowRange:o.keyword_null,selection:o.keyword_null,bounds:o.keyword_null,level:o.keyword_null,selectionLevel:o.keyword_null,filterCleared:o.keyword_null,scrollPosition:o.keyword_null,filterType:o.keyword_null,condition:o.keyword_null},this.LEt={},this.initList(),this.initClearFilterButton()},g.prototype.initList=function(){var t,i,n,t=this,i=new y.PivotTimelineList,n=i.props;n.offset={top:-45,left:-10},n.bounds=t.y4.bounds,i.props=n,i.props.onSelectionChanged=t.onSelectionChanged.bind(t),i.props.getPointerRelativeControl=t.getPointerRelativeControl.bind(t),i.props.refresh=t.refresh.bind(t),i.props.getStyle=t.getStyle.bind(t),i.props.getThemeColor=t.getThemeColor.bind(t),i.props.setCursor=t.setCursor.bind(t),i.props.onScrollPositionChanged=t.onScrollPositionChanged.bind(t),t.wY=i,this.onWindowMouseMove=this.onWindowMouseMove.bind(this),this.onWindowMouseUp=this.onWindowMouseUp.bind(this),this.onWindowKeyUp=this.onWindowKeyUp.bind(this),this.onWindowMouseWheel=this.onWindowMouseWheel.bind(this),window.addEventListener("mousemove",this.onWindowMouseMove),window.addEventListener("mouseup",this.onWindowMouseUp),window.addEventListener("keyup",this.onWindowKeyUp),window.addEventListener("mousewheel",this.onWindowMouseWheel)},g.prototype.initDropDown=function(){var t,i,n,n,e,r,o,a,s,r,o,a,t=this,i=t.sheet,n=t.onLevelChanged.bind(t),n=new u.PivotTimelineDropdown(i.parent&&i.parent.j2(),d.mt.gi(i.parent.Ti),n),e=t.dWt,r=t.shape,o=r.startRow(),a=r.startColumn(),s=r.startRowOffset(),r=r.startColumnOffset(),o=i.getCellRect(o,a),a=i.zoom();n.init(t.y4.level,o.x+(r+e.x)*a,o.y+(s+e.y+20)*a)},g.prototype.filterCleared=function(){return this.y4.filterCleared},g.prototype.triggerEvent=function(t,i){this.fireEvent(t,i)},g.prototype.onSelectionChanged=function(t){this.triggerEvent("valueChanged",t)},g.prototype.onLevelChanged=function(t){this.triggerEvent("propertyChanged",{propName:"level",value:t}),this.wY.onLevelChanged()},g.prototype.onScrollPositionChanged=function(t){this.triggerEvent("propertyChanged",{propName:"scrollPosition",value:t})},g.prototype.setStyle=function(t){this.RN=t},g.prototype.getStyle=function(t){return this.RN[t]()},g.prototype.update=function(){var t,i,n,e,r,o,a,s,u,n,c,l,c,t=this,i=t.wY.props,n=t.y4,e=n.bounds,r=n.selection,o=n.selectionLevel,a=n.level,s=n.scrollPosition,u=n.canShowRange,n=n.filterCleared,c=t.options,l=c.showHeader,c=c.showHorizontalScrollbar;i.bounds=e,i.selection=r,i.level=a,i.selectionLevel=o,i.showHeader=l,i.showScrollbar=c,i.scrollPosition=s,i.canShowRange=u,i.filterCleared=n,t.wY.update()},g.prototype.render=function(t,i){var i,n,e,r,i,o,a,i=h.prototype.render.call(this,t,i);if(i&&(n=i.left,e=i.top,r=i.w,i=i.h,!(r<0)))return a=(o=this).LEt.showHeader,t.save(),t.rect(n+8,e+(a?37:5),r+4,i),t.clip(),o.LEt.showSelectionLabel&&o.paintSelectionLabel(t,n+10,e+(a?30:5),r-70,30),o.LEt.showTimeLevel&&o.paintLevel(t,n,e-(a?0:25),r,i),o.paintList(t,n,e,r,i),t.restore(),{left:n,top:e,w:r,h:i}},g.prototype.paintHeader=function(t,i,n,e,r){var o,e,r,e,o=this;h.prototype.paintHeader.call(this,t,i,n,e,r),o.width<=20||(r=(e=o.getWholeStyle())&&e.borderTop(),e=new d.Rect(i+10,n,o.width-20,Math.min(o.height,25)),s(t,2,e,r,this.getThemeColor.bind(this)))},g.prototype.paintSelectionLabel=function(t,i,n,e,r){var o,a,s,u,c,s,a,l,f,o,o=this,a=o.y4,s=a.filterType,u,c,s=S(a.selection,s,a.condition),a=o.getWholeStyle(),l=o.getStyle("selectionLabelStyle"),f=l&&l.font()||a&&a.font()||v.SELECTION_LABEL_FONT,o=o.getThemeColor(l&&l.foreColor()||a&&a.foreColor()||v.BLACK);t.save(),m(t,b(t,s,e),i,n,o,f,r,e),t.restore()},g.prototype.eCi=function(){var t,i,n,e,r,o,a,s,u,c,l,t,i=0,n=0,e=this.LEt,r=e.showHeader,o=e.showSelectionLabel,a=e.showTimeLevel,s,u,c=-10,l=-45;return r?n+=25:l+=25,e.showHorizontalScrollbar||(c-=23),o||a||(n-=20,l+=20),{x:0,y:n,listLeft:c,listTop:l}},g.prototype.paintList=function(t,i,n,e,r){var o,a,s,u,o=this;t.save(),s=-e/2+(a=o.eCi()).x,u=-r/2+a.y,o.wY.props.offset.left=a.listLeft,o.wY.props.offset.top=a.listTop,t.rect(s,u,e,r),t.clip(),t.beginPath(),t.translate(s,u),o.pWt(e,r),o.wY.render(t),t.restore()},g.prototype.paintLevel=function(t,i,n,e,r){var o,a,e,n,s,u,c,l,f,l,h,c,a,c,l,o=this,a=o.y4.level;if(a){switch(e=i+(e<70?10:e-60),n=n+30,s=60,u=30,c=o.getWholeStyle(),f=(l=o.getStyle("timeLevelStyle"))&&l.font()||c&&c.font()||v.TIMELINE_DEFAULT_FONT,l=o.getThemeColor(l&&l.foreColor()||c&&c.foreColor()||v.BLACK),h="",a){case p.TimelineLevel.years:h=A().TIME_LEVEL_YEARS;break;case p.TimelineLevel.quarters:h=A().TIME_LEVEL_QUARTERS;break;case p.TimelineLevel.months:h=A().TIME_LEVEL_MONTHS;break;case p.TimelineLevel.days:h=A().TIME_LEVEL_DAYS}t.save(),f=d.mt.yt(f),t.font=f,c=b(t,h,60),a=Math.ceil(t.measureText(c).width)+5,m(t,c,(e+=60-a)-5,n,l,f,30,a),t.restore(),t.save(),c=e+a,l=n+10,t.beginPath(),t.fillStyle="#b2b2b2",t.moveTo(c,l),t.lineTo(c+10,l),t.lineTo(c+5,l+10),t.lineTo(c,l),t.closePath(),t.fill(),t.restore(),o.dWt=new d.Rect(e-i,o.LEt.showHeader?30:5,a+10,30)}},g.prototype.pWt=function(t,i){var n,e,n,e;this.wY.props.containerSize={w:t,h:i}},g.prototype.setValue=function(t){this.y4=t,this.refresh()},g.prototype.onWindowMouseMove=function(t){h.prototype.onWindowMouseMove.call(this,t),this.wY.onWindowMouseMove(t)},g.prototype.onWindowMouseUp=function(t){this.wY.onWindowMouseUp(t)},g.prototype.onWindowKeyUp=function(t){this.wY.onWindowKeyUp(t)},g.prototype.onLevelDropDownClicked=function(t,i){var n=this;return!!n.mWt(t,i)&&(n.initDropDown(),!0)},g.prototype.doMouseDown=function(t){var i,n,i=this,n=i.getPointerRelativeControl(t);return!(!i.LEt.showTimeLevel||!i.onLevelDropDownClicked(n.x,n.y))||this.wY.onMouseDown(t)},g.prototype.doMouseMove=function(t){var i,t,i=this;i.wY.onMouseMove(t),h.prototype.doMouseMove.call(this,t),t=i.getPointerRelativeControl(t),i.mWt(t.x,t.y)&&i.setCursor("default")},g.prototype.doMouseUp=function(t){this.wY.onMouseUp(t),h.prototype.doMouseUp.call(this,t)},g.prototype.onWindowMouseWheel=function(t){this.wY.onWindowMouseWheel(t)},g.prototype.mWt=function(t,i){var n=this.dWt;return!!n&&t>=n.x&&t<=n.x+n.width&&i>=n.y&&i<=n.y+n.height-10},g.prototype.bWt=function(){var t;return{top:-5,left:31-this.width}},g.prototype.gWt=function(t,i){var n,e,r,o,e,a,e,s,u,s,n=this,e=h.prototype.gWt.call(this,t,i);if(e.rect)return e.rect;switch(r=n.options,a=(e=n.eCi()).listLeft,e=e.listTop,t){case c.scrollBar:o={rect:n.wY.F1i(i)};break;case c.item:s=i.index,u=i.displayIndex,s=s,(0,w.ht)(u)||(s=u+n.wY.JQt),o=n.wY.B1i(s);break;case c.timeLevel:o={rect:n.dWt};break;case c.dragBar:o={rect:n.wY.nCi(i)},r.showHorizontalScrollbar||(o.rect.x-=19)}return r.showHeader||(t===c.timeLevel&&r.showTimeLevel?o.rect.y+=5:o.rect.y-=15),o&&t!==c.timeLevel&&(o.rect.x-=a,o.rect.y-=e),o},g.prototype.dispose=function(){this.wY.dispose(),this.wY=o.keyword_null,this.wWt=o.keyword_null,this.RN=o.keyword_null,this.dWt=o.keyword_null,window.removeEventListener("mousemove",this.onWindowMouseMove),window.removeEventListener("mouseup",this.onWindowMouseUp),window.removeEventListener("keyup",this.onWindowKeyUp),window.removeEventListener("mousewheel",this.onWindowMouseWheel),h.prototype.dispose.call(this)},v.PivotTableTimelineView=g),N=[0,3,6,9],I=[2,5,8,11]},"./dist/plugins/pivot/pivot-panel/pivot-panel.js":function(L,t,i){"use strict";var E,e,l,B,u,n,R,f,h,G,V,r,i,U,o,a,Q,s,W,v,i,d,p,m,b,z,g,w,y,C,A,N,I,Z,T,S,x,M,D,k,j,c,Y,H,J,O,_,q,K,X,n,$;function F(t,i,n){void 0===n&&(n=l.PivotPanelLayoutType.stack);var e=this;e.yWt=i.Zc,e.Ti=t,e.uit=0,e.CWt=n,e.Qy=i.Qy,e.IWt=i,e.AWt=!1,e.NWt=[],e.TWt=0,e.Hc()}function P(t,i,n){var t=$.call(this,t,i)||this;return t.uit=0,t.T$=1,t.MWt(n),t.GY=new q(n,t),t.xWt={showFields:!0,showArea:!0,showViewList:!0},t.dh&&(t.Qy=t.dh.Qy,t.z=i,t.dh.addPivotView(t)),t.paint(),t}E=this&&this.__extends||(X=function(t,i){return(X=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}X(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),e=this&&this.__assign||function(){return(e=Object.assign||function(t){for(var i,n,e,r,n=1,e=arguments.length;n<e;n++)for(r in i=arguments[n])Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r]);return t}).apply(this,arguments)},Object.defineProperty(t,"__esModule",{value:!0}),t.PivotPanel=t.panelOperation=void 0,l=i("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),B=i("./dist/plugins/pivot/pivot-core/pivot-view.js"),u=i("Pivot"),n=i("@spreadjs/js-sheets-common"),R=i("./dist/plugins/pivot/pivot.ns.js"),f=i("Core"),h=i("./dist/plugins/pivot/pivot-ui/dropdown-list.js"),G=i("./dist/plugins/pivot/pivot-table/pivot-table.js"),V=i("./dist/plugins/pivot/pivot-util.js"),r=n.Common.zf.j0,i=window,U=document,o=i.jQuery,a="pivotPanel",Q="string",s=null,W=void 0,v=n.Common.lt.ht,i=new n.Common.ResourceManager(R.SR,"PivotTables"),d=i.getResource.bind(i),p=".pivot-panel",b="gc-panel-all-field-item",z="gc-panel-all-field-item-filtered",g=(m="gc-panel-area-item")+"-content",w="gc-panel-defer-layout-right-button",y="gc-panel-bottomBorderStyle",C="gc-panel-topBorderStyle",A="gc-panel-defer-layout-input",N="gc-panel-area-item-icon",I="data-index",Z="gc-panel-all-field-filter",T="Pivot-Field-Filter",S="gc-panel-all-field-checkbox",x="gc-panel-all-field",M="gc-panel-collapse",D="gc-panel-selected-view",k="gc-panel-add",j="gc-panel-apply",c="gc-panel-withoutViewList",Y="containViewList",H="containFields",J="containArea",O="gc-panel-views",(n=_=t.panelOperation||(t.panelOperation={}))[n.addField=0]="addField",n[n.removeField=1]="removeField",n[n.updateFieldArea=2]="updateFieldArea",n[n.updateValuePosition=3]="updateValuePosition",F.prototype.Hc=function(){this.Fz()},F.prototype.dispose=function(){var t=this;t.IWt=s,t.Qy=s,t.NWt=s,t.DWt=s,t.Ti.innerHTML="",t.Ti=W,t.SWt()},F.prototype.Fz=function(){var u,e,t,a,s,c,u=this,e="."+u.yWt,t=u.Ti;this.IWt.dh&&((0,f.GC$)(u.Ti,t).bind("dragover"+p+e,function(t){t.preventDefault()}).bind("dragleave"+p+e,function(){a&&(s=a)}),(0,f.GC$)("."+m,t).bind("dragstart"+p+e,function(){a=a||(0,f.GC$)(this),(0,f.GC$)(document).bind("dragover"+p+e,function(t){t.preventDefault()}).bind("drop"+p+e,function(t){var i,t,i,n;t.preventDefault(),i=t.clientX,t=t.clientY,!a||i>u.Ti.offsetLeft&&i<u.Ti.offsetLeft+u.Ti.offsetWidth&&t>u.Ti.offsetTop&&t<u.Ti.offsetTop+u.Ti.offsetHeight||v(s)||(i=u.IWt.z.Zc,(n=u.AWt?u.IWt.dh.copyFieldsModel:u.IWt.dh).wVt({cmd:"removeField",sheetName:"",cmdOption:{fieldName:s.attr("data-name"),pivotName:i,isSusPaint:u.AWt}})),(0,f.GC$)(document).unbind("dragover"+p+e),(0,f.GC$)(document).unbind("drop"+p+e),a=null})}),(0,f.GC$)("."+g,t).bind("dragover"+p+e,function(t){var i,t,n,i=t.target;i.classList.contains(m)?(t=t.offsetY,n=i.parentElement,(0,f.GC$)(n.children).removeClass(y),(0,f.GC$)(n.children).removeClass(C),t<i.offsetHeight&&i.classList.add(C)):i.classList.contains(g)&&i.lastElementChild&&i.lastElementChild.classList.add(y)}).bind("dragleave"+p+e,function(){(0,f.GC$)("."+m).removeClass(y).removeClass(C)}).bind("drop"+p+e,function(t){var i,n,e,r,t,t,o,r;t.stopPropagation(),(t=t.toElement||t.relatedTarget||t.target).classList.contains("gc-panel-area-item-label")&&(t=t.parentElement),a&&(e=a.attr("data-sourceName")||a.attr("data-name"),r=(0,f.GC$)(a).attr("data-area"),n=t&&parseInt((0,f.GC$)(t).attr("data-area"),10),i=parseInt((0,f.GC$)(t).attr(I),10),0===t.childElementCount?i=0:t.classList.contains("gc-panel-area-item-content")&&(t=t.lastElementChild,i=parseInt((0,f.GC$)(t).attr(I),10),i++),v(r)?(u.AWt&&(t=_.addField,u.NWt.push({name:e,toArea:n,index:i,type:t})),c=u.AWt?u.IWt.dh.copyFieldsModel:u.IWt.dh,o=u.IWt.z.Zc,c.wVt({cmd:"AddField",sheetName:"",cmdOption:{fieldName:e,targetArea:n,targetIndex:i,pivotName:o,isSusPaint:u.AWt}})):v(n)||(r=u.AWt?u.IWt.dh.copyFieldsModel:u.IWt.dh,o=u.IWt.z.Zc,r.wVt({cmd:"moveField",sheetName:"",cmdOption:{fieldName:e,targetArea:n,targetIndex:i,pivotName:o,isSusPaint:u.AWt}})),s=a=null)}),(0,f.GC$)("."+b,t).bind("dragstart"+p+e,function(){a=a||(0,f.GC$)(this)}),(0,f.GC$)("."+x,t).bind("dragenter"+p+e,function(t){t.stopPropagation(),a&&(s=a)}).bind("drop"+p+e,function(){var t,i;v(s)||(u.AWt&&u.NWt.push({name:s.attr("data-name"),type:_.removeField}),t=u.IWt.z.Zc,(i=u.AWt?u.IWt.dh.copyFieldsModel:u.IWt.dh).wVt({cmd:"removeField",sheetName:"",cmdOption:{fieldName:s.attr("data-name"),pivotName:t,fieldsModel:i,isSusPaint:u.AWt}})),s=a=null}),(0,f.GC$)("."+A,t).bind("click"+p+e,function(t){u.AWt=t.target.checked;var t=(0,f.GC$)("."+w);u.AWt?u.IWt.dh&&(u.IWt.dh.copyFieldsModel=u.IWt.dh.clone()):(u.IWt.dh.copyFieldsModel=void 0,u.IWt.refresh(u.AWt)),t&&t.prop("disabled",!u.AWt)}),(0,f.GC$)("."+w,t).bind("click"+p+e,function(){var t,i,n;u.AWt&&(t=u.IWt.dh.copyFieldsModel.UM(),i=u.IWt.z.Zc,(n=u.IWt.dh).wVt({cmd:"updatePivotDefer",sheetName:"",cmdOption:{pivotName:i,fieldsInfo:t}})),u.IWt.refresh(!1)}),(0,f.GC$)("."+N,t).bind("click"+e,function(t){var i,n,e,i,r,t,o,a,s;(0,f.GC$)(this).hasClass(T)||(n=(i=(0,f.GC$)(t.target).parent()).attr("data-name"),e=+i.attr("data-area"),i=+i.attr(I),r=u.updateOptionForDropDown(n,e,i),t={x:t.clientX,y:t.clientY},o=u.IWt.z.Zc,a=u.AWt?u.IWt.dh.copyFieldsModel:u.IWt.dh,(s=new h.PivotDropDown(document.body,a,o,n,e,i,u.AWt)).rQ(t,r))}),(0,f.GC$)("."+b,t).bind("contextmenu"+e,function(t){var i,n,t,e,r,o,i,n=(0,f.GC$)(this).attr("data-name"),t={x:t.clientX,y:t.clientY},e=u.IWt.z.Zc,r=u.AWt?u.IWt.dh.copyFieldsModel:u.IWt.dh,o;return new h.PivotCacheFieldsDropdownDialog(document.body,r,e,n,null,null,u.AWt).rQ(t),!1}),(0,f.GC$)("."+S,t).bind("click"+e,function(t){var i,t,n,e,r,t,i,t=(0,f.GC$)(t.target).parent().attr("data-sourceName"),n=this.checked,e=u.AWt?u.IWt.dh.copyFieldsModel:u.IWt.dh,r,t={fieldName:t,checked:n,pivotName:u.IWt.z.Zc,isSusPaint:u.AWt};e.wVt({cmd:"changePanelFieldStatus",sheetName:u.IWt.Zc,cmdOption:t})}),(0,f.GC$)("."+T,t).bind("click"+e,function(t){var i,n,t,e,r,o,o,a,i,n=(0,f.GC$)(t.target).parent().attr("data-name"),t={x:t.pageX,y:t.pageY},e=u.AWt?u.IWt.dh.copyFieldsModel:u.IWt.dh,r=u.IWt.z.Zc,o=u.IWt.z;o instanceof G.PivotTable&&(o=o.layoutType()===l.PivotTableLayoutType.compact,e.wVt({cmd:"CreatePivotFilterDialog",sheetName:u.IWt.Zc,cmdOption:a={position:t,fieldName:n,fieldsModel:e,isCompact:o,pivotName:r}}))}),(0,f.GC$)("."+M,t).bind("click"+e,function(t){var i,t,n,e,r,o,o,i=u.IWt.dh,t={x:t.pageX,y:t.pageY},n=u.IWt.z,e=u.IWt.z.Zc,r=100,o=(0,f.GC$)("."+O);o&&0<o.length&&200<o.width()&&300<(r=o.width()-100)&&(r=300),n&&(o={position:t,pivotName:e,views:n.views,width:r},i.wVt({cmd:"CreatePivotViewsListDialog",cmdOption:o}))}),(0,f.GC$)("."+k,t).bind("click"+e,function(t){var i,n,e,r,i,i=(0,f.GC$)("#"+D).val();(0,V.kWt)(i)&&(i=d().DefaultPivotTableViewName),n=u.IWt.z,e=u.IWt.dh,r=u.IWt.z.Zc,n&&(i={name:i,pivotName:r,views:n.views},e.wVt({cmd:"AddPivotView",cmdOption:i}),(0,f.GC$)("#"+D).val(""))}),(0,f.GC$)("."+j,t).bind("click"+e,function(t){var i,n,e,r,i,i=(0,f.GC$)("#"+D).val(),n=u.IWt.dh,e=u.IWt.z,r=u.IWt.z.Zc;e&&(i={name:i,pivotName:r,views:e.views},n.wVt({cmd:"ApplyPivotView",cmdOption:i}))}),(0,f.GC$)("."+x,t).bind("scroll.pivotPanel"+p+e,function(){u.TWt=this.scrollTop}))},F.prototype.updateOptionForDropDown=function(t,i,n){var e,r,o,a,e,s,a,e=this.AWt?this.IWt.dh.copyFieldsModel:this.IWt.dh,r={1:u.DataPosition.row,2:u.DataPosition.col},o={isSigma:!1,isAlone:!1,location:1,area:i},a=e.getSigmaValuePosition(),e=e.nw(i),s=0;return a.display&&a.positionType===r[i]&&(s=1),t===d().sigmaValue&&(o.isSigma=!0),1===(a=e.length+s)&&(o.isAlone=!0),0===n?o.location=1:n<a-1?o.location=2:n===a-1&&(o.location=3),o},F.prototype.SWt=function(){var t,i,t="."+this.yWt,i=this.Ti;(0,f.GC$)(document).unbind("dragover"+p+t),(0,f.GC$)(document).unbind("drop"+p+t),(0,f.GC$)("."+m,i).unbind("dragstart"+p+t),(0,f.GC$)("."+b,i).unbind("dragstart"+p+t),(0,f.GC$)(this.Ti,i).unbind("dragover"+p+t),(0,f.GC$)(this.Ti,i).unbind("dragleave"+p+t),(0,f.GC$)("."+g,i).unbind("dragleave"+p+t),(0,f.GC$)("."+g,i).unbind("dragover"+p+t),(0,f.GC$)("."+g,i).unbind("drop"+p+t),(0,f.GC$)("."+b,i).unbind("dragstart"+p+t),(0,f.GC$)("."+x,i).unbind("drop"+p+t),(0,f.GC$)("."+x,i).unbind("dragenter"+p+t),(0,f.GC$)("."+A,i).unbind("click"+p+t),(0,f.GC$)("."+w,i).unbind("click"+p+t),(0,f.GC$)("."+N,i).unbind("click."+t),(0,f.GC$)("."+b,i).unbind("contextmenu."+t),(0,f.GC$)("."+S,i).unbind("click."+t),(0,f.GC$)("."+T,i).unbind("click."+t),(0,f.GC$)("."+M,i).unbind("click."+t),(0,f.GC$)("."+k,i).unbind("click."+t),(0,f.GC$)("."+j,i).unbind("click."+t),(0,f.GC$)("."+x,i).unbind("scroll"+p+t)},F.prototype.Mrt=function(t){var i,n,e,r,o,t,t,a,s,i,o,n,e,r,s,i,i=t.allField,n=t.rowField,e=t.colField,r=t.valueField,o=t.filterField,t=t.valuePosition;r&&1<r.length&&t.positionType===u.DataPosition.row&&n.splice(t.positionIndex,0,{Zc:d().sigmaValue,lp:t.positionIndex}),r&&1<r.length&&t.positionType===u.DataPosition.col&&e.splice(t.positionIndex,0,{Zc:d().sigmaValue,lp:t.positionIndex}),a=l.PivotPanelLayoutType[(t=this).CWt].toLocaleLowerCase(),s=t.jWt(),i=t.OWt(i),o=t.PWt([o,n,e,r]),n=t.FWt(),e=t.IWt.xWt.showViewList?t._Wt():"",r=t.IWt.xWt.showFields?'\n                <div class="gc-panel-fields-section" '.concat(J,'="').concat(t.IWt.xWt.showArea,'">\n                    ').concat(s,"\n                    ").concat(i,"\n                </div>"):"",s=t.IWt.xWt.showArea?'\n                <div class="gc-panel-areas-section" '.concat(H,'="').concat(t.IWt.xWt.showFields,'">\n                    <span>').concat(d().PivotPanel_FieldAreaText,'</span>\n                    <div class = "gc-panel-field-area">\n                        ').concat(o,"\n                    </div>\n                    ").concat(n,"\n                </div>\n                "):"",t.Ti.innerHTML='\n                <div class="gc-panel gc-panel-'.concat(a,' gc-no-user-select">\n                    <div class=').concat(c," ").concat(Y,'="').concat(t.IWt.xWt.showViewList,'">\n                        <div class="gc-panel-header">\n                            <h2>').concat(d().PivotPanel_Title,"</h2>\n                        </div>\n                        ").concat(r,"\n                        ").concat(s,"\n                    </div>\n                    ").concat(e,"\n                </div>\n                "),(i=(0,f.GC$)("#"+x)[0])&&i.scrollTo({top:t.TWt})},F.prototype._Wt=function(){return'\n            <div class="'.concat(O,'">\n                <span style="width: 45px;display: inline-block;text-align: center; font-size: 14px">').concat(d().Views,'</span>\n                <div style="width: calc(100% - 50px); display: inline-block; border: 1px solid #CBCBCB; white-space: nowrap">\n                    <span class="').concat(M,'"></span>\n                    <input style="border: none; width: calc(100% - 91px); outline:none; vertical-align: text-bottom;" id="').concat(D,'"/>\n                    <input type="button" class="gc-panel-button ').concat(k,'" value="\u271a"/>\n                    <input type="button" class="gc-panel-button ').concat(j,'" value="\u2714"/>\n                </div>\n            </div>\n            ')},F.prototype.jWt=function(){return"\n                <span>".concat(d().PivotPanel_ReportText,"</span>\n                ")},F.prototype.OWt=function(t){var i,n,e,r,o,a,s,r,i="";if(t)for(n=0,e=t;n<e.length;n++)o=(r=e[n]).fieldName,a=r.sourceName,s=r.isFilter,r=r.isDims,i+=this.LWt(o,a,s,r);return'\n                <div class="'.concat(x,'" id="').concat(x,'">\n                    <ul>\n                        ').concat(i,"\n                    </ul>\n                </div>\n                ")},F.prototype.LWt=function(t,i,n,e){return i=r(i),t=r(t),'\n        <li class="'.concat(b+(n?" "+z:""),'" title="').concat(t,'" data-name="').concat(t,'" data-sourceName="').concat(i,'" draggable="true">\n            <input type="checkbox" ').concat(e?"checked":"",' class = "').concat(S,' gc-panel-checkbox"/>\n            <span class="').concat(e?"gc-panel-all-field-checked":"gc-panel-all-field-unchecked",'">').concat(i,'</span>\n            <span class="').concat(N+" "+T,'"></span>\n            <span class="').concat(n?Z:"",'"></span>\n        </li>')},F.prototype.render=function(t){this.SWt(),this.Mrt(t),this.Fz()},F.prototype.d5=function(){this.SWt(),this.Ti.innerHTML=""},F.prototype.PWt=function(t){for(var i,n,e,r,o,i="",n=this.CWt===l.PivotPanelLayoutType.stack?[0,2,1,3]:[0,1,2,3],e=0,r=n;e<r.length;e++)o=r[e],i+=this.EWt(o,t?t[o]:null);return i},F.prototype.BWt=function(t){var i,t,i,t=["Filters","Rows","Columns","Values"][t];return{title:d()["PivotPanel_"+t+"ItemsTitle"],rowItemClass:t}},F.prototype.EWt=function(t,i){var n,e,n,r,n=this.BWt(t),e=n.title,n=n.rowItemClass,r="";return i&&(r=this.RWt(i,t)),'\n        <section class="gc-panel-area-section gc-panel-area-section-'.concat(n,'">\n            <div class="gc-panel-area-item-title">\n                <label class="').concat(N," gc-panel-area-item-").concat(n,'"></label>\n                <span>').concat(e,'</span>\n            </div>\n            <ul class="gc-panel-area-item-content" data-area="').concat(t,'">\n                ').concat(r,"\n            </ul>\n        </section>")},F.prototype.RWt=function(t,n){var e,r,e=this,r="";return t.forEach(function(t,i){r+=e.GWt(t.Zc,n,i)}),r},F.prototype.GWt=function(t,i,n){return'\n        <li class="'.concat(m,'" data-name="').concat(r(t),'" data-area="').concat(i,'" data-index="').concat(n,'" draggable="true">\n            <span class="gc-panel-area-item-label">').concat(r(t),'</span>\n            <span class="').concat(N,'"></span>\n        </li>\n        ')},F.prototype.FWt=function(){var t=this;return'<div class = "gc-panel-defer-layout-update">\n                     <div class = "gc-panel-defer-layout-left-div">\n                       <input type="checkbox" class = "gc-panel-checkbox gc-panel-defer-layout-input" '.concat(t.AWt?"checked":"",">\n                       <label>").concat(d().PivotPanel_DeferUpdateText,'</label >\n                 </div>\n                 <button class="gc-panel-defer-layout-right-button" ').concat(t.AWt?"":"disabled",">").concat(d().PivotPanel_Update,"</button>\n                </div>\n             ")},F.prototype.VWt=function(t){if(v(t))return this.CWt;this.CWt=t},q=F,$=B.PivotView,E(P,$),P.prototype.MWt=function(t){var i=this;t&&(o&&o(t).data(a,i),(0,f.GC$)(t).data(a,i))},P.prototype.UWt=function(){var t,t,t=this,t=t.GY&&t.GY.Ti;t&&(o&&o(t).data(a,s),(0,f.GC$)(t).data(a,s))},P.prototype.isPivotViewAttached=function(t){return this.z&&this.z===t},P.prototype.attach=function(t){this.detach(),t&&(this.dh=t.dh,this.Qy=this.dh.Qy,this.dh.addPivotView(this),this.z=t)},P.prototype.detach=function(){this.dh&&(this.dh.removePivotView(this),this.dh=null,this.z=null,this.paint())},P.prototype.sectionVisibility=function(t){var i,i;if(v(t))return i=0,this.xWt.showFields&&(i+=l.PivotPanelSection.fields),this.xWt.showArea&&(i+=l.PivotPanelSection.area),this.xWt.showViewList&&(i+=l.PivotPanelSection.viewList),i;i={showFields:!1,showArea:!1,showViewList:!1},t&l.PivotPanelSection.fields&&(i.showFields=!0),t&l.PivotPanelSection.area&&(i.showArea=!0),t&l.PivotPanelSection.viewList?((0,f.GC$)("."+c).attr("containViewList","true"),i.showViewList=!0):(0,f.GC$)("."+c).attr("containViewList","false"),this.xWt=i,this.refresh(!1)},P.prototype.panelLayout=function(t){var i=this.GY.VWt();if(v(t))return i;t===l.PivotPanelLayoutType.stack&&i===l.PivotPanelLayoutType.flow?(this.GY.VWt(l.PivotPanelLayoutType.stack),this.refresh(!1)):t===l.PivotPanelLayoutType.flow&&i===l.PivotPanelLayoutType.stack&&(this.GY.VWt(l.PivotPanelLayoutType.flow),this.refresh(!1))},P.prototype.type=function(t){if(0===arguments.length)return this.uit;this.uit=t},P.prototype.paint=function(t){var i,t,n,i=this,t=t?this.dh.copyFieldsModel:this.dh,n=i.z&&i.z.views.all();i.GY.render(t?e(e({},t.IVt()),{views:n}):{allField:null,rowField:null,colField:null,valueField:null,filterField:null,valuePosition:null,views:n})},P.prototype.refresh=function(t){var i=t?this.dh.copyFieldsModel:this.dh;i&&i.q3(t)},P.prototype.destroy=function(){var t=this;t.Qy=s,t.dh&&(t.dh.removePivotView(t),t.dh=s),t.UWt(),t.Ti=s,t.GY&&(t.GY.dispose(),t.GY=s)},P.prototype.dispose=function(){var t=this;t.destroy(),t.z=s},P.findControl=function(t){return typeof t==Q&&(t=U.getElementById(t)),(0,f.GC$)(t).data(a)},t.PivotPanel=P},"./dist/plugins/pivot/pivot-panel/pivot-widget.js":function(t,i,n){"use strict";var e,r,o,a;function s(t){return 0===t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDE8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQxIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cG9seWdvbiBpZD0i6Lev5b6ELTQiIGZpbGw9IiM2NjY2NjYiIHBvaW50cz0iNSA3IDEzIDcgOSAxMSI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":1===t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDQ8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQ0IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNMTEsMyBMMTIsMyBMMTIsOSBMMTQsOSBMMTEuNSwxMiBMOSw5IEwxMSw5IEwxMSwzIFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTEuNTAwMDAwLCA3LjUwMDAwMCkgcm90YXRlKC0xODAuMDAwMDAwKSB0cmFuc2xhdGUoLTExLjUwMDAwMCwgLTcuNTAwMDAwKSAiPjwvcGF0aD4KICAgICAgICA8cG9seWdvbiBpZD0i6Lev5b6ELTQiIGZpbGw9IiM2NjY2NjYiIHBvaW50cz0iMyAxMCA4IDEwIDUuNSAxMyI+PC9wb2x5Z29uPgogICAgPC9nPgo8L3N2Zz4=":2===t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDM8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQzIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNMTEsMyBMMTIsMyBMMTIsOSBMMTQsOSBMMTEuNSwxMiBMOSw5IEwxMSw5IEwxMSwzIFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiI+PC9wYXRoPgogICAgICAgIDxwb2x5Z29uIGlkPSLot6/lvoQtNCIgZmlsbD0iIzY2NjY2NiIgcG9pbnRzPSIzIDEwIDggMTAgNS41IDEzIj48L3BvbHlnb24+CiAgICA8L2c+Cjwvc3ZnPg==":3===t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDI8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQyIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cG9seWdvbiBpZD0i6Lev5b6ELTQiIGZpbGw9IiM2NjY2NjYiIHBvaW50cz0iMyAxMCA4IDEwIDUuNSAxMyI+PC9wb2x5Z29uPgogICAgICAgIDxwYXRoIGQ9Ik0xNC4zNTk0ODc1LDQgQzE0LjUyNTE3MjksNCAxNC42NTk0ODc1LDQuMTM0MzE0NTggMTQuNjU5NDg3NSw0LjMgQzE0LjY1OTQ4NzUsNC4zNzAxODA5NSAxNC42MzQ4ODI3LDQuNDM4MTQwODIgMTQuNTg5OTUzOSw0LjQ5MjA1NTMyIEwxMS4zOTk1MDUsOC4zMiBMMTEuNCwxMS42MzIyNTgxIEw5LjYsMTIuNiBMOS41OTk1MDQ5Niw4LjMyIEw2LjQxMDA0NjEsNC40OTIwNTUzMiBDNi4zMDM5NzY4OCw0LjM2NDc3MjI1IDYuMzIxMTc0MDksNC4xNzU2MDI4NCA2LjQ0ODQ1NzE2LDQuMDY5NTMzNjIgQzYuNTAyMzcxNjYsNC4wMjQ2MDQ4NyA2LjU3MDMzMTUzLDQgNi42NDA1MTI0OCw0IEwxNC4zNTk0ODc1LDQgWiIgaWQ9IkNvbWJpbmVkLVNoYXBlIiBmaWxsPSIjNjY2NjY2Ij48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":4===t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDU8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQ1IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNNCw1IEw1LDUgTDUsMTEgTDcsMTEgTDQuNSwxNCBMMiwxMSBMNCwxMSBMNCw1IFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNC41MDAwMDAsIDkuNTAwMDAwKSByb3RhdGUoLTE4MC4wMDAwMDApIHRyYW5zbGF0ZSgtNC41MDAwMDAsIC05LjUwMDAwMCkgIj48L3BhdGg+CiAgICAgICAgPHBhdGggZD0iTTE0LjM1OTQ4NzUsNCBDMTQuNTI1MTcyOSw0IDE0LjY1OTQ4NzUsNC4xMzQzMTQ1OCAxNC42NTk0ODc1LDQuMyBDMTQuNjU5NDg3NSw0LjM3MDE4MDk1IDE0LjYzNDg4MjcsNC40MzgxNDA4MiAxNC41ODk5NTM5LDQuNDkyMDU1MzIgTDExLjM5OTUwNSw4LjMyIEwxMS40LDExLjYzMjI1ODEgTDkuNiwxMi42IEw5LjU5OTUwNDk2LDguMzIgTDYuNDEwMDQ2MSw0LjQ5MjA1NTMyIEM2LjMwMzk3Njg4LDQuMzY0NzcyMjUgNi4zMjExNzQwOSw0LjE3NTYwMjg0IDYuNDQ4NDU3MTYsNC4wNjk1MzM2MiBDNi41MDIzNzE2Niw0LjAyNDYwNDg3IDYuNTcwMzMxNTMsNCA2LjY0MDUxMjQ4LDQgTDE0LjM1OTQ4NzUsNCBaIiBpZD0iQ29tYmluZWQtU2hhcGUiIGZpbGw9IiM2NjY2NjYiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+":5===t?"data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxOHB4IiB2aWV3Qm94PSIwIDAgMTggMTgiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c29ydDY8L3RpdGxlPgogICAgPGcgaWQ9InNvcnQ2IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMTcsMCBMMTcsMTcgTDAsMTcgTDAsMCBMMTcsMCBaIE0xNiwxIEwxLDEgTDEsMTYgTDE2LDE2IEwxNiwxIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNBQkFCQUIiPjwvcGF0aD4KICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjRjdGOUZCIiB4PSIxIiB5PSIxIiB3aWR0aD0iMTUiIGhlaWdodD0iMTUiPjwvcmVjdD4KICAgICAgICA8cGF0aCBkPSJNNCw1IEw1LDUgTDUsMTEgTDcsMTEgTDQuNSwxNCBMMiwxMSBMNCwxMSBMNCw1IFoiIGlkPSJDb21iaW5lZC1TaGFwZSIgZmlsbD0iIzY2NjY2NiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoNC41MDAwMDAsIDkuNTAwMDAwKSBzY2FsZSgxLCAtMSkgcm90YXRlKC0xODAuMDAwMDAwKSB0cmFuc2xhdGUoLTQuNTAwMDAwLCAtOS41MDAwMDApICI+PC9wYXRoPgogICAgICAgIDxwYXRoIGQ9Ik0xNC4zNTk0ODc1LDQgQzE0LjUyNTE3MjksNCAxNC42NTk0ODc1LDQuMTM0MzE0NTggMTQuNjU5NDg3NSw0LjMgQzE0LjY1OTQ4NzUsNC4zNzAxODA5NSAxNC42MzQ4ODI3LDQuNDM4MTQwODIgMTQuNTg5OTUzOSw0LjQ5MjA1NTMyIEwxMS4zOTk1MDUsOC4zMiBMMTEuNCwxMS42MzIyNTgxIEw5LjYsMTIuNiBMOS41OTk1MDQ5Niw4LjMyIEw2LjQxMDA0NjEsNC40OTIwNTUzMiBDNi4zMDM5NzY4OCw0LjM2NDc3MjI1IDYuMzIxMTc0MDksNC4xNzU2MDI4NCA2LjQ0ODQ1NzE2LDQuMDY5NTMzNjIgQzYuNTAyMzcxNjYsNC4wMjQ2MDQ4NyA2LjU3MDMzMTUzLDQgNi42NDA1MTI0OCw0IEwxNC4zNTk0ODc1LDQgWiIgaWQ9IkNvbWJpbmVkLVNoYXBlIiBmaWxsPSIjNjY2NjY2Ij48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==":6===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAeBJREFUOBGtkj1oU1EUx8+5fSC00VZoCwpOtUOcBMHFdhA0g5ODg0HSDg0EuoibOrTRodBdhWIMlCAFFTMphCqVakgGcS2InSoiQQ22SUxe373H+7+ax2uJkz3w7rnn6/fOvecSHaQsfqjNLLyvCXQvbrValUqlItGYihrNts50ds0b6Ki/uw+CgLTWXdPpEHC7/Pl0xzenuE8lfd/EYe/JtAaK/wlotnSm7QdPs2dHv/7yg2ew9wN6dcBIml2rxYLG9hdi3mShLWE6QSJjXuzI8QfnRxtdUKlUEmamRCLh6uD3sLTq9aSQqnl96jr+4nkeBYHO+9Zvww+RAzHGWO6eO/wL8E1GickvJ8fX/6QSXV3ZyBsmHCMEAP5fUiwWBV8U4o7QWb0Q175+7gK2RVE8SEaOseKJ/ktr5W7B/gnA7wCHLr7asPs4HPJycqTR0utM6snAlXdhMWIA9LwDBCHyeOLozvf2KrF6G7tWvkEUXraL9wKEGfLo3OGfuvnajvDjUPryFHPWuCq7FAqFeTuBLGyMEV0opbKpVOqOe4mydKa/3vjxQrc6W0OD49PRYhQhEQB0gElgD58DYvm2ePKWpS64h2Ro13WOu2a6N3zz033kQHK53Bx0Op2+C30g8htq3/HPc2QfaQAAAABJRU5ErkJggg==":7===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAdVJREFUOBFjYKAQMIL0/9ztovn31991YLP+/2f4z8TIz/DvvyQjE6MNl9f+ozA7Tpw48R8IGCwtLcH6QOIsIILddc91IKUJYv/fZiv65dvfQ4wMTKu4Q47ANYPk/vz5A6JQANgAmMj/pTaCn9/+2M3AyHSYJ/poIQMD3CKwkr9//8KUwmm4Af/nWvN+/Ppl539GhisCKQEZjIyM/+GqoAyQC4DiKMJgA/7PNOZ6/+XdVqD3HgtJ6cQzMjb8Q1FFyIC3Hz7mAwPHFmj83bd3z19506ECDAygLkaGKSIVd6bCDPv37x8DKBCRAdgFIuV32oGCIIwXYAtEJmQdnedeJbedefUfRCOLw9ggA9ANQTHg64+/6T9//zsAomGakGlQLKDHBNyAqqNPDH7++qfFyMwU+evXP00QH1kziA3SjNMFX7/9Tf/x68/qBjOxF99//VkD4mMzAN0F4EjN2v+K58+XT89AsQCM/cfAtCALDG5lFh4+qWmOYl8WL15cD4yBBpCBoHQAigkmJqaG2NjYRrAXvr1/H/nz9/9Xf/8y5v/49bcHRAO98wokDtIEUggyAOYFEBskBpIDg7AV189ELL9eBeODaBAfJI4sNmfOnDoQRhajmA0AtPr0ppdKGGIAAAAASUVORK5CYII=":8===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAO5JREFUOBFjYBgFRIfAjRs3eI8dO7bz+PHjRsiaWJA5uNhnzpxhffny5dr///+7MjExgfQ4w9QywRggev/+/Rx79+6NRBYDamJ8//79/J8/f7r+/v373q9fv6KQ5VEM+Pbt24rv378v27ZtWwFMEZDdCdQUDdT8+u/fv+4uLi4vYXIgmhGZs3HjRr9///6tBYoxA3EqEPMAXTCBkZHxKzMzs6Ofn99pZPUgNooBIIGVK1eCvLAEqJEB6F9GIP0XSPuFhoZuB8mjAwwDQAoWL16cAtQ4G6o4MS4ubgGUTTw1b968wrlz51YRr2PkqgQA82JlH8nI1QYAAAAASUVORK5CYII=":9===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAPlJREFUOBHtULkNg0AQPJBBogVyKICE1CSkxIgCqMkFUAApiQlISCiAAlwABIjfM2dZOnwteKXTfjNzuyvE34zfE7Rt65/n+bBtOwuC4MV+13XuPM+FaZp5GIa9yrmpCeNpmh5wdxCeTdNErI3jWEPUgwB7ssY6TRNYliUzDOMJgk9PEMmIe/iMuWraCmxWVeWu6ypFmJNsWVYUx7FcibWvaROwgTXEvu8Sg18FRhfbtn05F69NUJalC4EaKA9PHgwiXKd3HCdKkuQyhTbBMAwFCJLMsfkd14HzcZ8C/nJEkwDVjuPIAaxBitI0ffExZg3CuYr9x58LvAEtbX2YkfGdBQAAAABJRU5ErkJggg==":11===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAO5JREFUOBFjYBgFRIfAjRs3eI8dO7bz+PHjRsiaWJA5uNhnzpxhffny5dr///+7MjExgfQ4w9QywRggev/+/Rx79+6NRBYDamJ8//79/J8/f7r+/v373q9fv6KQ5VEM+Pbt24rv378v27ZtWwFMEZDdCdQUDdT8+u/fv+4uLi4vYXIgmhGZs3HjRr9///6tBYoxA3EqEPMAXTCBkZHxKzMzs6Ofn99pZPUgNooBIIGVK1eCvLAEqJEB6F9GIP0XSPuFhoZuB8mjAwwDQAoWL16cAtQ4G6o4MS4ubgGUTTw1b968wrlz51YRr2PkqgQA82JlH8nI1QYAAAAASUVORK5CYII=":12===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAgRJREFUOBFjYKAQMIL0nzx5cs6/f/+SCZnFyMh4kpeX105bW/sXTC0TiCEmJpbz58+fc0DMgAe/YWJiCkXWDNILNkBRUfEHUGPw379/3/3+/RtsCIhGwv+A8pFmZmaPQZqQAdgAkICjo+MDoAExQPwPpBFIgzHIRUDv1QLl9yBrhLHBYQDjgOjt27fXAzU0AP0LFgbSmzw8PAKA9H9kdTA2hgH///9n2gIEQEO+mpzfvp2FmfWgeO3kuzAN6DTcCzAJoE0g/zZoXj+8h+Pti7lMLx5deJHpmwKTB9H/09JY74XamoHYGAaABIFh8PemhAb//3//1wBN4/r769fsRwmu0x8luUrdjXRov/v++sM/f/5a4DOA4RMrZ+dOq7C1QC8Z/P/7/8K/P38z/nz/+fjfn98+QDf4qq0/NgmvAaCYAHrlpziDzI0/f//e+AuMjb9//jH9+8dQrrL6yFmQZhDA6gWQBDAaG+Pu79/+8OudjX9//4kAeqcLKLbm7+9fHf8bGuD64AyQJhj4+fPnpaTHj5se3Xm08d/fv57AGJmgsupwubqIbtSP778enNm/IhymFqsB6enpvx/fO+IL9ILbn39/L6oIaJaBNDDOmvVb8Ldg2I9vv2yAYQNOAlgNACn+zfD/+r+//+4x/mMoAGkEiYGA4oEDP1iZmCp3a4mpQEQoJAFYGTPePuR04gAAAABJRU5ErkJggg==":13===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NjlBNDZFRkFFMDUxMTFFOTkyRTA4QkVCNjlCMDYwMEEiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NjlBNDZFRkJFMDUxMTFFOTkyRTA4QkVCNjlCMDYwMEEiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo2OUE0NkVGOEUwNTExMUU5OTJFMDhCRUI2OUIwNjAwQSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo2OUE0NkVGOUUwNTExMUU5OTJFMDhCRUI2OUIwNjAwQSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Poa+1GoAAAE5SURBVHjapJO/SgNBEIdzS6x9CR8gEIjNYSkISWNI1BCw0MLCQCqDhWC0SGIltpo3SIrY2NgI1ygoJo1WIZBW0gn+Qc9vYC8sS+5OyMB3c7v3m7mZnTvH9/3EPJaUi+d5V7idf+jvYcV13a9gQ2m/D08xwW9QMIOnCdj8wOVhEhL8C1voxvaDoAJJMsKVtdi2I57fzsqszAWiG9yJpbmGRuQhWnYKy/AOkvCOxKGjUvYGYmnhGKTkNjwzpV1Tw3oBMmEViP3AInRgHS4JSOvqKrANTXhQEWNrQRdSUgXsgUwhCzkqvZjZgmWf8KoJ9DWCH0PPwLC6PsQebMKZbqlJOyouwUCPU4LX4Jy31vAlkO9lIzIB4m/pE1ahDwfGflFuqcKJa+EFhlDVgQnjsz+EJVk78/7OfwIMAP6mWr/ROcXGAAAAAElFTkSuQmCC":14===t?"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAAAXNSR0IArs4c6QAAAGBJREFUGBljYCAHzJo1a8L///+ZsOlFEQQqygcqXr1q1SpOdMUoCqGSQe/fv987c+ZMEWTF2BSC5C0ZGRkXEaPwONAZccgKWZA5UPY6QUHBmLCwsO9Y5CBC+HyNUxPZEgCPEyCkHm49GwAAAABJRU5ErkJggg==":""}function u(t,i){return{position:e.ButtonPosition.right,imageSize:{width:18,height:18},options:{configurationNumber:i},imageType:e.ButtonImageType.custom,visibility:e.ButtonVisibility.always,useButtonStyle:!1,enable:!0,buttonBackColor:"transparent",imageSrc:s(t),command:"OpenPivotFilterDialogCmd",hasOverLay:!0}}Object.defineProperty(i,"__esModule",{value:!0}),i.getFilterCellButtonInfo=i.getFilterButtonImageSrc=void 0,e=n("Core"),r="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAKTWlDQ1BQaG90b3Nob3AgSUNDIHByb2ZpbGUAAHjanVN3WJP3Fj7f92UPVkLY8LGXbIEAIiOsCMgQWaIQkgBhhBASQMWFiApWFBURnEhVxILVCkidiOKgKLhnQYqIWotVXDjuH9yntX167+3t+9f7vOec5/zOec8PgBESJpHmomoAOVKFPDrYH49PSMTJvYACFUjgBCAQ5svCZwXFAADwA3l4fnSwP/wBr28AAgBw1S4kEsfh/4O6UCZXACCRAOAiEucLAZBSAMguVMgUAMgYALBTs2QKAJQAAGx5fEIiAKoNAOz0ST4FANipk9wXANiiHKkIAI0BAJkoRyQCQLsAYFWBUiwCwMIAoKxAIi4EwK4BgFm2MkcCgL0FAHaOWJAPQGAAgJlCLMwAIDgCAEMeE80DIEwDoDDSv+CpX3CFuEgBAMDLlc2XS9IzFLiV0Bp38vDg4iHiwmyxQmEXKRBmCeQinJebIxNI5wNMzgwAABr50cH+OD+Q5+bk4eZm52zv9MWi/mvwbyI+IfHf/ryMAgQAEE7P79pf5eXWA3DHAbB1v2upWwDaVgBo3/ldM9sJoFoK0Hr5i3k4/EAenqFQyDwdHAoLC+0lYqG9MOOLPv8z4W/gi372/EAe/tt68ABxmkCZrcCjg/1xYW52rlKO58sEQjFu9+cj/seFf/2OKdHiNLFcLBWK8ViJuFAiTcd5uVKRRCHJleIS6X8y8R+W/QmTdw0ArIZPwE62B7XLbMB+7gECiw5Y0nYAQH7zLYwaC5EAEGc0Mnn3AACTv/mPQCsBAM2XpOMAALzoGFyolBdMxggAAESggSqwQQcMwRSswA6cwR28wBcCYQZEQAwkwDwQQgbkgBwKoRiWQRlUwDrYBLWwAxqgEZrhELTBMTgN5+ASXIHrcBcGYBiewhi8hgkEQcgIE2EhOogRYo7YIs4IF5mOBCJhSDSSgKQg6YgUUSLFyHKkAqlCapFdSCPyLXIUOY1cQPqQ28ggMor8irxHMZSBslED1AJ1QLmoHxqKxqBz0XQ0D12AlqJr0Rq0Hj2AtqKn0UvodXQAfYqOY4DRMQ5mjNlhXIyHRWCJWBomxxZj5Vg1Vo81Yx1YN3YVG8CeYe8IJAKLgBPsCF6EEMJsgpCQR1hMWEOoJewjtBK6CFcJg4Qxwicik6hPtCV6EvnEeGI6sZBYRqwm7iEeIZ4lXicOE1+TSCQOyZLkTgohJZAySQtJa0jbSC2kU6Q+0hBpnEwm65Btyd7kCLKArCCXkbeQD5BPkvvJw+S3FDrFiOJMCaIkUqSUEko1ZT/lBKWfMkKZoKpRzame1AiqiDqfWkltoHZQL1OHqRM0dZolzZsWQ8ukLaPV0JppZ2n3aC/pdLoJ3YMeRZfQl9Jr6Afp5+mD9HcMDYYNg8dIYigZaxl7GacYtxkvmUymBdOXmchUMNcyG5lnmA+Yb1VYKvYqfBWRyhKVOpVWlX6V56pUVXNVP9V5qgtUq1UPq15WfaZGVbNQ46kJ1Bar1akdVbupNq7OUndSj1DPUV+jvl/9gvpjDbKGhUaghkijVGO3xhmNIRbGMmXxWELWclYD6yxrmE1iW7L57Ex2Bfsbdi97TFNDc6pmrGaRZp3mcc0BDsax4PA52ZxKziHODc57LQMtPy2x1mqtZq1+rTfaetq+2mLtcu0W7eva73VwnUCdLJ31Om0693UJuja6UbqFutt1z+o+02PreekJ9cr1Dund0Uf1bfSj9Rfq79bv0R83MDQINpAZbDE4Y/DMkGPoa5hpuNHwhOGoEctoupHEaKPRSaMnuCbuh2fjNXgXPmasbxxirDTeZdxrPGFiaTLbpMSkxeS+Kc2Ua5pmutG003TMzMgs3KzYrMnsjjnVnGueYb7ZvNv8jYWlRZzFSos2i8eW2pZ8ywWWTZb3rJhWPlZ5VvVW16xJ1lzrLOtt1ldsUBtXmwybOpvLtqitm63Edptt3xTiFI8p0in1U27aMez87ArsmuwG7Tn2YfYl9m32zx3MHBId1jt0O3xydHXMdmxwvOuk4TTDqcSpw+lXZxtnoXOd8zUXpkuQyxKXdpcXU22niqdun3rLleUa7rrStdP1o5u7m9yt2W3U3cw9xX2r+00umxvJXcM970H08PdY4nHM452nm6fC85DnL152Xlle+70eT7OcJp7WMG3I28Rb4L3Le2A6Pj1l+s7pAz7GPgKfep+Hvqa+It89viN+1n6Zfgf8nvs7+sv9j/i/4XnyFvFOBWABwQHlAb2BGoGzA2sDHwSZBKUHNQWNBbsGLww+FUIMCQ1ZH3KTb8AX8hv5YzPcZyya0RXKCJ0VWhv6MMwmTB7WEY6GzwjfEH5vpvlM6cy2CIjgR2yIuB9pGZkX+X0UKSoyqi7qUbRTdHF09yzWrORZ+2e9jvGPqYy5O9tqtnJ2Z6xqbFJsY+ybuIC4qriBeIf4RfGXEnQTJAntieTE2MQ9ieNzAudsmjOc5JpUlnRjruXcorkX5unOy553PFk1WZB8OIWYEpeyP+WDIEJQLxhP5aduTR0T8oSbhU9FvqKNolGxt7hKPJLmnVaV9jjdO31D+miGT0Z1xjMJT1IreZEZkrkj801WRNberM/ZcdktOZSclJyjUg1plrQr1zC3KLdPZisrkw3keeZtyhuTh8r35CP5c/PbFWyFTNGjtFKuUA4WTC+oK3hbGFt4uEi9SFrUM99m/ur5IwuCFny9kLBQuLCz2Lh4WfHgIr9FuxYji1MXdy4xXVK6ZHhp8NJ9y2jLspb9UOJYUlXyannc8o5Sg9KlpUMrglc0lamUycturvRauWMVYZVkVe9ql9VbVn8qF5VfrHCsqK74sEa45uJXTl/VfPV5bdra3kq3yu3rSOuk626s91m/r0q9akHV0IbwDa0b8Y3lG19tSt50oXpq9Y7NtM3KzQM1YTXtW8y2rNvyoTaj9nqdf13LVv2tq7e+2Sba1r/dd3vzDoMdFTve75TsvLUreFdrvUV99W7S7oLdjxpiG7q/5n7duEd3T8Wej3ulewf2Re/ranRvbNyvv7+yCW1SNo0eSDpw5ZuAb9qb7Zp3tXBaKg7CQeXBJ9+mfHvjUOihzsPcw83fmX+39QjrSHkr0jq/dawto22gPaG97+iMo50dXh1Hvrf/fu8x42N1xzWPV56gnSg98fnkgpPjp2Snnp1OPz3Umdx590z8mWtdUV29Z0PPnj8XdO5Mt1/3yfPe549d8Lxw9CL3Ytslt0utPa49R35w/eFIr1tv62X3y+1XPK509E3rO9Hv03/6asDVc9f41y5dn3m978bsG7duJt0cuCW69fh29u0XdwruTNxdeo94r/y+2v3qB/oP6n+0/rFlwG3g+GDAYM/DWQ/vDgmHnv6U/9OH4dJHzEfVI0YjjY+dHx8bDRq98mTOk+GnsqcTz8p+Vv9563Or59/94vtLz1j82PAL+YvPv655qfNy76uprzrHI8c",i.getFilterButtonImageSrc=s,a=o={noSortFilter:0,0:"noSortFilter",ascending:1,1:"ascending",descending:2,2:"descending",filter:3,3:"filter",filterAscend:4,4:"filterAscend",filterDescend:5,5:"filterDescend",sortAscending:6,6:"sortAscending",sortDescending:7,7:"sortDescending",checkAll:8,8:"checkAll",unCheckAll:9,9:"unCheckAll",isChecked:11,11:"isChecked",clearAble:12,12:"clearAble",clearUnable:13,13:"clearUnable",disableRightArrow:14,14:"disableRightArrow"},i.getFilterCellButtonInfo=u},"./dist/plugins/pivot/pivot-table-entry.js":function(t,i,n){"use strict";var e,r,o,e=this&&this.__createBinding||(Object.create?function(t,i,n,e){void 0===e&&(e=n);var r=Object.getOwnPropertyDescriptor(i,n);r&&("get"in r?i.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return i[n]}}),Object.defineProperty(t,e,r)}:function(t,i,n,e){t[e=void 0===e?n:e]=i[n]}),r=this&&this.__exportStar||function(t,i){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(i,n)||e(i,t,n)};Object.defineProperty(i,"__esModule",{value:!0}),i.SortType=void 0,r(n("./dist/plugins/pivot/pivot.ns.js"),i),r(n("./dist/plugins/pivot/pivot-table/pivot-table-spread.js"),i),n("./dist/plugins/pivot/pivot-table/pivot-table-command.js"),r(n("./dist/plugins/pivot/pivot-table/pivot-table-theme.js"),i),r(n("./dist/plugins/pivot/pivot-table/pivot-table.js"),i),r(n("./dist/plugins/pivot/pivot-core/pivot-view.js"),i),r(n("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),i),r(n("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),i),r(n("./dist/plugins/pivot/pivot-panel/pivot-panel.js"),i),r(n("./dist/plugins/pivot/pivot-ui/dropdown-list.js"),i),r(n("./dist/plugins/pivot/pivot-ui/pivot-filter-dialogs.js"),i),r(n("./dist/plugins/pivot/pivot-ui/filter-dialog.js"),i),r(n("./dist/plugins/pivot/pivot-ui/pivot-view-list-dialog.js"),i),r(n("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/pivot-slicer-caches.js"),i),r(n("./dist/plugins/pivot/pivot-filter-diagram/slicer-base/slicer-base.js"),i),r(n("./dist/plugins/pivot/pivot-filter-diagram/slicer/pivot-item-slicer.js"),i),r(n("./dist/plugins/pivot/pivot-filter-diagram/timeline/pivot-timeline-slicer.js"),i),o=n("Pivot"),Object.defineProperty(i,"SortType",{enumerable:!0,get:function(){return o.SortType}}),n("./dist/plugins/pivot/pivot-definition.js")},"./dist/plugins/pivot/pivot-table/pivot-data-model.js":function(t,i,n){"use strict";var e,r,o,a,s,u;function c(t){this.dataTable=[],this.QWt=t,this.WWt=[],this.zWt=[],this.ZWt=[],this.YWt={}}function l(){this.HWt=[new s(0),new s(1),new s(2),new s(3),new s(4)]}Object.defineProperty(i,"__esModule",{value:!0}),i.PivotDataModel=void 0,e=n("@spreadjs/js-sheets-common"),r=n("Core"),o=n("Pivot"),a=e.Common.lt.ht,c.prototype.JWt=function(t,i){this.ZWt[t]=i},c.prototype.setStartInfo=function(t,i){this.DQ=t,this.jN=i},c.prototype.Kbt=function(t,i,n){var e;this.J_(t,i,!0).value=n},c.prototype.setColCount=function(t){this.Tx=t},c.prototype.setRowCount=function(t){this.Sx=t},c.prototype.getColInfoMap=function(){for(var t,i,n,e,r,t={},i=this.WWt,n=i.length,e=0;e<n;e++)i[e]&&(r=i[e].path,i[e].valueFieldName&&(""===r?r=i[e].valueFieldName||"":r+=o.Separator+i[e].valueFieldName||""),t[r]=e);return t},c.prototype.getRange=function(){return new r.Range(this.DQ,this.jN,this.Sx,this.Tx)},c.prototype.Sl=function(t,i){var t=this.J_(t,i);return t&&t.value},c.prototype.qWt=function(t,i,n){var e;this.J_(t,i,!0).style=n},c.prototype.ML=function(t,i){var t=this.J_(t,i);return t&&t.style},c.prototype.KWt=function(t,i,n){var e;this.J_(t,i,!0).fieldName=n},c.prototype.XWt=function(t,i){var t=this.J_(t,i);return t&&t.fieldName||t&&t.value},c.prototype.$Wt=function(t,i){var t=this.J_(t,i);return t&&t.nodeRefer},c.prototype.J_=function(t,i,n){var e,r,t,e,r=this.dataTable[t];if(!r){if(!n)return null;r=this.dataTable[t]=[]}if(!(t=r[i])){if(!n)return null;t=r[i]={}}return t},c.prototype.c5=function(){this.dataTable=[],this.WWt=[],this.zWt=[],this.ZWt=[],this.YWt={},delete this.Sx,delete this.Tx},c.prototype.kn=function(t){for(var i,n,e,i=this,n=i.ZWt,e=0;e<n.length;e++)if(i.ZWt[e]&&i.ZWt[e].fieldName===t)return e},c.prototype.tZt=function(t,i,n,e){var r,o,r=this.YWt;a(r[i])&&(r[i]={}),a(r[i][n])&&(r[i][n]={},r[i][n].ranges=[]),(o=r[i][n]).level===e&&o.ranges.includes(t)||(r[i][n].level=e,r[i][n].ranges.push(t))},s=c,l.prototype.getAllModel=function(){var t=this.HWt,i,n,e,r,o;return{pageModel:t[0],cornerModel:t[1],columnModel:t[2],rowModel:t[3],contentModel:t[4]}},l.prototype.getModel=function(t){return this.HWt[t]},l.prototype.c5=function(){var t=this.HWt,i=t[0],n=t[1],e=t[2],r=t[3],t=t[4];i.c5(),n.c5(),e.c5(),r.c5(),t.c5()},l.prototype.getWholeRange=function(){},l.prototype.iZt=function(){},i.PivotDataModel=l},"./dist/plugins/pivot/pivot-table/pivot-table-command.js":function(O,t,i){"use strict";var n,T,_,F,v,P,w,E,B,R,G,p,V,t,b,I,U,d,Q,i,L,t,e,r,W,z,o,a,s,u,c,l,f,h,m,g,y,C,Z,Y,H,J,q,K,X,$,tt,it,nt,et,rt,ot,at,st,ut,ct,lt,ft,ht,vt,dt,pt,mt,bt,gt,wt,yt,Ct,At,A,k,Nt,It,Tt,St,xt,Mt,Dt,kt,jt,Ot,_t,Ft,Pt,Lt,Et,Bt,Rt,Gt,Vt,Ut,Qt,Wt,zt,Zt,Yt,Ht,Jt,qt,Kt,Xt,$t,ti,ii,ni,ei,ri,oi,ai,si,ui,ci,li,fi,hi,vi,di,pi,mi,bi,gi,wi,yi,Ci,Ai,Ni;function Ii(t,i,n,e,r,o){var a,s,u,c,i,l,f,s,h,v,a,d,c,p,m,b,u=!1;return i?(c=i.a,a=t.getFilterInfo(c),s=i.nrt):(a=t.getFilterInfo(n),c=n),l=i=!1,a&&a.labelFilter&&(a.labelFilter.condition&&(i=!0),a.labelFilter.textItem)&&!a.labelFilter.textItem.isAll&&(l=!0),f=!!a&&a.on(),s=s?s.sortType:A,0===t.rBt(n)&&(u=!0),h=A,v=!1,a&&a.labelFilter&&a.labelFilter.textItem&&(h=a.labelFilter.textItem.list,v=a.labelFilter.textItem.isAll),a=t.bl(c).DH(),d=t.hr(c),p=(c=t.bl(c)).sf(),{fieldIsNumber:u,sortInfo:s,hasLabelCondition:i,hasValueCondition:f,fields:b=Ti(c,a,h,v,p,s,d,m=(t.z||[]).filter(function(t){return t.Zc===r})[0],n,o),isColOrRow:e,hasLabelManual:l}}function Ti(e,t,i,n,r,o,a,s,u,c){var l,f,h,v,o,d,f=[],h=[];if(r){for(v=0;v<t.length;v++)h[r[v]]=t[v];o===P.SortType.desc&&h.reverse()}return o=0===h.length?t:h,d=function(t){var i,i,i,n;if(!(e.nZt&&0<e.nZt.length)&&(0,P.ht)(e.y1)&&(i=3===c?{dataOnly:!0,references:[{fieldName:L().Values,items:[u]}]}:{labelOnly:!0,references:[{fieldName:u}]},i=(i=s.getStyle(i))&&i.formatter,a===P.PivotDataType.date&&(t=(0,P.parseStringToDate)(t),n=z.Fe().DateTimeFormat,i=i||n.shortDatePattern),i)){if("string"==typeof i)return new Q(i).format(t);if(i instanceof p.Formatter.FormatterBase)return i.format(t)}return t+""},!i||0===i.length||n?o.forEach(function(t){l={status:!0,value:t,text:d(t)},f.push(l)}):o.forEach(function(t){l={status:!0,value:t,text:d(t)},i.indexOf(t)<0&&(l.status=!1),f.push(l)}),f}function Si(t,n){var e=0;return t.forEach(function(t,i){t.Zc===n&&(e=i)}),e}function S(t,i){var n,e,r,o,a,s,u,c,l,f,h,v,d,e=t.colHeadFieldInfo,r=t.cornerFieldInfo,o=t.pageFieldInfo,a=t.rowInfos,s=t.colInfos,u=t.activeRowFieldInfo,c=t.activeColFieldInfo,l=t.area,f=t.value,h=t.menuArea,v=t.valueFieldName;switch(l){case 0:n=o&&o.fieldName;break;case 1:1===h?n=f:2===h&&r&&(n=r.fieldName)===L().sigmaValueTemp&&(n=L().sigmaValue);break;case 2:if(2===h&&e)(n=e.fieldName)===L().sigmaValueTemp&&(n=L().sigmaValue);else if(5===h)n=v||i&&i.Q[0].Zc;else if(n=c&&c.name||f,(0,P.ht)(n)){for(d=c;0<=d&&s[d]&&(0,P.ht)(s[d].itemName);)d-=1;n=s[d].fieldName}break;case 3:if(5===h)n=v||i&&i.Q[0].Zc;else if(n=u&&u.name||f,(0,P.ht)(n)){for(d=u.index;0<=d&&a[d]&&(0,P.ht)(a[d].itemName);)d-=1;n=a[d].fieldName}break;case 4:n=v}return n}function xi(t,i){var i;return i?(i=i.numberGroup,{isStartActive:(0,P.ht)(i.start),start:((0,P.ht)(i.start)?t:i).start,isEndActive:(0,P.ht)(i.end),end:((0,P.ht)(i.end)?t:i).end,by:(0,P.ht)(i.by)?10:i.by}):{start:t.start,isStartActive:!0,end:t.end,isEndActive:!0,by:10}}function Mi(t,i){var n,e,r,o,a;if(i){for(e=[],r=0,o=n=i.dateGroups;r<o.length;r++)a=o[r],e.push(a.by);return{start:t.start,isStartActive:!0,end:t.end,isEndActive:!0,by:e}}return{start:t.start,isStartActive:!0,end:t.end,isEndActive:!0,by:[P.DateGroupType.months,P.DateGroupType.quarters,P.DateGroupType.years]}}function Di(t,i){return Xt.call(this,t,i)||this}function ki(t,i){return $t.call(this,t,i)||this}function ji(t,i){var t,n,t,e,r,t=t.getRange(),n=t.page,t=t.content,e=i.getActiveRowIndex(),r=i.getActiveColumnIndex();0!==t.colCount?t.contains(e,r)||i.setActiveCell(t.row,t.col):n&&!n.contains(e,r)&&i.setActiveCell(n.row,n.col)}function Oi(t,i){return ti.call(this,t,i)||this}function _i(t,i){return ii.call(this,t,i)||this}function N(t,i){return ni.call(this,t,i)||this}function x(t,i){return ei.call(this,t,i)||this}function Fi(t,i){return ri.call(this,t,i)||this}function M(t,i){return oi.call(this,t,i)||this}function Pi(t,i){return ai.call(this,t,i)||this}function Li(t){var i,t,n,e,r,o,a,s,u,c,u,s;if(4===t.menuArea){if(e=t.rowInfos,r=t.colInfos,o=e&&e.length,a=r&&r.length,s=0===o||e&&e.some(function(t){return t.isGrandTotal}),u=0===a||r&&r.some(function(t){return t.isGrandTotal}),t=t.valueFieldName,c=L(),s&&u||!t)throw new Error(c.Invalid_Field_Sort_By);return(u=s?(i=r[a-1].fieldName,e):(i=e[o-1].fieldName,r))&&0<u.length&&(-1!==(s=u.findIndex(function(t){return t.fieldName===c.sigmaValue}))&&(t=u[s].itemName,u.splice(s,1)),n=u.map(function(t){return{fieldName:t.fieldName,items:[t.itemName]}})),{fieldName:i,sortValueFieldName:t,sortByPivotReferences:n}}}function Ei(t,i){return si.call(this,t,i)||this}function Bi(t,i){return ui.call(this,t,i)||this}function Ri(t,i){return ci.call(this,t,i)||this}function Gi(t,i){return li.call(this,t,i)||this}function Vi(t){return(0,P.ht)(t)?A:t instanceof Date?t:W.yU(t)}function D(t,i){return fi.call(this,t,i)||this}function j(t,i){return hi.call(this,t,i)||this}function Ui(t,i){return vi.call(this,t,i)||this}function Qi(t,i){return di.call(this,t,i)||this}function Wi(t,i){return pi.call(this,t,i)||this}function zi(t,i,n){var e,r,i,o,a,s,u,c,l,f,h,v,d,p,m,b,g,w,y,C,A,N,I,T,S,x,M,D,e=i.tT,r=e.commandOptions.pivotTableCellInfo,i=i.Mf,o=e.selections[0],a=i.pivotTables.get(e.commandOptions.pivotTableName),s=a.eZt,u=!1,c=a.rZt.HWt[3],l=a.rZt.HWt[2],f=[],h=a.dh,v=c.zWt,d=l.WWt,p=[];switch(1<h.Q.length&&(g=h.x2,w=h.P2),a.suspendLayout(),r.area){case 3:if(y=h.B.length,0===g&&r.activeRowFieldInfo&&w<r.activeRowFieldInfo.index&&(y+=1),u=r.activeRowFieldInfo&&r.activeRowFieldInfo.index===y-1,(m=n?{row:c.DQ+s.row,col:o.col,rowCount:c.Sx,colCount:1}:o).row<c.DQ+s.row||m.row+m.rowCount>c.DQ+s.row+c.Sx||m.col<s.col||m.col+m.colCount>s.col+c.Tx)return;for(C=m.row;C<m.row+m.rowCount;C++)for(A=m.col;A<m.col+m.colCount&&(I=(N=a.getPivotInfoImp(C,A,!1,!1,!0)).rowInfos&&N.rowInfos[r.activeRowFieldInfo.index-(u?1:0)])&&((T=v[C-c.DQ-s.row]).collapseIndex!==k||!(I.isSubtotal&&a.options.subtotalsPosition!==F.SubtotalsPosition.top||I.isGrandTotal||I.isBlankRow))&&(I=N.rowInfos&&N.rowInfos[r.activeRowFieldInfo.index-(u?1:0)]).itemName;A++)if((S=a.collapse(I.fieldName,I.itemName))&&!t||!S&&t){x=I.fieldName+I.itemName,p.indexOf(x)<0&&(p.push(x),f.push({fieldName:I.fieldName,itemName:I.itemName,collapse:t}));break}break;case 2:if(r.colHeadFieldInfo){for(y=h.R.length,1===g&&(0===r.relativeRow&&w<r.relativeColumn||r.activeColFieldInfo&&w<r.activeColFieldInfo.index)&&(y+=1),u=r.relativeColumn===y-1,A=(b={row:r.relativeColumn+s.row+1,col:l.jN+s.col,rowCount:1,colCount:l.Tx}).col;A<b.col+b.colCount;A++)for(C=b.row;C<b.row+b.rowCount&&(M=a.getPivotInfoImp(C,A,!1,!1,!0),T=d[A-l.jN-s.col],D=M.colInfos&&M.colInfos[M.relativeRow-1-(u?1:0)])&&(T.collapseIndex!==k||!D.isSubtotal&&!D.isGrandTotal)&&(D=M.colInfos&&M.colInfos[M.relativeRow-1-(u?1:0)]).itemName;C++)if((S=a.collapse(D.fieldName,D.itemName))&&!t||!S&&t){x=D.fieldName+D.itemName,p.indexOf(x)<0&&(p.push(x),f.push({fieldName:D.fieldName,itemName:D.itemName,collapse:t}));break}}else{if(y=h.R.length,1===g&&r.activeColFieldInfo&&w<r.activeColFieldInfo.index&&(y+=1),u=r.activeColFieldInfo&&r.activeColFieldInfo.index===y-1,(b=n?{row:o.row,col:l.jN+s.col,rowCount:1,colCount:l.Tx}:o).col<l.jN+s.col||b.col+b.colCount>l.jN+s.col+l.Tx||b.row<=s.row||b.row+b.rowCount>s.row+l.Sx)return;for(A=b.col;A<b.col+b.colCount;A++)for(C=b.row;C<b.row+b.rowCount&&(M=a.getPivotInfoImp(C,A,!1,!1,!0),T=d[A-l.jN-s.col],D=M.colInfos[r.activeColFieldInfo&&r.activeColFieldInfo.index-(u?1:0)])&&(T.collapseIndex!==k||!D.isSubtotal&&!D.isGrandTotal)&&(D=M.colInfos[r.activeColFieldInfo.index-(u?1:0)]).itemName;C++)if((S=a.collapse(D.fieldName,D.itemName))&&!t||!S&&t){x=D.fieldName+D.itemName,p.indexOf(x)<0&&(p.push(x),f.push({fieldName:D.fieldName,itemName:D.itemName,collapse:t}));break}}break;case 1:if(1<o.colCount*o.rowCount)return;if(r.cornerFieldInfo)for(y=c.Tx,2===g&&w<r.relativeColumn&&(y+=1),u=r.relativeColumn===y-1,C=(m={row:c.DQ+s.row,col:o.col,rowCount:c.Sx,colCount:1}).row;C<m.row+m.rowCount;C++)for(A=m.col;A<m.col+m.colCount&&(N=a.getPivotInfoImp(C,A,!1,!1,!0),T=v[C-c.DQ-s.row],I=N.rowInfos[r.relativeColumn-(u?1:0)])&&(T.collapseIndex!==k||!(I.isSubtotal&&a.options.subtotalsPosition!==F.SubtotalsPosition.top||I.isGrandTotal||I.isBlankRow))&&(I=N.rowInfos[r.relativeColumn-(u?1:0)]).itemName;A++)if((S=a.collapse(I.fieldName,I.itemName))&&!t||!S&&t){x=I.fieldName+I.itemName,p.indexOf(x)<0&&(p.push(x),f.push({fieldName:I.fieldName,itemName:I.itemName,collapse:t}));break}}return a.resumeLayout(),f}function Zi(t,i){return mi.call(this,t,i)||this}function Yi(t,i){return bi.call(this,t,i)||this}function Hi(t,i){return gi.call(this,t,i)||this}function Ji(t,i){return wi.call(this,t,i)||this}function qi(t,i){return yi.call(this,t,i)||this}function Ki(t){return!isNaN(parseFloat(t))&&isFinite(t)}function Xi(t){for(var i,n,e,r,o,o,i=0,n=0;n<t.sheets.length;n++)for(e=t.sheets[n].tables.all(),r=0;r<e.length;r++)(o=e[r].name())&&5<o.length&&"table"===o.substring(0,5).toLowerCase()&&Ki(o=o.substring(5,o.length))&&Number(o)>=i&&(i=Number(o));return"Table"+(i+1).toString()}function $i(t,i){return Ci.call(this,t,i)||this}function tn(t,i){return Ai.call(this,t,i)||this}function nn(t,i){return Ni.call(this,t,i)||this}function en(t,i){var n,e,n=t.split(I.nameSeparator);isNaN(parseInt(n[n.length-1],10))?t+=I.nameSeparator+"1":(e=n[n.length-1],n.splice(n.length-1,1,I.nameSeparator+(parseInt(e,10)+1)),t=n.join("")),i.save(t)||en(t,i)}function rn(t,i){return t.sheets?(0,_._f)(t,i.sheetName):t}n=this&&this.__extends||(Kt=function(t,i){return(Kt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}Kt(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),T=this&&this.__spreadArray||function(t,i,n){if(n||2===arguments.length)for(var e=0,r=i.length,o;e<r;e++)!o&&e in i||((o=o||Array.prototype.slice.call(i,0,e))[e]=i[e]);return t.concat(o||Array.prototype.slice.call(i))},Object.defineProperty(t,"__esModule",{value:!0}),_=i("Core"),F=i("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),v=i("./dist/plugins/pivot/pivot-table-entry.js"),P=i("Pivot"),w=i("./dist/plugins/pivot/pivot-ui/filter-dialog.js"),E=i("./dist/plugins/pivot/pivot-ui/pivot-field-setting-dialog.js"),B=i("./dist/plugins/pivot/pivot-ui/pivot-show-value-as-dialog.js"),R=i("./dist/plugins/pivot/pivot-ui/pivot-number-group-dialog.js"),G=i("./dist/plugins/pivot/pivot-ui/pivot-date-group-dialog.js"),p=i("@spreadjs/js-sheets-common"),V=i("SheetsCalc"),t=i("./dist/plugins/pivot/pivot.ns.js"),b=i("./dist/plugins/pivot/pivot-core/pivot-core-entry.js"),I=i("./dist/plugins/pivot/pivot-util.js"),U=i("@spreadjs/js-calc"),d=i("./dist/plugins/pivot/pivot-ui/pivot-sort-dialog.js"),Q=p.Formatter.GeneralFormatter,i=new p.Common.ResourceManager(t.SR,"PivotTables"),L=i.getResource.bind(i),t=_.Commands.ActionBase,e="PivotOutlineButtonToggle",r=_.Commands.zA,W=p.Common.ct,z=p.Common.CultureManager,o="moveField",a="removeField",s="AddField",u="fieldSet",c="CreatePivotFilterDialog",l="updateListBox",f="changePanelFieldStatus",h="filterFieldLabelValue",m="pivotSort",g="ClearCommand",y="updatePivotCache",C="createFilterSecondaryMenu",Z="createDialogForLabelFilter",Y="OpenPivotFilterDialogCmd",H="updateCondition",J="createDialogForValueFilter",q="updateValueCondition",K="createDialogForPivotSort",X="sortPivotField",$="sortPivotValueField",tt="TopTenCondition",it="dialogForDateFilter",nt="openValueFieldSettingDialogCmd",et="UpdatePivotValueFieldCmd",rt="UpdatePivotFieldCmd",ot="CreatePivotViewsListDialog",at="OpenPivotGroupDialog",st="OpenPivotShowValueAsDialog",ut="ApplyPivotView",ct="AddPivotView",lt="pivotRefresh",ft="pivotTableGroup",ht="pivotTableUnGroup",vt="pivotShowDetails",dt="pivotExpand",pt="pivotCollapse",mt="pivotExpandEntireField",bt="pivotCollapseEntireField",gt="removePivotGrandTotal",wt="updatePivotDefer",yt="doPivotTableFilter",Ct="selectWholePivotTable",At=["backColor","foreColor","hAlign","vAlign","font","themeFont","formatter","borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","showEllipsis","_showTip","shrinkToFit","backgroundImage","cellType","backgroundImageLayout","tabStop","textDecoration","imeMode","name","parentName","watermark","cellPadding","labelOptions","quotePrefix","diagonalDown","diagonalUp","isVerticalText","cellButtons","dropDowns","textOrientation"],A=null,k=void 0,Nt=function(t,i,n){var t,e,t=t.pivotTables.findPivotTable(i,n),e=A;return{pivotInfo:e=t?t.getPivotInfoImp(i,n,!1,!1,!0):e,pt:t}},It=function(t,i,n,e,r){for(var o,a,s,u,s,o=[],a=0;a<e.length;a++)s=e[a],u=void 0,3===r?u=new _.Range(s.row,s.col,s.rowCount,1):2===r&&(u=new _.Range(s.row,s.col,1,s.colCount)),(s=u&&t.pivotTables.getRangePivotAreas(u))&&s[i].map(function(t){var i;t.labelOnly&&t.references.forEach(function(t){if(t.fieldName===n)for(var i=0;i<t.items.length;i++)-1===o.indexOf(t.items[i])&&o.push(t.items[i])})});return o},n(Di,Xt=t),Di.prototype.execute=function(){var t,i,n,e,e,r,e,o,a,s,u,c,l,f,h,s,t=this,i=!1;if(t.canExecute()&&(n=t.Mf,e=t.tT,r=(e=Nt(n,e.row,e.col)).pivotInfo,e=e.pt,r)){o=r.activeRowFieldInfo,a=r.activeColFieldInfo,s=r.area,u=void 0,(c=n.Ut).startTransaction(),t.X5(n,!0);try{switch(s){case 2:u=r.colInfos[a&&a.index];break;case 3:u=r.rowInfos[o&&o.index]}l=u.fieldName,f=u.itemName,h=e.collapse(l,f),e.collapse(l,f,!h),n.ki(_.Events.PivotTableChanged,{type:"collapse",fieldName:l,item:f,newValue:!h,oldValue:h,pivotTableName:e.Zc}),i=!0}finally{t.q5(n,!0),s=_.Commands.TI(n.name()),t.tT[s]=c.endTransaction()}}return i},Di.prototype.undo=function(){var t,i,n,e,r,o,a,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=_.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),o=r.pivotTableChanges[r.pivotTableChanges.length-1].value,a=Nt(i,t.tT.row,t.tT.col).pt,i.ki(_.Events.PivotTableChanged,{type:"collapse",fieldName:o.fieldName,newValue:o.isCollapse,oldValue:!o.isCollapse,pivotTableName:a.Zc,item:o.item}),n=!0}finally{t.q5(i,!0)}}return n},Tt=Di,_.Commands[e]={canUndo:!0,execute:function(t,i,n){return _.Commands.zA(t,Tt,i,n)}},n(ki,$t=t),ki.prototype.execute=function(){var t,i,n,e,r,o,a,s,u,r,c,l,f,h,v,d,p,m,b,g,w,y,C,h,t=this,i=!1;if(t.canExecute())if(e=(n=t.Mf).Ut,o=(r=t.tT.cmdOption).fieldName,a=r.targetArea,s=r.targetIndex,u=r.isSusPaint,r=r.pivotName,c=n.pivotTables&&n.pivotTables.get(r),l=u?c.dh.copyFieldsModel:c.dh,u)o===L().sigmaValue?(s=(s=-1<s?s:0)<=(f=l.nw(a)).length?s:f.length,l.setSigmaValuePosition(a-1,s)):l.changeFieldArea(o,a,s),l.q3(u);else if(e.startTransaction(),t.X5(n,!0),!(0,P.ht)(o))try{if(o===L().sigmaValue)f=l.nw(a),s=(s=-1<s?s:0)<=f.length?s:f.length,h=c.dataPosition(),l.setSigmaValuePosition(a-1,s),v=a-1,d=s,p=h.positionType,m=h.positionIndex,v===p&&d===m||(c.updateDataModel(),n.ki(_.Events.PivotTableChanged,{type:"dataPositionChanged",newArea:v,newIndex:d,oldArea:p,oldIndex:m,pivotTableName:r}));else{if(f=b=void 0,b=l.getFieldInfoByName(o),(0,P.ht)(b))return!1;for(g=F.PivotTableFieldType.columnField;g>=F.PivotTableFieldType.filterField;g--){for(f=l.nw(g),w=!1,y=f.length-1;0<=y;y--)if(f[y].a===b.a){o=f[y].Zc,w=!0;break}if(w)break}C=c.getField(o),f=l.nw(a),v=a,p=C.pivotArea,m=C.pivotIndex,d=(d=-1<s?s:0)<=f.length?d:f.length,v===p&&m===d||(c.updateField(o,a,s),c.updateDataModel(),n.ki(_.Events.PivotTableChanged,{type:"fieldChanged",fieldName:o,newArea:v,newIndex:d,oldArea:p,oldIndex:m,pivotTableName:r}))}l.q3(u,null,!0),ji(c,n),i=!0}catch(t){n.jT(10,t.message)}finally{t.q5(n,!0),h=_.Commands.TI(n.name()),t.tT[h]=e.endTransaction()}return i},ki.prototype.undo=function(){var t,i,n,e,r,o,a,s,u,c,l,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{for(e=_.Commands.TI(i.name()),r=t.tT[e],o=i.pivotTables&&i.pivotTables.get(t.tT.cmdOption.pivotName),a=r.pivotTableChanges,s=void 0,i.Ut.undo(r),u=0;u<a.length&&("addField"!==(s=a[u].value).type&&"updateValuePosition"!==s.type);u++);c=o.getField(s.fieldName),"updateValuePosition"===s.type?(l=o.dataPosition(),i.ki(_.Events.PivotTableChanged,{type:"fieldChanged",newArea:s.position,newIndex:s.valuesIndex,oldArea:l.positionType,oldIndex:l.positionIndex,pivotTableName:t.tT.cmdOption.pivotName})):i.ki(_.Events.PivotTableChanged,{type:"fieldChanged",fieldName:s.fieldName,newArea:s.area,newIndex:s.index,oldArea:c.pivotArea,oldIndex:c.pivotIndex,pivotTableName:t.tT.cmdOption.pivotName}),n=!0}finally{t.q5(i,!0)}}return n},St=ki,_.Commands[o]={canUndo:!0,execute:function(t,i,n){return r(t,St,i,n)}},n(Oi,ti=t),Oi.prototype.execute=function(){var t,i,n,e,r,o,a,s,u,c,l,n,f,h,v,d,p,m,n,t=this,i=!1;if(t.canExecute())if(n=t.tT,r=(e=t.Mf).Ut,o=n.cmdOption,(l=c=u=s=a=void 0,P.ht)(o)?(f=(n=n.commandOptions).pivotTableCellInfo,a=(c=e.pivotTables&&e.pivotTables.get(n.pivotTableName)).dh,s=S(f)):(s=o.fieldName,u=o.isSusPaint,c=e.pivotTables&&e.pivotTables.get(o.pivotName),a=u?c.dh.copyFieldsModel:c.dh),u){if(s===L().sigmaValue)for(v=(h=a.nw(F.PivotTableFieldType.valueField)).length-1;0<=v;v--)a.clearValueFilterOfValueField(h[v].Zc);d=a.Z[s],(l=a.removeFieldOrSigmaByName(s))instanceof b.PivotViewField&&(d===F.PivotTableFieldType.valueField?a.clearValueFilterOfValueField(s):a.y2(s,!1)),a.q3(u)}else{r.startTransaction(),t.X5(e,!0);try{if(p=[],s===L().sigmaValue){for(v=(h=a.nw(F.PivotTableFieldType.valueField)).length-1;0<=v;v--)a.clearValueFilterOfValueField(h[v].Zc);if((m=a.nw(F.PivotTableFieldType.valueField))&&0<m.length)for(v=0;v<m.length;v++)p.push(c.getField(m[v].Zc))}else p.push(c.getField(s));for(l=a.getFieldInfoByName(s),d=a.Z[s],l instanceof b.PivotViewField&&(d===F.PivotTableFieldType.valueField?a.clearValueFilterOfValueField(s):a.y2(s,!1)),a.removeFieldOrSigmaByName(s),v=0;v<p.length;v++)e.ki(_.Events.PivotTableChanged,{type:"fieldChanged",fieldName:s,oldArea:p[v].pivotArea,oldIndex:p[v].pivotIndex,newArea:A,newIndex:A,pivotTableName:c.Zc});a.q3(u,void 0,!1),ji(c,e),i=!0}finally{t.q5(e,!0),n=_.Commands.TI(e.name()),t.tT[n]=r.endTransaction()}}return i},Oi.prototype.undo=function(){var t,i,n,e,r,o,a,s,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{for(e=_.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),o=r.pivotTableChanges,a=0;a<o.length;a++)s=o[a],i.ki(_.Events.PivotTableChanged,{type:"fieldChanged",fieldName:s.fieldName,newArea:s.area,newIndex:s.index,oldIndex:A,oldArea:A,pivotTableName:(t.tT.cmdOption||t.tT.commandOptions).pivotName});n=!0}finally{t.q5(i,!0)}}return n},xt=Oi,_.Commands[a]={canUndo:!0,execute:function(t,i,n){return r(t,xt,i,n)}},n(_i,ii=t),_i.prototype.execute=function(){var t,i,n,e,r,o,a,s,u,c,l,e,t=this,i=!1;if(t.canExecute()){e=(n=t.tT).commandOptions,(o=(r=t.Mf).Ut).startTransaction(),t.X5(r,!0);try{a=e.pivotTableCellInfo,s=r.pivotTables.get(e.pivotTableName),u=a.area,c=a.menuArea,1===(l=s.options.grandTotalPosition)||2===l?s.options.grandTotalPosition=0:3===l&&(3===u&&5===c?s.options.grandTotalPosition=1:2===u&&5===c&&(s.options.grandTotalPosition=2)),i=!0}finally{t.q5(r,!0),e=_.Commands.TI(r.name()),t.tT[e]=o.endTransaction()}}return i},_i.prototype.undo=function(){var t,i,n,e,r,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=_.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),n=!0}finally{t.q5(i,!0)}}return n},Mt=_i,_.Commands[gt]={canUndo:!0,execute:function(t,i,n){return r(t,Mt,i,n)}},n(N,ni=t),N.prototype.execute=function(){var t,i,n,e,r,o,a,s,u,c,l,f,h,h,v,d,p,m,b,g,w,y,C,A,N,h,t=this,i=!1;if(t.canExecute()){e=(n=t.tT).cmdOption,r=n.commandOptions,(a=(o=t.Mf).Ut).startTransaction(),t.X5(o,!0),(f=l=c=u=s=void 0,P.ht)(e)?(h=r.pivotTableCellInfo,s=(f=o.pivotTables.get(r.pivotTableName)).dh,u=r.subTotalType,l=S(h,s)):(u=e.subtotalType,l=e.oldFieldName,s=(f=o.pivotTables.get(e.pivotName)).dh),h=s.getFieldInfoByName(l),v=s.xy(l),c=e&&e.fieldName||!(0,P.ht)(u)&&v!==u&&s.dz(s.FG(h.a,h.Zc,u))||l;try{(0,P.ht)(h)||(0,P.ht)(u)||(p=!(d=!0),v!==u&&(s.xy(l,u),p=!0),(0,P.ht)(l)||l===c||(m=s.getFieldInfoByName(l),d=s.changeFieldName(m,c)),d||(c=l,o.jT(10,L().PivotTableErrorMessage_EmptyFieldName)),p&&(f.updateDataModel(),o.ki(_.Events.PivotTableChanged,{type:"SummarizedValueBy",fieldName:c,oldValue:v,newValue:u,pivotTableName:f.Zc}))),w=g=b=void 0,e?(b=e.showValueAsType,g=e.baseField,w=e.baseItem):r&&(b=r.showValueAsType),y=void 0,w?y=0===w.index?{showDataAs:b,baseFieldName:g,baseFieldItemType:2}:1===w.index?{showDataAs:b,baseFieldName:g,baseFieldItemType:1}:{showDataAs:b,baseFieldName:g,baseFieldItemType:0,baseFieldItem:w.value}:g?y={showDataAs:b,baseFieldName:g}:(0,P.ht)(b)||(y={showDataAs:b}),C=s.getFieldInfoByName(c).Or||{showDataAs:0},(A=y&&!this.oZt(y,C))&&(f.showDataAs(c,y),f.updateDataModel(),o.ki(_.Events.PivotTableChanged,{type:"ShowValueAs",fieldName:c,oldValue:(0,_.RF)(C),newValue:(0,_.RF)(y),pivotTableName:f.Zc})),N=n.formatter,7===u&&(N=N||"0.0000000"),(0,P.ht)(f.showDataAs(c))||(b=f.showDataAs(c).showDataAs),(0,I.applyShowDataAsStyle)(f,c,b,N),s.q3(null,null,!0),i=!0}catch(t){o.jT(10,t.message)}finally{t.q5(o,!0),h=_.Commands.TI(o.name()),t.tT[h]=a.endTransaction()}}return i},N.prototype.oZt=function(t,i){var n=i.showDataAs,e=i.baseFieldName,r=i.baseFieldItem,i=i.baseFieldItemType;return t.showDataAs===n&&t.baseFieldName===e&&t.baseFieldItem===r&&t.baseFieldItemType===i},N.prototype.aZt=function(t){for(var i,n,e,i=0,n=At;i<n.length;i++)if(!(0,P.ht)(t[e=n[i]]))return!1;return!0},N.prototype.undo=function(){var t,i,n,e,r,o,a,s,u,c,l,f,h,v,d,p,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{for(e=_.Commands.TI(i.name()),o=(r=t.tT[e]).pivotTableChanges,s=(a=t.tT.cmdOption||t.tT.commandOptions).pivotTableName||a.pivotName,c=(u=i.pivotTables&&i.pivotTables.get(s)).dh,f=l=void 0,h=0;h<o.length;h++)"showDataAs"===(v=o[h].value).type?l=v:"subTotalType"===v.type&&(f=v);i.Ut.undo(r),l&&(d=c.getFieldInfoByName(l.fieldName))&&(p=d.Or,i.ki(_.Events.PivotTableChanged,{type:"ShowValueAs",fieldName:l.fieldName,oldValue:(0,_.RF)(p),newValue:(0,_.RF)(l.oldShowDataAs),pivotTableName:u.Zc})),f&&i.ki(_.Events.PivotTableChanged,{type:"SummarizedValueBy",fieldName:f.fieldName,oldValue:c.xy(f.fieldName),newValue:f.subtotalType,pivotTableName:u.Zc}),n=!0}finally{t.q5(i,!0)}}return n},Dt=N,_.Commands[et]={canUndo:!0,execute:function(t,i,n){return r(t,Dt,i,n)}},n(x,ei=t),x.prototype.execute=function(){var t,i,n,e,r,o,a,s,u,c,l,f,h,v,r,d,e,t=this,i=!1;if(t.canExecute()){e=(n=t.tT).cmdOption,r=n.commandOptions,u=s=void 0,(a=(o=t.Mf).Ut).startTransaction(),t.X5(o,!0),u=((h=f=l=c=void 0,P.ht)(e)?(f=S(v=r.pivotTableCellInfo,c=(h=o.pivotTables.get(r.pivotTableName)).dh),s=r.showNoData,r):(f=e.oldFieldName,c=(h=o.pivotTables.get(e.pivotName)).dh,s=e.showNoData,e)).showSubtotalTop,r=c.getFieldInfoByName(f),l=e&&e.fieldName||c.dz(c.OR(r.a,r.Zc))||f;try{if(h&&h.suspendLayout(),d=n.formatter,h&&(h.showNoData(r.a,s),h.subtotalPosition(r.Zc,u?F.SubtotalsPosition.top:F.SubtotalsPosition.bottom),f!==l)&&h.updateFieldName(f,l),_.mt.St(d))try{(0,V.evaluateFormula)(o,d)}catch(t){if(!(t instanceof U.CalcError))return}this.sZt(h,l,null,d),h&&h.resumeLayout(),i=!0}finally{t.q5(o,!0),e=_.Commands.TI(o.name()),t.tT[e]=a.endTransaction()}}return i},x.prototype.uZt=function(t){return-1<[P.PivotShowDataAs.percentOfTotal,P.PivotShowDataAs.percentOfRow,P.PivotShowDataAs.percentOfCol,P.PivotShowDataAs.percent,P.PivotShowDataAs.percentOfParentRow,P.PivotShowDataAs.percentOfParentCol,P.PivotShowDataAs.percentOfParent,P.PivotShowDataAs.percentDiff,P.PivotShowDataAs.percentOfRunningTotal].indexOf(t)},x.prototype.sZt=function(t,i,n,e){var r,i={labelOnly:!0,references:[{fieldName:i}]},r=(0,_.RF)(t.getStyle(i));r=r||new _.Style,e?r.formatter=e:(delete r.formatter,(0,I.cZt)(r)&&(r=null)),t.setStyle(i,r)},x.prototype.undo=function(){var t,i,n,e,r,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=_.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),n=!0}finally{t.q5(i,!0)}}return n},kt=x,_.Commands[rt]={canUndo:!0,execute:function(t,i,n){return r(t,kt,i,n)}},n(Fi,ri=t),Fi.prototype.execute=function(){var t,i,n,e,r,o,a,n,s,u,c,l,f,f,f,t=this,i=!1,n=t.tT.cmdOption;if(t.canExecute())if(e=n.targetArea,r=n.fieldName,o=n.targetIndex,a=n.pivotName,n=n.isSusPaint,u=(s=t.Mf).Ut,c=s.pivotTables.get(a),l=n?c.dh.copyFieldsModel:c.dh,(0,P.ht)(o)&&(o=l.nw(e).length,(f=l.getSigmaValuePosition()).display)&&f.positionType===e-1&&o++,f=r,e===F.PivotTableFieldType.valueField&&(f=l.dz(l.FG(r))),n)l.addFieldByName(r,f,e,A,o),l.q3(n);else{u.startTransaction(),t.X5(s,!0);try{l.addFieldByName(r,f,e,A,o),c.updateDataModel(),s.ki(_.Events.PivotTableChanged,{type:"fieldChanged",fieldName:r,newArea:e,newIndex:o,oldIndex:A,oldArea:A,pivotTableName:a}),l.q3(n,null,!0),ji(s.pivotTables.get(a),s),i=!0}catch(t){s.jT(10,t.message)}finally{t.q5(s,!0),f=_.Commands.TI(s.name()),t.tT[f]=u.endTransaction()}}return i},Fi.prototype.undo=function(){var t,i,n,e,r,o,a,s,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{for(e=_.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),o=r.pivotTableChanges,a=0;a<o.length;a++)"removeField"===(s=o[a].value).type&&i.ki(_.Events.PivotTableChanged,{type:"fieldChanged",fieldName:s.fieldName,oldArea:s.area,oldIndex:s.index,newArea:A,newIndex:A,pivotTableName:t.tT.cmdOption.pivotName});n=!0}finally{t.q5(i,!0)}}return n},jt=Fi,_.Commands[s]={canUndo:!0,execute:function(t,i,n){return r(t,jt,i,n)}},n(M,oi=t),M.prototype.getAllItemsList=function(t){var i,n,i=[],n;return t._items.forEach(function(t){i.push(t.value)}),i},M.prototype.execute=function(){var t,i,n,e,r,o,a,s,u,c,l,f,h,v,d,p,m,b,g,w,y,C,A,N,I,b,t=this,i=!1;if(t.canExecute()){e=(n=t.tT).cmdOption,s=a=o=r=void 0,(c=(u=t.Mf).Ut).startTransaction(),t.X5(u,!0);try{if((0,P.ht)(e)){if(d=t.tT.commandOptions,p=t.tT.selections,m=d.subType,a=u.pivotTables.get(d.pivotTableName),b=d.pivotTableCellInfo,g=a.dh,w=b.area,r=S(b),y=void 0,s=a.options.allowMultipleFiltersPerField&&a.labelFilter(r)||{},y=(0,P.ht)(s.textItem)?{isAll:!1}:s.textItem,C=It(u,d.pivotTableName,r,p,w),1===m)y.list=T([],C,!0);else if(2===m){for(A=(g.getLabelFilterInfo(r)&&g.getLabelFilterInfo(r).textItem&&g.getLabelFilterInfo(r).textItem.list||g.Kz(r)).slice(0),N=[],I=0;I<A.length;I++)-1===C.indexOf(A[I])&&N.push(A[I]);y.list=N}s.textItem=y}else r=e.fieldName,o=e.pivotName,a=u.pivotTables.get(o),l=e.dataOfListBox,s=a.options.allowMultipleFiltersPerField&&a.labelFilter(r)||{},f={list:[],isAll:!1},h=[],v=!0,l.forEach(function(t){t.status||(v=v&&t.status),t.status&&h.push(t.value)}),f.isAll=v,f.list=h,s.textItem=f;a.labelFilter(r,s),u.ki(_.Events.PivotTableChanged,{type:"filter",fieldName:r,filterInfo:a.labelFilter(r),pivotTableName:o}),i=!0}finally{t.q5(u,!0),b=_.Commands.TI(u.name()),t.tT[b]=c.endTransaction()}}return i},M.prototype.undo=function(){var t,i,n,e,r,o,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=_.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),o=r.pivotTableChanges[r.pivotTableChanges.length-1].value,i.ki(_.Events.PivotTableChanged,{type:"filter",fieldName:o.fieldName,filterInfo:(0,_.RF)(o.filterInfo),pivotTableName:t.tT.cmdOption&&t.tT.cmdOption.pivotName||t.tT.commandOptions.pivotTableName}),n=!0}finally{t.q5(i,!0)}}return n},Ot=M,_.Commands[h]={canUndo:!0,execute:function(t,i,n){return r(t,Ot,i,n)}},n(Pi,ai=t),Pi.prototype.execute=function(){var t,i,n,e,r,o,a,s,u,c,l,f,h,v,d,p,m,b,g,w,y,C,p,t=this,i=!1;if(t.canExecute()){e=(n=t.tT).cmdOption,c=u=a=o=r=void 0,(f=(l=t.Mf).Ut).startTransaction(),t.X5(l,!0),h=!1;try{if((0,P.ht)(e))o=(d=n.commandOptions).pivotTableName,a=l.pivotTables.get(d.pivotTableName),r=S(p=d.pivotTableCellInfo),s=d.subType,d.sortValueInfo?h=!0:(m=Li(p))&&(r=m.fieldName,u=m.sortValueFieldName,c=m.sortByPivotReferences);else switch(r=e.fieldName,o=e.pivotName,v=e.commandName,a=l.pivotTables.get(o),v){case"asc":s=P.SortType.asc;break;case"desc":s=P.SortType.desc;break;case"custom":s=P.SortType.custom;break;default:return}if(b=void 0,h){for(g=a.dh,w=(d=e||n.commandOptions).sortValueInfo.sortedFieldNames,y=[].concat(w),w.sort(function(t,i){var t=t.localeCompare(i);return s===P.SortType.desc?-1*t:t}),C=0;C<w.length-1;C++)g.changeFieldArea(w[C],3,C);a.refresh(),b={type:"sort",sortType:s,fieldName:L().Values,oldOrder:y,newOrder:w,pivotTableName:o}}else a.sort(r,{sortType:s,sortValueFieldName:u,sortByPivotReferences:c}),b={type:"sort",fieldName:r,sortType:s,sortInfo:a.sort(r),pivotTableName:o};b&&(l.ki(_.Events.PivotTableChanged,b),i=!0)}catch(t){l.jT(10,t.message)}finally{t.q5(l,!0),p=_.Commands.TI(l.name()),t.tT[p]=f.endTransaction()}}return i},Pi.prototype.undo=function(){var t,i,n,e,r,o,a,s,u,c,l,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=_.Commands.TI(i.name()),o=(r=t.tT[e]).pivotTableChanges[r.pivotTableChanges.length-1].value,i.Ut.undo(r),a=t.tT.cmdOption||t.tT.commandOptions,s=void 0,s=a.sortValueInfo?(c=(u=a.sortValueInfo).sortedFieldNames,{type:"sort",sortType:l=u.sortType,fieldName:L().Values,oldOrder:T([],c,!0),newOrder:T([],c,!0).reverse(),pivotTableName:a.pivotName||a.pivotTableName}):{type:"sort",fieldName:o.fieldName,sortType:o.sortInfo?o.sortInfo.sortType:A,sortInfo:o.sortInfo,pivotTableName:a.pivotName},i.ki(_.Events.PivotTableChanged,s),n=!0}finally{t.q5(i,!0)}}return n},_t=Pi,_.Commands[m]={canUndo:!0,execute:function(t,i,n){return r(t,_t,i,n)}},n(Ei,si=t),Ei.prototype.execute=function(){var t,i,n,e,r,o,a,s,u,c,l,f,h,v,f,t=this,i=!1;if(t.canExecute()){e=(n=t.tT).cmdOption,u=s=a=o=r=void 0,(l=(c=t.Mf).Ut).startTransaction(),t.X5(c,!0);try{(0,P.ht)(e)?(f=t.tT.commandOptions,r=c.pivotTables.get(f.pivotTableName),o=S(h=f.pivotTableCellInfo),a=f.clearType):(o=e.fieldName,a=e.clearType,s=e.labelType||3,u=e.pivotName,r=c.pivotTables.get(u)),1===a?((v=r.labelFilter(o))&&(1===s?delete v.textItem:2===s?delete v.condition:v=A),r.labelFilter(o,v)):2===a?r.valueFilter(o,A):0===a&&(r.labelFilter(o,A),r.valueFilter(o,A)),c.ki(_.Events.PivotTableChanged,{type:"filter",fieldName:o,pivotTableName:u,clearType:a}),i=!0}finally{t.q5(c,!0),f=_.Commands.TI(c.name()),t.tT[f]=l.endTransaction()}}return i},Ei.prototype.undo=function(){var t,i,n,e,r,o,a,s,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{for(e=_.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),o=r.pivotTableChanges,a=0;a<o.length;a++)"setLabelFilter"!==(s=o[a].value).type&&"setValueFilter"!==s.type||i.ki(_.Events.PivotTableChanged,{type:"filter",fieldName:s.fieldName,filterInfo:(0,_.RF)(s.filterInfo),pivotTableName:(t.tT.cmdOption||t.tT.commandOptions).pivotName});n=!0}finally{t.q5(i,!0)}}return n},Ft=Ei,_.Commands[g]={canUndo:!0,execute:function(t,i,n){return r(t,Ft,i,n)}},n(Bi,ui=t),Bi.prototype.execute=function(){var t,i,n,e,r,o,a,n,s,u,c,l,f,h,l,t=this,i=!1;if(t.canExecute()){e=(n=t.tT.cmdOption).fieldName,r=n.selectValue,o=n.inputValue,a=n.inputValueEnd,n=n.pivotName,(u=(s=t.Mf).Ut).startTransaction(),t.X5(s,!0);try{l=(c=s.pivotTables.get(n)).dh.rBt(e),f=c.options.allowMultipleFiltersPerField&&c.labelFilter(e)||{},l===P.PivotDataType.number&&(o=(0,P.ht)(o)?o:parseInt(o,10),a=(0,P.ht)(a)?a:parseInt(a,10)),h={conType:P.PivotConditionType.caption,val:[o,a],operator:r},f.condition=h,c.labelFilter(e,f),s.ki(_.Events.PivotTableChanged,{type:"filter",fieldName:e,filterInfo:c.labelFilter(e),pivotTableName:n}),i=!0}finally{t.q5(s,!0),l=_.Commands.TI(s.name()),t.tT[l]=u.endTransaction()}}return i},Bi.prototype.undo=function(){var t,i,n,e,r,o,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=_.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),o=r.pivotTableChanges[r.pivotTableChanges.length-1].value,i.ki(_.Events.PivotTableChanged,{type:"filter",fieldName:o.fieldName,filterInfo:(0,_.RF)(o.filterInfo),pivotTableName:t.tT.cmdOption.pivotName}),n=!0}finally{t.q5(i,!0)}}return n},Pt=Bi,_.Commands[H]={canUndo:!0,execute:function(t,i,n){return r(t,Pt,i,n)}},n(Ri,ci=t),Ri.prototype.execute=function(){var t,i,n,e,r,o,a,s,u,c,l,f,h,v,n,t=this,i=!1;if(t.canExecute()){n=t.tT.cmdOption,(r=(e=t.Mf).Ut).startTransaction(),t.X5(e,!0);try{o=n.valueOfField,a=n.valueOfFieldValue,s=n.inputValue,u=n.inputValueEnd,c=n.fieldName,l=n.pivotName,f=e.pivotTables.get(l),h={},v=void 0,v={conType:P.PivotConditionType.value,val:[s,u],operator:+a},h.condition=v,h.conditionByName=o,f.valueFilter(c,h),e.ki(_.Events.PivotTableChanged,{type:"filter",fieldName:c,filterInfo:f.valueFilter(c),pivotTableName:l}),i=!0}finally{t.q5(e,!0),n=_.Commands.TI(e.name()),t.tT[n]=r.endTransaction()}}return i},Ri.prototype.undo=function(){var t,i,n,e,r,o,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=_.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),o=r.pivotTableChanges[r.pivotTableChanges.length-1].value,i.ki(_.Events.PivotTableChanged,{type:"filter",fieldName:o.fieldName,filterInfo:(0,_.RF)(o.filterInfo),pivotTableName:t.tT.cmdOption.pivotName}),n=!0}finally{t.q5(i,!0)}}return n},Lt=Ri,_.Commands[q]={canUndo:!0,execute:function(t,i,n){return r(t,Lt,i,n)}},n(Gi,li=t),Gi.prototype.execute=function(){var t,i,n,e,r,o,a,s,u,c,l,f,h,v,d,p,m,n,t=this,i=!1;if(t.canExecute()){n=t.tT.cmdOption,(r=(e=t.Mf).Ut).startTransaction(),t.X5(e,!0);try{o=n.fieldName,a=n.TopOrBottomValue,s=n.inputValue,u=n.pivotName,c=n.selectTypeValue,l=n.valueFieldName,f=e.pivotTables.get(u),h={},v=void 0,d=1,p=0,m=10,"Bottom"===a&&(d=-1),"Percent"===c?p=1:"Sum"===c&&(p=2),isNaN(+s)||(m=+s),v={conType:P.PivotConditionType.top10,val:m,type:p,operator:d},h.condition=v,h.conditionByName=l,f.valueFilter(o,h),i=!0}finally{t.q5(e,!0),n=_.Commands.TI(e.name()),t.tT[n]=r.endTransaction()}}return i},Gi.prototype.undo=function(){var t,i,n,e,r,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=_.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),n=!0}finally{t.q5(i,!0)}}return n},Et=Gi,_.Commands[tt]={canUndo:!0,execute:function(t,i,n){return r(t,Et,i,n)}},n(D,fi=t),D.prototype.canExecute=function(){for(var t,i,n,e,r,o,a,t=this,i=t.tT.cmdOption,n,e,r=t.Mf.pivotTables.get(i.pivotName).dh,a=0;a<r.z.length;a++)r.z[a]instanceof v.PivotPanel&&(o=r.z[a]);return!(o&&o.GY&&o.GY.AWt)},D.prototype.execute=function(){var t,i,n,e,r,o,a,s,u,c,l,f,n,h,v,d,p,m,b,g,s,t=this,i=!1;if(t.canExecute()){if(n=t.tT.cmdOption,r=(e=t.Mf).Ut,o=n.fieldName,a=n.pivotName,s=n.host,u=n.command,c=n.isWholeDay,l=n.dateLabel,f=n.value1,n=n.value2,v=(h=e.pivotTables.get(a)).dh,d=h.options.allowMultipleFiltersPerField&&h.labelFilter(o)||{},p=void 0,m=+u.split("-")[0],isNaN(m))return;if(m<=P.PivotDateFilterOperator.notBetween&&l)new w.DateFilterDialog(s,l,v,o,a,m),i=!0;else try{if(r.startTransaction(),t.X5(e,!0),b=Vi(f),g=Vi(n),!(0,P.ht)(f)&&(0,P.ht)(b)||!(0,P.ht)(n)&&(0,P.ht)(g))throw new Error(L().DateFormatError);p=41==m?t.createParallelDateFilterCondition(u):{conType:P.PivotConditionType.date,val:[b,g],isWholeDay:c,operator:m},d.condition=p,h.labelFilter(o,d),i=!0}finally{t.q5(e,!0),s=_.Commands.TI(e.name()),t.tT[s]=r.endTransaction()}}return i},D.prototype.createParallelDateFilterCondition=function(t){var i,n,e,r,o,a,i;switch(+t.split("-")[1]){case 1:e=new Date,r=new Date,a=(o=e.getMonth())%3,e.setDate(1),e.setHours(0,0,0,0),e.setMonth(o-a),r.setHours(23,59,59),n={conType:P.PivotConditionType.date,val:[e,r],isWholeDay:!0,operator:P.PivotDateFilterOperator.dateToDate,isParallel:!1,by:P.PivotAdvancedDateFilterBy.quarter};break;case 2:e=new Date,r=new Date,e.setDate(1),e.setHours(0,0,0,0),r.setHours(23,59,59),n={conType:P.PivotConditionType.date,val:[e,r],isWholeDay:!0,operator:P.PivotDateFilterOperator.dateToDate,isParallel:!1,by:P.PivotAdvancedDateFilterBy.month};break;case 3:e=new Date,r=new Date,e.setMonth(0,1),e.setHours(0,0,0,0),r.setHours(23,59,59),n={conType:P.PivotConditionType.date,val:[e,r],isWholeDay:!0,operator:P.PivotDateFilterOperator.dateToDate,isParallel:!0,by:P.PivotAdvancedDateFilterBy.year};break;case 4:e=new Date,r=new Date,a=(o=e.getMonth())%3,e.setDate(1),e.setHours(0,0,0,0),e.setMonth(o-a),r.setHours(23,59,59),n={conType:P.PivotConditionType.date,val:[e,r],isWholeDay:!0,operator:P.PivotDateFilterOperator.dateToDate,isParallel:!0,by:P.PivotAdvancedDateFilterBy.quarter};break;case 5:e=new Date,r=new Date,e.setDate(1),e.setHours(0,0,0,0),r.setHours(23,59,59),n={conType:P.PivotConditionType.date,val:[e,r],isWholeDay:!0,operator:P.PivotDateFilterOperator.dateToDate,isParallel:!0,by:P.PivotAdvancedDateFilterBy.month}}return n},D.prototype.undo=function(){var t,i,n,e,r,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=_.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),n=!0}finally{t.q5(i,!0)}}return n},Bt=D,_.Commands[it]={canUndo:!0,execute:function(t,i,n){return r(t,Bt,i,n)}},n(j,hi=t),j.prototype.canExecute=function(){return!0},j.prototype.execute=function(){var t,i,n,e,r,o,a,n,a,a,t=this,i=!1;if(t.canExecute()){n=t.tT.cmdOption,r=(e=t.Mf).Ut,o=n.fieldName,a=n.pivotName,n=n.labelFilter,a=e.pivotTables.get(a);try{r.startTransaction(),t.X5(e,!0),a.labelFilter(o,n),i=!0}finally{t.q5(e,!0),a=_.Commands.TI(e.name()),t.tT[a]=r.endTransaction()}}return i},j.prototype.undo=function(){var t,i,n,e,r,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=_.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),n=!0}finally{t.q5(i,!0)}}return n},Rt=j,_.Commands[yt]={canUndo:!0,execute:function(t,i,n){return r(t,Rt,i,n)}},n(Ui,vi=t),Ui.prototype.execute=function(){var t,i,n,e,r,o,a,s,u,c,l,f,h,v,d,p,m,b,g,w,y,C,A,N,I,T,S,x,M,D,k,j,O,o,t=this,i=!1;if(t.canExecute()){(e=(n=t.Mf).Ut).startTransaction(),t.X5(n,!0),o=(r=t.tT).commandOptions,a=r.cmdOption;try{if(d=((m=p=d=v=h=f=l=c=u=s=void 0,P.ht)(a)?(s=(l=n.pivotTables.get(o.pivotTableName)).dh,g=(b=o.pivotTableCellInfo).activeRowFieldInfo,w=b.activeColFieldInfo,v=b.area,u=g&&g.name||w&&w.name,r):(u=a.fieldName,c=a.pivotName,f=a.dataType,l=n.pivotTables.get(c),a)).selections,u=(p=l.getField(u)).sourceName,m=p.fieldName,f===P.PivotDataType.number)h={originFieldName:u,numberGroup:{start:a.startingAtValue,end:a.endingAtValue,by:a.groupByValue}},l.group(h);else if(f===P.PivotDataType.date){if(h={originFieldName:u},0<(y=a.groupByValueArray).length)for(h.dateGroups=[],C=0;C<y.length;C++)A=y[C],h.dateGroups.push({start:new Date(a.startingAtValue),end:new Date(a.endingAtValue),by:A});l.group(h)}else if(N=u,T=I=void 0,S={},x=!!s.sy(u),D=M=void 0,D=It(n,l.name(),m,d,v),j=(k=l.getGroupInfo(u))&&k.textGroup&&k.textGroup.groupItems,(0,P.ht)(j))1<D.length&&(N=(I=u)+2,S[M=L().Group+1]=D,T={originFieldName:I,textGroup:{fieldName:N,groupItems:S}},l.group(T),x||(3===v?l.add(N,N,F.PivotTableFieldType.rowField,void 0,Si(s.B,u)):2===v&&l.add(N,N,F.PivotTableFieldType.columnField,void 0,Si(s.R,u))));else{for(C=0;C<D.length;C++)if(-1<(O=D[C]).indexOf("Group")&&j[O]&&1<j[O].length)return!1;j[M=L().Group+(Object.keys(j).length+1)]=D,l.group(k)}i=!0}catch(t){n.jT(10,t.message)}finally{t.q5(n,!0),o=_.Commands.TI(n.name()),t.tT[o]=e.endTransaction()}}return i},Ui.prototype.undo=function(){var t,i,n,e,r,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=_.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),n=!0}finally{t.q5(i,!0)}}return n},Gt=Ui,_.Commands[ft]={canUndo:!0,execute:function(t,i,n){return r(t,Gt,i,n)}},n(Qi,di=t),Qi.prototype.execute=function(){var t,i,n,e,r,o,a,s,u,c,o,t=this,i=!1;if(t.canExecute()){(e=(n=t.Mf).Ut).startTransaction(),t.X5(n,!0);try{o=(r=t.tT).commandOptions,a=n.pivotTables.get(o.pivotTableName),u=S(s=o.pivotTableCellInfo),(c=a.getField(u))&&c.sourceName&&(a.ungroup(c.sourceName),i=!0)}finally{t.q5(n,!0),o=_.Commands.TI(n.name()),t.tT[o]=e.endTransaction()}}return i},Qi.prototype.undo=function(){var t,i,n,e,r,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=_.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),n=!0}finally{t.q5(i,!0)}}return n},Vt=Qi,_.Commands[ht]={canUndo:!0,execute:function(t,i,n){return r(t,Vt,i,n)}},n(Wi,pi=t),Wi.prototype.execute=function(){var t,i,n,e,r,o,o,t=this,i=!1;if(t.canExecute()){(e=(n=t.Mf).Ut).startTransaction(),t.X5(n,!0);try{(r=t.Mf.pivotTables.get(t.tT.commandOptions.pivotTableName)).suspendLayout(),o=zi(!1,this,!1),(0,P.o)(o,function(t){var i=r.collapse(t.fieldName,t.itemName);r.collapse(t.fieldName,t.itemName,t.collapse),r.updateDataModel(),n.ki(_.Events.PivotTableChanged,{type:"collapse",fieldName:t.fieldName,item:t.itemName,newValue:t.collapse,oldValue:i,pivotTableName:r.Zc})}),r.resumeLayout(),i=!0}finally{t.q5(n,!0),o=_.Commands.TI(n.name()),t.tT[o]=e.endTransaction()}}return i},Wi.prototype.undo=function(){var t,i,n,e,r,o,a,s,u,c,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{for(e=_.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),o=r.pivotTableChanges,a=t.Mf.pivotTables.get(t.tT.commandOptions.pivotTableName),s=0;s<o.length;s++)"setCollapse"===(u=o[s].value).type&&(c=a.collapse(u.fieldName,u.item),i.ki(_.Events.PivotTableChanged,{type:"collapse",fieldName:u.fieldName,item:u.item,newValue:c,oldValue:u.isCollapse,pivotTableName:a.Zc}));n=!0}finally{t.q5(i,!0)}}return n},Ut=Wi,_.Commands[dt]={canUndo:!0,execute:function(t,i,n){return r(t,Ut,i,n)}},n(Zi,mi=t),Zi.prototype.execute=function(){var t,i,n,e,r,o,o,t=this,i=!1;if(t.canExecute()){(e=(n=t.Mf).Ut).startTransaction(),t.X5(n,!0);try{(r=t.Mf.pivotTables.get(t.tT.commandOptions.pivotTableName)).suspendLayout(),o=zi(!0,this,!1),(0,P.o)(o,function(t){var i=r.collapse(t.fieldName,t.itemName);r.collapse(t.fieldName,t.itemName,t.collapse),r.updateDataModel(),n.ki(_.Events.PivotTableChanged,{type:"collapse",fieldName:t.fieldName,item:t.itemName,newValue:t.collapse,oldValue:i,pivotTableName:r.Zc})}),r.resumeLayout(),i=!0}finally{t.q5(n,!0),o=_.Commands.TI(n.name()),t.tT[o]=e.endTransaction()}}return i},Zi.prototype.undo=function(){var t,i,n,e,r,o,a,s,u,c,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{for(e=_.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),o=r.pivotTableChanges,a=t.Mf.pivotTables.get(t.tT.commandOptions.pivotTableName),s=0;s<o.length;s++)"setCollapse"===(u=o[s].value).type&&(c=a.collapse(u.fieldName,u.item),i.ki(_.Events.PivotTableChanged,{type:"collapse",fieldName:u.fieldName,item:u.item,newValue:c,oldValue:u.isCollapse,pivotTableName:a.Zc}));n=!0}finally{t.q5(i,!0)}}return n},Qt=Zi,_.Commands[pt]={canUndo:!0,execute:function(t,i,n){return r(t,Qt,i,n)}},n(Yi,bi=t),Yi.prototype.execute=function(){var t,i,n,e,r,o,a,s,u,n,t=this,i=!1;if(t.canExecute()){n=t.tT,(r=(e=t.Mf).Ut).startTransaction(),t.X5(e,!0);try{(o=e.pivotTables.get(n.commandOptions.pivotTableName)).suspendLayout(),a=zi(!1,this,!0),(u=!1,P.o)(a,function(t){u=o.collapse(t.fieldName,t.itemName),o.collapse(t.fieldName,t.itemName,t.collapse),s=t.fieldName}),o.updateDataModel(),e.ki(_.Events.PivotTableChanged,{type:"collapse",fieldName:s,newValue:!1,oldValue:u,pivotTableName:o.Zc}),o.resumeLayout(),i=!0}finally{t.q5(e,!0),n=_.Commands.TI(e.name()),t.tT[n]=r.endTransaction()}}return i},Yi.prototype.undo=function(){var t,i,n,e,r,o,a,s,u,c,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{for(e=_.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),o=r.pivotTableChanges,a=t.Mf.pivotTables.get(t.tT.commandOptions.pivotTableName),s=0;s<o.length;s++)"setCollapse"===(u=o[s].value).type&&(c=a.collapse(u.fieldName,u.item),i.ki(_.Events.PivotTableChanged,{type:"collapse",fieldName:u.fieldName,item:u.item,newValue:c,oldValue:u.isCollapse,pivotTableName:a.Zc}));n=!0}finally{t.q5(i,!0)}}return n},Wt=Yi,_.Commands[mt]={canUndo:!0,execute:function(t,i,n){return r(t,Wt,i,n)}},n(Hi,gi=t),Hi.prototype.execute=function(){var t,i,n,e,r,o,a,s,u,n,t=this,i=!1;if(t.canExecute()){n=t.tT,(r=(e=t.Mf).Ut).startTransaction(),t.X5(e,!0);try{(o=e.pivotTables.get(n.commandOptions.pivotTableName)).suspendLayout(),a=zi(!0,this,!0),u=!0,(0,P.o)(a,function(t){u=o.collapse(t.fieldName,t.itemName),o.collapse(t.fieldName,t.itemName,t.collapse),s=t.fieldName}),o.updateDataModel(),e.ki(_.Events.PivotTableChanged,{type:"collapse",fieldName:s,newValue:!0,oldValue:u,pivotTableName:o.Zc}),o.resumeLayout(),i=!0}finally{t.q5(e,!0),n=_.Commands.TI(e.name()),t.tT[n]=r.endTransaction()}}return i},Hi.prototype.undo=function(){var t,i,n,e,r,o,a,s,u,c,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{for(e=_.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),o=r.pivotTableChanges,a=t.Mf.pivotTables.get(t.tT.commandOptions.pivotTableName),s=0;s<o.length;s++)"setCollapse"===(u=o[s].value).type&&(c=a.collapse(u.fieldName,u.item),i.ki(_.Events.PivotTableChanged,{type:"collapse",fieldName:u.fieldName,item:u.item,newValue:c,oldValue:u.isCollapse,pivotTableName:a.Zc}));n=!0}finally{t.q5(i,!0)}}return n},zt=Hi,_.Commands[bt]={canUndo:!0,execute:function(t,i,n){return r(t,zt,i,n)}},n(Ji,wi=t),Ji.prototype.execute=function(){var t,i,n,e,r,n,o,a,s,n,u,c,l,f,h,v,d,p,m,b,g,n,t=this,i=!1;if(t.canExecute())if(n=t.tT,r=(e=t.Mf).Ut,o=(n=n.cmdOption).isSusPaint,a=n.fieldName,s=n.checked,n=n.pivotName,u=e.pivotTables&&e.pivotTables.get(n),c=void 0,l=o?u.dh.copyFieldsModel:u.dh,o)s?l.qVt(a):l.HVt(a),l.q3(o);else{r.startTransaction(),t.X5(e,!0);try{if(s)f=l.qVt(a),c=(v=(h=l.Ti.getPivotCacheByName(l.L).Pq)[a].W5)===P.PivotDataType.number?{pivotArea:F.PivotTableFieldType.valueField,pivotIndex:l.nw(F.PivotTableFieldType.valueField).length-1}:u.getField(a),l.q3(o,null,!1),e.ki(_.Events.PivotTableChanged,{type:"fieldChanged",fieldName:f&&f.Zc,oldArea:A,oldIndex:A,newArea:c.pivotArea,newIndex:c.pivotIndex,pivotTableName:u.Zc});else{for(d=void 0,p=[],m=F.PivotTableFieldType.valueField;m>=F.PivotTableFieldType.filterField;m--)for(b=(d=l.nw(m)).length-1;0<=b;b--)d[b].a===a&&p.unshift(u.getField(d[b].Zc));for(l.HVt(a),l.q3(o,null,!1),g=0;g<p.length;g++)c=p[g],e.ki(_.Events.PivotTableChanged,{type:"fieldChanged",fieldName:c.fieldName,sourceName:a,oldArea:c.pivotArea,oldIndex:c.pivotIndex,newArea:A,newIndex:A,pivotTableName:u.Zc})}i=!0}finally{t.q5(e,!0),n=_.Commands.TI(e.name()),t.tT[n]=r.endTransaction()}}return i},Ji.prototype.undo=function(){var t,i,n,e,r,o,a,s,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{for(e=_.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),o=r.pivotTableChanges,a=0;a<o.length;a++)"removeField"===(s=o[a].value).type?i.ki(_.Events.PivotTableChanged,{type:"fieldChanged",fieldName:s.fieldName,oldArea:s.area,oldIndex:s.index,newArea:A,newIndex:A,pivotTableName:t.tT.cmdOption.pivotName}):i.ki(_.Events.PivotTableChanged,{type:"fieldChanged",fieldName:s.fieldName,oldArea:A,oldIndex:A,newArea:s.area,newIndex:s.index,pivotTableName:t.tT.cmdOption.pivotName});n=!0}finally{t.q5(i,!0)}}return n},Zt=Ji,_.Commands[f]={canUndo:!0,execute:function(t,i,n){return r(t,Zt,i,n)}},n(qi,yi=t),qi.prototype.execute=function(){var t,i,n,e,r,o,a,s,u,n,t=this,i=!1;if(t.canExecute()){n=t.tT,(r=(e=t.Mf).Ut).startTransaction(),t.X5(e,!0);try{a=(o=n.cmdOption).fieldsInfo,(u=(s=e.pivotTables&&e.pivotTables.get(o.pivotName)).dh).VT(a),i=!0}finally{t.q5(e,!0),n=_.Commands.TI(e.name()),t.tT[n]=r.endTransaction()}}return i},qi.prototype.undo=function(){var t,i,n,e,r,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=_.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),n=!0}finally{t.q5(i,!0)}}return n},Yt=qi,_.Commands[wt]={canUndo:!0,execute:function(t,i,n){return r(t,Yt,i,n)}},n($i,Ci=t),$i.prototype.execute=function(){var t,i,n,e,r,o,a,s,n,t=this,i=!1;if(t.canExecute()){n=t.tT,(r=(e=t.Mf).Ut).startTransaction(),t.X5(e,!0);try{a=(o=n.cmdOption).name,(s=o.views).apply(a),e.ki(_.Events.PivotTableChanged,{type:"viewChanged",viewName:a,pivotTableName:o.pivotName}),i=!0}finally{t.q5(e,!0),n=_.Commands.TI(e.name()),t.tT[n]=r.endTransaction()}}return i},$i.prototype.undo=function(){var t,i,n,e,r,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=_.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),i.ki(_.Events.PivotTableChanged,{type:"viewChanged",pivotTableName:t.tT.cmdOption.pivotName}),n=!0}finally{t.q5(i,!0)}}return n},Ht=$i,_.Commands[ut]={canUndo:!0,execute:function(t,i,n){return r(t,Ht,i,n)}},_.Commands[vt]={canUndo:!1,execute:function(t,i,n){var t,i,e,i,r,i,r,o,a,i,r,e,t,t=_.Commands.Tp(t,i),i=i.commandOptions,e=t.pivotTables.get(i.pivotTableName),i=i.pivotTableCellInfo,r=i.rowInfos,i=i.colInfos,r=r&&i?r.concat(i):r||i||[],o=[],a=0;(0,P.o)(r,function(t){t.fieldName!==L().sigmaValue&&(o[a]={fieldName:t.fieldName,fieldItem:t.itemName},a++)}),i=e.getPivotDetails(o),(r=t.getParent())&&((e=new _.Worksheet).setRowCount(200<i.length?i.length:200),e.setColumnCount(20<i[0].length?i[0].length:20),e.setArray(0,0,i),t=Xi(r),e.tables.add(t,0,0,i.length,i[0].length),r.addSheet(r.getActiveSheetIndex(),e))}},_.Commands[C]={canUndo:!1,execute:function(t,i){var t,i,n,e,r,o,a,s,u,i,t,r,c,l,t=_.Commands.Tp(t,i),i=i.cmdOption,n=i.fieldName,e=i.pivotName,r=i.commandName,o=i.host,a=i.position,s=i.filterDialog,i=[],c,l=(t.pivotTables&&t.pivotTables.get(e)).dh,t=l.K.get(n);if("ValueFilter"===r)u=new v.PivotValuesDialog(o,l,e,n,A,A,s),t&&t.valueFilter&&(3===t.valueFilter.condition.sn?i.push(8):i.push(t.valueFilter.condition.LVt));else{switch(l.rBt(n)){case 0:u=new v.PivotNumberFilter(o,l,e,n,A,A,s);break;case 2:u=new v.PivotDateFilterDialog(o,l,e,n,A,A,s);break;default:u=new v.PivotStringFilterDialog(o,l,e,n,A,A,s)}t&&t.labelFilter&&t.labelFilter.condition&&(r=2===t.labelFilter.condition.sn?t.labelFilter.condition.LVt+6:t.labelFilter.condition.LVt,i.push(r))}u.rQ(a,{existed:i,dataType:1})}},_.Commands[Z]={canUndo:!1,execute:function(t,i,n){var e,t,r,o,a,s,u,c,i,i,i,l,f,e=i.cmdOption,t=_.Commands.Tp(t,i);(0,P.ht)(e)?(i=i.commandOptions,c=t.pivotTables.get(i.pivotTableName),i=i.pivotTableCellInfo,r=c.dh,o=S(i),a=c.name(),u=(l=(i=c.labelFilter(o))&&i.conditionInfo&&i.conditionInfo.LVt)||0):(o=e.fieldName,a=e.pivotName,u=e.command,r=(c=t.pivotTables.get(a)).dh),new((f=r.rBt(o))===P.PivotDataType.date?(s=L().getDateLabelFilterItemText(),w.DateFilterDialog):(s=L().getStringLabelFilterItemText(),v.LabelFilter))(document.body,s,r,o,a,+u)}},_.Commands[c]={canUndo:!1,execute:function(t,i,n){var t,i,e,r,i,o,t,a,s,u,c,a,l,t=_.Commands.Tp(t,i),i=i.cmdOption,e=i.position,r=i.fieldName,i=i.pivotName,o,t=t.pivotTables.get(i).dh,a=t.getFieldInfoByName(r),c=t.Z[r],a=Ii(t,a,r,u,i,c);return c===F.PivotTableFieldType.filterField?u=!(s=24):(s=30,c!==F.PivotTableFieldType.valueField&&(u=!0)),a.isColOrRow=u,(l=new v.PivotFilterDialog(document.body,t,i)).init(s,r,e,a),!0}},_.Commands[u]={canUndo:!1,execute:function(t,i){var n,t,e,r,o,i,a,i,s,t,n,t,n=i.cmdOption,t=_.Commands.Tp(t,i),i=((0,P.ht)(n)?(r=S(s=(i=i.commandOptions).pivotTableCellInfo,e=(a=t.pivotTables.get(i.pivotTableName))&&a.dh),o=i.pivotTableName):(a=t.pivotTables.get(n.pivotName),r=n.fieldName,o=n.pivotName,e=a&&a.dh),a&&a.lZt),t=e.getFieldInfoByName(r),n=e.a1(t.a),t=!!t.Spi;return new E.PivotDimFieldSettingDialog(e,r,o,i,n,t,a.layoutType()).$c(),!0}},_.Commands[Y]={canUndo:!1,execute:function(t,i,n){var t,e,r,e,o,a,s,u,i,c,l,f,u,h,t=_.Commands.Tp(t,i),e=Nt(t,i.row,i.col),r=e.pivotInfo,e=e.pt;if(r){switch(a=void 0,o=r.area){case 0:a=r.pageFieldInfo;break;case 1:a=r.cornerFieldInfo;break;case 2:a=r.colHeadFieldInfo}if(!a)return!1;s=a.fieldName,u=a.isCompactRoot,i=t.getCellRect(i.row,i.col),c=e.dh,i.y+=i.height,l=Ii(c,c.getFieldInfoByName(s),s,!0,e.Zc,c.Z[s]),(f=0)===r.area?f=24:(f=30,u&&(u=void 0,1===r.area&&(u=c.B.length),1<(u=2===r.area?c.R.length:u)&&(f+=1),l.areaFieldName=c.nw(r.area).map(function(t){return t.Zc}))),(h=new v.PivotFilterDialog(t.parent&&t.parent.j2(),e.dh,e.getName(),{allowResize:!0,keepDialogSize:!0})).init(f,s,i,l)}return!0}},_.Commands[l]={canUndo:!1,execute:function(t,i){var t,i,n,e,r,o,i,a,t,s,u,c,l,t,t=_.Commands.Tp(t,i),i=i.cmdOption,n=i.fieldName,e=i.configurationNumber,r=i.position,o=i.filterDialog,i=i.pivotName,a,t=t.pivotTables.get(i).dh,s=t.getFieldInfoByName(n),u=[],c=t.Z[n],l;return t.nw(c).forEach(function(t){u.push(t.Zc)}),u.splice(u.indexOf(n),1),u.unshift(n),(t=Ii(t,s,n,!0,i,c)).areaFieldName=u,o.init(e,n,r,t),!0}},_.Commands[K]={canUndo:!1,execute:function(i,t,n){var e,r,i,o,a,s,u,c,l,t,f,e,r,h,e,r,h,v,e=t.cmdOption,r=t.commandOptions,i=_.Commands.Tp(i,t);if(e)return o=e.fieldName,a=e.pivotName,c=(u=(s=i.pivotTables.get(a)).dh).nw(3),l=[o],c.forEach(function(t){l.push(t.Zc)}),new d.SortFieldDialog(document.body,l,u,o,a,i),!0;if(r){if(t=r.pivotTableCellInfo,a=r.pivotTableName,u=(s=i.pivotTables.get(a)).dh,4===(f=t.area)){e=s.getRange().content,r=s.rZt.HWt[4].getRange(),h=e.row+t.relativeRow+r.row,e=e.col+t.relativeColumn+r.col,r=s.getPivotInfo(h,e);try{new d.SortValueDialog(document.body,i,s,r)}catch(t){return i.jT(10,t.message),!1}}else{if(o=void 0,t.colHeadFieldInfo?o=t.colHeadFieldInfo.fieldName:t.activeColFieldInfo?o=t.activeColFieldInfo.name:t.activeRowFieldInfo?o=t.activeRowFieldInfo.name:t.cornerFieldInfo&&(o=t.cornerFieldInfo.fieldName),!o)return!1;if(c=u.nw(3),h=[o],v=[],c.forEach(function(t){v.push(t.Zc)}),-1!==v.indexOf(o))return!1;o===L().Values?new d.SortValueDialog(document.body,i,s,t,!0):(h=h.concat(v),new d.SortFieldDialog(document.body,h,u,o,a,i))}return!0}return!1}},n(tn,Ai=t),tn.prototype.execute=function(){var t,i,n,e,r,o,a,s,u,n,t=this,i=!1;if(t.canExecute()){n=t.tT.cmdOption,(r=(e=t.Mf).Ut).startTransaction(),t.X5(e,!0);try{o=n.pivotName,a=n.fieldName,s=n.sortInfo,(u=e.pivotTables.get(o)).sort(a,s),e.ki(_.Events.PivotTableChanged,{type:"sort",fieldName:a,sortType:s.sortType,sortInfo:u.sort(a),pivotTableName:o}),i=!0}finally{t.q5(e,!0),n=_.Commands.TI(e.name()),t.tT[n]=r.endTransaction()}}return i},tn.prototype.undo=function(){var t,i,n,e,r,o,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=_.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),o=r.pivotTableChanges[r.pivotTableChanges.length-1].value,i.ki(_.Events.PivotTableChanged,{type:"sort",fieldName:o.fieldName,sortType:o.sortInfo.sortType,sortInfo:(0,_.RF)(o.sortInfo),pivotTableName:t.tT.cmdOption.pivotName}),n=!0}finally{t.q5(i,!0)}}return n},Jt=tn,_.Commands[X]={canUndo:!0,execute:function(t,i,n){return r(t,Jt,i,n)}},n(nn,Ni=t),nn.prototype.execute=function(){var t,i,n,e,r,o,a,s,u,c,l,f,n,t=this,i=!1;if(t.canExecute()){n=t.tT.cmdOption,(r=(e=t.Mf).Ut).startTransaction(),t.X5(e,!0);try{for(o=n.pivotName,a=n.sortedFieldNames,s=n.sortType,l=(c=(u=e.pivotTables.get(o)).dh).Q.map(function(t){return t.Zc}),f=0;f<a.length-1;f++)c.changeFieldArea(a[f],3,f);u.refresh(),e.ki(_.Events.PivotTableChanged,{type:"sort",fieldName:L().Values,sortType:s,oldOrder:l,newOrder:a,pivotTableName:o}),i=!0}finally{t.q5(e,!0),n=_.Commands.TI(e.name()),t.tT[n]=r.endTransaction()}}return i},nn.prototype.undo=function(){var t,i,n,e,r,o,a,s,u,t=this,i=t.Mf,n=!1;if(t.canUndo()){t.X5(i,!0);try{e=_.Commands.TI(i.name()),r=t.tT[e],i.Ut.undo(r),a=(o=t.tT.cmdOption).sortedFieldNames,s=o.sortType,u=o.pivotName,i.ki(_.Events.PivotTableChanged,{type:"sort",sortType:s,fieldName:L().Values,oldOrder:T([],a,!0),newOrder:T([],a.reverse(),!0),pivotTableName:u}),n=!0}finally{t.q5(i,!0)}}return n},qt=nn,_.Commands[$]={canUndo:!0,execute:function(t,i,n){return r(t,qt,i,n)}},_.Commands[J]={canUndo:!1,execute:function(t,i,n){var e,t,r,o,a,s,u,c,l,i,o,i,f,i,h,e=i.cmdOption,t=_.Commands.Tp(t,i);if((0,P.ht)(e)){if(i=i.commandOptions,l=t.pivotTables&&t.pivotTables.get(i.pivotTableName),o=i.pivotTableCellInfo,c=i.isTop10,0===(r=l.dh).nw(3).length)return t.jT(10,L().EmptyValueFieldError),!1;o=S(o),a=l.name(),s=L().getValueFilterItemText(),c||(u=(f=(i=l.valueFilter(o))&&i.conditionInfo&&i.conditionInfo.LVt)||0)}else{if(o=e.fieldName,a=e.pivotName,s=e.content,u=e.command,0===(r=(l=t.pivotTables.get(a)).dh).nw(3).length)return t.jT(10,L().EmptyValueFieldError),!1;"Top10"===u&&(c=!0)}i=r.nw(3),h=[],i.forEach(function(t){h.push(t.Zc)}),new w.ValueFilter(document.body,s,h,r,o,a,+u,c)}},_.Commands[nt]={canUndo:!1,execute:function(t,i){var n,t,e,r,o,i,a,i,s,n=i.cmdOption,t=_.Commands.Tp(t,i),i=((0,P.ht)(n)?(r=S(s=(i=i.commandOptions).pivotTableCellInfo,e=(a=t.pivotTables.get(i.pivotTableName))&&a.dh),o=i.pivotTableName):(o=n.pivotName,e=(a=t.pivotTables.get(o)).dh,r=n.fieldName),a.lZt);return new E.PivotValuesFieldSettingDialog(e,r,o,i).$c(),!0}},_.Commands[at]={canUndo:!1,execute:function(t,i){var t,n,e,r,o,r,o,r,a,e,s,u,c,l,c,u,r,i,f,t=_.Commands.Tp(t,i),n=i.commandOptions,e=t.pivotTables.get(n.pivotTableName);if(e)if(o=(r=n.pivotTableCellInfo).activeRowFieldInfo,r=r.activeColFieldInfo,o=o&&o.name||r&&r.name,r=e.getGroupInfo(o),a=e.getField(o),e=e.dh,u=1===(s=n.selections||t.getSelections()).length&&1===s[0].rowCount&&1===s[0].colCount,a.dataType===P.PivotDataType.number&&u){if(c=xi(a,r),!(0,P.ht)(c))return(l=new R.PivotNumberGroupDialog(document.body,n.pivotTableName,o,e,a.start,c.start,a.end,c.end,c.by)).$c(),!0}else if(a.dataType===P.PivotDataType.date&&u){if(c=Mi(a,r),!(0,P.ht)(c))return u=i.activeRow||t.getActiveRowIndex(),r=i.activeCol||t.getActiveColumnIndex(),i=t.getActualStyle(u,r)&&t.getActualStyle(u,r).formatter,(f=new G.PivotDateGroupDialog(document.body,n.pivotTableName,o,e,a.start,c.start,a.end,c.end,c.by,s,i)).$c(),!0}else t.Qy().execute({cmd:"pivotTableGroup",sheetName:t.name(),commandOptions:n,selections:s})}},_.Commands[st]={canUndo:!1,execute:function(t,i){var t,i,t,n,t,e,r,i,t=_.Commands.Tp(t,i),i=i.commandOptions,t=t.pivotTables.get(i.pivotTableName),n=i.pivotTableCellInfo,t=t&&t.dh,e=S(n,t),r=i.pivotTableName,i=i.showValueAsType;return new B.PivotShowValueAsDialog(document.body,t,e,r,n,i),!0}},_.Commands[y]={canUndo:!1,execute:function(t,i){var n,t,i,n=i.cmdOption,t=_.Commands.Tp(t,i),i=t.parent;try{i.kx(n.pivotCacheName,n.pivotCache,n._ptName,t)}catch(t){(0,b.throwError)(L().NoHaveSpread)}}},_.Commands[lt]={canUndo:!1,execute:function(t,i){var t,i,t,t=_.Commands.Tp(t,i),i=i.commandOptions,t=t.pivotTables.get(i.pivotTableName);(0,P.ht)(t)||t.updateSource()}},_.Commands[ot]={canUndo:!1,execute:function(t,i){var i,n,e,i,r,i=i.cmdOption,n=i.position,e=i.views,i=i.width,r;new v.PivotViewListDialog(document.body,e,i).init(n)}},_.Commands[ct]={canUndo:!1,execute:function(t,i){var i,n,i,i=i.cmdOption,n=i.name,i=i.views;return!i.save(n)&&(en(n,i),!0)}},_.Commands[Ct]={canUndo:!1,execute:function(t,i,n){var e,t,r,o,a,s,u,c,u,l,e=rn(t,i),t=e.getSelections();if(1===t.length&&!e.isEditing())for(r=t[0],o=e.pivotTables.all(),a=0;a<o.length;a++)if(c=(u=(s=o[a]).getRange()).page,u=u.content,l=c?c.union(u):u,c&&c.containsRange(r)||u&&u.containsRange(r)){e.setSelection(l.row,l.col,l.rowCount,l.colCount);break}}},_.Commands.fZt=function(t){var i=_.mt.Qf(),n=!i,i=i;t.register(e,_.Commands[e]),t.register(o,_.Commands[o]),t.register(a,_.Commands[a]),t.register(u,_.Commands[u]),t.register(s,_.Commands[s]),t.register(c,_.Commands[c]),t.register(ut,_.Commands[ut]),t.register(ct,_.Commands[ct]),t.register(ot,_.Commands[ot]),t.register(l,_.Commands[l]),t.register(h,_.Commands[h]),t.register(m,_.Commands[m]),t.register(K,_.Commands[K]),t.register(X,_.Commands[X]),t.register($,_.Commands[$]),t.register(g,_.Commands[g]),t.register(C,_.Commands[C]),t.register(Z,_.Commands[Z]),t.register(H,_.Commands[H]),t.register(J,_.Commands[J]),t.register(q,_.Commands[q]),t.register(tt,_.Commands[tt]),t.register(it,_.Commands[it]),t.register(yt,_.Commands[yt]),t.register(Y,_.Commands[Y]),t.register(at,_.Commands[at]),t.register(nt,_.Commands[nt]),t.register(rt,_.Commands[rt]),t.register(et,_.Commands[et]),t.register(f,_.Commands[f]),t.register(lt,_.Commands[lt]),t.register(y,_.Commands[y]),t.register(wt,_.Commands[wt]),t.register(gt,_.Commands[gt]),t.register(ft,_.Commands[ft]),t.register(ht,_.Commands[ht]),t.register(dt,_.Commands[dt]),t.register(pt,_.Commands[pt]),t.register(mt,_.Commands[mt]),t.register(bt,_.Commands[bt]),t.register(vt,_.Commands[vt]),t.register(st,_.Commands[st]),t.register(Ct,_.Commands[Ct],65,n,!1,!1,i)}},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js":function(t,S,i){"use strict";var F,P,j,r,n,e,O,o,_,L,C,a,i,E,s,u,c,x,l,f;function M(){return o.Functions.CALC_PRECISION||14}function B(t,i,n,e){return!0!==t&&i!==a&&2<=n&&0===e?1:0}function h(){}Object.defineProperty(S,"__esModule",{value:!0}),S.PivotTableLayoutBase=S.getValuesRowOffset=S.hZt=void 0,F=i("Pivot"),P=i("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),j=i("Core"),r=i("./dist/plugins/pivot/pivot-panel/pivot-widget.js"),n=i("@spreadjs/js-sheets-common"),e=i("./dist/plugins/pivot/pivot.ns.js"),O=i("./dist/plugins/pivot/pivot-util.js"),o=i("@spreadjs/js-calc"),_=n.Common.lt.ht,L=null,C=Math.max,a=void 0,i=new n.Common.ResourceManager(e.SR,"PivotTables"),E=i.getResource.bind(i),s=j.GC$,u="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+bWludXMxNjwvdGl0bGU+CiAgICA8ZyBpZD0ibWludXMxNiIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Iue8lue7hOWkh+S7vS0yIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzLjAwMDAwMCwgMy4wMDAwMDApIj4KICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgZmlsbD0iI0ZGRkZGRiIgeD0iMCIgeT0iMCIgd2lkdGg9IjExIiBoZWlnaHQ9IjExIj48L3JlY3Q+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDAgTDExLDAgTDExLDExIEwwLDExIEwwLDAgWiBNMSwxIEwxLDEwIEwxMCwxMCBMMTAsMSBMMSwxIFoiIGlkPSLnn6nlvaIiIGZpbGw9IiNBQkFCQUIiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPgogICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjNjY2NjY2IiB4PSIzIiB5PSI1IiB3aWR0aD0iNSIgaGVpZ2h0PSIxIj48L3JlY3Q+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=",c="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+cGx1czE2PC90aXRsZT4KICAgIDxnIGlkPSJwbHVzMTYiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSLnvJbnu4TlpIfku70tMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMy4wMDAwMDAsIDMuMDAwMDAwKSI+CiAgICAgICAgICAgIDxyZWN0IGlkPSLnn6nlvaIiIGZpbGw9IiNGRkZGRkYiIHg9IjAiIHk9IjAiIHdpZHRoPSIxMSIgaGVpZ2h0PSIxMSI+PC9yZWN0PgogICAgICAgICAgICA8cGF0aCBkPSJNMCwwIEwxMSwwIEwxMSwxMSBMMCwxMSBMMCwwIFogTTEsMSBMMSwxMCBMMTAsMTAgTDEwLDEgTDEsMSBaIiBpZD0i55+p5b2iIiBmaWxsPSIjQUJBQkFCIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgICAgICAgICAgPHBhdGggZD0iTTYsMyBMNiw1IEw4LDUgTDgsNiBMNS45OTksNiBMNiw4IEw1LDggTDQuOTk5LDYgTDMsNiBMMyw1IEw1LDUgTDUsMyBMNiwzIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiM2NjY2NjYiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==",x=n.Common.st.E8,S.hZt=l=function(t,i,n,e,r,o,a){var s;return r&&(s=r[a]),t.vZt(i,n,e,s,o,a)},S.getValuesRowOffset=B,h.dZt=function(t,i){var i,n,t,e,r,o,i,a,s,u,c,i,l,f,h,v,d,r,p,m,m,b,g,w,y,C,A,N,I,T,A,S,x,M,D,k,j,O,_,e=!0,o=t.pivotTables.get(i);if(o){for(t=o.pZt(),i=o.rZt,n=o.Get(),a=(i=i.HWt)[0],s=i[1],u=i[2],c=i[3],i=i[4],f=(l=o.mZt()).length,h=o.bZt(),v=o.dh.nrt,d=h.length,r=l.length,m=(m=(p=o.options).subTotalsPosition)===P.SubtotalsPosition.top||m===P.SubtotalsPosition.bottom,b=o.gZt(),g=o.dh.getSigmaValuePosition(),w=(A=o.wZt()).Nkt,y=A.yZt,C=A,N=[],I={},(0,F.o)(t,function(t){var i,i,i,i=o.dh.bl(t.a),i=i&&i.D5?F.SubtotalType.sum:t.Ar,i={name:t.Zc,subtotalText:F.SubtotalType[i],subtotalType:i,cacheName:t.a,hasShowDataAs:!(!C.CZt[t.Zc]||C.CZt[t.Zc].showDataAs===F.PivotShowDataAs.normal)};N.push(i),I[t.Zc]=i}),T=0,S=A=-1,1<N.length&&(g.positionType===F.DataPosition.col?A=g.positionIndex:S=g.positionIndex),x=[],l.forEach(function(t){x.push(t.Zc)}),0<=A&&x.splice(A,L,E().Values),k=B(M=o.options.hideValuesRow,D=o.cCi,t.length,l.length),j={},O=0;O<x.length;O++)j[x[O]]=O+k;return _={},[].concat(b,l,h).forEach(function(t){var i=o.dh.bl(t.a);(0,F.isEmptyObject)(i.P)&&(0,F.isEmptyObject)(i.AQt)||(_[t.Zc]=i.getFieldsItemList()||[])}),o.IZt=_,o.AZt=d+(-1<S?1:0),o.NZt=r+(-1<A?1:0)+k,o.options.showHeaders?e=!1:1===t.length?0===h.length&&0!==l.length||(e=!1):1<t.length&&0===l.length&&-1<A&&(e=!1),u.isHideFirstRow=e,r=o.options.showHeaders,{sharedMap:_,repeatValueFiledChildLength:0,rowDeep:d,rowFields:h,colFields:l,hasColumnSubTotal:m,fieldMap:n,pageModel:a,cornerModel:s,columnModel:u,rowModel:c,contentModel:i,options:p,pageFields:b,valuePositionInfo:g,valueFieldsInfo:N,columnValuePosition:A,rowValuePosition:S,columnDeep:f,rootNode:w,headerNode:y,subtotalCollection:C,valueFieldsMap:I,pt:o,sortInfo:v,columnFieldsIndexes:x,colFieldsMap:j,isHideFirstRow:e,showHeaders:r,hideValuesRow:M,dataCaption:D}}},h.render=function(t){var i=this.dZt(t.Ti,t.Zc);i&&(this.TZt(i),this.MZt(i),this.xZt(i),this.DZt(t,i.rowModel),this.SZt(i),this.kZt(i),t.Uct(),this.jZt(i))},h.jZt=function(t){delete t.rootNode,delete t.headerNode,t.subtotalCollection.L0(),delete t.subtotalCollection},h.OZt=function(t,i,n){_(n.rowHeaderLevel)?n.YAt=n.grandTotalLevel:n.YAt=n.rowHeaderLevel,t.zWt[i]=n},h.recalcFormula=function(t){var t=t.Ti;t&&(t.suspendPaint(),t.getCalcService().recalculateAll(!1,!1),t.resumePaint())},h.PZt=function(t){var i,n,e,r,o,a,s,u,c,l,f,h,v,d,p,i=t.sharedMap,n=t.rowFieldsIndexes,e=t.rowModel,r=e.zWt,o=r.length,a=t.rowValuePosition,s=t.rowFieldsIndexes.length;for(e.YWt={},u=0;u<o;u++)if((c=r[u])&&(l=c.path,!_(l))&&""!==l&&!c.isBlankRow&&!c.isSubtotal)for(f=l.split(F.Separator),t.valuePositionInfo.display&&t.valuePositionInfo.positionType===F.DataPosition.row&&!_(c.valueFieldName)&&f.splice(a,null,c.valueFieldName),h=0,v=f.length;h<v;h++)d=n[h],p=f[h],e.tZt(u,d,d!==E().Values?(0,O.FZt)(i,d,p):p,s-h)},h._Zt=function(t,i,n,e){t.push({path:i,isBlankRow:!0}),n.push([]),e.push([])},h.DZt=function(r,t){var e,o,a,s,i,n,u,c,l,f,h,v,d,p,m;if(r.options.mergeItem&&r.layoutType()===P.PivotTableLayoutType.tabular)for(u in e=r.EZt.LZt,o=t.Tx,a=t.dataTable,s=t.zWt,i=t.YWt,(0,F.o)(a,function(t,i){var n,n,n=s[i];n&&(n.isBlankRow||n.isSubtotal||n.isGrandTotal)&&(n=n.isBlankRow?a[i-1].length-1:t.length-1,e.push({row:i,col:n,rowCount:1,colCount:o-n}))}),n=function(t,i,n,e){return!r.collapse(n,e)||t.valueFieldName===i.valueFieldName},i)if(i.hasOwnProperty(u))for(l in c=i[u])if(c.hasOwnProperty(l)&&(h=(f=c[l]).ranges,1<(v=f.level))&&-1<o-v&&1<h.length){for(p=d=h[0],m=1;m<h.length;m++)h[m]-h[m-1]==1&&n(s[m],s[m-1],u,l)?p+=1:(0<p-d&&e.push({row:d,col:o-v,rowCount:p-d+1,colCount:1}),p=d=h[m]);0<p-d&&e.push({row:d,col:o-v,rowCount:p-d+1,colCount:1})}},h.SZt=function(t){var r,i,t,e,o,n,a,s,u,c,l,f,h,v,d,p,m,b,g,w,r=t.pt,i=t.columnModel,t=t.isHideFirstRow;if(r.options.mergeItem)for(f in e=r.EZt.BZt,o=i.Sx-1,n=t?1+o:o,a=this.twoDimensionalArraySpin(i.dataTable),s=i.WWt,u=i.YWt,c=t?0:1,(0,F.o)(a,function(t,i){var n,n,n=s[i];_(n)||n.isBlankColumn||(n.isSubtotal||n.isGrandTotal)&&(n=t.length-1,e.push({row:n,col:i,rowCount:o-n+1,colCount:1}))}),l=function(t,i,n,e){return!r.collapse(n,e)||t.valueFieldName===i.valueFieldName},u)if(u.hasOwnProperty(f))for(v in h=u[f])if(h.hasOwnProperty(v)&&(p=(d=h[v]).ranges,1<(m=d.level))&&-1<n-m&&1<p.length){for(g=b=p[0],w=1;w<p.length;w++)p[w]-p[w-1]==1&&l(s[w],s[w-1],f,v)?g+=1:(0<g-b&&e.push({row:n-m+c,col:b,rowCount:1,colCount:g-b+1}),g=b=p[w]);0<g-b&&e.push({row:n-m+c,col:b,rowCount:1,colCount:g-b+1})}},h.twoDimensionalArraySpin=function(t){var i,n,e,r,o;if(t&&0!==t.length){for(n=t.length,e=i=0;e<t.length;e++)t[e]&&i<t[e].length&&(i=t[e].length);if(0!==i){for(r=new Array(i),e=0;e<i;e++)r[e]=[];for(e=0;e<i;e++)for(o=0;o<n;o++)t[o]&&t[o][e]&&(r[e][o]=t[o][e]);return r}}},h.TZt=function(o){var a,t,s,i,u,c,l,f,i,h,v,a=this,t=o.pageFields,s=o.pageModel,i=o.pt,u=0,c=0,l=0,f=i.dh,i=o.options,h=i.displayFieldsInPageFilterArea,v=i.reportFilterFieldsPerColumn;h===P.DisplayFields.overThenDown?0===v?s.setRowCount(1):s.setRowCount(Math.ceil(t.length/v)):0===v?s.setRowCount(t.length):s.setRowCount(t.length>=v?v:t.length),(0,F.o)(t,function(t,i){var n,t,e,r,i,t,n=t.Zc,t=t.a,e=f.isFilter(t);h===P.DisplayFields.overThenDown?u=0===v?(c=0,3*i):(c=Math.floor(i/v),3*(r=i%v)):0===v?(c=i,u=0):(u=3*Math.floor(i/v),c=i%v),s.Kbt(c,u,n),e?(t=(i=f.getFilterInfo(t))&&i.getSlicerItemInfo(),s.Kbt(c,u+1,t.hasMoreThanOneSelect?E().MultipleItems:t.text)):s.Kbt(c,u+1,E().All),s.qWt(c,u+1,a.RZt(e,L,8,o.options.showFilter)),s.KWt(c,u+1,n),l=l<u+1?u+1:l}),s.setColCount(l+1)},h.GZt=function(t,r,o,a,e,i,s,u){var c,n,l,f,h,v,d,p,t,m,c=this,n=t.columnModel,l=t.contentModel,f=t.columnValuePosition,h=t.rowValuePosition,v=t.valueFieldsMap,d=t.subtotalCollection,p=t.rowModel,t=t.rowDeep,m;-1!==f?(0,F.o)(n.WWt,function(t,i){var n,e;t&&(n=t.rowPathMap,e=v[t.valueFieldName],n)&&n.indexList&&n.indexList[a]&&e&&(c.VZt(d,d.CZt[t.valueFieldName],r,t.valueFieldName,n,t)?l.Kbt(o,i,O.GC_EMPTY_VALUE):l.Kbt(o,i,x((0,S.hZt)(d,n.indexList[a],e.cacheName,e.subtotalText,r.UZt,r.YAt,t.valueFieldName),M())))}):(p.tZt(o,E().Values,u,t+1-h),(0,F.o)(n.WWt,function(t,i){var n=t&&t.rowPathMap;n&&n.indexList&&n.indexList[a]&&(c.VZt(d,d.CZt[u],r,u,n,t)?l.Kbt(o,i,O.GC_EMPTY_VALUE):l.Kbt(o,i,x((0,S.hZt)(d,n.indexList[a],e,s,r.UZt,r.YAt,u),M())))}))},h.VZt=function(t,i,n,e,r,o){var a,a,e,s,a=n.UZt;if(a&&a[e]){if(a=a[e],_(a.minorPath)||(a.minorPath=o.path),_(a.colTotalIndex)||(a.colTotalIndex=r.indexList[""]),8===i.showDataAs||9===i.showDataAs){if(-1<i.baseRootLevel&&0<(i.showDataAsIndex&n.QZt))return!0;if(-1<i.baseHeaderLevel&&0<(i.showDataAsIndex&o.showDataAsIndex))return!0}if(i.isDifferenceOrPercent)if(i.isHeaderOfPercentOrDiff){if(r.level<i.baseHeaderLevel+1)return!0;a.indexInfo.baseMinorPath=o.rowPathMap.baseSubtotalInfo[e].baseMajorPath}else{if(i.baseRootLevel+1>n.YAt||n.nodeName===i.baseFieldItemShared&&i.baseRootLevel+1===n.YAt)return!0;a.indexInfo.baseMinorPath=o.path}if(i.needBuildRunningTotalOrRankPath){if(n.zEt&&-1<i.baseRootLevel)return!0;if(-1<i.baseHeaderLevel&&r.level<i.baseHeaderLevel+1)return!0;a.indexInfo.minorPath=o.path,a.indexInfo.baseMinorPath=o.rowPathMap.baseSubtotalInfo[e].baseMajorPath}if(i.showDataAs===F.PivotShowDataAs.percentOfRow&&(a.indexInfo.baseIndex=t.WZt("").indexList[n.zZt]),i.showDataAs===F.PivotShowDataAs.percentOfCol&&(a.indexInfo.baseIndex=r.indexList[""]),i.showDataAs===F.PivotShowDataAs.percentOfParent){if(-1<i.baseRootLevel&&n.YAt<i.baseRootLevel+1)return!0;if(-1<i.baseHeaderLevel){if(i.baseHeaderLevel+1>r.level)return!0;r.level===i.baseHeaderLevel+1&&(a.indexInfo.baseIndex=r.indexList[n.zZt]),r.level>i.baseHeaderLevel+1&&(e=o.rowPathMap.baseSubtotalInfo[e].percentOfBasePath,_(e)||(a.indexInfo.baseIndex=t.WZt(e).indexList[n.zZt]))}}if(i.showDataAs===F.PivotShowDataAs.index&&(a.indexInfo.rowTotalIndex=t.WZt("").indexList[n.zZt],a.indexInfo.colTotalIndex=r.indexList[""]),i.showDataAs===F.PivotShowDataAs.percentOfParentRow&&(a.indexInfo.minorPath=o.path),i.showDataAs===F.PivotShowDataAs.percentOfParentCol&&(a.indexInfo.baseIndex=t.WZt(o.rowPathMap.parentPath).indexList[n.zZt]),s=""===o.path&&i.needBuildPercentOfPath&&-1===i.baseRootLevel)return!0}},h.ZZt=function(t,i,n,e,r){var o,a,s,u,c,u,s,l,f,h,v,d,p,m,b,g,w,v,y,C,A,N,I,T,u,s,e;if(void 0===r&&(r=""),o=t.colMap,a=t.contentModel,s=t.columnValuePosition,u=t.rowValuePosition,c=t.rowDeep,u=-1!==u,s=-1!==s,!(n.zEt&&0<c&&t.options.grandTotalPosition!==P.GrandTotalPosition.both&&t.options.grandTotalPosition!==P.GrandTotalPosition.row||""===r&&n.YAt<c)){if(l=r,s)for(""!==r&&(r+=F.Separator),f=0,h=e;f<h.length;f++)d=(v=h[f]).name,p=v.cacheName,m=v.subtotalText,b=v.hasShowDataAs,w=o[g=r+d],v=!1,(v=b?this.YZt(t.subtotalCollection,t.subtotalCollection.CZt[d],r,n,d,l,c):v)?a.Kbt(i,w,O.GC_EMPTY_VALUE):a.Kbt(i,w,x((0,S.hZt)(t.subtotalCollection,n.HZt,p,m,n.UZt,n.YAt,d),M()));if(u&&(w=o[r],!_(w)))for(y=i,C=0,A=e;C<A.length;C++)I=(N=A[C]).name,p=N.cacheName,m=N.subtotalText,T=!1,(T=(b=N.hasShowDataAs)?this.YZt(t.subtotalCollection,t.subtotalCollection.CZt[I],r,n,I,l,c):T)?a.Kbt(y,w,O.GC_EMPTY_VALUE):a.Kbt(y,w,x((0,S.hZt)(t.subtotalCollection,n.HZt,p,m,n.UZt,n.YAt,I),M())),y++;u||s||1!==e.length||(s=(u=e[0]).name,p=u.cacheName,m=u.subtotalText,b=u.hasShowDataAs,""!==r&&(r+=F.Separator),w=o[r+s],_(w))||(e=!1,(e=b?this.YZt(t.subtotalCollection,t.subtotalCollection.CZt[s],r,n,s,l,c):e)?a.Kbt(i,w,O.GC_EMPTY_VALUE):a.Kbt(i,w,x((0,S.hZt)(t.subtotalCollection,n.HZt,p,m,n.UZt,n.YAt,s),M())))}},h.YZt=function(t,i,n,e,r,o,a){return i.needBuildRunningTotalOrRankPath&&-1<i.baseHeaderLevel&&(e.UZt[r].indexInfo.minorPath=o),(8===i.showDataAs||9===i.showDataAs)&&0<(i.showDataAsIndex&e.QZt)||(i.showDataAs===F.PivotShowDataAs.percentOfRow&&e.YAt<=a&&(e.UZt[r].indexInfo.baseIndex=t.JZt(e.zZt,!1)),i.showDataAs===F.PivotShowDataAs.index&&e.YAt<=a&&(e.UZt[r].indexInfo.rowTotalIndex=t.JZt(e.zZt,!1)),!!(i.isDifferenceOrPercent&&-1<i.baseHeaderLevel&&e.YAt<i.actualBaseLevel))||""===n&&i.showDataAs===F.PivotShowDataAs.percentOfParent&&-1===i.baseRootLevel||-1<i.baseHeaderLevel&&e.YAt<i.actualBaseLevel||!!(e.zEt&&i.needBuildRunningTotalOrRankPath&&-1<i.baseRootLevel)||!!(""===n&&i.needBuildRunningTotalOrRankPath&&-1<i.baseHeaderLevel&&i.actualBaseLevel===e.YAt)},h.MZt=function(t){var i,n,e,r,o,a,s,u,c,l,f,h,v,d,p,p,m,b,g,w,y,r,i=t.columnModel,n=t.valueFieldsInfo,e=t.headerNode,r=t.hasColumnSubTotal,o=t.colFields,a=t.columnValuePosition,s=t.columnDeep,u=t.isHideFirstRow,c=t.showHeaders,l=t.pt,f=t.hideValuesRow,h=t.dataCaption,v=e.qZt+(u?0:1)+B(f,h,n.length,o.length),d=r?e.KZt+e.XZt+e.$Zt:e.KZt+e.$Zt,p=t.options.grandTotalPosition;if(p!==P.GrandTotalPosition.both&&p!==P.GrandTotalPosition.row?r&&(d-=-1===t.columnValuePosition?1:t.valueFieldsInfo.length,d=C(d,0)):r||(d+=-1===t.columnValuePosition?1:t.valueFieldsInfo.length),0===o.length&&(d=e.KZt+e.$Zt),p=n.length,(d=0===s&&0===p?0:d)<(m=t.columnFieldsIndexes.length)){for(b=d;b<m;b++)i.WWt[b]={path:"",isBlankColumn:!0};d=m}-1!==a&&0<s&&(v+=1),i.setColCount(d),t.contentModel.setColCount(d),i.setRowCount(v),g={},w=[],y=s?1:0,y+=B(f,h,p,o.length),0<s&&(c&&this.tYt(i,o,a,t),(0,F.o)(o,function(t){w.push({name:t.Zc,isFilter:l.dh.isFilter(t.a),isDim:!0,sortInfo:t.nrt})})),-1!==a&&w.splice(a,0,{name:E().Values,isFilter:!1,isDim:!1}),(0,F.o)(w,function(t,i){var t=t.name;g[t]=i+y}),t.columnHeaderRowMap=g,r=0,1===B(f,h,n.length,o.length)&&(i.Kbt(r,0,h),r++),this.iYt(t,e,r<s?r+1:r,0,n),u&&i.dataTable.splice(r,1),t.colMap=i.getColInfoMap()},h.nYt=function(t,i){var n,e,n,r,i,e,n=t.options,e=n.subTotalsPosition,n=n.grandTotalPosition,r=e!==P.SubtotalsPosition.none?i.KZt+i.XZt+i.$Zt:i.KZt+i.$Zt;return i.zEt&&(0===t.colFields.length&&(r=i.KZt+i.$Zt),i=e!==P.SubtotalsPosition.none,e=n!==P.GrandTotalPosition.none&&n!==P.GrandTotalPosition.col,0<t.columnDeep)&&(i&&!e?r-=-1===t.columnValuePosition?1:t.valueFieldsInfo.length:e&&!i&&(r+=-1===t.columnValuePosition?1:t.valueFieldsInfo.length)),r},h.iYt=function(t,i,n,e,r){var o,a,s,u,c,l,f,h,v,d,p,m,b,g,w,y,h,C,A,N,n,I,T,S,x,M,D,k,n,p,h,o=t.columnModel,a=t.columnDeep,s=t.columnValuePosition,u=t.sharedMap,c=t.columnHeaderRowMap,l=t.colFields,f=t.columnFieldsIndexes,h=i.nodeName,v=i.YAt,d=i.zEt,p=i.eYt,m=i.rYt,b=i.oYt,g=1,w=t.options.subTotalsPosition!==P.SubtotalsPosition.none,y=t.options.grandTotalPosition!==P.GrandTotalPosition.none&&t.options.grandTotalPosition!==P.GrandTotalPosition.col;if(-1!==s&&v<=s&&(g=r.length),h=(0,O.FZt)(u,m,h),C=t.pt.collapse(m,h)&&v!==a,o.Kbt(n,e,h),C)for(N=(A=i.lYt).split(F.Separator),0<=s&&s<=v&&(n=c[E().Values]-1,N.splice(n,L,r[0].name)),I=0,T=N.length;I<T;I++)o.tZt(e,f[I],f[I]!==E().Values?(0,O.FZt)(u,f[I],N[I]):N[I],f.length-I);if(S=e,p){for(x=c[E().Values],d||0===s||(o.Kbt(x-1,e,h),b&&0<b.length&&v<a&&t.options.showDrill&&o.qWt(x-1,e,this.aYt(C,j.ButtonPosition.leftOfText))),M=0,D=r;M<D.length;M++)k=D[M],o.Kbt(x,S,k.name),d&&0===a&&o.tZt(S,E().Values,k.name,l.length-s+1),S+=C?1:this.sYt(t,i,x+1,S,[k]);if(C)return this.uYt(t,i,x,S-g,r,x),v===a&&0!==a&&this.cYt(t,o,S,i,s,a,r),g}else{if(n=c[m],_(n))n=0;else if(o.Kbt(n,S,h),b&&0<b.length&&v<a&&t.options.showDrill&&o.qWt(n,S,this.aYt(C,j.ButtonPosition.leftOfText)),C)return this.uYt(t,i,n,S,r,n),v===a&&0!==a&&this.cYt(t,o,S,i,s,a,r),g;this.sYt(t,i,n+1,S,r)}return h=e+(p=this.nYt(t,i)||g)-g,v===a&&0!==a&&this.cYt(t,o,h,i,s,a,r),(w||d&&y||!a&&r.length)&&this.uYt(t,i,c[m]||1,h,r),p},h.cYt=function(t,i,n,e,r,o,a){var s,u,c,l,f,h,s=t.columnFieldsIndexes,u=t.colFieldsMap,c;if(-1!==r)for(l=0,f=a.length;l<f;l++)h=a[l],i.WWt[n+l]={path:e.lYt,valueFieldName:h.name,grandTotalLevel:e.YAt,showDataAsIndex:e.QZt,rowPathMap:t.subtotalCollection.WZt(e.zZt)},this.tZt(i,n+l,t.sharedMap,e.lYt,e.YAt,r,s,u,h.name,!1);else i.WWt[n]={path:e.lYt,grandTotalLevel:e.YAt,showDataAsIndex:e.QZt,rowPathMap:t.subtotalCollection.WZt(e.zZt)},this.tZt(i,n,t.sharedMap,e.lYt,e.YAt,r,s,u,a&&a[0]&&a[0].name,!1)},h.tZt=function(t,i,n,e,r,o,a,s,u,c){var l,e,f,h,v,l=e.split(F.Separator);for(0<=o&&o<=r&&(e=s[E().Values],l.splice(e,L,u)),f=a.length,h=0,v=c?l.length-1:l.length;h<v;h++)t.tZt(i,a[h],(0,O.FZt)(n,a[h],l[h]),f-h)},h.uYt=function(t,i,n,e,r,o){var a,s,u,c,l,f,h,v,d,p,m,b,g,w,y,C,A,N,I,T,S,A,x,M,D,k,c,w,a=t.columnModel,s=t.columnDeep,u=t.columnValuePosition,c=t.sharedMap,l=t.columnHeaderRowMap,f=t.columnFieldsIndexes,h=t.colFieldsMap,v=t.hideValuesRow,d=t.dataCaption,p=t.colFields,m=r.length,b=i.zEt,g=i.YAt,w=i.nodeName,y=i.lYt,C=i.rYt,A=t.options.grandTotalPosition;if(!(b&&0<s&&A!==P.GrandTotalPosition.both&&A!==P.GrandTotalPosition.row||s-1<g&&0!==s))if(I=(0,O.FZt)(c,C,w),T=t.pt.collapse(C,I),S=l[E().Values],A=B(v,d,r.length,p.length),g<=u)for(n=b?0===s?0+A:1+A:l[C]+A,x=e,M=0;M<m;M++)D=r[M].name,N=0===s?T?I:b?D:I+" "+D:T?I:b?E().Total+" "+D:I+" "+D,(T&&0===M||!T)&&a.Kbt(n,x+M,N),T&&a.Kbt(S,x+M,D),k={path:y,valueFieldName:D,grandTotalLevel:g,showDataAsIndex:i.QZt,rowPathMap:t.subtotalCollection.WZt(i.zZt)},y&&g<s&&a.tZt(x+M,E().Values,D,s+1-g),_(o)||(k.collapseIndex=o-1),b?0===u&&0===s||(k.isGrandTotal=!0):k.isSubtotal=!0,a.WWt[x+M]=k;else c=e,0===s&&-1===u?(N=r[0]&&r[0].name||"",n=0):N=T?I:b?E().GrandTotal:I+E().Total,t.valuePositionInfo.display&&t.valuePositionInfo.positionType===F.DataPosition.row&&0===s&&(N=""),a.Kbt(n,c,N),w=void 0,k={path:y,valueFieldName:w=1===r.length?r[0].name:w,grandTotalLevel:g,showDataAsIndex:i.QZt,rowPathMap:t.subtotalCollection.WZt(i.zZt)},y&&this.tZt(a,c,t.sharedMap,i.lYt,i.YAt,u,f,h,r&&r[0]&&r[0].name,!0),_(o)||(k.collapseIndex=o-1),b?k.isGrandTotal=!0:k.isSubtotal=!0,a.WWt[c]=k},h.fYt=function(t,i,n){if(!(t<i&&n<=1||t+1<i&&1<n))return i},h.tYt=function(o,t,i,a){var s,n,e,s=this,n=[],e=a.pt.dh;(0,F.o)(t,function(t){n.push({name:t.Zc,isFilter:e.isFilter(t.a),isDim:!0,sortInfo:t.nrt})}),-1!==i&&n.splice(i,0,{name:E().Values,isFilter:!1,isDim:!1}),(0,F.o)(n,function(t,i){var n=t.name,e=t.isDim,r=t.isFilter,t=t.sortInfo;o.Kbt(0,i,n),e&&o.qWt(0,i,s.RZt(r,t,24,a.options.showFilter)),o.JWt(i,{isCompactRoot:!1,fieldName:n})})},h.sYt=function(t,i,n,e,r){var o,a,s,u,c,l,f,h,v,d,p,m,b,g,o=t.columnDeep,a=t.options,s=t.columnModel,u=e,c=i.oYt,l=0;if(0<c.length&&i.YAt<o)for(f=a.fillDownLabels,v=a.subTotalsPosition===P.SubtotalsPosition.none?0:1,b=m=p=d=h=void 0,b=0;b<c.length;b++){if(h=1,d=c[b],m=(p=this.iYt(t,d,n,u,r))-v,f)for(g=s.Sl(n,u);h<m;h++)s.Kbt(n,h+u,g);u+=p,l+=p}return l=i.YAt>=o?1:l},h.hYt=function(t,i,n,e,r){var o,a,s,u,c,l,f,h,v,d,p,m,b,g,w,y,C,A,c,v,o=t.valueFieldsInfo,a=t.columnModel,s=t.columnDeep,u=t.columnValuePosition,c=t.sharedMap,l=o.length,f=e.zEt,h=e.YAt,v=e.nodeName,d=e.lYt,p=e.rYt;if(!(s-1<h&&0!==s))if(b=(0,O.FZt)(c,p,v),g=t.pt.collapse(p,b),r&&h<=u)for(w=g?n:n+(e.KZt+e.vYt-1)*l,y=0;y<l;y++)C=o[y].name,m=0===s?g?b:f?C:b+" "+C:g?b:f?E().Total+" "+C:b+" "+C,a.Kbt(i,w+y,m),A={path:d,valueFieldName:C,grandTotalLevel:h,showDataAsIndex:e.QZt,rowPathMap:t.subtotalCollection.WZt(e.zZt)},f?A.isGrandTotal=!0:A.isSubtotal=!0,a.WWt[w+y]=A;else c=g?n:n+e.KZt+e.XZt-1,m=0===s?o[0]&&o[0].name||"":g?b:f?E().GrandTotal:b+E().Total,a.Kbt(i,c,m),v=void 0,A={path:d,valueFieldName:v=1===o.length?o[0].name:v,grandTotalLevel:h,showDataAsIndex:e.QZt,rowPathMap:t.subtotalCollection.WZt(e.zZt)},f?A.isGrandTotal=!0:A.isSubtotal=!0,a.WWt[c]=A},h.dYt=function(t,i,n,e){var r=new j.Style;return r.textIndent=i,r.hAlign=0,r.cellButtons=[{position:void 0===n?j.ButtonPosition.left:n,imageType:j.ButtonImageType.custom,command:"PivotOutlineButtonToggle",visibility:j.ButtonVisibility.always,useButtonStyle:!1,enabled:!0,buttonBackColor:"transparent",hoverBackColor:"transparent",imageSrc:t?c:u,imageSize:{width:18,height:18}}],r},h.pYt=function(t){var i=new j.Style;return i.textIndent=t,i},h.Gn=function(t,i,n){var e,r,t,o,t,o,e=t.rowDeep,r=t.rowValuePosition,t=t.options,o=t.rowLabelIndent,t=t.showDrill,o=o*i*2;return n&&t&&(1<e||1===e&&-1!==r)&&(o+=3),o},h.aYt=function(t,i){var n=new j.Style;return n.cellButtons=[{position:void 0===i?j.ButtonPosition.left:i,command:"PivotOutlineButtonToggle",imageType:j.ButtonImageType.custom,visibility:j.ButtonVisibility.always,useButtonStyle:!1,enabled:!0,buttonBackColor:"transparent",hoverBackColor:"transparent",imageSrc:t?c:u,imageSize:{width:18,height:18}}],n},h.RZt=function(t,i,n,e){var e,i,t;return e?(e=0,i&&(i.sortType===F.SortType.asc&&(e=1),i.sortType===F.SortType.desc)&&(e=2),i=t?[3,4,5][e]:e,(t=new j.Style).cellButtons=[(0,r.getFilterCellButtonInfo)(i,n)],t):{}},h.mYt=function(t){var t,i,t=t?"0px 0px 0px 25px":void 0,i=new j.Style;return i.cellPadding=t,i},S.PivotTableLayoutBase=h},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-compact-layout.js":function(t,i,n){"use strict";var e,L,E,N,B,I,r,F,R,T,G,n,V,o,a,U;function s(){return null!==U&&U.apply(this,arguments)||this}e=this&&this.__extends||(a=function(t,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}a(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTableCompactLayout=void 0,L=n("Pivot"),E=n("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),N=n("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js"),B=n("./dist/plugins/pivot/pivot-util.js"),I=n("@spreadjs/js-sheets-common"),r=n("./dist/plugins/pivot/pivot.ns.js"),F=n("Core"),R=n("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),T=n("@spreadjs/js-calc"),G=I.Common.lt.ht,n=new I.Common.ResourceManager(r.SR,"PivotTables"),V=n.getResource.bind(n),U=N.PivotTableLayoutBase,e(s,U),s.kZt=function(t){var i,n,e,r,o,a,s,u,c,l,f,h,n,v,l,d,p,m,i=t.cornerModel,n=t.columnModel,e=t.rowModel,r=t.valueFieldsInfo,o=t.rowFields,a=t.options,s=t.showHeaders,u=t.colFields,c=t.rowValuePosition,l=t.pt,f=t.hideValuesRow,h=t.dataCaption,n=n.Sx,v=l.dh;i.setRowCount(n),i.setColCount(e.Tx),l=(0,N.getValuesRowOffset)(f,h,r.length,u.length),0<o.length?(1!==r.length||u.length<1&&!s||i.Kbt(0+l,0,r[0].name),s&&(G(a.rowHeaderCaption)?i.Kbt(n-1,0,V().RowLabels):i.Kbt(n-1,0,a.rowHeaderCaption),d=!1,m=[],(p=null,L.o)(o,function(t){d=d||v.isFilter(t.a),p=p||t.nrt,m.push(t.Zc)}),i.qWt(n-1,0,this.RZt(d,p,24,t.options.showFilter)),i.JWt(0,{isCompactRoot:!0,fieldName:o[0]&&o[0].Zc||""}),e.JWt(0,{isCompactRoot:!0,compactFieldList:m}),e.WWt)&&o[o.length-1]&&(e.WWt[0]={path:o[o.length-1].Zc})):0<=c&&s&&i.Kbt(i.Sx-1,0,V().Values)},s.tYt=function(r,t,i,o){var a,s,a=this;G(o.options.colHeaderCaption)?r.Kbt(0,0,0<t.length?V().ColumnLabels:V().Values):r.Kbt(0,0,o.options.colHeaderCaption),s=o.pt.dh,r.JWt(0,{isCompactRoot:!0,fieldName:t[0]&&t[0].Zc}),(0,L.o)(t,function(t,i){var n=t.Zc,e=s.isFilter(t.a),t=t.nrt;r.zWt[i+1]={path:n},0===i&&r.qWt(0,i,a.RZt(e,t,30,o.options.showFilter))})},s.xZt=function(t){var i,n,e,r,o,a,s,u,c,l,f,h,v,d,p,m,b,g,c,r,i=t.rootNode,n=t.options,e=t.valueFieldsInfo,r=t.rowFields,o=t.colFields,a=t.rowValuePosition,s=t.hideValuesRow,u=t.dataCaption,c=0<r.length?1:0;for(0===c&&1===e.length&&0<o.length&&(c=1),0===r.length&&-1<t.rowValuePosition&&(c+=1),t.rowModel.setColCount(c),l=[],f={},h=[],v=0,d=r;v<d.length;v++)p=d[v],h.push(p.Zc);for(-1!==a&&h.splice(a,0,V().Values),m=(0,N.getValuesRowOffset)(s,u,e.length,o.length),b=0,g=h.length;b<g;b++)f[h[b]]=b+m,l.push(h[b]);t.rowFieldsIndexes=l,t.rowFieldsMap=f,c=n.subTotalsPosition===E.SubtotalsPosition.bottom,r=this.bYt(t,i,c,0,e),t.rowModel.setRowCount(r),t.contentModel.setRowCount(r)},s.gYt=function(t,i){var n,e,r,e,r,e,n=i.KZt+i.wYt,e=t.options,r=e.subTotalsPosition,e=e.grandTotalPosition;return r===E.SubtotalsPosition.top?(n+=i.yYt,0<i.kpi&&(n+=i.kpi)):r===E.SubtotalsPosition.bottom&&(n+=i.vYt),n=i.zEt&&(r=r!==E.SubtotalsPosition.none,e=e!==E.GrandTotalPosition.none&&e!==E.GrandTotalPosition.row,r&&!e?n-=-1===t.rowValuePosition?1:t.valueFieldsInfo.length:(!r&&e||e&&0===i.vYt)&&(n+=-1===t.rowValuePosition?1:t.valueFieldsInfo.length),0===t.rowFields.length)?i.KZt+i.wYt:n},s.CYt=function(t,i){var t;return 0!==t.rowValuePosition&&i.YAt<=t.rowValuePosition?t.options.subTotalsPosition===E.SubtotalsPosition.none?i.IYt:i.AYt:t.options.subTotalsPosition===E.SubtotalsPosition.bottom?i.AYt:(t=i.IYt,0<i.jpi&&(t+=i.jpi),t)},s.bYt=function(t,i,n,e,r){var o,a,s,u,c,l,f,h,v,d,p,m,b,g,w,y,y,c,C,A,N,v,I,T,S,x,M,D,k,j,O,h,v,w,c,h,b,_,f,v,y,o=t.rowModel,a=t.rowValuePosition,s=t.rowDeep,u=t.options,c=t.sharedMap,l=t.rowFieldsIndexes,f=t.rowFieldsMap,h=i.eYt,v=i.nodeName,d=i.YAt,p=i.zEt,m=i.lYt,b=i.rYt,g=1,w=0;if(-1!==a&&(d<=a?g=r.length:w=1),y=(y=t.pt.dh.getFieldInfoByName(b))&&y.Spi,c=(0,B.FZt)(c,b,v),C=e,A=t.pt.collapse(i.rYt,c)&&d!==s,v=d<s,h){if(p||t.repeatValueFiledChildLength++,!p&&0!==a){for(N={path:m,isValueFieldDim:!1},t.valuePositionInfo&&0===t.valuePositionInfo.positionType&&t.valuePositionInfo.display?N.compactLevel=(0,R.in)(t.rowFields,b,{valuePositionIndex:t.valuePositionInfo.positionIndex,Zc:r[0].name}):N.compactLevel=i.YAt-1,v&&(N.rowHeaderLevel=this.fYt(s,d+w,g)),this.OZt(o,C,N),T=0,S=(I=i.lYt.split(L.Separator)).length;T<S;T++)o.tZt(C,l[T],(0,B.FZt)(t.sharedMap,l[T],I[T]),l.length-T);o.Kbt(C,0,c),i.oYt&&0<i.oYt.length&&i.YAt<t.rowDeep&&t.options.showDrill?o.qWt(C,0,this.aYt(A,F.ButtonPosition.leftOfText)):o.qWt(C,0,this.pYt(U.Gn.call(this,t,i.YAt-1,!0))),C++}for(x=void 0,D=!1,k=M=0,j=r;k<j.length;k++){if(O=j[k],o.Kbt(C,0,O.name),o.qWt(C,0,this.pYt(U.Gn.call(this,t,a,0!==a))),x={path:m,grandTotalLevel:d,valueFieldName:O.name,isValueFieldDim:!(i.oYt&&0<i.oYt.length&&i.YAt<t.rowDeep),rowHeaderLevel:this.fYt(s,d,g),isSigmaValue:!0},t.valuePositionInfo&&0===t.valuePositionInfo.positionType&&t.valuePositionInfo.display?x.compactLevel=(0,R.in)(t.rowFields,O.name,{valuePositionIndex:t.valuePositionInfo.positionIndex,Zc:O.name}):N.compactLevel=i.YAt-1,this.OZt(o,C,x),i.YAt<s)for(I=i.lYt.split(L.Separator),0<=a&&a<=d&&I.splice(a,null,O.name),T=0,S=I.length;T<S;T++)I[T]&&o.tZt(C,l[T],l[T]!==V().Values?(0,B.FZt)(t.sharedMap,l[T],I[T]):I[T],l.length-T);C++,A?i.YAt<=a&&a<s&&!p&&u.insertBlankLineAfterEachItem&&(this.NYt(t,i,o.zWt.length),C++,M++,D=!0):(i.zEt&&0===s&&0===a&&(this.TYt(t,i,C-1,"",r),e=r.length),C+=this.MYt(t,i,n,C,[O]),!i.zEt&&d<s&&u.insertBlankLineAfterEachItem&&i.oYt&&0===i.oYt[0].AYt&&(C++,this.NYt(t,i,o.zWt.length)))}if(d===s&&u.insertBlankLineAfterEachItem&&(C++,this.NYt(t,i,o.zWt.length)),A)return(g=this.xYt(t,i,C-r.length-M,r,g,void 0,0,!0,D))+1}else{if(!p){if(o.Kbt(C,0,c),N={path:m,grandTotalLevel:d,valueFieldName:r[0]&&r[0].name},v&&(N.rowHeaderLevel=this.fYt(s,d+w,g)),h=-1!==t.rowValuePosition&&i.YAt>t.rowValuePosition?i.YAt:i.YAt-1,i.oYt&&0<i.oYt.length&&i.YAt<t.rowDeep?(N.isValueFieldDim=!1,t.options.showDrill?o.qWt(C,0,this.dYt(t.pt.collapse(i.rYt,c),U.Gn.call(this,t,h),F.ButtonPosition.leftOfText)):o.qWt(C,0,this.pYt(U.Gn.call(this,t,h)))):(N.isValueFieldDim=!0,o.qWt(C,0,this.pYt(U.Gn.call(this,t,h,!0)))),t.valuePositionInfo&&0===t.valuePositionInfo.positionType&&t.valuePositionInfo.display?N.compactLevel=(0,R.in)(t.rowFields,b,{valuePositionIndex:t.valuePositionInfo.positionIndex,Zc:r[0].name}):N.compactLevel=i.YAt-1,this.OZt(o,C,N),i.YAt<s)for(I=i.lYt.split(L.Separator),0<=a&&a<d&&(v=f[V().Values],I.splice(v,null,r[0].name)),T=0,S=I.length;T<S;T++)o.tZt(C,l[T],l[T]!==V().Values?(0,B.FZt)(t.sharedMap,l[T],I[T]):I[T],l.length-T);if(A)return 1<r.length&&t.rowValuePosition>d?(g=this.xYt(t,i,++C,r,g,void 0,0,!0))+1:this.xYt(t,i,C,r,g,void 0,0);C++}this.MYt(t,i,n,C,r)}return w=(0,B.getActualSubtotalPosition)(u.subTotalsPosition,y),c=0,h=this.gYt(t,i),u.insertBlankLineAfterEachItem&&(h+=c=this.CYt(t,i)),b=e+h-g,f=!0,(v=s||!r.length?w:E.SubtotalsPosition.bottom)===E.SubtotalsPosition.bottom||v===E.SubtotalsPosition.top&&d<a||u.subTotalsPosition===E.SubtotalsPosition.top&&p?b=e+h-g:v===E.SubtotalsPosition.top&&a<=d?(b=e,_=!0,d===a&&(b=e+h-g,_=!1)):u.subTotalsPosition!==E.SubtotalsPosition.none||!p||u.grandTotalPosition!==E.GrandTotalPosition.both&&u.grandTotalPosition!==E.GrandTotalPosition.col?f=!1:b=e+h-g,f?(!_&&u.insertBlankLineAfterEachItem&&i.AYt&&!p&&b--,0===s&&p?(y=r[0]&&r[0].name||"",o.Kbt(b,0,y),-1===a&&(x={path:m,rowHeaderLevel:this.fYt(s,d,g)},this.OZt(o,b,x)),this.ZZt(t,b,i,r,"")):this.xYt(t,i,b,r,void 0,_)):u.subTotalsPosition===E.SubtotalsPosition.none&&t.options.insertBlankLineAfterEachItem&&0<c&&this.NYt(t,i,b),h},s.xYt=function(t,i,n,e,r,o,a,s,u){var c,l,f,h,v,d,p,m,b,g,w,y,C,C,A,N,n,h,b,I,C,T,S,x,M,D,k,j,O,_,F,j,P,P,c=t.rowDeep,l=t.rowModel,f=t.rowValuePosition,h=t.sharedMap,v=t.options,d=t.rowFieldsMap,p=t.rowFieldsIndexes,m=i.YAt,b=i.nodeName,g=i.zEt,w=i.lYt,y=i.rYt;if(!g||t.options.grandTotalPosition!==E.GrandTotalPosition.none&&t.options.grandTotalPosition!==E.GrandTotalPosition.row){if(C=(C=t.pt.dh.getFieldInfoByName(y))&&C.Spi,m<c||0===c){if(-(A=1)!==f&&m<=f&&(A=e.length),n=N=n,h=(0,B.FZt)(h,y,b),N>=l.Sx)return;if(b=void 0,b=g?1<e.length&&0<=f?V().Total:V().GrandTotal:1<e.length&&0<=f||(0,B.getActualSubtotalPosition)(v.subtotalsPosition,C)!==E.SubtotalsPosition.bottom?h:h+V().Total,0===c&&(b=e[0]&&e[0].name||""),I=t.pt.collapse(i.rYt,h)?f<=0?h:"":b,C=-1!==t.columnValuePosition,T={path:w,rowHeaderLevel:this.fYt(c,m,A),grandTotalLevel:m},(0,L.ht)(a)||(T.collapseIndex=a),g?T.isGrandTotal=!0:T.isSubtotal=!0,t.valuePositionInfo&&0===t.valuePositionInfo.positionType&&t.valuePositionInfo.display?T.compactLevel=(0,R.in)(t.rowFields,y,{valuePositionIndex:t.valuePositionInfo.positionIndex,Zc:e[0].name}):T.compactLevel=i.YAt-1,C){for(l.Kbt(N,0,I),x=0,M=(S=i.lYt.split(L.Separator)).length;x<M-1;x++)l.tZt(N,p[x],p[x]!==V().Values?(0,B.FZt)(t.sharedMap,p[x],S[x]):S[x],p.length-x);this.DYt(l,N,U.Gn.call(this,t,T.rowHeaderLevel-1)),this.OZt(l,N,T),this.GZt(t,i,N,w)}else{if(0===t.valueFieldsInfo.length){if(!o){for(l.Kbt(N,0,I),x=0,M=(S=i.lYt.split(L.Separator)).length;x<M-1;x++)l.tZt(N,p[x],p[x]!==V().Values?(0,B.FZt)(t.sharedMap,p[x],S[x]):S[x],p.length-x);this.DYt(l,N,U.Gn.call(this,t,T.rowHeaderLevel-1))}this.OZt(l,N,T)}for(D=0,k=e;D<k.length;D++){for(O=(j=k[D]).name,_=j.cacheName,F=j.subtotalType,j=j.subtotalText,T={path:w,rowHeaderLevel:this.fYt(c,m,A),grandTotalLevel:m,valueFieldName:O},(0,L.ht)(a)||(T.collapseIndex=a),s&&(T.collapse=!0),u||(1<A?l.Kbt(N,0,I+" "+O):l.Kbt(N,0,I)),S=i.lYt.split(L.Separator),0<=f&&f<m&&(P=d[V().Values],S.splice(P,null,O)),x=0,M=S.length;x<M-1;x++)l.tZt(N,p[x],p[x]!==V().Values?(0,B.FZt)(t.sharedMap,p[x],S[x]):S[x],p.length-x);P=-1!==t.rowValuePosition&&i.YAt>t.rowValuePosition?i.YAt:i.YAt-1,this.DYt(l,N,U.Gn.call(this,t,P)),g?T.isGrandTotal=!0:T.isSubtotal=!0,t.valuePositionInfo&&0===t.valuePositionInfo.positionType&&t.valuePositionInfo.display?T.compactLevel=(0,R.in)(t.rowFields,i.eYt?O:y,{valuePositionIndex:t.valuePositionInfo.positionIndex,Zc:O}):T.compactLevel=i.YAt-1,this.OZt(l,N,T),this.GZt(t,i,N,w,_,F,j,O),N++,u&&(N++,r++)}}this.ZZt(t,n,i,e)}return g||!v.insertBlankLineAfterEachItem||u||(this.NYt(t,i,l.zWt.length),G(r))||r++,r}},s.NYt=function(t,i,n){var e,t,r,i,e=t.rowDeep,t=t.rowModel,r=i.YAt,i=i.lYt;(r<=e||0===e)&&this.OZt(t,n,{path:i,isBlankRow:!0})},s.DYt=function(t,i,n){var e=t.ML(i,0)||new F.Style;e.h5(this.pYt(n)),t.qWt(i,0,e)},s.MYt=function(t,i,n,e,r){var o,a,s,u,c,l,f,h,v,d,p,m,b,g,w,y,C,A,A,o=t.rowDeep,a=t.rowValuePosition,s=t.rowFieldsIndexes,u=t.rowModel,c=i.oYt,l=i.YAt,f=c.length;if(o<=l)for(h=i.lYt.split(L.Separator),0<=a&&!G(r)&&h.splice(a,null,r[0].name),v=0,d=h.length;v<d;v++)h[v]&&u.tZt(e-1,s[v],s[v]!==V().Values?(0,B.FZt)(t.sharedMap,s[v],h[v]):h[v],s.length-v);if((p=0)<f)for(m=e,b=0,g=c;b<g.length;b++)y=0,o<(C=(w=g[b]).YAt)?(A=m-1,i.zEt&&0===o&&0<t.columnDeep&&-1===a&&(A=m),this.TYt(t,w,A,"",r)):(C===o&&(A=w.eYt?m+1:m,this.ZZt(t,A,w,r)),p+=y=this.bYt(t,w,n,m,r),m+=y);return p},s.TYt=function(t,i,n,e,r){var o,a,s,u,c,l,f,h,v,d,p,m,d,b,b,g,w,y,C,A,o=t.columnValuePosition,a=t.contentModel,s=t.colMap,u=i.oYt,c=i.nodeName,l=i.HZt;if(""!==e&&(e+=L.Separator),f=-1!==o,0===u.length)for(h=0,v=r;h<v.length;h++)p=(d=v[h]).name,m=d.cacheName,d=d.subtotalText,b=e,0!==t.columnDeep&&(b+=c),f&&(""!==b?b+=L.Separator+p:b=p),b=s[b],G(b)||(g=!1,g=!!((w=t.subtotalCollection.CZt[p])&&(w.needBuildRunningTotalOrRankPath&&(i.UZt[p].indexInfo.minorPath=i.SYt),8===w.showDataAs||9===w.showDataAs)&&0<(w.showDataAsIndex&i.QZt))||g)||a.Kbt(n,b,I.Common.st.E8((0,N.hZt)(t.subtotalCollection,l,m,d,i.UZt,i.YAt,p),T.Functions.CALC_PRECISION||14));else for(y=0,C=u;y<C.length;y++)A=C[y],this.TYt(t,A,n,e+c,r);i.kYt||this.ZZt(t,n,i,r,e+c)},s.uit=E.PivotTableLayoutType.outline,i.PivotTableCompactLayout=s},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-empty-layout.js":function(t,i){"use strict";var m,n,e;function r(t,i,n,e,r,o,a,s){var u,c,l,f,h,v,d,p,m,b,g,a;o<3||r<3||(u=.125,c=.08,l=.75,f=20,h=11,p=o/(v=194),m=r/(d=362),b=r-2,g=0,t.save(),t.rect(a.x,a.y,a.width,a.height),t.clip(),1<b&&(t.translate(n,e),w(t,o,r),b-=2),0<b&&(t.translate((o-2)*u,.08*(r-2)),y(t,.75*o,20,i),b-=.08*(r-2)+20),0<b&&(t.translate(.75*(o-2)/2,.08*(r-2)),b-=.08*(r-2)+(g=C(t,o,s))),0<b&&(t.translate(0,.9*(a=.7*b)),A(t,o-11*p,a,Math.min(p,m))),t.restore())}function w(t,i,n){t.save(),t.strokeStyle=m.frameColor,t.lineWidth=m.frameLineWidth,t.strokeRect(0,0,i,n),t.fillStyle=m.tableHeadLine,t.fillRect(0,0,i,n),t.restore()}function y(t,i,n,e){var r=.5;t.save(),t.strokeStyle=m.frameColor,t.lineWidth=m.inputLineWidth,t.strokeRect(0,0,i,n),t.rect(1,0,i-2,n),t.clip(),t.translate(.5*i,0),s(t,e),t.restore()}function C(t,i,n){for(var e,r,o,a,e=10,r=20,o=h(n,i-10,m.font),a=0;a<o.length;a++)t.translate(0,20),s(t,o[a]);return 20*o.length}function s(t,i){t.save(),t.textBaseline=m.nameBaseline,t.textAlign=m.textAlign,t.font=m.font,t.fillStyle=m.nameColor,t.fillText(i,0,4),t.restore()}function A(t,i,n,e){a(t,i,n),o(t,e)}function o(t,i){var n=180,e=152,r=63,o=54,a=70,s=152,u=32;t.save(),t.translate(-180*i*.5,-152*i*.5),c(t,63,54,i),t.translate(110*i,0),l(t,70,152,i),t.translate(-2*i,64*i),f(t,32,i),t.restore()}function c(t,i,n,e){var r,o,a,s,u,c,l,f,h,v,d,p,r=8,o=13,a=7,s=2,u=4,c=5,l=49,f=45;for(t.save(),t.scale(e,e),b(t,0,0,13,8,m.tableHeadColor,!0),b(t,3,3,7,2,m.tableHeadLine,!0),b(t,14,0,49,8,m.tableHeadColor,!0),d=v=h=0;d<4;d++)b(t,h=12*d+17,3,7,2,m.tableHeadLine,!0);for(b(t,0,9,13,45,m.tableHeadColor,!0),d=0;d<7;d++)b(t,3,v=6*d+12,7,2,m.tableHeadLine,!0);for(b(t,14,9,49,45,m.tableContentRim,!0),d=0;d<7;d++)for(v=6*d+8+4,p=0;p<4;p++)b(t,h=12*p+17,v,7,2,m.tableContent,!0);t.restore()}function l(t,i,n,e){var r,o,a,s,u,c,l,f,h,r=57,o=55,a=7,s=41,u=3;for(t.save(),t.scale(e,e),b(t,0,0,i,n,m.tableContentRim,!0),b(t,8,8,41,3,m.tableHeadColor,!0),b(t,7,19,57,55,m.recordBookFrameColor,!1),b(t,8,20,55,53,m.tableHeadLine,!0),l=c=0;l<9;l++)b(t,11,c=26+5*l,2,2,m.recordColor,!0),b(t,14,c,42,2,m.recordColor,!0);for(b(t,8,82,41,3,m.tableHeadColor,!0),l=f=0;l<2;l++)for(f=92+30*l,h=0;h<2;h++)b(t,c=7+31*h,f,26,24,m.recordBookFrameColor,!1),b(t,c+1,1+f,24,22,m.tableHeadLine,!0);t.restore()}function f(t,i,n){t.save(),t.scale(n,n),t.beginPath(),t.save(),t.arc(0,0,i,0,2*Math.PI,!0),t.clip(),t.arc(0,0,i,0,2*Math.PI,!0),t.strokeStyle=m.MagnifierFrameColor,t.stroke(),t.arc(0,0,i-1,0,2*Math.PI,!0),t.clip(),t.arc(0,0,i-1,0,2*Math.PI,!0),t.fillStyle=m.tableHeadLine,t.fill();for(var e=0,r=0;r<3;r++)b(t,-16,-(e=24-18*r),13,13,m.tableContent,!1),b(t,1,4-e,35,5,m.recordColor,!0);u(t,-15,-6,11),t.restore(),t.restore()}function a(t,i,n){t.save(),t.fillStyle=m.tableHeadLine,t.fillRect(.5*-i,.5*-n,i,n),t.restore()}function b(t,i,n,e,r,o,a){t.save(),t.translate(i,n),a?(t.fillStyle=o,t.fillRect(0,0,e,r)):(t.strokeStyle=o,t.strokeRect(0,0,e,r)),t.restore()}function u(t,i,n,e){t.save();var e=e;t.translate(Math.round(i+e/2),Math.round(n+e/2)),t.strokeStyle="red",t.rotate(-.25*Math.PI),t.beginPath(),t.fillStyle=m.tickColor,t.fillRect(.375*-e,.25*-e,.2*e,.5*e),t.closePath(),t.fill(),t.beginPath(),t.fillStyle=m.tickColor,t.fillRect(.375*-e,.05*e,.75*e,.2*e),t.closePath(),t.fill(),t.stroke(),t.restore()}function h(t,i,n){var e,r,o,a,s,u,e=[];if(t&&0<t.length){for(r=t.split(/\r\n|\r|\n/),(o=p()).save(),n&&(o.font=n),a=0,s=r.length;a<s;a++)(u=v(o,r[a],i))&&(0===u.length?e.push(""):u.forEach(function(t){e.push(t)}));o.restore()}return e}function v(t,i,n){var e,r,o,a,s,u,c,l,f,h,v,e=i.split(" "),r=[],o="",a=0,s=t.measureText(" ").width;if(1===i.length)return e;for(u=0,c=e.length;u<c;u++)l=e[u],n<(f=t.measureText(l).width)?(0<o.length&&r.push(o),(h=d(t,e[u],n,f)).forEach(function(t){r.push(t)}),o="",a=0):(v=o+l,o=n<(a+=f+s)?a-s<=n?(r.push(v),a=0,""):(r.push(o),n<(a=f+s)?(r.push(l),a=0,""):l+" "):v+" ");return 0<o.length&&r.push(o),r}function d(t,i,n,e){var r,o,a,s,u,c,l,r=Math.ceil(e/n),o=i.length/r,a=[];for(r=0;0<n&&r<i.length;){for(s=i.substring(r,r+o),c=(u=t.measureText(s).width)<=n?1:-1,l=0;(u<n&&0<c||n<u&&c<0)&&!(r+o+(l+=c)>=i.length||r+o+l===0);)s=i.substring(r,r+o+l),u=t.measureText(s).width;if(!(r<r+o+(l-=c)))break;a.push(i.substring(r,r+o+l)),r=r+o+l}return a}function p(){var t,i,t=e;return t||((i=document.createElement("canvas")).hidden=!0,i.width=1,i.height=1,document.body.appendChild(i),e=t=(n=i).getContext("2d")),t}Object.defineProperty(i,"__esModule",{value:!0}),i.jYt=void 0,m={frameColor:"rgba(100,100,100,1)",nameColor:"rgba(50,50,50,1)",panelTitleColor:"rgba(50,50,50)",tableHeadColor:"rgba(77,130,184,1)",tableHeadLine:"rgba(255,255,255,1)",tableContent:"rgba(128,128,128,1)",tableContentRim:"rgba(193,211,230,1)",recordBookFrameColor:"rgba(153,183,214,1)",recordColor:"rgba(179,179,179,1)",MagnifierFrameColor:"rgba(196,213,231,1)",tickColor:"rgba(216,99,68,1)",font:"12px Regular",textAlign:"center",nameBaseline:"hanging",frameLineWidth:2,inputLineWidth:2},i.jYt=r},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-outline-layout.js":function(t,i,n){"use strict";var e,B,R,N,G,I,r,T,V,n,U,o,a,s;function u(){return null!==s&&s.apply(this,arguments)||this}e=this&&this.__extends||(a=function(t,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}a(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTableOutlineLayout=void 0,B=n("Pivot"),R=n("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),N=n("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js"),G=n("./dist/plugins/pivot/pivot-util.js"),I=n("@spreadjs/js-sheets-common"),r=n("./dist/plugins/pivot/pivot.ns.js"),T=n("@spreadjs/js-calc"),V=I.Common.lt.ht,n=new I.Common.ResourceManager(r.SR,"PivotTables"),U=n.getResource.bind(n),s=N.PivotTableLayoutBase,e(u,s),u.kZt=function(o){var a,s,t,u,i,c,l,n,e,r,f,h,v,t,d,h,p,a=this,s=o.cornerModel,t=o.columnModel,u=o.rowModel,i=o.valueFieldsInfo,c=o.rowFieldsMap,l=o.pt,n=o.rowFields,e=o.showHeaders,r=o.colFields,f=o.rowValuePosition,h=o.hideValuesRow,v=o.dataCaption,t=t.Sx,d=l.dh;s.setRowCount(t),s.setColCount(u.Tx),h=(0,N.getValuesRowOffset)(h,v,i.length,r.length),0<n.length?(1!==i.length||r.length<1&&!e||s.Kbt(0+h,0,i[0].name),e&&(p=t-1,(0,B.o)(Object.keys(c),function(t){var i,n,e,r,e,i=c[t];s.Kbt(p,i,t),(n=t!==U().Values)&&(e=l.zRt(t),r=d.isFilter(e.a),e=e.nrt,s.qWt(p,i,a.RZt(r,e,30,o.options.showFilter))),s.JWt(i,{isCompactRoot:!1,fieldName:t,isDim:n}),u.WWt[i]={path:t}}))):0<=f&&e&&s.Kbt(s.Sx-1,0,U().Values)},u.tYt=function(o,t,i,a){var s,n,s=this,n=[];(0,B.o)(t,function(t){n.push({name:t.Zc,isFilter:a.pt.dh.isFilter(t.a),isDim:!0,sortInfo:t.nrt})}),-1!==i&&n.splice(i,0,{name:U().Values,isFilter:!1,isDim:!1}),(0,B.o)(n,function(t,i){var n=t.name,e=t.isDim,r=t.isFilter,t=t.sortInfo;o.Kbt(0,i,n),o.zWt[i+1]={path:n},e&&o.qWt(0,i,s.RZt(r,t,30,a.options.showFilter)),o.JWt(i,{isCompactRoot:!1,fieldName:n})})},u.CYt=function(t,i){var t;return 0!==t.rowValuePosition&&i.YAt<=t.rowValuePosition?t.options.subTotalsPosition===R.SubtotalsPosition.none?i.IYt:i.AYt:t.options.subTotalsPosition===R.SubtotalsPosition.bottom?i.AYt:(t=i.IYt,0<i.jpi&&(t+=i.jpi),t)},u.gYt=function(t,i){var n,e,r,e,r,e,n=i.KZt+i.wYt,e=t.options,r=e.subTotalsPosition,e=e.grandTotalPosition;return r===R.SubtotalsPosition.top?(n+=i.yYt,0<i.kpi&&(n+=i.kpi)):r===R.SubtotalsPosition.bottom&&(n+=i.vYt),n=i.zEt&&(r=r!==R.SubtotalsPosition.none,e=e!==R.GrandTotalPosition.none&&e!==R.GrandTotalPosition.row,r&&!e?n-=-1===t.rowValuePosition?1:t.valueFieldsInfo.length:(!r&&e||e&&0===i.vYt)&&(n+=-1===t.rowValuePosition?1:t.valueFieldsInfo.length),0===t.rowFields.length)?i.KZt+i.wYt:n},u.xZt=function(t){var i,n,i;this.OYt(t),i=t.rootNode,n=t.valueFieldsInfo,i=this.bYt(t,i,0,n),t.rowModel.setRowCount(i),t.contentModel.setRowCount(i)},u.bYt=function(t,i,n,e){var r,o,a,s,u,c,l,f,h,v,d,p,m,b,g,w,y,w,C,A,N,I,T,S,x,M,D,k,j,O,u,h,v,f,_,w,r,b,r=t.rowFieldsMap,o=t.rowModel,a=t.rowValuePosition,s=t.options,u=t.sharedMap,c=t.rowDeep,l=t.rowFieldsIndexes,f=i.eYt,h=i.rYt,v=i.nodeName,d=i.YAt,p=i.zEt,m=i.lYt,b=r[h],g=1;if(-1!==a&&d<=a&&(g=e.length),y=(w=t.pt.dh.getFieldInfoByName(h))&&w.Spi,w=(0,G.FZt)(u,h,v),C=n,A=t.pt.collapse(i.rYt,w)&&d!==c,f){if(p||t.repeatValueFiledChildLength++,N=r[U().Values],!p&&0!==a){for(o.Kbt(C,b,w),this.OZt(o,C,{path:m,isValueFieldDim:!1,rowHeaderLevel:this.fYt(c,d,g)}),T=0,S=(I=i.lYt.split(B.Separator)).length;T<S;T++)o.tZt(C,l[T],(0,G.FZt)(t.sharedMap,l[T],I[T]),l.length-T);i.oYt&&0<i.oYt.length&&i.YAt<t.rowDeep&&t.options.showDrill&&o.qWt(C,b,this.aYt(A)),C++}for(x=void 0,D=!1,k=M=0,j=e;k<j.length;k++){if(O=j[k],o.Kbt(C,N,O.name),x={path:m,rowHeaderLevel:this.fYt(c,d,g),isValueFieldDim:!(i.oYt&&0<i.oYt.length&&i.YAt<t.rowDeep),valueFieldName:O.name},this.OZt(o,C,x),i.YAt<c)for((I=i.lYt.split(B.Separator)).splice(N,null,O.name),T=0,S=I.length;T<S;T++)I[T]&&o.tZt(C,l[T],l[T]!==U().Values?(0,G.FZt)(t.sharedMap,l[T],I[T]):I[T],l.length-T);C++,A?i.YAt<=a&&a<c&&!p&&s.insertBlankLineAfterEachItem&&(this.NYt(t,i,o.zWt.length),C++,M++,D=!0):(i.zEt&&0===c&&0===a&&(this.TYt(t,i,C-1,"",e),n=e.length),C+=this.MYt(t,i,C,[O],y),!i.zEt&&d<c&&s.insertBlankLineAfterEachItem&&i.oYt&&0===i.oYt[0].AYt&&(C++,this.NYt(t,i,o.zWt.length)))}if(d===c&&s.insertBlankLineAfterEachItem&&(C++,this.NYt(t,i,o.zWt.length)),A)return(g=this.xYt(t,i,C-e.length-M,e,g,void 0,b,!0,D))+1}else{if(!V(b)){if(o.Kbt(C,b,w),x={path:m,rowHeaderLevel:this.fYt(c,d,g),valueFieldName:e[0]&&e[0].name},i.oYt&&0<i.oYt.length&&i.YAt<t.rowDeep?(x.isValueFieldDim=!1,t.options.showDrill&&o.qWt(C,b,this.aYt(t.pt.collapse(i.rYt,w)))):x.isValueFieldDim=!0,this.OZt(o,C,x),i.YAt<c)for(I=i.lYt.split(B.Separator),0<=a&&a<d&&(N=r[U().Values],I.splice(N,null,e[0].name)),T=0,S=I.length;T<S;T++)o.tZt(C,l[T],l[T]!==U().Values?(0,G.FZt)(t.sharedMap,l[T],I[T]):I[T],l.length-T);if(A)return d<a?(g=this.xYt(t,i,++C,e,g,!1,b,!0))+1:this.xYt(t,i,C,e,g,void 0,b);C++}this.MYt(t,i,C,e,y)}return u=(0,G.getActualSubtotalPosition)(s.subTotalsPosition,y),h=0,v=this.gYt(t,i),s.insertBlankLineAfterEachItem&&(v+=h=this.CYt(t,i)),f=n+v-g,w=!0,(r=c||!e.length?u:R.SubtotalsPosition.bottom)===R.SubtotalsPosition.bottom||r===R.SubtotalsPosition.top&&d<a||r===R.SubtotalsPosition.top&&p?f=n+v-g:r===R.SubtotalsPosition.top&&a<=d?(f=n,_=!0,d===a&&(f=n+v-g,_=!1)):s.subTotalsPosition!==R.SubtotalsPosition.none||!p||s.grandTotalPosition!==R.GrandTotalPosition.both&&s.grandTotalPosition!==R.GrandTotalPosition.col?w=!1:f=n+v-g,w?(!_&&s.insertBlankLineAfterEachItem&&i.AYt&&!p&&f--,0===c&&p?(b=e[0]&&e[0].name||"",o.Kbt(f,0,b),-1===a&&(x={path:m,rowHeaderLevel:this.fYt(c,d,g)},this.OZt(o,f,x)),this.ZZt(t,f,i,e,"")):this.xYt(t,i,f,e,void 0,_)):s.subTotalsPosition===R.SubtotalsPosition.none&&t.options.insertBlankLineAfterEachItem&&0<h&&this.NYt(t,i,f),v},u.xYt=function(t,i,n,e,r,o,a,s,u){var c,l,f,h,v,d,p,m,L,b,g,w,y,y,C,A,N,n,I,v,w,T,S,x,M,D,k,j,O,_,E,j,F,P,P,c=t.rowDeep,l=t.rowModel,f=t.rowFieldsMap,h=t.rowValuePosition,v=t.sharedMap,d=t.options,p=t.rowFieldsIndexes,m=i.YAt,L=i.nodeName,b=i.zEt,g=i.lYt,w=i.rYt;if(!i.zEt||t.options.grandTotalPosition!==R.GrandTotalPosition.none&&t.options.grandTotalPosition!==R.GrandTotalPosition.row){if(y=(y=t.pt.dh.getFieldInfoByName(w))&&y.Spi,m<c||0===c){if(C=b?0:f[i.rYt],-(A=1)!==h&&m<=h&&(A=e.length),(n=N=n)>=l.Sx)return;if(I=void 0,I=0===c?e[0]&&e[0].name||"":(v=(0,G.FZt)(v,w,L),t.pt.collapse(i.rYt,v)?v:b?1<e.length&&0<=h?U().Total:U().GrandTotal:1<e.length&&0<=h||e.length<2&&(0,G.getActualSubtotalPosition)(d.subtotalsPosition,y)===R.SubtotalsPosition.top?v:v+U().Total),w=-1!==t.columnValuePosition,T={path:g,rowHeaderLevel:this.fYt(c,m,A),grandTotalLevel:m},(0,B.ht)(a)||(T.collapseIndex=a),b?T.isGrandTotal=!0:T.isSubtotal=!0,w){if(!o)for(l.Kbt(N,C,I),x=0,M=(S=i.lYt.split(B.Separator)).length;x<M-1;x++)l.tZt(N,p[x],p[x]!==U().Values?(0,G.FZt)(t.sharedMap,p[x],S[x]):S[x],p.length-x);this.OZt(l,N,T),this.GZt(t,i,N,g)}else{if(0===t.valueFieldsInfo.length){if(!o)for(l.Kbt(N,C,I),x=0,M=(S=i.lYt.split(B.Separator)).length;x<M-1;x++)l.tZt(N,p[x],p[x]!==U().Values?(0,G.FZt)(t.sharedMap,p[x],S[x]):S[x],p.length-x);this.OZt(l,N,T)}for(D=0,k=e;D<k.length;D++){for(O=(j=k[D]).name,_=j.subtotalType,E=j.cacheName,j=j.subtotalText,T={path:g,rowHeaderLevel:this.fYt(c,m,A),grandTotalLevel:m,valueFieldName:O},(0,B.ht)(a)||(T.collapseIndex=a),s&&(T.collapse=!0),(P=F=void 0)===o||1<A?(F=h>=T.grandTotalLevel?I+" "+O:I,P=C):o?(F=I,s||(P=C)):(F=O,P=t.valuePositionInfo.positionIndex),u||l.Kbt(N,P,F),S=i.lYt.split(B.Separator),0<=h&&h<m&&(P=f[U().Values],S.splice(P,null,e[0].name)),x=0,M=S.length;x<M-1;x++)l.tZt(N,p[x],p[x]!==U().Values?(0,G.FZt)(t.sharedMap,p[x],S[x]):S[x],p.length-x);b?T.isGrandTotal=!0:T.isSubtotal=!0,this.OZt(l,N,T),this.GZt(t,i,N,g,E,_,j,O),N++,u&&(N++,r++)}}this.ZZt(t,n,i,e)}return b||!d.insertBlankLineAfterEachItem||u||(this.NYt(t,i,l.zWt.length),V(r))||r++,r}},u.NYt=function(t,i,n){var e,t,r,i,e=t.rowDeep,t=t.rowModel,r=i.YAt,i=i.lYt;(r<=e||0===e)&&this.OZt(t,n,{path:i,isBlankRow:!0})},u.MYt=function(t,i,n,e,r){var o,a,s,u,c,l,f,h,v,d,p,m,b,g,w,y,C,A,N,I,T,S,x,M,D,k,j,O,k,o=t.rowDeep,a=t.options,s=t.rowFieldsMap,u=t.rowModel,c=t.rowValuePosition,l=t.rowFieldsIndexes,f=1,h=i.oYt,v=i.YAt,d=h.length;if(o<=v)for(p=i.lYt.split(B.Separator),0<=c&&!V(e)&&p.splice(c,null,e[0].name),m=0,b=p.length;m<b;m++)p[m]&&u.tZt(n-1,l[m],l[m]!==U().Values?(0,G.FZt)(t.sharedMap,l[m],p[m]):p[m],l.length-m);if((g=0)<d)for(w=n,y=a.fillDownLabels,I=(N=A=C=void 0,G.getActualSubtotalPosition)(a.subTotalsPosition,r)===R.SubtotalsPosition.bottom?1:0,T=this.mYt(a.showDrill),S=0,x=h;S<x.length;S++)if(M=x[S],D=0,o<=v)k=w-1,i.zEt&&0===o&&0<t.columnDeep&&-1===c&&(k=w),this.TYt(t,M,k,"",e);else{if(D=this.bYt(t,M,w,e),y)for(C=s[M.rYt],N=D+w-I,A=u.Sl(w,C),j=void 0,O=w+1;O<N;O++)(j=u.zWt[O])&&!j.isBlankRow&&(!j.isSubtotal||v<j.grandTotalLevel-1)&&(u.Kbt(O,C,A),u.qWt(O,C,T));g+=D,v+1===o&&(k=M.eYt?w+1:w,this.ZZt(t,k,M,e)),w+=D}return g},u.TYt=function(t,i,n,e,r){var o,a,s,u,c,l,f,h,v,d,p,m,d,b,b,g,w,y,C,A,o=t.columnValuePosition,a=t.contentModel,s=t.colMap,u=i.oYt,c=i.nodeName,l=i.HZt;if(""!==e&&(e+=B.Separator),f=-1!==o,0===u.length)for(h=0,v=r;h<v.length;h++)p=(d=v[h]).name,m=d.cacheName,d=d.subtotalText,b=e,0!==t.columnDeep&&(b+=c),f&&(""!==b?b+=B.Separator+p:b=p),b=s[b],g=t.subtotalCollection.CZt[p],V(b)||(w=!1,w=!!(g&&(g.needBuildRunningTotalOrRankPath&&(i.UZt[p].indexInfo.minorPath=i.SYt),8===g.showDataAs||9===g.showDataAs)&&0<(g.showDataAsIndex&i.QZt))||w)||a.Kbt(n,b,I.Common.st.E8((0,N.hZt)(t.subtotalCollection,l,m,d,i.UZt,i.YAt,p),T.Functions.CALC_PRECISION||14));else for(y=0,C=u;y<C.length;y++)A=C[y],this.TYt(t,A,n,e+c,r);i.kYt||this.ZZt(t,n,i,r,e+c)},u.OYt=function(t){var i,n,e,r,o,a,s,u,c,l,f,h,v,d,i=t.rowModel,n=t.rowFields,e=t.rowValuePosition,r=t.valueFieldsInfo,o=t.colFields,a=n.length;for(0===a&&1===r.length&&0<o.length&&(a=1),s=[],u=0,c=n;u<c.length;u++)l=c[u],s.push(l.Zc);for(-1!==e&&(a+=1,s.splice(e,0,U().Values)),i.setColCount(a),f={},h=[],v=0,d=s.length;v<d;v++)f[s[v]]=v,h.push(s[v]);t.rowFieldsMap=f,t.rowFieldsIndexes=h},u.uit=R.PivotTableLayoutType.outline,i.PivotTableOutlineLayout=u},"./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-tabular-layout.js":function(t,i,n){"use strict";var e,G,V,N,I,r,U,T,Q,n,W,o,a,s;function u(){return null!==s&&s.apply(this,arguments)||this}e=this&&this.__extends||(a=function(t,i){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}a(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PivotTableTabularLayout=void 0,G=n("Pivot"),V=n("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),N=n("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-base-layout.js"),I=n("@spreadjs/js-sheets-common"),r=n("./dist/plugins/pivot/pivot.ns.js"),U=n("./dist/plugins/pivot/pivot-util.js"),T=n("@spreadjs/js-calc"),Q=I.Common.lt.ht,n=new I.Common.ResourceManager(r.SR,"PivotTables"),W=n.getResource.bind(n),s=N.PivotTableLayoutBase,e(u,s),u.kZt=function(o){var a,s,t,u,i,n,c,e,r,l,f,h,v,t,h,d,a=this,s=o.cornerModel,t=o.columnModel,u=o.rowModel,i=o.valueFieldsInfo,n=o.rowFieldsMap,c=o.pt,e=o.rowFields,r=o.showHeaders,l=o.colFields,f=o.rowValuePosition,h=o.hideValuesRow,v=o.dataCaption,t=t.Sx;s.setRowCount(t),s.setColCount(u.Tx),h=(0,N.getValuesRowOffset)(h,v,i.length,l.length),e.length?(1!==i.length||l.length<1&&!r||s.Kbt(0+h,0,i[0].name),r&&(d=t-1,(0,G.o)(Object.keys(n),function(t,i){var n,e,r,e;s.Kbt(d,i,t),(n=t!==W().Values)&&(e=c.zRt(t),r=c.dh.isFilter(e.a),e=e.nrt,s.qWt(d,i,a.RZt(r,e,30,o.options.showFilter))),s.JWt(i,{isCompactRoot:!1,fieldName:t,isDim:n}),u.WWt[i]={path:t}}))):0<=f&&r&&s.Kbt(s.Sx-1,0,W().Values)},u.tYt=function(o,t,i,a){var s,n,s=this,n=[];(0,G.o)(t,function(t){n.push({name:t.Zc,isFilter:a.pt.dh.isFilter(t.a),isDim:!0,sortInfo:t.nrt})}),-1!==i&&n.splice(i,0,{name:W().Values,isFilter:!1,isDim:!1}),(0,G.o)(n,function(t,i){var n=t.name,e=t.isDim,r=t.isFilter,t=t.sortInfo;o.Kbt(0,i,n),o.zWt[i+1]={path:n},e&&o.qWt(0,i,s.RZt(r,t,30,a.options.showFilter)),o.JWt(i,{isCompactRoot:!1,fieldName:n})})},u.xZt=function(t){var i,n,e,r,o,n;this.OYt(t),i=t.rootNode,n=t.options,e=t.valueFieldsInfo,r=t.rowModel,o=t.contentModel,n=n.subTotalsPosition!==V.SubtotalsPosition.none,this.bYt(t,i,n,0,e),r.setRowCount(r.zWt.length),o.setRowCount(r.zWt.length)},u.bYt=function(t,i,n,e,r){var o,a,s,u,c,l,f,h,v,d,p,m,b,g,w,y,c,C,A,N,I,T,S,x,M,D,k,h,j,O,v,f,c,o,h,o=t.rowFieldsMap,a=t.rowModel,s=t.rowValuePosition,u=t.rowDeep,c=t.sharedMap,l=t.rowFieldsIndexes,f=i.eYt,h=i.rYt,v=i.nodeName,d=i.YAt,p=i.zEt,m=i.lYt,b=o[h],g=1,w=t.options.subTotalsPosition!==V.SubtotalsPosition.none,y=t.options.grandTotalPosition!==V.GrandTotalPosition.none&&t.options.grandTotalPosition!==V.GrandTotalPosition.row;if(-1!==s&&d<=s&&(g=r.length),c=(0,U.FZt)(c,h,v),C=e,A=t.pt.collapse(i.rYt,c)&&d!==u,f){for(N=o[W().Values],p||0===s||(a.Kbt(C,b,c),i.oYt&&0<i.oYt.length&&i.YAt<t.rowDeep&&t.options.showDrill&&a.qWt(C,b,this.aYt(A))),I=void 0,S=!1,x=T=0,M=r;x<M.length;x++)D=M[x],a.Kbt(C,N,D.name),I={path:m,rowHeaderLevel:this.fYt(u,d,g)},1<g&&(I.valueFieldName=D.name,I.isValueFieldDim=!0),this.OZt(a,C,I),A?i.YAt<=s&&s<u&&!p&&t.options.insertBlankLineAfterEachItem?(this.NYt(t,i,a.zWt.length),C++,C++,T++,S=!0):C++:(i.zEt&&0===u&&0===s&&(this.TYt(t,i,C,"",r),e=r.length),C+=this.MYt(t,i,n,C,[D],!0),!i.zEt&&d<u&&t.options.insertBlankLineAfterEachItem&&i.oYt&&0===i.oYt[0].AYt&&(C++,this.NYt(t,i,a.zWt.length)));if(d===u&&t.options.insertBlankLineAfterEachItem&&0!==u&&(C++,this.NYt(t,i,a.zWt.length)),A)return g=this.xYt(t,i,n,C-g-T,r,g,!0,b,!0,S),n||(g+=T),g}else{if(!Q(b)&&(a.Kbt(C,b,c),this.OZt(a,C,{path:m,rowHeaderLevel:this.fYt(u,d,g),valueFieldName:r[0]&&r[0].name}),i.oYt&&0<i.oYt.length&&i.YAt<t.rowDeep&&t.options.showDrill&&a.qWt(C,b,this.aYt(A)),A)){if(i.YAt<u)for(k=i.lYt.split(G.Separator),0<=s&&s<=d&&(h=o[W().Values]-1,k.splice(h,null,r[0].name)),j=0,O=k.length;j<O;j++)k[j]&&a.tZt(C,l[j],l[j]!==W().Values?(0,U.FZt)(t.sharedMap,l[j],k[j]):k[j],l.length-j);return v=!0,0!==t.valuePositionInfo.positionIndex&&(v=!1),g=this.xYt(t,i,!0,C,r,g,v,b,!0)}this.MYt(t,i,n,C,r)}return f=this.gYt(t,i)||g,c=0,t.options.insertBlankLineAfterEachItem&&(f+=c=this.CYt(t,i)),o=e+f-g,w||p&&y||!u&&r.length?(t.options.insertBlankLineAfterEachItem&&i.AYt&&!p&&o--,0===u&&p?(h=r[0]&&r[0].name||"",a.Kbt(o,0,h),-1===s?(I={path:m,rowHeaderLevel:this.fYt(u,d,g)},this.OZt(a,o,I),this.ZZt(t,0,i,r,"")):this.ZZt(t,o,i,r,"")):s<=0?this.xYt(t,i,n,o,r,void 0,!0):this.xYt(t,i,n,o,r)):t.options.subTotalsPosition===V.SubtotalsPosition.none&&t.options.insertBlankLineAfterEachItem&&0<c&&this.NYt(t,i,o),f},u.CYt=function(t,i){return t.options.subTotalsPosition===V.SubtotalsPosition.none?i.IYt:i.AYt},u.gYt=function(t,i){var n,e,n,r,e,n,n=t.options,e=n.subTotalsPosition,n=n.grandTotalPosition,r=e!==V.SubtotalsPosition.none?i.KZt+i.XZt+i.$Zt:i.KZt+i.$Zt;return r=i.zEt&&(e=e!==V.SubtotalsPosition.none,n=n!==V.GrandTotalPosition.none&&n!==V.GrandTotalPosition.row,e&&!n?r-=-1===t.rowValuePosition?1:t.valueFieldsInfo.length:(n&&!e||n&&0===i.vYt&&0!==t.rowFields.length)&&(r+=-1===t.rowValuePosition?1:t.valueFieldsInfo.length),0===t.rowFields.length)?i.KZt+i.$Zt:r},u.xYt=function(t,i,n,e,r,o,a,s,u,c){var l,f,h,L,v,d,p,m,E,b,g,B,w,y,C,A,n,N,w,R,I,T,S,x,M,D,k,j,O,_,k,F,P,P,l=t.rowDeep,f=t.rowModel,h=t.rowFieldsMap,L=t.sharedMap,v=t.options,d=t.rowValuePosition,p=t.rowFieldsIndexes,m=i.YAt,E=i.nodeName,b=i.zEt,g=i.lYt,B=i.rYt,w=!1;if(b){if(t.options.grandTotalPosition===V.GrandTotalPosition.none||t.options.grandTotalPosition===V.GrandTotalPosition.row)return;w=!0}if(n&&m<l||0===l||w){if(-(y=1)!==d&&m<=d&&(y=r.length),C=b?0:h[i.rYt],(n=A=e)>=f.Sx)return;if(N=void 0,N=0===l?r[0]&&r[0].name||"":(w=(0,U.FZt)(L,B,E),t.pt.collapse(i.rYt,w)?w:b?1<r.length&&0<=d?W().Total:W().GrandTotal:1<r.length&&0<d||r.length<2&&v.subtotalsPosition===V.SubtotalsPosition.none?w:w+W().Total),R=-1!==t.columnValuePosition){for(I={path:g,grandTotalLevel:m,valueFieldName:r[0]&&r[0].name},b?I.isGrandTotal=!0:I.isSubtotal=!0,(0,G.ht)(s)||(I.collapseIndex=s),f.Kbt(A,C,N),S=0,x=(T=i.lYt.split(G.Separator)).length;S<x-1;S++)f.tZt(A,p[S],p[S]!==W().Values?(0,U.FZt)(t.sharedMap,p[S],T[S]):T[S],p.length-S);this.OZt(f,A,I),this.GZt(t,i,A,g)}else{if(I=void 0,0===t.valueFieldsInfo.length){for(f.Kbt(A,C,N),S=0,x=(T=i.lYt.split(G.Separator)).length;S<x-1;S++)f.tZt(A,p[S],p[S]!==W().Values?(0,U.FZt)(t.sharedMap,p[S],T[S]):T[S],p.length-S);I={path:g,grandTotalLevel:m},b?I.isGrandTotal=!0:I.isSubtotal=!0,(0,G.ht)(s)||(I.collapseIndex=s),this.OZt(f,A,I)}for(M=0,D=r;M<D.length;M++){for(j=(k=D[M]).cacheName,O=k.subtotalType,_=k.subtotalText,I={path:g,grandTotalLevel:m,valueFieldName:k=k.name},b?I.isGrandTotal=!0:I.isSubtotal=!0,P=F=void 0,u&&(I.collapse=!0),void 0===a||1<y?(F=N+" "+k,P=C):a?(F=N,u||(P=C)):(F=k,P=t.valuePositionInfo.positionIndex),I.valueFieldName=k,c||f.Kbt(A,P,F),T=i.lYt.split(G.Separator),0<=d&&d<m&&(P=h[W().Values],T.splice(P,null,F)),S=0,x=T.length;S<x-1;S++)f.tZt(A,p[S],p[S]!==W().Values?(0,U.FZt)(t.sharedMap,p[S],T[S]):T[S],p.length-S);(0,G.ht)(s)||(I.collapseIndex=s),this.OZt(f,A,I),this.GZt(t,i,A,g,j,O,_,k),A++,c&&(A++,o++)}}this.ZZt(t,n,i,r)}return b||!v.insertBlankLineAfterEachItem||c||(this.NYt(t,i,f.zWt.length),Q(o))||o++,o},u.NYt=function(t,i,n){var e,t,r,i,e=t.rowDeep,t=t.rowModel,r=i.YAt,i=i.lYt;(r<=e||0===e)&&this.OZt(t,n,{path:i,isBlankRow:!0})},u.MYt=function(t,i,n,e,r,o){var a,s,u,c,l,f,h,v,d,p,m,b,g,w,y,C,A,N,I,T,S,x,M,D,k,j,a=t.rowDeep,s=t.rowModel,u=t.options,c=t.rowFieldsMap,l=t.rowValuePosition,f=t.rowFieldsIndexes,h=1,v=i.oYt,d=i.YAt,p=v.length;if(a<=d)for(m=i.lYt.split(G.Separator),0<=l&&!Q(r)&&m.splice(l,null,r[0].name),b=0,g=m.length;b<g;b++)m[b]&&s.tZt(e,f[b],f[b]!==W().Values?(0,U.FZt)(t.sharedMap,f[b],m[b]):m[b],f.length-b);if((w=0)<p)for(y=e,C=u.fillDownLabels,I=N=A=void 0,T=u.subTotalsPosition===V.SubtotalsPosition.bottom?1:0,S=this.mYt(u.showDrill),x=0,M=v;x<M.length;x++)if(D=M[x],a<=d)this.TYt(t,D,y,"",r);else{if(d+1===a&&this.ZZt(t,y,D,r),k=this.bYt(t,D,n,y,r),C)for(A=c[D.rYt],I=k+y-T,N=s.Sl(y,A),j=y+1;j<I;j++)s.zWt[j]&&!s.zWt[j].isBlankRow&&(s.Kbt(j,A,N),s.qWt(j,A,S));y+=k,w+=k}return w=a<=d?1:w},u.TYt=function(t,i,n,e,r){var o,a,s,u,c,l,f,h,v,d,p,m,d,b,b,g,w,y,C,A,o=t.columnValuePosition,a=t.contentModel,s=t.colMap,u=i.oYt,c=i.nodeName,l=i.HZt;if(""!==e&&(e+=G.Separator),f=-1!==o,0===u.length)for(h=0,v=r;h<v.length;h++)p=(d=v[h]).name,m=d.cacheName,d=d.subtotalText,b=e,0!==t.columnDeep&&(b+=c),f&&(""!==b?b+=G.Separator+p:b=p),b=s[b],Q(b)||(g=!1,g=!!((w=t.subtotalCollection.CZt[p])&&(w.needBuildRunningTotalOrRankPath&&(i.UZt[p].indexInfo.minorPath=i.SYt),8===w.showDataAs||9===w.showDataAs)&&0<(w.showDataAsIndex&i.QZt))||g)||a.Kbt(n,b,I.Common.st.E8((0,N.hZt)(t.subtotalCollection,l,m,d,i.UZt,i.YAt,p),T.Functions.CALC_PRECISION||14));else for(y=0,C=u;y<C.length;y++)A=C[y],this.TYt(t,A,n,e+c,r);i.kYt||this.ZZt(t,n,i,r,e+c)},u.OYt=function(t){var i,n,e,r,o,a,s,u,c,l,f,h,v,d,i=t.rowModel,n=t.rowFields,e=t.rowValuePosition,r=t.valueFieldsInfo,o=t.colFields,a=n.length;for(0===a&&1===r.length&&0<o.length&&(a=1),s=[],u=0,c=n;u<c.length;u++)l=c[u],s.push(l.Zc);for(-1!==e&&(a+=1,s.splice(e,0,W().Values)),i.setColCount(a),f={},h=[],v=0,d=s.length;v<d;v++)f[s[v]]=v,h.push(s[v]);t.rowFieldsMap=f,t.rowFieldsIndexes=h},u.uit=V.PivotTableLayoutType.outline,i.PivotTableTabularLayout=u},"./dist/plugins/pivot/pivot-table/pivot-table-spread.js":function(b,t,i){"use strict";var x,n,M,N,I,T,S,g,D,c,e,k,w,r,V,o,j,U,O,y,_,Q,W,d,A,F,i,P,L,a,E,s,u,C,B,l,R,f;function z(t){return t?"0"===t.defaultSubtotal?T.SubtotalsPosition.none:"0"===t.subtotalTop?T.SubtotalsPosition.top:T.SubtotalsPosition.bottom:T.SubtotalsPosition.bottom}function h(t){this.PYt=[],this.Mf=t,this.FYt={},this._Yt={}}function Z(t,i,n){var e,r,o,a,s,u,e=i.LYt,r=i.eZt;if(!R(e))for(o=0;o<e.rowCount;o++)for(a=e.row+o,R(t[a])&&(t[a]={}),s=0;s<e.colCount;s++)u=e.col+s,R(t[a][u])&&(t[a][u]={}),n(t[a][u],i.getValue(a,u));if(!R(r))for(o=0;o<r.rowCount;o++)for(a=r.row+o,R(t[a])&&(t[a]={}),s=0;s<r.colCount;s++)u=r.col+s,R(t[a][u])&&(t[a][u]={}),n(t[a][u],i.getValue(a,u))}function p(t,i,n){var e,e,r,r,o,o,t,n,t,e,r,o,n,e=t.row,e=void 0===e?-1:e,r=t.col,r=void 0===r?-1:r,o=t.rowCount,o=void 0===o?n.getRowCount():o,t=t.colCount,n=void 0===t?n.getColumnCount():t,t=new x.Range(e,r,o,n),e=i.getRange(),r=e.page,o=e.content,n=o;return r&&(n=o.union(r)),t.containsRange(n)}function v(t,i,n){var e,e,r,r,o,o,t,n,t,i,t,e=t.row,e=void 0===e?-1:e,r=t.col,r=void 0===r?-1:r,o=t.rowCount,o=void 0===o?n.getRowCount():o,t=t.colCount,n=void 0===t?n.getColumnCount():t,t=i.getRange(),i=t.page,t=t.content;return i&&i.intersect(e,r,o,n)||t.intersect(e,r,o,n)}function m(t,i,n,e){var r,o,r,a,e;return"deletingRows"===e||"deletingColumns"===e||"clear"===e?!v(t,i,n)||p(t,i,n):"addingRows"===e?(o=(r=i.getRange()).page,a=r=r.content,o&&(a=r.union(o)),!v(t,i,n)||t.row<=a.row):"addingColumns"===e&&(o=(e=i.getRange()).page,a=r=e.content,o&&(a=r.union(o)),!v(t,i,n)||t.col<=a.col)}function Y(t,i){return t&&i&&t.color===i.color&&t.type===i.type||!t&&!i}function G(t,i,n,e){for(var r,o,a,s,u,r=i.getDefaultStyle(),o=e.startRow,a=e.endRow;o<a;o++)for(s=e.startCol,u=e.endCol;s<u;s++)H(i,o,s,r,n,t)}function H(t,i,n,e,r,o){var t,i,a,s,u,n;if(t.Ut&&(i=(t=t.Ut.sheetModels[3].J_(i,n))&&t.style)&&o&&"string"==typeof i)if(r[i])t.style=r[i];else if(a=o.i3(i)){for(s in a=a.clone(!0),l)!l.hasOwnProperty(s)||R(a[s])||(0===(u=l[s])?a[s]===e[s]&&(a[s]=F):1===u?Y(a[s],e[s])&&(a[s]=F):2===u&&x.mt.rfe(a[s],e[s])&&(a[s]=F));n=C+B+i,B++,a.name=n,o.$p(a),t.style=n,r[i]=n}}function J(t,i){var n,e,r,o,a,s,u,c,l,f,n={};for(e in t)if(t.hasOwnProperty(e)&&(n[e]={},"string"==typeof(o=(r=t[e]).EYt)&&0<o.indexOf("!")&&((a=o.split("!"))[0]&&("="===a[0][0]&&(a[0]=a[0].slice(1)),"'"===a[0][0])&&"'"===a[0][a[0].length-1]&&(a[0]=a[0].slice(1,a[0].length-1)),o=(0,x.i2e)(a[0])+"!"+a[1]),!R(o))&&"string"==typeof o){s=void 0;try{if((s=D.formulaToExpression((0,x.jf)(i),o,0,0,!0)).abt){u=s.abt,n[e].sourceType="worksheet",n[e].sourceName=u.name();continue}}catch(t){}c=void 0;try{if(f=l=void 0,(c=D.formulaToRanges((0,x.jf)(i),o,0,0))[0]&&c[0].ranges){if(n[e].sourceType="worksheet",s&&8===s.type&&s.value){n[e].sourceName=s.value;continue}l=c[0].sheetName,f=c[0].ranges[0],n[e].sheet=l,n[e].ref=D.rangeToFormula(f,0,0,15);continue}}catch(t){}0<o.indexOf("!")?(a=o.split("!"),n[e].sourceType="worksheet",n[e].sheet=a[0],n[e].ref=a[1]):(n[e].sourceType="worksheet",n[e].sourceName=o)}return n}function q(t,i){var n,t;"Object"===i.constructor.name&&(n=D.formulaToRange(t,i.ref),(t=t.pivotTables.add(i.name,i.dataRef,n.row,n.col))&&t.fromJson(i),i=t)}function K(t,i){for(var n,e,r,o,a,s,u,c,l,f,n=i.colCount,r=0;r<n&&(e=t.fDi(r),R(e)||e.isGroup);r++)i.col++,i.colCount--;for(o=[[]],s=0,u=i.colCount;s<u;s++)c=void 0,(a=t.fDi(i.col+s))&&(l=a.caption,c=f=a.value,"string"==typeof l&&""!==l?c=l:Array.isArray(l)&&(c=l[l.length-1])),o[0][s]=c;return o}function X(t,i){var n,e,r,n="_",e=t.split("_");return isNaN(parseInt(e[e.length-1],10))?t+="_1":(r=e[e.length-1],e.splice(e.length-1,1,"_"+(parseInt(r,10)+1)),t=e.join("")),t=-1!==i.indexOf(t)?X(t,i):t}function $(t,i){var n,e,r,t,o,e,t,t=(0,x.jf)(t),o=D.formulaToExpression(t,i,0,0);return o.abt?(r=(e=o.abt).range&&e.range()||e.dataRange&&e.dataRange(),n=e.Mf.name(),e="="+(i=e.name())):(o=D.formulaToRanges(t,i,0,0,!1,F,!0))[0]&&o[0].ranges&&(n=o[0].sheetName,r=o[0].ranges[0],t=D.rangeToFormula(r,0,0,15,!1),i="="+(0,x.i2e)(n)+"!"+t),{dataRefer:i,sheetName:n,tableName:e,range:r}}Object.defineProperty(t,"__esModule",{value:!0}),t.PivotTableManager=void 0,x=i("Core"),n=i("@spreadjs/js-sheets-common"),M=i("Pivot"),N=i("./dist/plugins/pivot/pivot-core/pivot-fields-model.js"),I=i("./dist/plugins/pivot/pivot-table/pivot-table.js"),T=i("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),S=i("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-empty-layout.js"),g=i("./dist/plugins/pivot/pivot.ns.js"),D=i("SheetsCalc"),c=i("./dist/plugins/pivot/pivot-panel/pivot-panel.js"),e=i("ConditionalFormatting"),k=i("./dist/plugins/pivot/pivot-util.js"),w=i("./dist/plugins/pivot/sheet-range-to-pivot-area.js"),r=i("Tables"),V=i("./dist/plugins/pivot/pivot-table/pivot-table-theme.js"),o=n.Common.kh,j=x.mt.xr,U=x.mt.go,O=x.Util.Sr,y=x.Util.wr,_=x.NodeHelper.ur,Q=x.NodeHelper.sr,W=x.Util.po,d=null,A=n.Common.lt.Nh,F=void 0,i=new n.Common.ResourceManager(g.SR,"PivotTables"),P=i.getResource.bind(i),L="pivot",a=x.GC$,E=a.isEmptyObject,s=x.UsedRangeUtil.hh,u=x.UsedRangeUtil.vh,C="__builtInPivotTableStyle",l={backColor:2,foreColor:B=0,borderBottom:1,borderLeft:1,borderRight:1,borderTop:1,font:0,textDecoration:0},R=n.Common.lt.ht,h.prototype.all=function(){return this.PYt.concat([])},h.prototype.add=function(t,i,n,e,r,o,a){var s,u,c,l,i,s,s=this.Mf.parent,u={};return s&&(c=!s.BYt(t))?((0,I.RYt)(new x.Range(0,0,0,0),new x.Range(n,e,18,3),this.Mf,t,!1,null,null,T.overlapCheck.value),"string"==typeof i&&(i=$(s,i).dataRefer),(l=s.GYt(i))||(l=s.VYt(t,i,this.Mf),u.pivotCacheName=l.Zc),i=s.UYt(l.getName(),t),s=new I.PivotTable(t,this.Mf,n,e,r,o,a,i),R(u.pivotCache)||(u.fieldsModelName=i.getName()),this._Qt(s,void 0,u),this.Mf.hP()&&this.Mf.repaint(),s):null},h.prototype._Qt=function(t,i,n){t&&(this.DT(t,"add",void 0,i,n),this.PYt.push(t),this.Mf.Ut.Spe(),t.dh.addPivotView(t),this.Mf.parent&&this.Mf.parent.QYt(t.name(),!0),t.Oy()||t.dh.q3())},h.prototype.getUsedRange=function(){var t,i,n,e,r,o,a,t,i=this.all(),n={};if(i)for(e=void 0,r=0,o=i;r<o.length;r++)e=(a=o[r]).getRange(),u(n,s(e.page)),u(n,s(e.content));return n},h.prototype.DT=function(t,i,n,e,r){var o,a,s,a,o,a=this.Mf;a&&(a=a.Ut).G8&&("add"===i?s={type:i,value:t.Zc,isMove:e,pivotType:0}:"remove"===i&&(s={type:i,value:t,index:n,isMove:e,pivotType:0,pivotCacheInfo:r}),a.WYt(t,s))},h.prototype.AP=function(t){var i,n,e,r,r;t&&(i=this,r=(t.type?(n=t.type,e=t.value,t):(n=t.value.type,e=t.value.value,t.value)).isMove,"add"===n?i.zYt(e,r):"remove"===n&&i.ZYt(t.value))},h.prototype.zYt=function(t,i){this.TOt(t,i)},h.prototype.ZYt=function(t){var i,i,n,e,r,o,e,i=this.PYt,n=t.value,e=t.index,r=this.Mf,o=r.parent;this.PYt=i.slice(0,e).concat(n).concat(i.slice(e)),null!=(i=r.Ut)&&i.Spe(),e=n.dh,(0,M.o)(e.z,function(t){t instanceof c.PivotPanel&&t.attach(n)}),e.q3(),o&&(o.QYt(n.Zc,!1),o.EQt&&o.EQt.undoRemovingPivotTable(n),t.pivotCacheInfo)&&o.YYt(t.pivotCacheInfo,!0),r.repaint()},h.prototype.adrs=function(){var t,t,t=this;t.qp={},t.PYt=[],(t=this.Mf&&this.Mf.parent)&&t.fMt&&t.fMt.reset(),this.Mf&&this.Mf.repaint()},h.prototype.HYt=function(t,i,n,e){for(var r,o,a,s,u,s,r=this.all(),o=0;o<r.length;o++)if(u=(s=(a=r[o]).getRange()).page,s=s.content,u&&u.intersect(t,i,n,e)||s.intersect(t,i,n,e))return this.Mf.jT(10,P().PivotTableErrorMessage_MakeChange),!1;return!0},h.prototype.remove=function(t){var i,n,i,n;0<this.PYt.length&&(this.TOt(t,!1),this.Mf.repaint())},h.prototype.TOt=function(t,i){for(var n,e,r,o,a,s,u,n=this.PYt,e=n.length,r=this.Mf&&this.Mf.parent,o=e-1;0<=o;o--)if(n[o].Zc===t){a=n[o].dh,s=this.PYt.splice(o,1)[0],u=void 0,i||(u=r&&r.JYt(a.getName())),this.DT(s,"remove",o,i,u),i||(0,M.o)(a.z,function(t){t instanceof c.PivotPanel&&t.detach()}),r&&r.QYt(t,!1),r&&r.EQt&&r.EQt.undoAddingPivotTable(s),this.PYt.length<1&&this.Mf.Ut.Spe();break}this.Mf.repaint()},h.prototype.get=function(t){for(var i,n,e,i=0,n=this.PYt;i<n.length;i++)if((e=n[i]).Zc===t)return e;return null},h.prototype.eG=function(){for(var t,i,n,e,t,i=0,n=this.PYt;i<n.length;i++)e=n[i],this.remove(e.name());this.PYt=[]},h.prototype.findPivotTable=function(t,i){var n,e,r,o,a,s,u,o,c,l,f,h,v,c;if(this.FYt[t]&&this._Yt[i]){for(n=0,e=this.PYt;n<e.length;n++)if(a=(o=(r=e[n]).getRange().content).row,s=o.col,u=o.rowCount,o=o.colCount,l=!1,(c=r.LYt)&&(f=c.row,h=c.col,v=c.rowCount,c=c.colCount,l=f<=t&&t<v+f&&h<=i&&i<h+c),a<=t&&t<u+a&&s<=i&&i<s+o||l)return r;return d}},h.prototype.qYt=function(){var i=this;i.FYt={},i._Yt={},(0,M.o)(i.PYt,function(t){t.qYt(i.FYt,i._Yt)})},h.prototype.KYt=function(t,i,n,e){return!R(t)&&this.XYt(t)&&(0,I.RYt)(t,i,n,e,!1)},h.prototype.XYt=function(t){var i,n,e,r,o,r,i=this;if(0!==i.PYt.length)for(n=0;n<i.PYt.length;n++){if(o=(r=(e=i.PYt[n]).getRange()).content,(r=r.page)&&(r.containsRange(t)||r.intersect(t.row,t.col,t.rowCount,t.colCount)&&r.union(o).containsRange(t)))return!0;if(o.containsRange(t))return!0}return!1},h.prototype.KB=function(t,i){var r,t,r=this,t=(0,k.$Yt)(this.Mf,t);return i&&(0,M.o)(t,function(t){for(var i,n,e,i=r.PYt,n=0;n<i.length;n++)(e=i[n]).Zc===t.name&&(t.pt=e,r.TOt(e.Zc,!0))}),t},h.prototype.JB=function(t,s,i,n,u,c,l,e,r,f){function h(t,i){var t=t.getRange().page;return t&&(i+=t.rowCount+1),i}(0,M.o)(t,function(t){var i,n,e,r,o,a,r,i,i=s.pivotTables.get(t.name),n=c+t.startPoint[0],e=l+t.startPoint[1];if(f){if(n=h(r=t.pt,n),r.suspendLayout(),r.position(n,e,u.name()),u.name()===s.name()){for(o=t.pt.dh.z,a=0;a<o.length;a++)if(o[a].Zc===t.pt.Zc){o.splice(a,1);break}u.pivotTables._Qt(t.pt,!0)}r.resumeLayout()}else r=i.serialize(),n=h(i,n),i=i.clone(i.name(),u,n,e),u.pivotTables._Qt(i),i.tJt(r,1023)})},h.prototype.getRangePivotAreas=function(t){for(var e,r,o,i,n,a,s,e=this,r=(0,k.iJt)(e.Mf,t),o={},i=function(t){var i,t,n,i=e.get(t),t=r[t],n=[];(0,M.o)(t,function(t){n=n.concat.apply(n,(0,w.rangeToAreas)(i,t))}),o[i.Zc]=n},n=0,a=Object.keys(r);n<a.length;n++)i(s=a[n]);return o},h.prototype.jT=function(t,i){var n,e,n=this,e=n.Mf;e&&(t?(n.nJt&&e.ki(x.Events.InvalidOperation,{sheet:e,sheetName:e.name(),invalidType:n.nJt.type,message:n.nJt.args},!0),n.nJt=d):!i||!i.args.force&&n.nJt||(n.nJt=i))},h.prototype.eJt=function(t,i,n){var e,r,t,o,e;return"number"==typeof n&&!!((r=this.findPivotTable(t,i))&&r.options.enableDataValueEditing&&r.rJt(t,i))&&(t=r.getNodeInfo(t,i),(o=r.getNodeValue(t))!==n)&&(r.oJt(t,n,!0),!0)},f=h,t.PivotTableManager=f,a.extend(x.Worksheet.prototype,{ptwm:function(t,i,n){return n?[P().wmk1,0]:-1===t?n?[P().wmk1,0]:[P().wmk2,1]:void 0},aJt:function(t,i){var n,e,r,o,a,s,n=this,o=n.pivotTables.findPivotTable(t,i);return o&&((a=n.getParent())&&a.options.enableAccessibility&&(s=o.sJt(t,i,!0))&&setTimeout(function(){a.n2(s)},0),e=o.getValue(t,i),r=!0),{value:e,inPivot:r}},uJt:function(t,i){var n,e,i,r,o,a,s,u,c,l,f,i,h,v,d,p,m,b,g,w,y,C,A,N,y,N,n=i.ctx,e=i.clipRect,i=t.position(),r=i.row,o=i.col,a=18,s=3,u=0,c=0,l=0,f=0,i=this.getActiveColumnIndex(),h=this.getActiveRowIndex(),v=new x.Range(r,o,18,3),d=t.getName(),p=P().EmptyPivotTable_PromptMessage1;for(o<=i&&i<o+3&&r<=h&&h<r+18&&!this.isActualProtected()&&(p=P().EmptyPivotTable_PromptMessage2),m=0;m<18;m++)c+=this.Gt(r+m);for(b=0;b<3;b++)u+=this.nn(o+b);for(g=0;g<=2;g++)for(w=0;w<=2;w++)C=(y=this.getRangeRect(g,w,v)).x,A=y.y,N=y.width,y=y.height,N=new x.Rect(C,A,N,y),(e=this.Fi().c9(g,w))&&0!==e.width&&0!==e.height&&e.intersectRect(N)&&(l=0===C||0!==w&&e.x>C?N.x-(u-N.width):N.x,f=0===A||0!==g&&e.y>A?N.y-(c-N.height):N.y,(0,S.jYt)(n,d,l,f,c,u,e,p))}}),x.Worksheet.ch("pivotTable",{init:function(){var t,i,n,t,e,r,o,t=this,i=t.pivotTables,n=t.parent;if(!R(i)&&!R(n)&&(t=i.all())&&0<t.length)for(e=0,r=t;e<r.length;e++)o=r[e],n.QYt(o.name(),!1);this.pivotTables=new f(this)},getUsedRange:function(t){var i,n,e;t.type&x.UsedRangeType.pivottable&&(e=(n=(i=this).pivotTables).getUsedRange(),u(t.range,e))},dispose:function(t){!1!==t.clearCache&&(this.pivotTables&&this.pivotTables.eG(),this.pivotTables=null)},beforePaintAdornment:function(t){for(var i,n,e,i=0,n=this.pivotTables.all();i<n.length;i++)(e=n[i]).Oy()&&this.uJt(e,t)},onLayoutChanged:function(t){var i,n,e,r,o,a,s,u,c,l,f,h,v,d;if(R(t.sheetArea)||3===t.sheetArea)if(i=this,n=t.changeType,e=t.row,r=t.col,o=t.rowCount,a=t.colCount,s=new x.Range(e,r,o,a),u=i.pivotTables.all(),"deletingRows"===n||"deletingColumns"===n)for(c=0;c<u.length;c++){if(!m(s,l=u[c],i,n)){t.canDelete=!1,i.jT(10,P().PivotTableErrorMessage_MakeChange);break}p(s,l,i)?i.pivotTables.remove(l.name()):(h=(f=l.position()).row,v=f.col,"deletingRows"===n?s.row<h&&l.position(h-s.rowCount,v):s.col<v&&l.position(h,v-s.colCount))}else if("addingRows"===n||"addingColumns"===n)for(c=0;c<u.length;c++){if(!m(s,l=u[c],this,n)){i.jT(10,P().PivotTableErrorMessage_MakeChange),t.canAdd=!1;break}h=(d=l.position()).row,v=d.col,"addingRows"===n?s.row<=h&&l.position(h+s.rowCount,v):s.col<=v&&l.position(h,v+s.colCount)}else if("clear"===n&&!t.ignorePivotTable)for(c=0;c<u.length;c++){if(!m(s,l=u[c],i,n)){t.canClear=!1,i.ki(x.Events.InvalidOperation,{sheet:this,sheetName:this.name(),invalidType:10,message:P().PivotTableErrorMessage_MakeChange},i.QI);break}p(s,l,i)&&i.pivotTables.remove(l.name())}},allowStartEdit:function(t){var i,n,e,r,o,a,s,u,s,i=this,n=t.row,e=t.col;if(i.pivotTables)for(r=i.pivotTables.all(),o=0;o<r.length;o++)if(u=(s=(a=r[o]).getRange()).page,s=s.content,(u&&u.contains(n,e)||s&&s.contains(n,e))&&(!a.options.enableDataValueEditing||!a.rJt(n,e)))return void(t.isAllow=!1)},fromJson:function(t,i,n){var e,r,o,a,s,u,c,l,l,f,h,v,d,h,v,d,h,f,p,m,b,m,h,e=this,r=e.parent;if(!(R(r)||n&&n.ignoreStyle)&&(o=r.fMt,a=t.pivotTables,o)&&a&&0<a.length)for(s={},u=B=0;u<a.length;u++)c=a[u],!(l=o.getPivotCacheByCacheId(+c.cacheId))||E(l.Pq)||(l=new N.PivotFieldsModel(c.name,c.cacheId,o,this.parent.Qy),r.BQt[c.name]=l,f=D.formulaToRanges(e,c.ref,0,0,!0)[0].ranges,h=c.pageFields,v=c.rowPageCount,d=c.colPageCount,h&&0<h.length&&1<f[0].row&&(h=new x.Range(f[0].row-v-1,f[0].col,v,3*d-1),e.clear(h.row,h.col,h.rowCount,h.colCount,3,x.StorageType.data),G(r,e,s,{startRow:h.row,startCol:h.col,endRow:h.row+h.rowCount,endCol:h.col+h.colCount})),e.clear(f[0].row,f[0].col,f[0].rowCount,f[0].colCount,3,x.StorageType.data),G(r,e,s,{startRow:f[0].row,startCol:f[0].col,endRow:f[0].row+f[0].rowCount,endCol:f[0].col+f[0].colCount}),(v=new I.PivotTable(c.name,e,f[0].row,f[0].col,null,null,null,l)).suspendLayout(),d=c.outline,h=c.compact,f=c.outlineData,p=c.compactData,c.fields&&0<c.fields.length&&(v.options.insertBlankLineAfterEachItem=!!c.insertBlankRowDefault,v.options.subTotalsPosition=!1===c.enabledSubtotalsDefault?T.SubtotalsPosition.none:!1===c.subtotalsOnTopDefault?T.SubtotalsPosition.bottom:T.SubtotalsPosition.top,l.Dpi=v.options.subTotalsPosition,b=(m=c.fields[0]).outline,m=m.compact,!0===d&&!0===f&&!1===h&&!1===p&&!1===m?v.layoutType(T.PivotTableLayoutType.outline):!1===b?v.layoutType(T.PivotTableLayoutType.tabular):!0===d&&!0===f&&v.layoutType(T.PivotTableLayoutType.compact)),l.fromJson(c,v),v.fromJson(c,t),e.pivotTables._Qt(v),v.Xst--,v.iM(!1,!0),h=v.eZt,R(h))||(e.getColumnCount()<h.col+h.colCount&&e.setColumnCount(h.col+h.colCount),e.getRowCount()<h.row+h.rowCount&&e.setRowCount(h.row+h.rowCount))},toJson:function(t,i){var n,e,r,o,a,s,n,e=this.pivotTables.all();if(e&&0<e.length)if(r=void 0,R(t.data.dataTable)&&(t.data.dataTable={}),r=t.data.dataTable,i&&i.ignoreStyle)for(o=0;o<e.length;o++)(a=e[o]).toJson(t,i);else for(s=t.pivotTables=[],o=0;o<e.length;o++)a=e[o],s.push(a.toJson(t,i)),Z(r,a,function(t,i){t.value=i})},setName:function(t){var i,i,n,e,r,i=this.getParent(),i=i&&i.fMt,n=i&&i.cut;if(!R(n))for(e in n)n.hasOwnProperty(e)&&(r=n[e],!R(r.sheet))&&t&&r.sheet===t.oldName&&(r.sheet=t.newName,R(r.sourceName))&&"string"==typeof r.EYt&&(r.EYt=t.newName+"!"+r.EYt.split("!")[1])},lastNonNullRowAndCol:function(){var t,i,n,e,r,o,a,o,s,u,c,t,i,n=0,e=0,r=this.pivotTables.all();if(r)for(s=0,u=r;s<u.length;s++)o=(c=u[s]).getRange(),a=Math.max(o.page?o.page.row+o.page.rowCount:-1,o.content.row+o.content.rowCount)-1,o=Math.max(o.page?o.page.col+o.page.colCount:-1,o.content.row+o.content.colCount)-1,n=Math.max(n,a),e=Math.max(e,o);return{lastNonNullRow:n,lastNonNullCol:e}},yh:function(t,p,i){var m,b,n,e,r,g,w,y,C,A,o,a,m=this,b=m.parent,n=b&&b.v2&&b.v2.sheetsState,e=b&&b.v2&&b.v2.refSheetsState;if(i&&!1===i.includeStyles){if(r=!1,!n)return;if(Object.keys(n).forEach(function(t){2!==n[t]&&1!==n[t]||(r=!0)}),!r||b.getActiveSheet()===m)return}if(b&&(g=b.fMt,w=m,C=(y=t).rels&&y.rels.c_,!(n&&2===n[w.name()]||e&&2===e[w.name()])))for(A={},o=function(t){var t,i,n,i,t,t,i,i,e,r,o,a,e,o,s,a,e,o,r,u,c,l,f,h,v,u,u,u,d,e,t=C[t],i=t.Type;if(i===x.RelationshipConstants.oc&&(i=(n=t.Target).split("/").pop().slice(0,-4),t=p.pivotTables)&&(t=t[i],g)){if(i=g.getPivotCacheByCacheId(+t.cacheId),b.BQt[t.name]&&(t.name=X(t.name,Object.keys(b.BQt))),!i||E(i.Pq)||b.BQt[t.name])return"continue";if(i=new N.PivotFieldsModel(t.name,t.cacheId,g,m.parent.Qy),b.BQt[t.name]=i,e=j(t,"location"),r=D.formulaToRanges(w,e.ref,0,0,!0)[0].ranges,o=j(t,"pageFields"),a=+e.rowPageCount,e=+e.colPageCount,o&&1<r[0].row&&(o=new x.Range(r[0].row-a-1,r[0].col,a,3*e-1),w.clear(o.row,o.col,o.rowCount,o.colCount,3,x.StorageType.data),G(b,m,A,{startRow:o.row,startCol:o.col,endRow:o.row+o.rowCount,endCol:o.col+o.colCount})),w.clear(r[0].row,r[0].col,r[0].rowCount,r[0].colCount,3,x.StorageType.data),G(b,m,A,{startRow:r[0].row,startCol:r[0].col,endRow:r[0].row+r[0].rowCount,endCol:r[0].col+r[0].colCount}),(s=new I.PivotTable(t.name,w,r[0].row,r[0].col,null,null,null,i)).suspendLayout(),a=_(t.outline),e=_(t.compact),o=_(t.outlineData),r=_(t.compactData),c=(u=j(t,"pivotFields"))&&u.c_){for(l=c[0],f=z(l),h=0,v=c.length;h<v;h++)if(z(c[h])!==f){f=F;break}(u=j(t,"extLst"))&&(u=u.c_)&&u.forEach(function(t){var t=j(t,"pivotTableDefinition16");t&&(f!==F?s.options.subTotalsPosition=f:R(t.EnabledSubtotalsDefault)||!1!==_(t.EnabledSubtotalsDefault)?R(t.SubtotalsOnTopDefault)||!1!==_(t.SubtotalsOnTopDefault)?s.options.subTotalsPosition=T.SubtotalsPosition.top:s.options.subTotalsPosition=T.SubtotalsPosition.bottom:s.options.subTotalsPosition=T.SubtotalsPosition.none,R(t.InsertBlankRowDefault)?s.options.insertBlankLineAfterEachItem=_(l.insertBlankRow):s.options.insertBlankLineAfterEachItem=_(t.InsertBlankRowDefault))}),i.Dpi=s.options.subTotalsPosition,u=_(l.outline),d=_(l.compact),!0===a&&!0===o&&!1===e&&!1===r&&!1===d?s.layoutType(T.PivotTableLayoutType.outline):!1===u?s.layoutType(T.PivotTableLayoutType.tabular):!0===a&&!0===o&&s.layoutType(T.PivotTableLayoutType.compact)}i.yh(t,s),s.yh(t,p,y),w.pivotTables._Qt(s),s.Xst--,s.iM(!1,!0),e=s.eZt,R(e)||(w.getColumnCount()<e.col+e.colCount&&w.setColumnCount(e.col+e.colCount),w.getRowCount()<e.row+e.rowCount&&w.setRowCount(e.row+e.rowCount))}},a=B=0;a<C.length;a++)o(a)},wh:function(t,i,n){var e,r,o,a,s,u,c,l,f,h,v,d,l,p,m,b,b,e,r=this.pivotTables.all();if(r&&0<r.length)if(o=j(t,"sheetData"),R(o)&&(o={n_:"sheetData"}),t.rels||(t.rels={}),a=i.sharedStrings,s=t.rels,n&&!1===n.includeStyles)for(u=0;u<r.length;u++)f=(l=(c=r[u]).rZt.HWt)[0],h=l[1],v=l[2],d=l[3],l=l[4],p=c.LYt,m=c.getRange().content,(0,I.synchronizeDataTable)(p.row+f.DQ,p.col+f.jN,o,f.dataTable,function(t,i){(0,I.setDataForSJSPivotTable)(t,i,a)}),(0,I.synchronizeDataTable)(m.row+h.DQ,m.col+h.jN,o,h.dataTable,function(t,i){(0,I.setDataForSJSPivotTable)(t,i,a)}),(0,I.synchronizeDataTable)(m.row+v.DQ,m.col+v.jN,o,v.dataTable,function(t,i){(0,I.setDataForSJSPivotTable)(t,i,a)}),(0,I.synchronizeDataTable)(m.row+d.DQ,m.col+d.jN,o,d.dataTable,function(t,i){(0,I.setDataForSJSPivotTable)(t,i,a)}),(0,I.synchronizeDataTable)(m.row+l.DQ,m.col+l.jN,o,l.dataTable,function(t,i){(0,I.setDataForSJSPivotTable)(t,i,a)});else for(u=0;u<r.length;u++)Z(o,c=r[u],function(t,i){(0,I.setDataForSJSPivotTable)(t,i,a)}),b=y(s),b=x.XFileConstants.Rr+b,s.c_.push({n_:x.XFileConstants.Lr,Id:b,Type:x.RelationshipConstants.oc,Target:"../"+x.XFileConstants.Mu+"s/"+x.XFileConstants.Mu+c.Mp+"."+x.XFileConstants.Cr})}}),x.Workbook.ch("pivotTable",{adlc:function(t){var i,n,e,r,o,t,a,s,u,c,l,i=t.flg,n=t.checkRs,e=t.m,r=t.d,o=t.nl,t=t.fn,a="p",s=["able","ivotT"],u=this.ptwm||this.parent&&this.parent.ptwm;i&&-1===i.indexOf("p".toUpperCase()+s[1]+s[0])?(n.wm=n.wm||[],(c=u&&u(e,r,!0))&&n.wm.push(c),n.nwm=!0,1!==o&&f&&(l=f.prototype._Qt,f.prototype._Qt=function(){l.apply(this,arguments),this.PYt=[]}),n.state||(n.state=[]),n.state.push(["pte",0]),n.dis||(n.dis=[]),n.dis.push("7069766f745461626c6573"),this.parent&&t&&t(this,n.dis,"ad")):-1===e&&(n.wm=n.wm||[],(c=u&&u(e,r,!1))&&n.wm.push(c),n.nwm=!0)},setHost:function(){},init:function(){this.cJt(),x.Commands.fZt(this.commandManager())},dispose:function(){if(this.fMt){for(var t in this.fMt.dispose(),this.fMt=null,this.BQt)this.BQt.hasOwnProperty(t)&&this.BQt[t].dispose();this.BQt=null,this.qp=null,this.lJt=null}},preFromJson:function(t,i,n){var e,t,r;if(this.cJt(),e=this.fMt,t=t.pivotCaches,!R(e)){if(e.dispose(),n&&n.ignoreStyle)return;e.fromJson(t)}for(r in this.BQt)this.BQt.hasOwnProperty(r)&&this.BQt[r]&&this.BQt[r].dispose();this.BQt={}},preFromSJSFormat:function(t,i,n){var e,r,n,i,o,a,s,u,c,l,n,f,h,v,d,p,m,p,m,b,m,m,g,w,g,y,C,A;if(this.cJt(),e=this.fMt,!R(e)){if(e.dispose(),n&&!1===n.includeStyles)return;if(r=i.styleManager,(i=(n=t.styles)&&n.tableStyles)&&(r.addDefaultStyleName("defaultPivotStyle",i.defaultPivotStyle||"PivotStyleLight16"),0<(o=Q(i.count,0)))&&(a=U(i,"tableStyle")))for(s=0,u=[].concat(a);s<u.length;s++)c=u[s],_(c.table)||(l=new V.PivotTableTheme).yh(c,r);if(f=!1,n=j(t.workbook,"pivotCaches"))for(h=n.c_,v=t.pivotCache,d=0;d<h.length;d++)if(m=(p=h[d])["r:id"],p=p.cacheId,m=O(t.workbook.rels.c_,m)){if(m=(b=m.Target).split("/").pop().slice(0,-4),!(m=v&&v[m]))return;g=m["r:id"],w=void 0,R(g)||(w=v[C=(y=(g=O(m.rels.c_,g))&&g.Target).split("/").pop().slice(0,-4)]),e.yh(m,p,w),f=!0}f||e.resetDataAnalyzer()}for(A in this.BQt)this.BQt.hasOwnProperty(A)&&this.BQt[A]&&this.BQt[A].dispose();this.BQt={}},initCustomName:function(){var t,i,n,e,r,o,a,t=this;if(t.fMt&&(i=t.fMt.cut))for(n in i)i.hasOwnProperty(n)&&(e=i[n],(0,M.ht)(e)||(r="pivot"+e.Zc,0<(o=e.EYt).indexOf("!")?((a=o.split("!"))[0]&&"="===a[0][0]&&(a[0]=a[0].slice(1)),o=(0,x.i2e)(a[0])+"!"+a[1]):"worksheet"===e.sourceType&&e.sheet&&(o=(0,x.i2e)(e.sheet)+"!"+o),!(0,M.ht)(o)&&""!==o&&(t.zwt(t.lJt,r,o,null,null,!0,null),R(e.oQt)||e.oQt.length<1)&&t.kx(e.Zc,e)))},toJson:function(e,t){var t,i,n,r,o,a,s,u,c,l,f,h,v,d,p,m,b,g;if(!t||!t.ignoreStyle){for(i=(t=this).fMt,n=t.sheets,r={},o=0;o<n.length;o++)for(s=(a=n[o]).pivotTables.all(),u=0;u<s.length;u++)if((c=s[u])&&(l=c.dh.L,R(r[l])&&(r[l]={}),f=c.dh.Z))for(h in f)f.hasOwnProperty(h)&&3!==f[h]&&(r[l][h]=!0);for(v={},d=0,p=n;d<p.length;d++)if((a=p[d]).pivotTables&&a.pivotTables.PYt)for(m=0,b=a.pivotTables.PYt;m<b.length;m++)v[(c=b[m]).dh.L]=1;e.pivotCaches=i&&i.toJson(r,Object.keys(v)),g=J(e.pivotCaches,t),Object.keys(g).forEach(function(t){var i=g[t],n=e.pivotCaches[t];i&&n&&Object.keys(i).forEach(function(t){n[t]=i[t]})})}},onCultureChanged:function(){P(),(0,M.getSR)()},wh:function(u,c,l){var t,i,n,e,r,o,a,s,f,h,v,d,p,m,b,g,w,y,C,i,A,t,N,I,T,t,S;if(!l||!1!==l.includeStyles){for(i=(t=this).fMt,n=t.sheets,e={},r=0;r<n.length;r++)for(a=(o=n[r]).pivotTables.all(),s=0;s<a.length;s++)if((f=a[s])&&(h=f.dh.L,R(e[h])&&(e[h]={}),v=f.dh.Z))for(d in v)v.hasOwnProperty(d)&&3!==v[d]&&(e[h][d]=!0);for(p={},m=0,b=n;m<b.length;m++)if((o=b[m]).pivotTables&&o.pivotTables.PYt)for(g=0,w=o.pivotTables.PYt;g<w.length;g++)p[(f=w[g]).dh.L]=1;y=i.wh(e,Object.keys(p)),C=J(i.cut,t),Object.keys(C).forEach(function(t){var i,t,t,n,i=C[t],t=y[t];i&&t&&(t=j(t.pivotCacheDefinition,"cacheSource"))&&(i.sourceType&&(t.type=i.sourceType),"worksheet"===i.sourceType)&&(n={n_:"worksheetSource"},(0,M.ht)(i.sourceName)||(n.name=i.sourceName),(0,M.ht)(i.ref)||(n.ref=i.ref),(0,M.ht)(i.sheet)||(n.sheet=i.sheet),t.c_=[n])}),i=Object.keys(y),A={},0<i.length&&(t=u.workbook.rels,N=t.c_,I=N.length,T=u.pivotCache={},S=(t={n_:"pivotCaches",c_:[]}).c_,i.forEach(function(t,i){var n,e,r,n,o,a,t,n=y[t],e=n.pivotCacheDefinition,r=n.pivotCacheRecords,n=n.cacheId,o=i+1,a=x.XFileConstants.yu+"/"+x.XFileConstants.bu+o+"."+x.XFileConstants.Cr;A[t]=a,t=x.XFileConstants.Rr+(I+1+i),N.push({n_:x.XFileConstants.Lr,Id:t,Type:x.RelationshipConstants.ec,Target:a}),S.push({n_:"pivotCache",cacheId:n,"r:id":t}),T["pivotCacheDefinition"+o]=e,T["pivotCacheRecords"+o]=r,e.rels={n_:x.XFileConstants.Dr,xmlns:x.RelationshipConstants._r,c_:[{n_:x.XFileConstants.Lr,Id:"rId1",Type:x.RelationshipConstants.ic,Target:x.XFileConstants.wu+o+"."+x.XFileConstants.Cr}]}}),u.workbook.c_||(u.workbook.c_=[]),u.workbook.c_.push(t)),n.forEach(function(t){var i,n,e,r,o,a,s,o,o,i=t.pivotTables.all(),n=W(u,t.name());if(i&&0<i.length)for(u.pivotTables||(u.pivotTables={}),e=u.pivotTables,r=0;r<i.length;r++)a=(o=i[r]).wh(n,c,l),e[s=x.XFileConstants.Mu+o.Mp]=a,o=o.dh.L,o=A[o],a.rels={n_:x.XFileConstants.Dr,xmlns:x.RelationshipConstants._r,c_:[{n_:x.XFileConstants.Lr,Id:"rId1",Type:x.RelationshipConstants.ec,Target:"../"+o}]}})}}}),a.extend(x.Workbook.prototype,{UYt:function(t,i){var n,t,n=this.fMt;return this.BYt(i)&&(0,N.throwError)(P().RepeatName),n.hasPivotCache(t)||(0,N.throwError)("pivot cache not exist"),t=new N.PivotFieldsModel(i,t,n,this.Qy),this.BQt[i]=t},ptwm:function(t,i,n){return n?[P().wmk1,0]:-1===t?n?[P().wmk1,0]:[P().wmk2,1]:void 0},addPivotLayoutModelWithExistCache:function(t,i){var n=this.fMt;n.hasPivotCache(i)||(0,N.throwError)(P().NotExist),this.BQt[t]=new N.PivotFieldsModel(t,i,n)},BYt:function(t){return!!this.qp[t]},QYt:function(t,i,n){i?this.qp[t]=1:delete this.qp[t],R(n)||delete this.qp[n]},YYt:function(t,i){i?R(t.fieldsModel)||(this.BQt[t.fieldsModel.getName()]=t.fieldsModel,this.fMt.cut[t.fieldsModel.L]=t.pivotCache):(delete this.BQt[t.fieldsModelName],delete this.fMt.cut[t.pivotCacheName])},fJt:function(t){var i;return this.fMt.hasPivotCache(t)?this.fJt(t+="1"):t},hJt:function(t){for(var i,n,e,r,o,o,i=this,n=[],e=0,r=Object.keys(i.BQt);e<r.length;e++)o=r[e],(o=i.BQt[o]).L===t&&(0,M.o)(o.z,function(t){if(t instanceof I.PivotTable)return n.push(t.getName()),!0});return n},JYt:function(t){var i,n,e,r,o,a,s,u,u,c,l,f,h,v,d,p,e,m,i=this,n=i.BQt,e=n[t];if(!R(e)){for(r=e.L,a=0,s=o=i.sheets;a<s.length;a++)if(u=(u=s[a]).pivotTables&&u.pivotTables.PYt,!R(u)&&0<u.length)for(c=0,l=u;c<l.length;c++)if((f=l[c])._fieldModel&&f._fieldModel.Zc===t)return;for(v=0,d=h=Object.keys(n);v<d.length;v++)if((p=d[v])!==t&&n[p].L===r)return;return e=n[t],m=i.fMt.cut[r],delete n[t],delete i.fMt.cut[r],{fieldsModel:e,pivotCache:m}}},VYt:function(t,i,n){var e,r,o,a,s,u,c,l,f,h,v,d,p,m,b,g,w,y,C,c;if(t=this.fJt(t),e=null,r="",o=L+t,"string"==typeof i)try{r=i=(c=$(this,i)).dataRefer,s=c.sheetName,u=c.tableName,a=c.range,R(this.vJt(o))||this.dJt(o),this.zwt(this.lJt,o,r,null,null,!0,null),l=(0,x._f)(this,s),f=new x.Range(-1===a.row?0:a.row,-1===a.col?0:a.col,-1===a.rowCount?l.getRowCount():a.rowCount,-1===a.colCount?l.getColumnCount():a.colCount),h=l.NMi,R(h)||(e=K(h,f)),v=l.getArray(f.row,f.col,f.rowCount,f.colCount),(e=R(e)?v:e.concat(v))||(0,N.throwError)(P().SourceError)}catch(t){(0,N.throwError)(P().SourceNotIsTableNameOrFormula)}else A(i)&&A(i[0])?e=i:(0,N.throwError)(P().SourceNotIsTableNameOrFormula);for(e.length<2&&(0,N.throwError)(P().SourceDataOnlyOne),d=[],p=e[0],m=e.slice(1),b={},w=0,y=p.length;w<y;w++){if(R(p[w]))return void n.jT(10,P().PivotTableErrorMessage_EmptySourceFieldName);C=this.pJt(m,w),b[g=(0,k.dz)(b,p[w])]=!0,d.push({name:g,dataType:C,index:w})}return(c=new M.PivotCache(t,d,m,i)).EYt=r,R(s)||(c.sheet=s),R(u)||(c.sourceName=u),this.fMt.addPivotCache(c),c},pJt:function(t,i){for(var n,e,r,o,n=!1,e=0;e<t.length;){if("number"==(o=typeof(r=t[e])[i]))return 0;if("object"==o&&r[i]instanceof Date)return 2;if("string"==o)return 1;e+=1}return 5},kx:function(t,i,n,e){var r,o,a,s,u,c,l,f,h,v,d,p,m,b,g,w,y,C,A,N,I,r=null,o=this,a=L+t;if("string"==typeof t){s=void 0;try{if(!o.mJt(t,n))return;if(s=o.vJt(a),u={},c=void 0,s&&(c=(l=s.getExpression()).source&&l.source.Mf,l.abt?u=(f=l.abt).range&&f.range()||f.dataRange&&f.dataRange():(h=D.expressionToFormula(o.getActiveSheet(),l,0,0),(v=D.formulaToRanges(o.getActiveSheet(),h,0,0,!1,void 0,!0))[0]&&v[0].ranges&&(u=v[0].ranges[0])),d=new x.Range(u.row<0?0:u.row,u.col<-1?0:u.col,u.rowCount<-1?c.getRowCount():u.rowCount,u.colCount<-1?c.getColumnCount():u.colCount),p=c.NMi,R(p)||(r=K(p,d)),m=c.getArray(d.row,d.col,d.rowCount,d.colCount),r=R(r)?m:r.concat(m)),!r||r.length<2)return}catch(t){return}for(b=[],g=r[0],w=r.slice(1),y={},A=0,N=g.length;A<N;A++){if(R(g[A]))return void(e&&e.jT(10,P().PivotTableErrorMessage_EmptySourceFieldName));I=o.pJt(w,A),y[C=(0,k.dz)(y,g[A])]=!0,b.push({name:C,dataType:I,index:A})}i.ln(b,w),o.bJt(i.Zc)}},bJt:function(t){var i,n,e,i,n=this.BQt;for(e in n)o(n,e)&&n[e].L===t&&n[e].LS()},GYt:function(t){return this.fMt.gJt(t)},mJt:function(t,n){var e,i,r,o,e=this,i=this.BQt,r=Object.keys(i).map(function(t){return i[t]}),o=!0;return(0,M.o)(r,function(i){o&&i.Zc!==n&&i.L===t&&(0,M.o)(e.sheets,function(t){o&&t.isActualProtected()&&t.pivotTables.get(i.Zc)&&(t.jT(10,P().PivotTableErrorMessage_Protect),o=!1)})}),o},vJt:function(t){return t?this.lJt[n.Common.zf.Gmt(t)]:void 0},wJt:function(){var n=[];return a.each(this.bp,function(t,i){n.push(i)}),n},dJt:function(t){var i;t&&(delete this.lJt[n.Common.zf.Gmt(t)],(i={})[t]=t,this.Zwt(i,!1))},ok:function(){var t,i,n,e,t,i=this.BQt;for(e in i)o(i,e)&&(n=i[e])&&n.JVt()},wQt:function(t){var i,n,n,e,i=this.sheets;if(i)for(e=0;e<i.length;e++)if((n=i[e].pivotTables)&&(n=n.get(t)))return n;return d},getPivotCaches:function(){var t,i,t,i={};return x.Workbook.fh.find(function(t){return"pivotTable"===t.name}).toJson.call(this,i),i},getPivotCacheByName:function(t){return this.fMt.getPivotCacheByName(t)},cJt:function(){var t=this;t.fMt=new M.PivotEngine,t.BQt={},t.qp={},t.lJt={}}}),a.extend(x.Y8.prototype,{yJt:function(t){var i=this.CJt;return!i||!i[t]},WYt:function(t,i){var n,e,n,n=this,e=n.G8;e&&n.yJt(t.Zc)&&((n=e.pivotTableChanges)?delete n.isRestored:n=e.pivotTableChanges=[],n.push({pivotObj:t,value:i}))},TVt:function(t,i){var n,e,r,n,e=this.G8;e&&((r=e.pivotTableChanges)?delete r.isRestored:r=e.pivotTableChanges=[],r.push({pivotObj:t,value:i}))},IJt:function(t){for(var i,n,e,r,o,i={},n=t.length-1;0<=n;n--)(e=t[n]).pivotObj instanceof I.PivotTable&&!i[e.pivotObj.name()]&&(i[e.pivotObj.name()]=e.pivotObj);for(r in i)i.hasOwnProperty(r)&&(o=i[r]).suspendLayout();return i},AJt:function(t){var i,n;for(i in t)t.hasOwnProperty(i)&&(n=t[i]).resumeLayout()},NJt:function(t){for(var i,n,e,i=this.Mf.pivotTables,n=t.length-1;0<=n;n--)e=t[n],i.AP(e)},applyPivotTableChange:function(t,i){var n,e,n=t.value.type,e=this.Mf.pivotTables;i?"add"===n?e.get(t.pivotObj.name)||q(this.Mf,t.pivotObj):"remove"===n&&e.get(t.pivotObj.name)&&e.TOt(t.pivotObj.name):"add"===n?e.get(t.pivotObj.name)&&e.TOt(t.pivotObj.name):"remove"!==n||e.get(t.pivotObj.name)||q(this.Mf,t.pivotObj),this.applyPivotTableFieldChange(t,i)},applyPivotTableFieldChange:function(t,i){var n,e,n,e=this.Mf.pivotTables.get(t.pivotObj.name);e&&e.dh.fromJson(t.pivotObj,e)},TJt:function(t,i){var t,n,e,t=t,n=t.value.type,e=this.Mf.pivotTables;"add"!==n&&"remove"!==n||(e.AP(t),t.value.isMove)?t.pivotObj.AP(t.value):"add"===n&&i[t.pivotObj.name()]&&delete i[t.pivotObj.name()]},MJt:function(t){t.pivotObj.AP(t.value),R(t.pivotObj.copyFieldsModel)&&(t.pivotObj.copyFieldsModel=t.pivotObj.clone())}}),x.Y8.ch("PivotTable",{priority:8e3,isValid:function(t){var i,i,t,i,t=-1<["getValue","setValue"].indexOf(t),i=0<(null==(i=null==(i=this.Mf.pivotTables)?void 0:i.PYt)?void 0:i.length);return!t||i},getValue:function(t){var i,n,e,r,o,e,o,r,i=t.row,n=t.col,e=t.sheetArea,r=this.Mf,o=r.pivotTables.PYt;3===e&&o&&0<o.length&&(o=(e=r.aJt(i,n)).inPivot,r=e.value,o)&&(t.isValueGet=!0,t.value=r)},setValue:function(t){var i,n,e,r,o,a,e,o,s,o,s,o,u,i=t.row,n=t.col,e=t.sheetArea,r=t.value,o=this.Mf,a=o.parent&&o.parent.Gie;3===e&&(e=o.pivotTables.findPivotTable(i,n))&&(s=(o=e.getRange()).page,o=o.content,s&&s.contains(i,n)||o&&o.contains(i,n))&&(s=!0,a?e.Kbt(i,n,r):e.options.enableDataValueEditing&&e.rJt(i,n)&&(o=e.getNodeInfo(i,n),s=!!(u=e.setNodeValue(o,r))),t.isValueSet=s)},applyChanges:function(t){var n,i,t,e,r,o,a,n=this,i=t.changes,t=t.isUndo;if(i&&(e=i.pivotTableChanges)){if(r={},t)for(o=e.length-1;0<=o;o--)r[e[o].pivotObj.name]=1,0===e[o].value.pivotType?n.applyPivotTableChange(e[o],!1):n.applyPivotTableFieldChange(e[o],!1);else for(o=0;o<e.length;o++)r[e[o].pivotObj.name]=1,0===e[o].value.pivotType?n.applyPivotTableChange(e[o],!0):n.applyPivotTableFieldChange(e[o],!0);(a=Object.keys(r)).forEach(function(t){var i,t,i,t=n.Mf.pivotTables.get(t);t&&t.refresh()})}},undo:function(t){var i,n,e,r,o,t,a,s,u,c,i=this;if(i.CJt={},n=t.pivotTableChanges,i.Mf.pivotTables.xJt=!0,e={},n&&!n.isRestored){for(r=i.IJt(n),o=n.length-1;0<=o;o--)0===n[o].value.pivotType?i.TJt(n[o],r):(i.MJt(n[o]),e[n[o].pivotObj.Zc]=1);if(i.AJt(r),t=Object.keys(e),a=i.Mf.parent&&i.Mf.parent.BQt,!R(a))for(s=0,u=t;s<u.length;s++)a[c=u[s]]&&a[c].q3()}i.Mf.pivotTables.xJt=!1,delete i.CJt}}),x.Worksheet.ch("PivotTable",{priority:8e3,applyEditingSetFormula:function(t){var i,n,e,r,e,o,a,o,i=t.row,n=t.col,e=t.sheetArea,r;3!==e&&e!==d||(e=this.pivotTables.findPivotTable(i,n))&&(a=(o=e.getRange()).page,o=o.content,a&&a.contains(i,n)||o&&o.contains(i,n)&&!e.options.enableDataValueEditing)&&(t.isAllow=!1)},canAddingSpan:function(t){var i,n,e,r,o,a,o,i,s,u,c,l,i=t.row,n=t.col,e=t.rowCount,r=t.colCount,o=t.sheetArea;if(R(o)||o===x.SheetArea.viewport)for(a=this,o=new x.Range(i,n,e,r),i=(0,k.iJt)(a,o),s=0,u=Object.keys(i);s<u.length;s++)if(c=u[s],!(l=a.pivotTables.get(c)).GCe){t.isAllow=!1,a.jT(10,P().PivotTableErrorMessage_MakeChange);break}}}),e.ConditionalFormats&&e.ConditionalFormats.ch("pivotTable",{onRuleRemoved:function(t){var i,n,e,r,o,i,n=this.pivotTables.all(),e=t.priority;if(e)for(r=0;r<n.length;r++)(o=n[r]).DJt(e)}}),r.Table&&r.Table.ch("pivotTable",{tableNameChanged:function(t){var i,n,n,i,n=this.getParent();n&&(n=n.GYt(t.oldName))&&(n.EYt=t.newName)}})},"./dist/plugins/pivot/pivot-table/pivot-table-theme.js":function(k,t,i){"use strict";var j,_t,Ft,O,m,o,b,_,F,n,a,Pt,Lt,s,P,u,Et,L,c,E,B,Bt,l,f,i,R,G,V,U,Q,h,v,d,p,W,z,g,w,y,C,A,Z,N,I,T,Y,H,e;function r(t,i,n,e,r,o,a,s,u,c,l,f,h,v){var d=this,p=arguments;m(g,function(t,i){d[i]=1<t?p[t+1]:p[t]}),b(n)&&(d.font=n)}function S(){}function x(t,i){return isNaN(i)?i:new _t.LineBorder(t,i)}function M(t,i,n,e,r,o,a,s,u,c){var l=new I;return i&&(l.backColor=i),n&&(l.foreColor=n),e&&(l.cpe=G,l.lre=V,l.lpe=U,l._font=R),r&&(l.borderLeft=x(t,r)),o&&(l.borderTop=x(t,o)),a&&(l.borderRight=x(t,a)),s&&(l.borderBottom=x(t,s)),u&&(l.borderHorizontal=x(t,u)),c&&(l.borderVertical=x(t,c)),l}function D(t){var t,t=0===t?"Background 1":"Accent "+t;return t}function J(t){var i,n,e,e,i,i=t-1,e=Pt(i/7);return 0<=e&&e<=3?((n=[K,X,$,tt][e](i%7))[Bt.FIRST_ROW_STRIP_SIZE](1),n[Bt.FIRST_COLUMN_STRIP_SIZE](1),n[Bt.SECOND_COLUMN_STRIP_SIZE](1),n[Bt.SECOND_ROW_STRIP_SIZE](1),n.name(e="Light"+t),n.builtInName(e)):((n=q()).name(i="Light0"),n.builtInName(i)),n}function q(){return new T}function K(t){var i,n,e,t,i,i=D(t),t=0===t?(n=" -15",e=" -35",w.TEXT1+" 50"):(n=" 80",e=" 60",i),n=i+n,e=i+e,i=new T;return i[Et.WHOLE_TABLE_STYLE](M(n,0,0,0,A,A,A,A,y)),i[Et.REPORT_FILTER_LABELS_STYLE](M(t,0,0,0,A,y,A,y)),i[Et.REPORT_FILTER_VALUES_STYLE](M(t,0,0,0,A,y,A,y)),i[Et.FIRST_COLUMN_STRIPE_STYLE](M(e,n,0,0,y,y,y,y,y,y)),i[Et.FIRST_ROW_STRIPE_STYLE](M(e,n,0,0,A,y,A,y)),i[Et.HEADER_ROW_STYLE](M(t,0,0,1,A,y,A,y)),i[Et.SUBTOTAL_ROW1_STYLE](M(n,0,0,1)),i[Et.SUBTOTAL_ROW2_STYLE](M(w.BLACK,0,0,1)),i[Et.ROW_SUBHEADING1_STYLE](M(w.BLACK,0,0,1)),i[Et.ROW_SUBHEADING2_STYLE](M(w.BLACK,0,0,1)),i[Et.GRANDTOTAL_ROW_STYLE](M(t,0,0,1,A,y,A,y)),i}function X(t){var i,n,e,r,o,a,t,i=D(t);return 0===t?(n=" -15",e=" -35",o=w.TEXT1,r=w.TEXT1+" 50",a=w.COLUMN_STRIPE):(n=" 80",e=" 60",o=i+" -25",r=a=i),n=i+n,e=i+e,(t=new T)[Et.WHOLE_TABLE_STYLE](M(n,0,o,0,A,A,A,A,y)),t[Et.FIRST_COLUMN_STRIPE_STYLE](M(a,0,0,0,y,y,y,y)),t[Et.FIRST_ROW_STRIPE_STYLE](M(e,0,0,0,y,y,y,y)),t[Et.FIRST_COLUMN_STYLE](M(r,0,w.TEXT1,1,A,A,y)),t[Et.HEADER_ROW_STYLE](M(r,0,w.TEXT1,1,C,C,C,C)),t[Et.SUBTOTAL_ROW1_STYLE](M(e,n,w.TEXT1,1,A,A,A,y)),t[Et.SUBTOTAL_ROW2_STYLE](M(w.BLACK,0,w.TEXT1,1)),t[Et.COLUMN_SUBHEADING2_STYLE](M(e,0,0,0,A,y)),t[Et.ROW_SUBHEADING1_STYLE](M(i,n,0,1,A,A,A,y)),t[Et.ROW_SUBHEADING2_STYLE](M(w.BLACK,0,0,1)),t[Et.GRANDTOTAL_ROW_STYLE](M(r,0,w.TEXT1,1,C,C,C,C)),t}function $(t){var i,n,e,t,r,i,i=D(t),r="Background 1 -25",t=0===t?(n=" -15",e=" -35",w.TEXT1+" 50"):(n=" 80",e=" 40",i),n=i+n,e=i+e,i=new T;return i[Et.WHOLE_TABLE_STYLE](M(w.WHITE,w.WHITE)),i[Et.REPORT_FILTER_LABELS_STYLE](M(e,n,0,0,A,A,A,y)),i[Et.REPORT_FILTER_VALUES_STYLE](M(e,n,0,0,A,A,A,y)),i[Et.FIRST_COLUMN_STRIPE_STYLE](M(r,w.BACKGROUND_COLOR,0,0,y,A,y,A)),i[Et.FIRST_ROW_STRIPE_STYLE](M(w.BLACK,w.BACKGROUND_COLOR)),i[Et.HEADER_ROW_STYLE](M(e,n,w.TEXT1,1,A,A,A,y)),i[Et.SUBTOTAL_COLUMN1_STYLE](M(w.BLACK,r,w.TEXT1)),i[Et.SUBTOTAL_ROW1_STYLE](M(t,0,0,1,A,y,A,y)),i[Et.SUBTOTAL_ROW2_STYLE](M(w.BLACK,0,0,1)),i[Et.ROW_SUBHEADING1_STYLE](M(e,0,w.TEXT1,1,A,A,A,y)),i[Et.ROW_SUBHEADING2_STYLE](M(w.BLACK,0,w.TEXT1,1)),i[Et.GRANDTOTAL_ROW_STYLE](M(e,n,w.TEXT1,1,A,y)),i}function tt(t){var i,n,e,t,r,i,i=D(t),t=0===t?(n=" -15",e=" -35",r=w.TEXT1,w.TEXT1+" 50"):(n=" 80",e=" 60",(r=i)+" -25"),n=i+n,e=i+e,i=new T;return i[Et.WHOLE_TABLE_STYLE](M(t,0,r,0,y,y,y,y,0,y)),i[Et.REPORT_FILTER_LABELS_STYLE](M(w.BLACK,0,r,1)),i[Et.FIRST_COLUMN_STRIPE_STYLE](M(w.BLACK,n)),i[Et.FIRST_ROW_STRIPE_STYLE](M(t,n,0,0,A,y,A,y)),i[Et.FIRST_COLUMN_STYLE](M(w.BLACK,0,r,1)),i[Et.HEADER_ROW_STYLE](M(t,0,r,1,A,A,A,y)),i[Et.SUBTOTAL_COLUMN1_STYLE](M(e,0,r,1,y,A,y)),i[Et.SUBTOTAL_ROW1_STYLE](M(w.BLACK,0,r,1)),i[Et.SUBTOTAL_ROW2_STYLE](M(w.BLACK,0,r,1)),i[Et.GRANDTOTAL_ROW_STYLE](M(t,0,r,1,A,y)),i}function it(t){var i,n,e,e,i=t-1,n=s,e=Pt(i/7);return 0<=e&&e<4&&((n=[nt,et,rt,ot][e](i%7))[Bt.FIRST_ROW_STRIP_SIZE](1),n[Bt.FIRST_COLUMN_STRIP_SIZE](1),n[Bt.SECOND_COLUMN_STRIP_SIZE](1),n[Bt.SECOND_ROW_STRIP_SIZE](1),n.name(e="Medium"+t),n.builtInName(e)),n}function nt(t){var i,n,e,t,i,i=D(t),t=0===t?(n=" -15",e=" -35",w.TEXT1+" 50"):(n=" 80",e=" 60",i+" -25"),n=i+n,e=i+e,i=new T;return i[Et.WHOLE_TABLE_STYLE](M(n,0,w.TEXT1,0,A,A,A,A,y)),i[Et.REPORT_FILTER_LABELS_STYLE](M(n,0,0,0,A,y,A,y)),i[Et.REPORT_FILTER_VALUES_STYLE](M(n,0,0,0,A,y,A,y)),i[Et.FIRST_COLUMN_STRIPE_STYLE](M(t,0,0,0,y,A,y)),i[Et.FIRST_ROW_STRIPE_STYLE](M(t,0,0,0,A,y,A,y,y)),i[Et.HEADER_ROW_STYLE](M(t,t,w.WHITE,0,A,A,A,A,y)),i[Et.FIRST_HEADER_CELL_STYLE](M(w.BLACK,0,w.WHITE,1)),i[Et.SUBTOTAL_ROW1_STYLE](M(w.BLACK,e,w.WHITE,1)),i[Et.SUBTOTAL_ROW2_STYLE](M(w.BLACK,w.BACKGROUND_COLOR,w.TEXT1,1)),i[Et.COLUMN_SUBHEADING1_STYLE](M(n,0,0,0,A,A,A,y)),i[Et.ROW_SUBHEADING1_STYLE](M(n,e,w.WHITE,0,A,A,A,y,y)),i[Et.ROW_SUBHEADING2_STYLE](M(n,n,0,0,A,A,A,y)),i[Et.GRANDTOTAL_ROW_STYLE](M(t,0,w.TEXT1,1,A,Z)),i}function et(t){var i,n,e,r,o,a,t,i,i=D(t),t=0===t?(n=" -15",e=w.TEXT1+" 50",r=i+" -25",o=C,a=w.TEXT1,w.TEXT1+" 50"):(n=" 80",r=i+" 60",o=y,a=e=i+" -25",i),n=i+n,i=new T;return i[Et.WHOLE_TABLE_STYLE](M(w.BLACK,0,w.TEXT1)),i[Et.REPORT_FILTER_LABELS_STYLE](M(w.BLACK,n)),i[Et.REPORT_FILTER_VALUES_STYLE](M(w.BLACK,n)),i[Et.FIRST_COLUMN_STRIPE_STYLE](M(n,0,0,0,o,A,o)),i[Et.FIRST_ROW_STRIPE_STYLE](M(r,0,0,0,A,y,A,y,y)),i[Et.HEADER_ROW_STYLE](M(e,t,w.WHITE,1,A,o)),i[Et.SUBTOTAL_COLUMN1_STYLE](M(r,0,w.TEXT1,1,o,o,o,o)),i[Et.SUBTOTAL_ROW1_STYLE](M(w.BLACK,r,w.TEXT1,1)),i[Et.SUBTOTAL_ROW2_STYLE](M(w.BLACK,0,w.TEXT1,1)),i[Et.ROW_SUBHEADING1_STYLE](M(w.BLACK,n,w.TEXT1,1)),i[Et.ROW_SUBHEADING2_STYLE](M(w.BLACK,0,w.TEXT1,1)),i[Et.GRANDTOTAL_ROW_STYLE](M(a,0,w.TEXT1,1,A,y,A,C)),i}function rt(t){var i,n,e,r,o,t,i,i=D(t),t=0===t?(n=" -15",e=" -35",r=w.TEXT1+" 50",o=i+" -5",i+" -25"):(o=i+(n=" 80"),i+(e=" 60")),n=i+e,e=i+e,i=new T;return i[Et.WHOLE_TABLE_STYLE](M(n,o,w.TEXT1,0,y,A,y,A,A,y)),i[Et.REPORT_FILTER_LABELS_STYLE](M(w.TEXT1,0,0,0,A,y,A,y)),i[Et.REPORT_FILTER_VALUES_STYLE](M(w.TEXT1,0,w.BLACK,0,A,y,A,y)),i[Et.FIRST_COLUMN_STRIPE_STYLE](M(t,n,0,0,y,A,y)),i[Et.FIRST_ROW_STRIPE_STYLE](M(t,n,0,0,A,y,A,y)),i[Et.HEADER_ROW_STYLE](M(w.BLACK,w.TEXT1,w.WHITE,0,A,A,A,A,A,y)),i[Et.SUBTOTAL_COLUMN1_STYLE](M(e,t,w.TEXT1,0,y,y,y)),i[Et.SUBTOTAL_ROW1_STYLE](M(t,0,w.TEXT1,1)),i[Et.SUBTOTAL_ROW2_STYLE](M(w.BLACK,0,r,1)),i[Et.ROW_SUBHEADING1_STYLE](M(w.BLACK,0,w.TEXT1,1)),i[Et.ROW_SUBHEADING2_STYLE](M(w.BLACK,0,r,1)),i[Et.ROW_SUBHEADING3_STYLE](M(w.BLACK,0,w.TEXT1,1)),i[Et.GRANDTOTAL_ROW_STYLE](M(w.BLACK,w.TEXT1,w.WHITE,0,A,A,A,A,A,y)),i}function ot(t){var i,n,e,t,i,i=D(t),t=0===t?(n=" -15",e=w.TEXT1+" 50",i+" -25"):(n=" 80",e=i+" -25",i+" 60"),n=i+n,i=new T;return i[Et.WHOLE_TABLE_STYLE](M(w.WHITE,n,e,0,A,A,A,A,A,y)),i[Et.REPORT_FILTER_LABELS_STYLE](M(w.BLACK,t,e,1)),i[Et.REPORT_FILTER_VALUES_STYLE](M(w.BLACK,n,e,1)),i[Et.SECOND_COLUMN_STRIPE_STYLE](M(w.BLACK,t,0)),i[Et.SECOND_ROW_STRIPE_STYLE](M(w.BLACK,t)),i[Et.FIRST_COLUMN_STYLE](M(w.BLACK,t,e,1)),i[Et.HEADER_ROW_STYLE](M(w.WHITE,0,e,1,A,A,A,y)),i[Et.SUBTOTAL_ROW1_STYLE](M(w.BLACK,0,w.TEXT1,1)),i[Et.SUBTOTAL_ROW2_STYLE](M(w.BLACK,0,w.TEXT1,1)),i[Et.ROW_SUBHEADING1_STYLE](M(w.BLACK,0,w.TEXT1,1)),i[Et.GRANDTOTAL_ROW_STYLE](M(w.BLACK,0,e,1)),i}function at(t){var i,n,e,e,i=t-1,n=s,e=Pt(i/7);return 0<=e&&e<4&&((n=[st,ut,ct,lt][e](i%7))[Bt.FIRST_ROW_STRIP_SIZE](1),n[Bt.FIRST_COLUMN_STRIP_SIZE](1),n[Bt.SECOND_COLUMN_STRIP_SIZE](1),n[Bt.SECOND_ROW_STRIP_SIZE](1),n.name(e="Dark"+t),n.builtInName(e)),n}function st(t){var i,n,e,r,t,i,i=D(t),t=0===t?(n=" -15",e=" -35",r=w.TEXT1+" 50",i+" -25"):(n=" 80",e=" 40",r=i+" -50",i+" 60"),n=i+n,e=i+e,i=new T;return i[Et.WHOLE_TABLE_STYLE](M(n,t,w.TEXT1,0,A,A,A,A,y)),i[Et.REPORT_FILTER_LABELS_STYLE](M(r,r,w.WHITE,1,A,A,A,A,y)),i[Et.REPORT_FILTER_VALUES_STYLE](M(r,r,w.WHITE,0,A,A,A,A,y)),i[Et.SECOND_COLUMN_STRIPE_STYLE](M(n,0,0,0,y,A,y)),i[Et.SECOND_ROW_STRIPE_STYLE](M(w.BLACK,e)),i[Et.HEADER_ROW_STYLE](M(w.WHITE,r,w.WHITE,1,A,A,A,y,y)),i[Et.SUBTOTAL_ROW1_STYLE](M(e,0,w.TEXT1,1,A,A,A,y)),i[Et.ROW_SUBHEADING1_STYLE](M(e,n,w.TEXT1,1,A,y,A,y)),i[Et.ROW_SUBHEADING2_STYLE](M(w.BLACK,0,w.TEXT1,1)),i[Et.GRANDTOTAL_ROW_STYLE](M(w.BLACK,r,w.WHITE,1)),i}function ut(t){var i,n,e,t,r,i,i=D(t),r=w.TEXT1+" -25",t=0===t?(n=" -15",e=w.TEXT1+" 50",i+" -25"):(n=" 80",i+" 60"),n=i+n,i=new T;return i[Et.WHOLE_TABLE_STYLE](M(e,n,w.TEXT1,0,C,C,C,C)),i[Et.REPORT_FILTER_LABELS_STYLE](M(e,0,0,0,y,y,A,y)),i[Et.REPORT_FILTER_VALUES_STYLE](M(e,0,0,0,A,y,y,y)),i[Et.FIRST_COLUMN_STRIPE_STYLE](M(w.COLUMN_STRIPE,0,0,0,y,A,y)),i[Et.SECOND_COLUMN_STRIPE_STYLE](M(w.COLUMN_STRIPE,0,0,0,y,A,y)),i[Et.SECOND_ROW_STRIPE_STYLE](M(t,0,0,0,A,y,A,y)),i[Et.HEADER_ROW_STYLE](M(w.BLACK,r,w.WHITE,1)),i[Et.SUBTOTAL_ROW1_STYLE](M(w.BLACK,t,w.TEXT1,1)),i[Et.COLUMN_SUBHEADING2_STYLE](M(t,0,0,0,A,y)),i[Et.COLUMN_SUBHEADING3_STYLE](M(t,0,0,0,A,y)),i[Et.ROW_SUBHEADING1_STYLE](M(n,t,w.TEXT1,1,A,A,A,y)),i[Et.ROW_SUBHEADING2_STYLE](M(w.BLACK,0,w.TEXT1,1)),i[Et.GRANDTOTAL_ROW_STYLE](M(w.BLACK,r,w.WHITE,1)),i}function ct(t){var i,n,e,r,t,o,i,i=D(t),o=i+" -25",t=0===t?(n=" -15",e=" -35",r=w.TEXT1+" 50",w.COLUMN_STRIPE):(n=" 80",e=" 60",r=i+" -25",i),n=i+n,e=i+e,i=new T;return i[Et.WHOLE_TABLE_STYLE](M(w.BLACK,t,n)),i[Et.REPORT_FILTER_LABELS_STYLE](M(w.BLACK,0,w.WHITE,1)),i[Et.FIRST_COLUMN_STRIPE_STYLE](M(o,0,0,y,A,y)),i[Et.FIRST_ROW_STRIPE_STYLE](M(e,0,0,0,A,y,A,y)),i[Et.HEADER_ROW_STYLE](M(w.BLACK,w.TEXT1,w.WHITE,1)),i[Et.SUBTOTAL_COLUMN1_STYLE](M(e,r,0,0,y,y,y,y)),i[Et.SUBTOTAL_ROW1_STYLE](M(w.BLACK,0,w.WHITE,1)),i[Et.COLUMN_SUBHEADING1_STYLE](M(e,0,0,0,A,A,A,y)),i[Et.ROW_SUBHEADING1_STYLE](M(r,r,w.WHITE,1,A,A,A,y)),i[Et.ROW_SUBHEADING2_STYLE](M(w.BLACK,0,w.WHITE,1)),i[Et.GRANDTOTAL_ROW_STYLE](M(w.BLACK,w.TEXT1,w.WHITE,1)),i}function lt(t){var i,n,e,r,o,i,i=D(t);return 0===t?(n=" -15",e=w.TEXT1+" 50",r=i+" -50",o=w.COLUMN_STRIPE):(n=" 80",e=i+" -25",o=i+" 40",r=i),n=i+n,(i=new T)[Et.WHOLE_TABLE_STYLE](M(w.WHITE,r,n,0,A,A,A,A,A,y)),i[Et.REPORT_FILTER_LABELS_STYLE](M(w.BLACK,e,0,0)),i[Et.SECOND_COLUMN_STRIPE_STYLE](M(w.BLACK,o,0)),i[Et.SECOND_ROW_STRIPE_STYLE](M(w.BLACK,o)),i[Et.FIRST_COLUMN_STYLE](M(w.BLACK,e)),i[Et.HEADER_ROW_STYLE](M(w.WHITE,e,0,0,A,A,A,C)),i[Et.FIRST_HEADER_CELL_STYLE](M(w.BLACK,0,w.WHITE,1)),i[Et.SUBTOTAL_ROW1_STYLE](M(w.BLACK,0,n,1)),i[Et.SUBTOTAL_ROW2_STYLE](M(w.BLACK,0,0===t?w.TEXT1:w.WHITE,1)),i[Et.ROW_SUBHEADING1_STYLE](M(w.BLACK,0,w.WHITE,1)),i[Et.ROW_SUBHEADING1_STYLE](M(w.BLACK,0,w.WHITE,1)),i[Et.GRANDTOTAL_ROW_STYLE](M(w.WHITE,0,w.WHITE,1,A,C)),i}function ft(){}function ht(){e.light0=J(0);for(var t=1;t<=28;t++)e["light"+t]=J(t),e["medium"+t]=it(t),e["dark"+t]=at(t)}function vt(e,r){e.name(r.name()),m(l,function(t,i){e[i](r[i]())}),m(c,function(t,i){var n=r[i]();e[i](n?n.Gf():s)}),e.builtInName(r.builtInName(),!1)}Object.defineProperty(t,"__esModule",{value:!0}),t.PivotTableThemes=t.PivotTableTheme=t.PivotTableStyle=void 0,j=i("@spreadjs/js-sheets-common"),_t=i("Core"),Ft=i("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),O=i("./dist/plugins/pivot/pivot-table/pivot-table.js"),m=_t.GC$.each,o=_t.GC$.isEmptyObject,b=_t.mt.T1,_=JSON.stringify,F=JSON.parse,n=_t.mt.p0,a=j.Common.lt.ht,Pt=Math.floor,s=null,P=_t.util.go,u=_t.NodeHelper.sr,L={wholeTable:"wholeTableStyle",pageFieldLabels:"reportFilterLabelsStyle",pageFieldValues:"reportFilterValuesStyle",firstRowStripe:"firstRowStripeStyle",secondRowStripe:"secondRowStripeStyle",firstColumnStripe:"firstColumnStripeStyle",secondColumnStripe:"secondColumnStripeStyle",firstColumn:"firstColumnStyle",headerRow:"headerRowStyle",firstHeaderCell:"firstHeaderCellStyle",firstSubtotalColumn:"subtotalColumn1Style",secondSubtotalColumn:"subtotalColumn2Style",thirdSubtotalColumn:"subtotalColumn3Style",blankRow:"blankRowStyle",firstSubtotalRow:"subtotalRow1Style",secondSubtotalRow:"subtotalRow2Style",thirdSubtotalRow:"subtotalRow3Style",firstColumnSubheading:"columnSubheading1Style",secondColumnSubheading:"columnSubheading2Style",thirdColumnSubheading:"columnSubheading3Style",firstRowSubheading:"rowSubheading1Style",secondRowSubheading:"rowSubheading2Style",thirdRowSubheading:"rowSubheading3Style",lastColumn:"grandTotalColumnStyle",totalRow:"grandTotalRowStyle"},c=[(Et={WHOLE_TABLE_STYLE:"wholeTableStyle",REPORT_FILTER_LABELS_STYLE:"reportFilterLabelsStyle",REPORT_FILTER_VALUES_STYLE:"reportFilterValuesStyle",FIRST_COLUMN_STRIPE_STYLE:"firstColumnStripeStyle",SECOND_COLUMN_STRIPE_STYLE:"secondColumnStripeStyle",FIRST_ROW_STRIPE_STYLE:"firstRowStripeStyle",SECOND_ROW_STRIPE_STYLE:"secondRowStripeStyle",FIRST_COLUMN_STYLE:"firstColumnStyle",HEADER_ROW_STYLE:"headerRowStyle",FIRST_HEADER_CELL_STYLE:"firstHeaderCellStyle",SUBTOTAL_COLUMN1_STYLE:"subtotalColumn1Style",SUBTOTAL_COLUMN2_STYLE:"subtotalColumn2Style",SUBTOTAL_COLUMN3_STYLE:"subtotalColumn3Style",BLANK_ROW_STYLE:"blankRowStyle",SUBTOTAL_ROW1_STYLE:"subtotalRow1Style",SUBTOTAL_ROW2_STYLE:"subtotalRow2Style",SUBTOTAL_ROW3_STYLE:"subtotalRow3Style",COLUMN_SUBHEADING1_STYLE:"columnSubheading1Style",COLUMN_SUBHEADING2_STYLE:"columnSubheading2Style",COLUMN_SUBHEADING3_STYLE:"columnSubheading3Style",ROW_SUBHEADING1_STYLE:"rowSubheading1Style",ROW_SUBHEADING2_STYLE:"rowSubheading2Style",ROW_SUBHEADING3_STYLE:"rowSubheading3Style",GRANDTOTAL_COLUMN_STYLE:"grandTotalColumnStyle",GRANDTOTAL_ROW_STYLE:"grandTotalRowStyle"}).WHOLE_TABLE_STYLE,Et.REPORT_FILTER_LABELS_STYLE,Et.REPORT_FILTER_VALUES_STYLE,Et.FIRST_COLUMN_STRIPE_STYLE,Et.SECOND_COLUMN_STRIPE_STYLE,Et.FIRST_ROW_STRIPE_STYLE,Et.SECOND_ROW_STRIPE_STYLE,Et.FIRST_COLUMN_STYLE,Et.HEADER_ROW_STYLE,Et.FIRST_HEADER_CELL_STYLE,Et.SUBTOTAL_COLUMN1_STYLE,Et.SUBTOTAL_COLUMN2_STYLE,Et.SUBTOTAL_COLUMN3_STYLE,Et.BLANK_ROW_STYLE,Et.SUBTOTAL_ROW1_STYLE,Et.SUBTOTAL_ROW2_STYLE,Et.SUBTOTAL_ROW3_STYLE,Et.COLUMN_SUBHEADING1_STYLE,Et.COLUMN_SUBHEADING2_STYLE,Et.COLUMN_SUBHEADING3_STYLE,Et.ROW_SUBHEADING1_STYLE,Et.ROW_SUBHEADING2_STYLE,Et.ROW_SUBHEADING3_STYLE,Et.GRANDTOTAL_COLUMN_STYLE,Et.GRANDTOTAL_ROW_STYLE],B=!(E=!(Lt=void 0)),l=[(Bt={FIRST_ROW_STRIP_SIZE:"firstRowStripSize",SECOND_ROW_STRIP_SIZE:"secondRowStripSize",FIRST_COLUMN_STRIP_SIZE:"firstColumnStripSize",SECOND_COLUMN_STRIP_SIZE:"secondColumnStripSize"}).FIRST_ROW_STRIP_SIZE,Bt.SECOND_ROW_STRIP_SIZE,Bt.FIRST_COLUMN_STRIP_SIZE,Bt.SECOND_COLUMN_STRIP_SIZE],f={firstColumnStripeStyle:Bt.FIRST_COLUMN_STRIP_SIZE,firstRowStripeStyle:Bt.FIRST_ROW_STRIP_SIZE,secondColumnStripeStyle:Bt.SECOND_COLUMN_STRIP_SIZE,secondRowStripeStyle:Bt.SECOND_ROW_STRIP_SIZE},i="name",R="bold 14.667px calibri",G="bold",V="14.667px",U="calibri",g=["backColor","foreColor",h="borderLeft",v="borderTop",d="borderRight",p="borderBottom",W="borderHorizontal",z="borderVertical","textDecoration","fontStyle","fontWeight","fontSize","fontFamily","_fontVariant","_fontStretch","_lineHeight"],w={TEXT1:"Text 1",BLACK:"rgb(0,0,0)",COLUMN_STRIPE:"rgb(140,140,140)",WHITE:"rgb(255,255,255)",BACKGROUND_COLOR:"Background 1 -15"},y=_t.LineStyle.thin,C=_t.LineStyle.medium,A=_t.LineStyle.empty,Z=_t.LineStyle.double,N=_t.W.upe,Object.defineProperty(r.prototype,"font",{get:function(){return this._font},set:function(t){_t.W.oce(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fontSize",{get:function(){return this.lre},set:function(t){_t.W.dpe(this,t)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fontStyle",{get:function(){return this.spe},set:function(t){var i=this;i.spe=t,i._font=N(i.spe,i.cpe,i.lre,i.lpe,i.b2e,i.y2e,i.w2e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fontWeight",{get:function(){return this.cpe},set:function(t){var i=this;i.cpe=t,i._font=N(i.spe,i.cpe,i.lre,i.lpe,i.b2e,i.y2e,i.w2e)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fontFamily",{get:function(){return this.lpe},set:function(t){var i=this;i.lpe=t,i._font=N(i.spe,i.cpe,i.lre,i.lpe,i.b2e,i.y2e,i.w2e)},enumerable:!1,configurable:!0}),r.prototype.h5=function(n,e,r,o,a){var s=this;m(g,function(t,i){0<=i.indexOf("border")?(r&&b(s[h])&&(n[h]=s[h]),e&&b(s[v])&&(n[v]=s[v]),!o&&b(s[W])&&(n[p]=s[W]),!a&&b(s[z])&&(n[d]=s[z]),a&&b(s[d])&&(n[d]=s[d]),o&&b(s[p])&&(n[p]=s[p])):b(s[i])&&(n[i]=s[i])})},r.prototype.Gf=function(){var t,i,t=new r,i=_(this.toJSON());return t.fromJSON(F(i)),t},r.prototype.toJSON=function(){var e,r,e=this,r={};return m(g,function(t,i){var n,n,n=e[i],n=n&&n.toJSON?n.toJSON():n;r[i]=n!==s&&o(n)?Lt:n}),r.font=e.font,r},r.prototype.fromJSON=function(r,o){var a;r&&(a=this,m(g,function(t,i){var n,e,n=r[i];b(n)&&(0<=i.indexOf("border")?((e=new _t.LineBorder).fromJSON(n,o),a[i]=e):a[i]=n)}),r.font)&&(a.font=r.font)},I=r,t.PivotTableStyle=I,S.prototype.h5=function(t,i,L,n){var e,E,r,B,o,R,G,V,U,Q,W,z,Z,Y,H,J,q,K,X,$,tt,it,nt,et,rt,ot,at,st,ut,ct,lt,a,ft,ht,s,u,c,l,f,h,v,d,vt,p,m,v,b,g,dt,pt,mt,bt,w,gt,wt,yt,y,C,Ct,yt,A,N,I,T,S,x,At,M,D,s,k,x,T,r,s,I,r,T,x,r,j,O,Nt,It,S,_,F,Tt,St,xt,Mt,O,P,D,Dt,k,B,kt,s,T,x,o,jt,Ot,e=this;if(!n.Oy||!n.Oy()){if(E=n.Ti,r=e[Et.WHOLE_TABLE_STYLE](),B=e[Et.REPORT_FILTER_LABELS_STYLE](),o=e[Et.REPORT_FILTER_VALUES_STYLE](),R=e[Et.FIRST_COLUMN_STRIPE_STYLE](),G=e[Et.SECOND_COLUMN_STRIPE_STYLE](),V=e[Et.FIRST_ROW_STRIPE_STYLE](),U=e[Et.SECOND_ROW_STRIPE_STYLE](),Q=e[Et.FIRST_COLUMN_STYLE](),W=e[Et.HEADER_ROW_STYLE](),z=e[Et.FIRST_HEADER_CELL_STYLE](),Z=e[Et.SUBTOTAL_COLUMN1_STYLE](),Y=e[Et.SUBTOTAL_COLUMN2_STYLE](),H=e[Et.SUBTOTAL_COLUMN3_STYLE](),J=e[Et.BLANK_ROW_STYLE](),q=e[Et.SUBTOTAL_ROW1_STYLE](),K=e[Et.SUBTOTAL_ROW2_STYLE](),X=e[Et.SUBTOTAL_ROW3_STYLE](),$=e[Et.COLUMN_SUBHEADING1_STYLE](),tt=e[Et.COLUMN_SUBHEADING2_STYLE](),it=e[Et.COLUMN_SUBHEADING3_STYLE](),nt=e[Et.ROW_SUBHEADING1_STYLE](),et=e[Et.ROW_SUBHEADING2_STYLE](),rt=e[Et.ROW_SUBHEADING3_STYLE](),ot=e[Et.GRANDTOTAL_COLUMN_STYLE](),at=e[Et.GRANDTOTAL_ROW_STYLE](),st=e[Bt.FIRST_COLUMN_STRIP_SIZE](),ut=e[Bt.SECOND_COLUMN_STRIP_SIZE](),ct=e[Bt.FIRST_ROW_STRIP_SIZE](),lt=e[Bt.SECOND_ROW_STRIP_SIZE](),a=n.options.showRowHeader,ft=n.options.showColumnHeader,ht=n.options.insertBlankLineAfterEachItem,s=n.getRange().content,u=n.layoutType(),c=t-s.row,l=i-s.col,f=t-n.LYt.row,h=i-n.LYt.col,d=(v=n.rZt.HWt)[0],vt=v[1],p=v[2],m=v[3],b=c==(v=v[4]).DQ+v.Sx-1,g=l==s.colCount-1,dt=c===p.DQ,pt=c==p.DQ+p.Sx-1,mt=c===v.DQ,bt=0==l,w=l===m.jN,gt=l==m.jN+m.Tx-1,wt=m.zWt,yt=m.DQ,y=p.WWt,C=p.DQ,yt=c-yt,A=l-(Ct=p.jN),N=new _t.Style,S=(T=new _t.Range(n.LYt.row,n.LYt.col,n.LYt.rowCount,n.LYt.colCount)).contains(t,i),x=s.contains(t,i),r&&(At=t===s.row&&x||t===T.row&&S,M=t===s.row+s.rowCount-1&&x||t===T.row+T.rowCount-1&&S,D=i===s.col&&x||i===T.col&&S,s=i===T.col+s.colCount-1&&x||i===T.col+T.colCount-1&&S,S&&(h-d.jN)%3!=2&&(k=d.dataTable,M||D||k[1+f]&&k[1+f][h]===Lt&&(M=!0),s||At||k[f]&&k[f][1+h]===Lt&&(s=!0)),r.h5(N,At,D,M,s)),d.getRange().contains(f,h)&&(At=0==f,D=0==h,M=f==d.Sx-1,x=n.dh.nw(0).length,T=n.options.reportFilterFieldsPerColumn,r=n.options.displayFieldsInPageFilterArea,I=s=void 0,I=0===T?0===r?(s=x,0):(s=0,3*x):(s=Pt(x/T),3*(x%n.options.reportFilterFieldsPerColumn-1)),T=t-(r=n.getRange().page).row,x=i-r.col,S&&(h-d.jN)%3!=2&&(k=d.dataTable,M||D||k[1+f][h]===Lt&&(M=!0)),(h-d.jN)%3==0?B&&(s===T&&I<x?N=new _t.Style:B.h5(N,At,!0,M,!0)):(h-d.jN)%3==1?o&&(s===T&&I<x-1?N=new _t.Style:o.h5(N,At,!0,M,!0)):N=new _t.Style,I=d.ML(f,h)),r=new _t.Range(v.DQ,v.jN,m.Sx,p.Tx),p.getRange().contains(c,l)||r.contains(c,l)){if(p.getRange().contains(c,l))ft&&(W&&W.h5(N,dt,w,pt,g),y[A]&&0!==y[A].grandTotalLevel&&$&&(O=(j=C+1)<c,c===j&&$.h5(N,!0,bt,!0,g),O)&&2===y[A].grandTotalLevel&&$.h5(N,!0,!0,!0,!0),y[A]&&0!==y[A].grandTotalLevel&&tt&&(O=(Nt=C+2)<c,c===Nt&&tt.h5(N,!0,bt,!0,g),O)&&3===y[A].grandTotalLevel&&tt.h5(N,!0,!0,!0,!0),y[A])&&0!==y[A].grandTotalLevel&&it&&(O=(It=C+3)<c,c===It&&it.h5(N,!0,bt,!0,g),O)&&4===y[A].grandTotalLevel&&it.h5(N,!0,!0,!0,!0),I=p.ML(c-p.DQ,l-p.jN);else if(S=c-v.DQ,St=Tt=F=_=void 0,n.options.bandColumns&&wt[S]&&0!==wt[S].grandTotalLevel&&0<(_=st+ut)){if((F=n.zSt[i])===Lt){if(xt=0,E)for(Mt=v.jN;Mt<l;Mt++)0<+E.getColumnWidth(Mt)&&xt++;F=n.zSt[i]=xt%_}F<st&&R?R.h5(N,mt,Tt=0===F,b,St=g||F===st-1):st<=F&&G&&G.h5(N,mt,Tt=F===st,b,St=g||F===_-1)}P=(O=y[A])&&O.grandTotalLevel%3,D=n.NZt,Z&&(j=C+1,O)&&O.isSubtotal&&O.collapseIndex===Lt&&1===P&&j<=c&&1<D&&Z.h5(N,Dt=c===j,!0,b,!0),Y&&(Nt=C+2,O)&&O.isSubtotal&&O.collapseIndex===Lt&&2===P&&Nt<=c&&2<D&&Y.h5(N,Dt=c===Nt,!0,b,!0),H&&(It=C+3,O)&&O.isSubtotal&&O.collapseIndex===Lt&&0===P&&It<=c&&3<D&&H.h5(N,Dt=c===It,!0,b,!0)}if((k=m.getRange().contains(c,l))||r.contains(c,l)){if(k&&(Q&&a&&(Dt=c===vt.DQ,B=l===m.jN,kt=c==vt.Sx+m.Sx-1,s=l==m.Tx-1,Q.h5(N,Dt,B,kt,s)),I=m.ML(c-m.DQ,l-m.jN)),St=Tt=F=_=void 0,T=wt[yt],O=y[A],P=T&&T.grandTotalLevel%3,x=T&&T.rowHeaderLevel%3,o=n.AZt,n.options&&n.options.bandRows&&T&&0!==P&&(!O||!O.isSubtotal&&!O.isGrandTotal)&&0<(_=ct+lt)){if((F=n.HSt[t])===Lt){if(jt=0,E)for(Ot=v.DQ;Ot<c;Ot++)0<+E.getRowHeight(Ot)&&jt++;F=n.HSt[t]=jt%_}F<ct&&V?V.h5(N,Tt=0===F,w,St=b||F===ct-1,g):ct<=F&&U&&U.h5(N,Tt=F===ct,w,St=b||F===_-1,g)}q&&T&&1===P&&T.isSubtotal&&T.collapseIndex===Lt&&(-1<l||u===Ft.PivotTableLayoutType.compact)&&1<o&&q.h5(N,!0,w,!0,g),K&&T&&2===P&&T.isSubtotal&&T.collapseIndex===Lt&&(0<l||u===Ft.PivotTableLayoutType.compact)&&2<o&&K.h5(N,!0,w,!0,g),X&&T&&0===P&&T.isSubtotal&&T.collapseIndex===Lt&&(1<l||u===Ft.PivotTableLayoutType.compact)&&3<o&&X.h5(N,!0,w,!0,g),T&&nt&&a&&1<o&&!(T.isSubtotal&&(P<2||x<2)&&T.collapseIndex===Lt||T.isGrandTotal||T.isBlankRow)&&(!(u!==Ft.PivotTableLayoutType.tabular&&1===T.rowHeaderLevel&&!T.isValueFieldDim||u===Ft.PivotTableLayoutType.tabular&&0==l)||u===Ft.PivotTableLayoutType.outline&&l<0||nt.h5(N,mt,w,b,gt)),T&&et&&a&&2<o&&!(T.isSubtotal&&(P<3||x<3)&&T.collapseIndex===Lt||T.isGrandTotal||T.isBlankRow)&&(!(u!==Ft.PivotTableLayoutType.tabular&&2===T.rowHeaderLevel&&!T.isValueFieldDim||u===Ft.PivotTableLayoutType.tabular&&1==l)||u===Ft.PivotTableLayoutType.outline&&l<1||et.h5(N,mt,w,b,gt)),T&&rt&&a&&3<o&&!(T.isSubtotal&&(P<1||x<1)&&T.collapseIndex===Lt||T.isGrandTotal||T.isBlankRow)&&(!(u!==Ft.PivotTableLayoutType.tabular&&3===T.rowHeaderLevel&&!T.isValueFieldDim||u===Ft.PivotTableLayoutType.tabular&&2==l)||u===Ft.PivotTableLayoutType.outline&&l<2||rt.h5(N,mt,w,b,gt)),ht&&J&&T&&T.isBlankRow&&J.h5(N,!0,w,!0,g)}ot&&(j=C+1,y[A])&&0===y[A].grandTotalLevel&&ot.h5(N,c===j,!0,b,!0),at&&wt[yt]&&0===wt[yt].grandTotalLevel&&at.h5(N,!0,w,!0,g),vt.getRange().contains(c,l)&&(Q&&a&&Q.h5(N,dt,w,b,gt),W&&ft&&W.h5(N,dt,w,pt,g),z&&ft&&a&&(kt=c==vt.getRange().rowCount-1,z.h5(N,dt,w,kt,gt)),I=vt.ML(c,l)),e.P5t(L,N,I)}},S.prototype.P5t=function(t,i,n){var t=t=a(t)?{}:t,e=20,r,r,r,r;a(t.backColor)&&(t.backColor=i.backColor),t.foreColor===Lt&&(t.foreColor=i.foreColor),a(t.themeFont)&&a(t.lpe)&&(t.themeFont=i.themeFont),a(t.lpe)&&(t.lpe=i.lpe),a(t.lre)&&(t.lre=i.lre,t.Uge=i.Uge,t.fpe=i.fpe),t.spe===Lt&&(t.spe=i.spe),t.cpe===Lt&&(t.cpe=i.cpe),t.b2e===Lt&&(t.b2e=i.b2e),t.y2e===Lt&&(t.y2e=i.y2e),t.w2e===Lt&&(t.w2e=i.w2e),t._font=N(t.spe,t.cpe,t.lre,t.lpe,t.b2e,t.y2e,t.w2e),a(t.borderLeft)&&(r=i.borderLeft,t.borderLeft=r&&r.Gf()||r,t.borderLeft)&&(t.borderLeft.level=20),a(t.borderTop)&&(r=i.borderTop,t.borderTop=r&&r.Gf()||r,t.borderTop)&&(t.borderTop.level=20),a(t.borderRight)&&(r=i.borderRight,t.borderRight=r&&r.Gf()||r,t.borderRight)&&(t.borderRight.level=20),a(t.borderBottom)&&(r=i.borderBottom,t.borderBottom=r&&r.Gf()||r,t.borderBottom)&&(t.borderBottom.level=20),a(t.textDecoration)&&(t.textDecoration=i.textDecoration),a(t.cellType)&&(t.cellType=i.cellType),a(t.formatter)&&(t.formatter=i.formatter),a(n)||(a(t.cellButtons)&&!a(n.cellButtons)&&(t.cellButtons=n.cellButtons),a(t.textIndent)&&!a(n.textIndent)&&(t.textIndent=n.textIndent),a(t.cellPadding)&&!a(n.cellPadding)&&(t.cellPadding=n.cellPadding))},S.prototype.toJSON=function(){var n,t,e,r,n=this,t=n.builtInName();return t?{buildInName:t}:(e={name:n.name()},m(c,function(t,i){(r=n[i]())&&(e[i]=r.toJSON())}),m(l,function(t,i){1!==(r=n[i]())&&(e[i]=r)}),o(e)?Lt:e)},S.prototype.wh=function(e){var r=this,o,a=[];if(m(c,function(t,i){var n;((o=r[i]())||f[i])&&(n={n_:"tableStyleElement",type:_t.SJSStylePropsToStyleProps[i]},o&&(n.dxfId=e.getDxfIndex(o)),f[i]&&1!==f[i]&&(n.size=r[f[i]]()),a.push(n))}),0<a.length)return a},S.prototype.fromJSON=function(r,o){var a,t,t;r&&(a=this,(t=r.buildInName)?vt(a,e[t.toLowerCase()]):(t=r.name,b(t)&&a.name(t,!1),m(l,function(t,i){var n=r[i]!==Lt?r[i]:r["_"+i];n&&a[i](n,!1)}),m(c,function(t,i){var n,e,n=r[i]!==Lt?r[i]:r["_"+i];n&&((e=new I).fromJSON(n,o),a[i](e,!1))})))},S.prototype.yh=function(t,o){var a,t,i,n,e,r,a=this;if(a.name(t.name),t=P(t,"tableStyleElement")){for(i=function(t){var i,n,t,e,r,i=u(t.dxfId,0),n=t.type,t=u(t.size,1),e=new I,r=L[n||"wholeTable"];"function"==typeof a[r]&&(o.getDxf(i,e,!0),m(g,function(t,i){0<=i.indexOf("border")&&e[i]===s&&(e[i]=new _t.LineBorder)}),a[r](e,!1)),"firstRowStripe"!==n&&"secondRowStripe"!==n&&"firstColumnStripe"!==n&&"secondColumnStripe"!==n||a[n.substr(0,n.length-1)+"Size"](t,!1)},n=0,e=t;n<e.length;n++)i(r=e[n]);o.addPivotTableTheme(a)}},T=S,t.PivotTableTheme=T,m(c,function(t,i){T.prototype[i]=n(i)}),m(l,function(t,i){T.prototype[i]=n(i,1)}),T.prototype.name=n(i),T.prototype.builtInName=n("builtInName"),Y="white",H="black",e=ft,t.PivotTableThemes=e,ht(),_t.GC$.extend(_t.StyleManager.prototype,{addPivotTableTheme:function(t){var i=this,n,n;(n=(n=i.SJt)||(i.SJt={}))[t.name()]=t},getPivotTableTheme:function(t){var i,n,e,r,i=this,n=i.SJt;return n=n||(i.SJt={}),O.BuiltInPivotTableThemeNames[t.toUpperCase()]?n[e=t.replace("PivotStyle","").toLowerCase()]?n[e]:(vt(r=new T,n[e]),i.addPivotTableTheme(r),r):n[t]}})},"./dist/plugins/pivot/pivot-table/pivot-table.js":function(o,M,t){"use strict";var s,D,w,vt,i,dt,pt,mt,h,v,U,Q,d,p,m,g,j,c,k,Z,W,Y,N,I,O,_,T,P,t,bt,S,x,L,t,b,E,gt,y,G,t,wt,V,F,H,C,a,J,q,l,K,X,f;function $(){for(var t,i,t={},i=1;i<=28;i++)t["PIVOTSTYLELIGHT"+i]=!0,t["PIVOTSTYLEMEDIUM"+i]=!0,t["PIVOTSTYLEDARK"+i]=!0;return t}function n(t){return t===gt?"":t}function tt(t){var i,t,i="{type:"+n(t.type)+",fieldName:"+n(t.fieldName)+",offset:"+n(t.offset)+",dataLabel:"+n(et(t))+",grandRow:"+n(t.grandRow)+",grandCol:"+n(t.grandCol)+",axis:"+n(t.axis);return t.references&&0<t.references.length&&(i+=",references:[",t.references.forEach(function(t){var t;t&&(i+="{axis:"+n(t.fieldName)+",subtotal:"+n(t.subtotal)+",offset:"+n(t.offset),(t=t.items)&&0<t.length&&(i+=",items[",t.forEach(function(t){i+=n(t)+","}),i+="]"),i+="},")}),i+="]"),t.offset&&(t=t.offset,i+=",offset:{row:"+t.row+",col:"+t.col+",rowCount:"+t.rowCount+",colCount:"+t.colCount+"}"),i+="}"}function yt(t,i,n,e){return new vt.Range(t,i,n,e)}function e(t,i){this.kJt=t,this.jJt=i,this.views=[]}function it(t,i,n,e,r,o,a,s,u,c,l){var f,h,v,d,n,v,p,m,b,g,w,y,n,C,A,N,I,T,S,x,M,D,k,j,O,f=[],v=n.zWt,d=n.dataTable,n=v[t];if(n){if(v=n.path,p=n.isSubtotal,m=n.isGrandTotal,b=n.isBlankRow,g=n.valueFieldName,w=n.collapseIndex,y=n.isValueFieldDim,n=n.compactLevel,(0,pt.ht)(g)||(h=g),m&&a&&(c||l))return{OJt:h,PJt:f};if(u&&!l&&(p&&bt(w)||m)){for(C="",A=0;A<d[t].length;A++)d[t]&&d[t][A]&&(C+=d[t][A].value);return{PJt:N=[{fieldName:m?V:F,itemName:C}],OJt:h}}for(I=v.split(pt.Separator),T=[].concat(e),S=void 0,x=u?wt().sigmaValueTemp:wt().sigmaValue,bt(o)||c||(T.splice(o,0,{Zc:x}),I.splice(o,0,x)),M=a||c||p&&bt(w)?I.length-1:s?Math.max(n,0):i,D=0;D<=M;D++)N={},k=T[D],bt(k)||(O="",N={fieldName:j=k.Zc,itemName:O=j===x?h:(0,dt.FZt)(r,k.Zc,I[D])},D===M&&(S={name:j===x?O:j,index:D}),D===I.length-1&&(b&&(N.isBlankRow=!0),p&&(N.isSubtotal=!0),bt(w)||(N.collapseIndex=w)),m&&(N.isGrandTotal=!0),f.push(N));return{isBlankRow:b,isValueFieldDim:y,OJt:h,activeRowFieldInfo:S,PJt:f}}}function nt(t,i,n,e,r,o,a,s,u,c,l){var f,h,v,d,n,v,p,m,b,g,w,n,y,C,A,N,I,T,S,x,M,D,k,j,f=[],v=n.WWt,d=n.dataTable,n=v[i];if(n){if(v=n.path,p=n.isSubtotal,m=n.isGrandTotal,b=n.valueFieldName,g=n.isBlankColumn,w=n.collapseIndex,n=n.grandTotalLevel,(0,pt.ht)(b)||(h=b),g)return{isBlankColumn:g};if(m&&a&&(c||l))return{OJt:h,FJt:f};if(u&&!l&&(p&&bt(w)&&0===n||m)){for(y="",C=0;C<d.length;C++)d[C]&&d[C][i]&&(y+=d[C][i].value);return{FJt:A=[{fieldName:m?V:F,itemName:y}],OJt:h}}for(N=v.split(pt.Separator),I=[].concat(e),T=void 0,S=u?wt().sigmaValueTemp:wt().sigmaValue,bt(o)||c||(I.splice(o,0,{Zc:S}),N.splice(o,0,S)),x=a||c||p&&bt(w)?N.length-1:t-1,M=0;M<=x;M++)A=void 0,D=I[M],bt(D)||(j="",A={fieldName:k=D.Zc,itemName:j=k===S?b:(0,dt.FZt)(r,D.Zc,N[M])},M===x&&(T={name:k===S?j:k,index:M}),M===N.length-1&&p&&(A.isSubtotal=!0),bt(w)||(A.collapseIndex=w),m&&(A.isGrandTotal=!0),f.push(A));return{activeColFieldInfo:T,OJt:h,FJt:f}}}function A(t){var i=[];return t&&t.forEach(function(t){bt(t.itemName)||i.push(t.itemName)}),i.join(" - ")}function et(t){return!1===t.dataOnly&&bt(t.labelOnly)||!0===t.dataOnly&&!0===t.labelOnly?"all":!1===t.dataOnly&&!1===t.labelOnly||bt(t.dataOnly)&&bt(t.labelOnly)?"dataOnly":!0!==t.labelOnly||t.dataOnly?t.labelOnly||t.dataOnly?void 0:"none":"labelOnly"}function rt(t,i,n){return void 0===n&&(n=!0),!bt(t)&&!bt(i)&&tt(t)===tt(i)}function ot(t){t.references&&1<t.references.length&&(t.references.sort(function(t,i){return t.fieldName>i.fieldName?-1:t.fieldName<i.fieldName?1:void 0}),t.references.forEach(function(t){var i;t&&t.items&&1<t.items.length&&t.items.sort(function(t,i){return i<t?-1:1})}))}function at(t){switch(t){case"origin":return mt.PivotAreaType.corner;case"button":return mt.PivotAreaType.button;case"topRight":case"topEnd":return mt.PivotAreaType.topRight;case"all":return mt.PivotAreaType.all;default:return}}function st(t){switch(t){case mt.PivotAreaType.corner:return"origin";case mt.PivotAreaType.button:return"button";case mt.PivotAreaType.topRight:return"topRight";case mt.PivotAreaType.all:return"all";default:return}}function ut(t){for(var i,n,e,r,i=[],n={start:t[0],end:t[0]},e=1,r=t.length;e<r;e++)t[e]-1===t[e-1]?n.end=t[e]:(i.push(n),n={start:t[e],end:t[e]});return i.push(n),i}function ct(t){var i,n,e,r,o,a,s,u,c,i={},n=t.pivotArea;if(n)for(e in i.pivotArea={},n)if(n.hasOwnProperty(e))if("references"===e&&n.references)for(r=i.pivotArea.references=[],o=0;o<n.references.length;o++){for(u in s={},a=n.references[o])if(a.hasOwnProperty(u))if("items"===u&&a.items){if(a.items)for(s.items=[],c=0;c<a.items.length;c++)s.items.push(a.items[c])}else s[u]=a[u];r.push(s)}else i.pivotArea[e]=n[e];return t.style&&(i.style=z(t.style)),i}function z(t){if(t instanceof vt.Style)return t.clone();var i=new vt.Style;if("string"==typeof t)i.fromJSON(JSON.parse(t),!1,void 0);else{if("object"!=typeof t)return null;i.fromJSON(t,!1,void 0)}return i}function lt(t,i,s,o,u,n,e,r){var a,c,l,f,h,v,d,p,m,b,a,g,w,y,C,C;if(void 0===r&&(r=7),a=s.pivotTables.all(),c=!1,u=!!u,l=e?e.union(i):i,r&mt.overlapCheck.pt&&(0,pt.o)(a,function(t){var t,i,t,n,e,r,i;if((t.name()!==o||!o)&&(i=(t=t.getRange()).page,t=t.content,e=n=!1,i&&(n=null!==i.getIntersect(l,0,0)),(e=null!==t.getIntersect(l,0,0))||n))return i={message:r=wt().PivotTableErrorMessage_Overlap,cancel:!1,force:!0},u?s.pivotTables.jT(!1,{type:11,args:i}):s.jT(11,i),c=!0}),c)return!0;function A(t,i,n){var e,r,o,a;if(i&&n)for(e=n.row;e<n.row+n.rowCount;e++)for(r=n.col;r<n.col+n.colCount;r++)if(t[e]&&i&&!i.contains(e,r)&&t[e][r]&&t[e][r].value)return a={message:o=wt().PivotTableErrorMessage_ExistData.replace("{}",s.name()),cancel:!1,force:!1},u?s.pivotTables.jT(!1,{type:11,args:a}):s.jT(11,a),1}if(r&mt.overlapCheck.value)for(f=s.Ut.W_(3).dataTable,h=0,v=[n,t];h<v.length;h++)for(d=v[h],p=0,m=[e,i];p<m.length;p++)if(A(f,d,b=m[p]))return!0;if(r&mt.overlapCheck.table&&(a=s.tables&&s.tables.all())&&0<a.length)for(g=0,w=a;g<w.length;g++)if(Ft((y=w[g]).range(),e,i))return C=wt().PivotTableErrorMessage_ExistTable,s.pivotTables.jT(!(C={message:C,cancel:!1,force:!0}),{type:11,args:C}),!0;return!1}function r(t){this.qK=[],this._Jt={fieldLevel:{},itemLevel:{}},this.LJt=t}function ft(t,i){return i.priority=t.priority&&t.priority(),i.scope=t.scope&&t.scope(),i.type=t.type&&t.type(),i}function ht(t){var i,n;if(!t)return 1;if(S(t))return 1;for(n in i=!0,t)if(t.hasOwnProperty(n)&&"_id"!==n){i=!1;break}return i}function Ct(t,i,n){var e,r,o,a,s,u,e=i.row,r=i.col,o=i.rowCount,a=i.colCount;if(n.borderLeft)for(s=0;s<o;s++)t[e+s]||(t[e+s]={}),bt(t[e+s][r])&&(t[e+s][r]={}),t[e+s][r].borderLeft=!0;if(n.borderRight)for(s=0;s<o;s++)t[e+s]||(t[e+s]={}),bt(t[e+s][r+a-1])&&(t[e+s][r+a-1]={}),t[e+s][r+a-1].borderRight=!0;if(n.borderTop)for(t[e]||(t[e]={}),u=0;u<a;u++)bt(t[e][r+u])&&(t[e][r+u]={}),t[e][r+u].borderTop=!0;if(n.borderBottom)for(t[e+o-1]||(t[e+o-1]={}),u=0;u<a;u++)bt(t[e+o-1][r+u])&&(t[e+o-1][r+u]={}),t[e+o-1][r+u].borderBottom=!0;if(n.borderHorizontal)for(s=0;s<o-1;s++)for(t[e+s]||(t[e+s]={}),u=0;u<a;u++)bt(t[e+s][r+u])&&(t[e+s][r+u]={}),t[e+s][r+u].borderBottom=!0;if(n.borderVertical)for(s=0;s<o;s++)for(t[e+s]||(t[e+s]={}),u=0;u<a-1;u++)bt(t[e+s][r+u])&&(t[e+s][r+u]={}),t[e+s][r+u].borderRight=!0}function At(t,n){t.sort(function(t,i){return n?t.row-i.row:t.col-i.col})}function Nt(t){var i,n,e,r;if(!t)return[];for(i=[],n=0;n<t.length;n++)t[n]&&i.push(t[n]);if(i.length<=1)return i;if(e=[],i[0].row===i[1].row&&i[0].rowCount===i[1].rowCount)for(At(i,!1),n=0;n<i.length-1;n++)for(r=n+1;r<i.length;r++){if(i[n].col+i[n].colCount!==i[r].col||i[n].row!==i[r].row||i[n].rowCount!==i[r].rowCount){e.push(i[n]),n=r-1,r===i.length-1&&e.push(i[r]);break}if(i[n].colCount=i[n].colCount+i[r].colCount,r===i.length-1){e.push(i[n]),n=r-1;break}}else if(i[0].col===i[1].col&&i[0].colCount===i[1].colCount)for(At(i,!0),n=0;n<i.length-1;n++)for(r=n+1;r<i.length;r++){if(i[n].row+i[n].rowCount!==i[r].row||i[n].col!==i[r].col||i[n].colCount!==i[r].colCount){e.push(i[n]),n=r-1,r===i.length-1&&e.push(i[r]);break}if(i[n].rowCount=i[n].rowCount+i[r].rowCount,r===i.length-1){e.push(i[n]),n=r-1;break}}else e=i;return e}function It(t,i,n){var e;if(!bt(i))switch(typeof i){case"boolean":t.b=i?1:0;break;case"string":t.v=n.getTextIndex(i);break;case"object":i instanceof Date?t.v=n.getTextIndex((0,pt.kQt)(i)):t.v=i;break;default:t.n=i}}function B(t,i){t.value=i}function Tt(t,i){var n,i,t,n=new vt.Style,i=_(i.numFmtId),t=t.Dd&&t.Dd.uv(i);return n.formatter=t,n}function R(t,i,n,e,r){var o,a,s,u,c;for(o in e)if(e.hasOwnProperty(o)&&(a=e[o],!bt(a)))for(u in bt(n[+o+t])&&(n[+o+t]={}),s=n[+o+t],a)!a.hasOwnProperty(u)||bt(a[u])||(c=a[u],bt(c))||bt(c.value)||(bt(s[+u+i])&&(s[+u+i]={}),r(s[+u+i],c.value))}function St(t){return bt(t)||t<1||isNaN(t)?1:t}function xt(t,i,n){return!(0!==t.row&&0!==t.col&&t.row!==a&&t.col!==a||!(t.row===a||t.row<=i)||!(t.col===a||t.col<=n)||t.row!==a&&t.rowCount!==a&&t.row+t.rowCount-1>i||t.col!==a&&t.colCount!==a&&t.col+t.colCount-1>n)}function Mt(t,i,n){var e,t,i,e=i.split(":"),t=U&&U.formulaToRanges(t,i,0,0,!0)[0].ranges,i=t&&t[0];if(i)return-1!==e[0].indexOf("256")&&(i.row=n?0:a),-1!==e[0].indexOf("IV")&&(i.col=n?0:a),"IV256"===e[0]&&n?(i.row=a,i.col=0):"IV1"===e[0]&&(i.row=0,i.col=a),1<e.length&&(-1!==e[1].indexOf("256")&&(i.rowCount=a),-1!==e[1].indexOf("IV"))&&(i.colCount=a),i}function Dt(t){return t===a?255:t}function kt(t){var t;if(t&&U)return t=yt(Dt(t.row),Dt(t.col),Dt(St(t.rowCount)),Dt(St(t.colCount))),U.rangesToFormula([t],0,0,15,!1)}function jt(t,i,n){var e,r,o,i,e=t.row===a?i:t.row,r=t.col===a?n:t.col,o=St(t.rowCount);return yt(e,r,o=o===a?e===i?1:i-e+1:o,i=(i=St(t.colCount))===a?r===n?1:n-r+1:i)}function Ot(t,i,n,e,r){var e=jt(t,e,r);return 0<e.row?e.colCount=1:0<e.col?e.rowCount=1:1!==e.rowCount&&1!==e.colCount&&(e.colCount!==a&&e.rowCount===a?e.rowCount=1:e.colCount=1),0!==e.row&&0!==e.col&&(t.row===a?e.row=0:t.col===a&&(e.col=0)),e.row=i+e.row,e.col=n+e.col,e}function _t(t,i){var n=1/0;return n=1<t.Q.length&&(t.x2===pt.DataPosition.col&&2===i||t.x2===pt.DataPosition.row&&1===i)?t.P2:n}function u(t,i,n,e,r,o,a,s){var t,u,i,t=f.call(this,t,s)||this;return t.T$=0,(u=t).Xst=0,u.eZt={row:bt(n)?0:n,col:bt(e)?3:e},u.suspendLayout(),u.rZt=new v.PivotDataModel,u.Ti=i,u.eZt={row:bt(n)?0:n,col:bt(e)?3:e},i=u.refresh.bind(u),u.options=(0,dt.b0)(H,t,i),u.EJt(a),s.Dpi=u.options.subTotalsPosition,u.BJt=o||Q.PivotTableThemes.light16,u.HSt=[],u.zSt=[],bt(r)?u.CWt=mt.PivotTableLayoutType.outline:u.CWt=r,u.dh.setSigmaValuePosition(pt.DataPosition.col,0),u.EZt={LZt:[],BZt:[],RJt:[],GJt:[]},u.VJt=[],u.lZt=[],u.UJt={},u.QJt={},u.WJt={},l&&(u.mJ=new l(u)),u.views=new q(u.deserialize.bind(u),u.serialize.bind(u)),u.zJt="",u.ZJt="",u.resumeLayout(),t}function Ft(t,i,n){var e=!1;return(e=i?t.intersect(i.row,i.col,i.rowCount,i.colCount):e)||t.intersect(n.row,n.col,n.rowCount,n.colCount)}function Pt(t,i){for(var n,e,r,o,a,s,n=t.getSpans(i,3),e=[],r=t.Ut,o=0,a=n;o<a.length;o++)(s=a[o]).getIntersect(i,gt,gt)&&e.push(s);(0,pt.o)(e,function(t){r.do("removeSpan",t,3)})}s=this&&this.__extends||(X=function(t,i){return(X=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}X(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),D=this&&this.__assign||function(){return(D=Object.assign||function(t){for(var i,n,e,r,n=1,e=arguments.length;n<e;n++)for(r in i=arguments[n])Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r]);return t}).apply(this,arguments)},w=this&&this.__spreadArray||function(t,i,n){if(n||2===arguments.length)for(var e=0,r=i.length,o;e<r;e++)!o&&e in i||((o=o||Array.prototype.slice.call(i,0,e))[e]=i[e]);return t.concat(o||Array.prototype.slice.call(i))},Object.defineProperty(M,"__esModule",{value:!0}),M.PivotTable=M.synchronizeDataTable=M.setDataForSJSPivotTable=M.PivotTableConditionalFormats=M.RYt=M.isSamePivotArea=M.BuiltInPivotTableThemeNames=void 0,vt=t("Core"),i=t("@spreadjs/js-sheets-common"),dt=t("./dist/plugins/pivot/pivot-util.js"),pt=t("Pivot"),mt=t("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),h=t("./dist/plugins/pivot/pivot-core/pivot-view.js"),v=t("./dist/plugins/pivot/pivot-table/pivot-data-model.js"),U=t("SheetsCalc"),Q=t("./dist/plugins/pivot/pivot-table/pivot-table-theme.js"),d=t("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-compact-layout.js"),p=t("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-outline-layout.js"),m=t("./dist/plugins/pivot/pivot-table/pivot-table-layout/pivot-table-tabular-layout.js"),g=t("./dist/plugins/pivot/pivot.ns.js"),j=t("@spreadjs/js-calc"),c=t("./dist/plugins/pivot/pivot-table-entry.js"),k=vt.mt.xr,Z=vt.mt.vo,W=vt.NodeHelper.dr,Y=vt.mt.Pr,N=vt.mt.Hue,I=vt.mt.go,O=vt.NodeHelper.ur,_=vt.NodeHelper.sr,T=vt.NodeHelper.ar,P=vt.mt.St,t=i.Common.lt,bt=t.ht,S=t._h,x=t.tv,L=i.Common.zf,t=i.Common.Uf,b=t.tR,E=i.Common.kh,gt=void 0,y=null,G=i.Common.lt.tv,t=new i.Common.ResourceManager(g.SR,"PivotTables"),wt=t.getResource.bind(t),H={allowMultipleFiltersPerField:!(F="subtotal"),fillDownLabels:!(V="grandTotal"),insertBlankLineAfterEachItem:!1,grandTotalPosition:mt.GrandTotalPosition.both,subTotalsPosition:mt.SubtotalsPosition.bottom,subtotalsPosition:mt.SubtotalsPosition.bottom,displayFieldsInPageFilterArea:mt.DisplayFields.downThenOver,reportFilterFieldsPerColumn:0,bandRows:!1,bandColumns:!1,showRowHeader:!0,showColumnHeader:!0,showDrill:!0,showMissing:!0,missingCaption:y,rowLabelIndent:1,printDrill:y,itemPrintTitles:y,fieldPrintTitles:y,showFilter:!0,showToolTip:!0,mergeItem:!1,isShowErrorValue:!1,errorValueInfo:y,rowHeaderCaption:null,colHeaderCaption:null,showHeaders:!0,calcItemAggregation:mt.CalcItemAggregation.include,enableDataValueEditing:!1,hideValuesRow:!0},C="4294967294",a=1/0,J=["backColor","foreColor","hAlign","vAlign","font","themeFont","formatter","borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","showEllipsis","_showTip","shrinkToFit","backgroundImage","cellType","backgroundImageLayout","tabStop","textDecoration","imeMode","name","parentName","watermark","cellPadding","labelOptions","quotePrefix","diagonalDown","diagonalUp","isVerticalText","cellButtons","dropDowns","textOrientation","decoration","mask"],M.BuiltInPivotTableThemeNames=$(),e.prototype.save=function(t){var i,n,i=this;return!bt(t)&&i.Hq(t)===y&&(n=i.jJt(),i.views.push({name:t,config:n}),!0)},e.prototype.add=function(t){var i=this;return!bt(t.name)&&i.Hq(t.name)===y&&(i.views.push(t),!0)},e.prototype.remove=function(t){var i,t,i=this,t=i.Hq(t);t!==y&&i.views.splice(t,1)},e.prototype.get=function(t){var i,t,i=this,t=i.Hq(t);if(t!==y)return i.views[t]},e.prototype.all=function(){return this.views},e.prototype.apply=function(t){var i,t,i=this,t=i.Hq(t);null!==t&&i.kJt(i.views[t].config)},e.prototype.Hq=function(t){for(var i,n,e,i=this,n=0;n<i.views.length;n++)if((e=i.views[n]).name===t)return n;return null},e.prototype.toJson=function(){return(0,vt.RF)(this.views)},e.prototype.fromJson=function(t){this.views=t},e.prototype.L0=function(){this.views=y},q=e,M.isSamePivotArea=rt,M.RYt=lt,r.prototype.L0=function(){this.LJt=y,this.qK=y,this._Jt=y},r.prototype.YJt=function(t){for(var i,n,e,r,o,a,i,n=this.qK,e=[],r=bt(t),o=0;o<n.length;o++)if(n[o].pivotAreas)for(a=0;a<n[o].pivotAreas.length;a++)if(r||rt(t,n[o].pivotAreas[a])){e.push(n[o].conditionalRule);break}return e},r.prototype.HJt=function(t,i,n){var e;this.JJt(t,i,n)},r.prototype.JJt=function(t,i,n){var e,r,o,e,a,s,u,c;if(!(bt(t)||t.length<=0)&&i&&(r=(e=this).qK,e=(o=e.LJt).Ti,!bt(e.conditionalFormats))&&(a={conditionalRule:i,pivotAreas:t},i.pivotTableAreas=t,i.pivotTableName=o.name(),r.push(a),!n)){for(s=[],c=0;c<t.length;c++)(u=o.getPivotAreaRanges(t[c]))&&0<u.length&&(s=s.concat(u));0<s.length&&(i.ranges(s),e.conditionalFormats.addRule(i))}},r.prototype.qJt=function(){var t,i,n,e,r,o,a,s,t=this,i=t.qK,n,e,r=t.LJt.Ti.conditionalFormats;if(!bt(r)){for(t.qK=[],o=0,a=i.length;o<a;o++)s=i[o],r.removeRule(s.conditionalRule);for(o=0,a=i.length;o<a;o++)s=i[o],t.HJt(s.pivotAreas,s.conditionalRule)}},r.prototype.QP=function(){return this.qK},r.prototype.DJt=function(t){for(var i,n,i=this.qK,n=0;n<i.length;n++)i[n].conditionalRule&&i[n].conditionalRule.priority()===t&&i.splice(n,1)},r.prototype.KJt=function(t,i){for(var n,e,r,o,a,s,n=this,e=n.qK,r=n.LJt,o=0;o<e.length;o++){if(t===e[o].conditionalRule){for(a=[],s=0;s<i.length;s++)a=a.concat(r.getPivotAreaRanges(i[s]));t.ranges(a)}e[o].pivotAreas=i}},r.prototype.XJt=function(t){for(var i,n,e,r,o,i=this,n=i.qK,e,r=i.LJt.Ti,o=0;o<n.length;o++)t===n[o].conditionalRule&&r.conditionalFormats.removeRule(t)},r.prototype.$Jt=function(t){for(var i,n,e,r,o,a,s,u,i=this,n=i.qK,e,r=i.LJt.Ti,o=0;o<n.length;o++)if((a=n[o]).pivotAreas&&t.length===a.pivotAreas.length){for(s=!0,u=0;u<t.length;u++)if(!rt(t[u],a.pivotAreas[u])){s=!1;break}s&&(r.conditionalFormats.removeRule(a.conditionalRule),n.splice(o,1))}},r.prototype.tqt=function(t,i,n,e,r){for(var o,a,s,u,c,l,f,h,v,d,p,m,o=this,a=o.LJt,s=a.Ti,u=s.conditionalFormats,c=[],l=u.GJ(t.ranges()),f=a.Zc,h=0,v=b(l);h<v;h++)(d=u.FX(l[h],i,n,e,r))&&(c=c.concat(d));if(0<b(c)){for(p=[],m=function(t){var i=s.pivotTables.getRangePivotAreas(c[t]);i&&Object.keys(i).forEach(function(t){t===f&&i[f]&&(p=w(w([],p,!0),i[f],!0))})},h=0;h<c.length;h++)m(h);o.KJt(t,p)}else o.XJt(t)},r.prototype.iqt=function(){this.qK.length=0,this._Jt={fieldLevel:{},itemLevel:{}}},r.prototype.count=function(){return b(this.qK)},l=r,M.PivotTableConditionalFormats=l,M.setDataForSJSPivotTable=It,M.synchronizeDataTable=R,f=h.PivotView,s(u,f),u.prototype.getFieldsModel=function(){return this.dh},u.prototype.showNoData=function(t,i){var n,e,r,n=this,e=n.dh;if(!(r=e&&!bt(t)&&""!==t?e.a1(t,i):r)||bt(i))return r;n.refresh(),n.DT({pivotTable:n,type:"showNoData",cacheFieldName:t,isShow:i})},u.prototype.updateCalcItem=function(t,i,n,e){var r,o,a,s,u,r=this,o=r.dh,a=r.Ti,s=o.up(t)[0];try{"="!==n&&""!==n||(n=null),u=o.x1(t,i,n,e),r.refresh()}catch(t){return a.jT(10,t.message),!1}return u&&r.DT({pivotTable:r,type:"updateCalcItem",calcItemInfo:s}),u},u.prototype.getCalcItems=function(t){var i,n;return this.dh.up(t)||[]},u.prototype.removeCalcItem=function(t,i){var n,e,i,n=this,e,i=n.dh.Rp(t,i);i&&0<i.length&&n.DT({pivotTable:n,type:"removeCalcItem",sourceName:t,formulaInfos:i}),n.refresh()},u.prototype.addCalcItem=function(t,i,n){var e=this,r=e.dh,o=e.Ti,a;if(!bt(t)&&""!==i){"="!==n&&""!==n||(n=null);try{a=r.Db(t,i,n),e.refresh()}catch(t){return o.jT(10,t.message),!1}return a&&e.DT({pivotTable:e,type:"addCalcItem",sourceName:t,calcItemName:i}),a}},u.prototype.getPivotDetails=function(t){if(bt(t))throw new Error(wt().param_error);var i=this;if(i.dh)return i.dh.KM(t)},u.prototype.getSource=function(){var t,t,t=this.dh;if(t&&"string"==typeof(t=t.LN()))return t},u.prototype.getSourceFields=function(){var t,t,i,n,e,r,o,t=this.dh,i=[];if(t&&(t=t.ky(),!bt(t)))for(e=0,r=t;e<r.length;e++)n={name:(o=r[e]).name},(0,pt.ht)(o.fieldType)||(n.fieldType=o.fieldType),i.push(n);return i},u.prototype.updateSource=function(){var t=this,i=t.dh;i&&i.kx(t.Ti)},u.prototype.serialize=function(){return this.nqt(134217727)},u.prototype.nqt=function(l){var f,t,i,h,n,v,e,r,d,o,t,a,s,u,e,c,p,f=this,t=f.layoutType(),i={},h=[],n=f.options,v=f.dh,e=f.eZt,r=f.dh.getSigmaValuePosition(),d={};if(l&mt.SerializeIndex.options){for(o in n)n.hasOwnProperty(o)&&"object"!=typeof n[o]&&(i[o]=n[o]);d.options=i}if(l&mt.SerializeIndex.layout&&(d.layoutType=t),l&mt.SerializeIndex.position&&(d.pivotTablePosition=[e.row,e.col]),l&mt.SerializeIndex.theme&&(t=f.theme().name(),bt(Q.PivotTableThemes[t.toLowerCase()])?f.theme()&&(d.theme=f.theme().toJSON()):d.theme=t),l&mt.SerializeIndex.styles)for(a=d.styles=[],s=f.lZt,u=0;u<s.length;u++)a.push(ct(s[u]));if(l&mt.SerializeIndex.showNoData&&(e=f.dh.ac)&&(d.showNoDataInfo=D({},e)),l&mt.SerializeIndex.fields){for(c=function(t){var e,r,i,n,o,a,s,u,c,u,e=[];if(4===t&&l&mt.SerializeIndex.filter)return r=f.getFieldsByArea().map(function(t){return t.sourceName}),i=v.getAllFieldNameList(),(0,pt.o)(i,function(t){var i,n,t;!(-1<r.indexOf(t))&&v.isFilter(t)&&(i={sourceName:t},n=f.labelFilter(t),t=f.valueFilter(t),n&&(i.labelFilter=n),t&&t.conditionByName&&(i.valueFilter=t),i.labelFilter||i.valueFilter)&&e.push(i)}),0<e.length&&(h[t]=e),"break";for(n=v.nw(t),o=0;o<n.length;o++)s={sourceName:(a=n[o]).a,displayName:a.Zc},(0,pt.ht)(a.Ar)||(s.subtotal=a.Ar),(0,pt.ht)(a.Spi)||(s.isShowSubtotalTop=a.Spi),l&mt.SerializeIndex.filter&&(u=f.labelFilter(a.Zc),c=f.valueFilter(a.Zc),u&&(s.labelFilter=u),c)&&c.conditionByName&&(s.valueFilter=c),l&mt.SerializeIndex.sort&&a.nrt&&(s.sortInfo=a.nrt),3===t&&l&mt.SerializeIndex.showValueAs&&f.eqt&&(u=f.showDataAs(a.Zc))&&(d.showDataAsList||(d.showDataAsList=[]),d.showDataAsList.push({valueFieldName:a.Zc,showDataAsInfo:u})),e.push(s);h[t]=e},u=0;u<5&&"break"!==(p=c(u));u++);r&&(d.valuePosition=r),l&mt.SerializeIndex.collapse&&(d.collapseItems=(0,vt.RF)(v.dv)||{}),d.fieldsInfo=h}return d},u.prototype.deserialize=function(t){this.tJt(t,134217727)},u.prototype.tJt=function(t,i){var n,e,r,o,a,s,u,c,l,f,h,v,d,p,m,b,g,w,y,C,A,N,I,T,S,x,n=this;n.Ti.suspendPaint(),n.suspendLayout();try{for(e=n.dh,r=0;r<4;r++)e.RM(r);if(o=e.getAllFieldNameList(),(0,pt.o)(o,function(t){e.clearFilterInfo(t,0)}),i&mt.SerializeIndex.position&&n.position(t.pivotTablePosition[0],t.pivotTablePosition[1]),i&mt.SerializeIndex.layout&&n.layoutType(t.layoutType),i&mt.SerializeIndex.options)for(a=Object.keys(t.options),r=0;r<a.length;r++)n.options[a[r]]!==t.options[a[r]]&&(n.options[a[r]]=t.options[a[r]]);if(i&mt.SerializeIndex.theme&&t.theme&&("object"==typeof(s=t.theme)&&(s=new Q.PivotTableTheme).fromJSON(t.theme),n.theme(s)),i&mt.SerializeIndex.styles){for(n.rqt(),u=t.styles||[],r=0;r<u.length;r++)n.setStyle(u[r].pivotArea,u[r].style);n.uqt()}if(i&mt.SerializeIndex.showNoData&&(t.showNoDataInfo?n.dh.ac=D({},t.showNoDataInfo):n.dh.ac=void 0),i&mt.SerializeIndex.fields){for(r=0;r<4;r++)for(c=t.fieldsInfo[r],l=0;l<c.length;l++)(f=c[l])&&(h=f.sourceName,v=f.displayName,d=f.subtotal,p=f.isShowSubtotalTop,e.isFieldActualExist(h))&&(m=e.addFieldByName(h,v,r,d,void 0),bt(m)||(m.Spi=p));t.valuePosition&&e.setSigmaValuePosition(t.valuePosition.positionType,t.valuePosition.positionIndex)}for(r=0;r<5;r++)if(c=t.fieldsInfo[r])for(l=0;l<c.length;l++)(f=c[l])&&(h=f.sourceName,b=f.valueFilter,g=f.labelFilter,w=f.sortInfo,i&mt.SerializeIndex.filter&&(g&&e.isFieldActualExist(h)&&e.setLabelFilterInfo(h,g),b)&&e.isFieldActualExist(h)&&e.setValueFilterInfo(h,b),i&mt.SerializeIndex.sort)&&w&&e.isFieldActualExist(h)&&e.setSortInfo(h,w);if(i&mt.SerializeIndex.collapse&&(y=t.collapseItems))for(C=0,A=Object.keys(y);C<A.length;C++)for(m=y[N=A[C]],I=0,T=Object.keys(m);I<T.length;I++)S=T[I],n.collapse(N,S,m[S]);i&mt.SerializeIndex.showValueAs&&(x=t.showDataAsList)&&(0,pt.o)(x,function(t){n.showDataAs(t.valueFieldName,t.showDataAsInfo)})}catch(t){throw Error(t)}finally{n.resumeLayout(),n.Ti.resumePaint()}},u.prototype.EJt=function(t){var i,n,e,r,i,n=this.options,e=H;if(!bt(t))for(r in t)E(t,r)&&E(e,r)&&(n[r]=t[r])},u.prototype.altText=function(t,i){if(bt(t)&&bt(i))return{altText:this.zJt,altTextSummary:this.ZJt};bt(t)||(this.zJt=t),bt(i)||(this.ZJt=i)},u.prototype.name=function(t){var i,n;if(0===arguments.length)return this.Zc;if(this.Ti&&this.Ti.parent&&(i=this.Ti.parent.BYt(t)))throw new Error(wt().RepeatName);n=this.Zc,this.Zc=t,this.Ti.parent.QYt(t,!0,n),this.DT({pivotTable:this,name:t,oldName:n,type:"name",pivotType:0})},u.prototype.position=function(t,i,n){var e,r,o,a,a,s,u,c,l,f,e=this;if(0===arguments.length)return{row:e.eZt.row,col:e.eZt.col,sheetName:e.Ti.name()};if(a=(r=e.Ti)&&r.parent,!bt(e.Ti)&&"number"==typeof t&&"number"==typeof i){if(s=e.eZt.row,u=e.eZt.col,e.eZt.row=t,e.eZt.col=i,!bt(n)&&n!==r.name()){if(o=a&&(0,vt._f)(a,n),bt(o))return;for(l=(c=(a=r.pivotTables)&&a.PYt).length,f=0;f<l;f++)if(c[f].name()===e.Zc){c.splice(f,1);break}c.length<1&&r.Ut.Spe(),o.pivotTables.PYt.push(e),o.Ut.Spe()}e.DT({pivotTable:e,row:t,col:i,oldCol:u,oldRow:s,sheetName:r.name(),type:"position",pivotType:0}),e.refresh(),o&&(e.Ti=o,e.qYt(o.pivotTables.FYt,o.pivotTables._Yt))}},u.prototype.sort=function(t,i){if(1===arguments.length)return this.dh.getSortInfo(t);var i;1<arguments.length&&(i=x(i),this.dh.setSortInfo(t,i)),this.refresh()},u.prototype.group=function(t){var i=this,n,e=i.Ti;try{n=this.dh.dy(t)}catch(t){return void e.jT(10,t.message)}"boolean"==typeof n?(i.dh.q1=!0,i.refresh()):i.Ti.jT(10,n)},u.prototype.getGroupInfo=function(t){var i,n,t;if(!bt(t)&&""!==t)return t=(n=(i=this).dh).rC(t),bt(t)?void 0:D({},t)},u.prototype.ungroup=function(t){var i,n,t,t,e,i=this,n=i.dh,t=n.getSourceNameByFieldName(t)||t;n.cy(t),n.q1=!0,(t=i.Ti)&&(e=t.getParent()).ok(),i.refresh()},u.prototype.add=function(t,i,n,e,r){var o,a,s,u,o=this,a=o.dh,s=o.Ti;if(!bt(t)&&!bt(i)&&bt(a.Z[i])&&(u=o.dh.bl(t))){if(!bt(u.D5)){if(n!==mt.PivotTableFieldType.valueField)return void(0,c.throwError)(wt().FieldAreaLimited);e=pt.SubtotalType.sum}try{a.addFieldByName(t,i,n,e,r),o.refresh()}catch(t){s.jT(10,t.message)}}},u.prototype.remove=function(t){var i,n,e,i=this.dh,n=i.Z[t],e;i.removeFieldOrSigmaByName(t)instanceof c.PivotViewField&&(n===mt.PivotTableFieldType.valueField?i.clearValueFilterOfValueField(t):i.y2(t,!1)),this.refresh()},u.prototype.theme=function(t){if(0===arguments.length)return this.BJt;var i=this.BJt&&this.BJt.name(),i=Q.PivotTableThemes[i]?i:this.BJt;"string"==typeof t&&(t=Q.PivotTableThemes[t.toLowerCase()]||Q.PivotTableThemes.light0),this.DT({pivotTable:this,type:"changeTheme",oldTheme:i,pivotType:0}),this.BJt=t,this.refresh()},u.prototype.DT=function(t){var i,n,e,i=this.Ti;i&&(n=i.getParent(),(0,pt.ht)(n.NVt)&&this.getRange&&(n.NVt={range:this.getRange()}),(e=i.Ut).WYt(this,t))},u.prototype.AP=function(t){var i,n,e,r,o,a,s,u,c,l,f,u,i=this,n;switch(t.type){case"changeTheme":i.theme(t.oldTheme);break;case"layoutType":i.layoutType(t.oldLayoutType);break;case"name":i.name(t.oldName);break;case"position":i.position(t.oldRow,t.oldCol,t.sheetName);break;case"setStyle":(e=i.lZt).pop();break;case"options":i.options[t.pn]=t.old;break;case"addCalcField":i.removeCalcField(t.fieldName);break;case"removeCalcField":i.addCalcField(t.fieldName,t.formula);break;case"showDataAs":bt(t.oldShowDataAs)?i.showDataAs(t.fieldName,{showDataAs:pt.PivotShowDataAs.normal}):i.showDataAs(t.fieldName,t.oldShowDataAs);break;case"resetPivotStyle":i.rqt(t.areaModel,t.rangeModel);break;case"adjustRange":i.eZt.row=t.oldRow;break;case"conditionalRulesChange":i.mJ.qK=t.originalConditionalRules,i.mJ.qJt();break;case"addCalcItem":i.removeCalcItem(t.sourceName,t.calcItemName);break;case"removeCalcItem":for(o=0,a=r=t.formulaInfos;o<a.length;o++)s=a[o],i.addCalcItem(t.sourceName,s.calcItemName,s.formula);break;case"updateCalcItem":c=(u=t.calcItemInfo).sourceName,l=u.calcItemName,f=u.formula,u=u.priority,i.updateCalcItem(c,l,f,u);break;case"showNoData":i.showNoData(t.cacheFieldName,!t.isShow);break;case"setNodeValue":i.setNodeValue(t.nodeInfo,t.oldValue)}},u.prototype.updateField=function(t,i,n){var e=this,r=e.dh,o=e.Ti;if(t===wt().sigmaValue)r.setSigmaValuePosition(i-1,n);else if(!bt(t))try{r.changeFieldArea(t,i,n),e.refresh()}catch(t){return o.jT(10,t.message),!1}},u.prototype.sq=function(t,i,n){var e,r,o,a,s,u,c,l,f,h,e=this,r=e.dh,o=r.getFieldInfoByName(t),a=r.Z;if(i&&o){if(a[t]===mt.PivotTableFieldType.valueField)(0,dt.R$)(e,t,o.Or&&o.Or.showDataAs),e.showDataAs(t,{showDataAs:pt.PivotShowDataAs.normal});else if(a[t]!==mt.PivotTableFieldType.filterField)for(u=0,c=s=r.nw(mt.PivotTableFieldType.valueField);u<c.length;u++)(l=c[u]).Or&&l.Or.baseFieldName===t&&(0,dt.R$)(e,l.Zc,l.Or&&l.Or.showDataAs)}else if(o&&!i)if(a[t]===mt.PivotTableFieldType.valueField&&n!==mt.PivotTableFieldType.valueField)(0,dt.R$)(e,t,o.Or&&o.Or.showDataAs),e.showDataAs(t,{showDataAs:pt.PivotShowDataAs.normal});else if(!(a[t]!==mt.PivotTableFieldType.rowField&&a[t]!==mt.PivotTableFieldType.columnField||n!==mt.PivotTableFieldType.filterField&&n!==mt.PivotTableFieldType.valueField))for(f=0,h=s=r.nw(mt.PivotTableFieldType.valueField);f<h.length;f++)(l=h[f]).Or&&l.Or.baseFieldName===t&&((0,dt.R$)(e,t,l.Or&&l.Or.showDataAs),e.showDataAs(l.Zc,{showDataAs:pt.PivotShowDataAs.normal}))},u.prototype.updateFieldName=function(t,i){var t=this.dh.getFieldInfoByName(t);"string"==typeof i&&(t&&this.dh.changeFieldName(t,i)?(this.dh.q1=!0,this.refresh()):this.Ti.jT(10,wt().PivotTableErrorMessage_EmptyFieldName))},u.prototype.autoFitColumn=function(){var t,i,t=this.oqt(),i=this.Ti;i.suspendPaint(),(0,pt.o)(t,function(t){(0,pt.o)(t,function(t){i.setColumnWidth(t.col,t.width)})}),i.resumePaint()},u.prototype.oqt=function(){var t,i,n,e,r,o,a,s,u,i,c,l,f,h,v,d,p,m,b,m,g,t=this.eZt.col,i=this.rZt.HWt[2],n=i.jN,e=i.WWt,r=i.Tx,o,a=this.mZt().length,s=[],u=[],i=this.dh.getSigmaValuePosition(),c=!1,l=!1;for(i.display&&1===i.positionType&&(i.positionIndex===(a+=1)-2?c=!0:i.positionIndex!==a-1&&(l=!0)),f=this.eZt.row+this.eZt.rowCount,h=this.eZt.col;h<this.eZt.col+n;h++)v=vt.mt.qf(h,this.Ti,3,1,f),s.push([{col:h,width:v}]);for(d=y,p=l?3:2,h=0;h<r;h++)m=e[h].path,b=e[h].isSubtotal,g=(m=m.split(pt.Separator))[a-p],c&&(g=e[h].valueFieldName),v=vt.mt.qf(t+n+h,this.Ti,3,1,f),null!==d&&d!==g?(this.aqt(u,s),(u=[]).push({col:t+n+h,width:v}),h===e.length-1&&s.push(w([],u,!0))):(b&&(this.aqt(u,s),u=[]),u.push({col:t+n+h,width:v}),h===e.length-1&&this.aqt(u,s)),d=m[a-p],c&&(d=e[h].valueFieldName);return s},u.prototype.aqt=function(t,i){var n,e,r,n=[];t.forEach(function(t){n.push(t.width)}),e=Math.max.apply(Math,n),r=[],t.forEach(function(t){r.push({col:t.col,width:e})}),i.push(w([],r,!0))},u.prototype.collapse=function(t,i,n){if(2===arguments.length)return this.dh.getCollapse(t,i);2<arguments.length&&(this.dh.setCollapse(t,i,n),this.refresh())},u.prototype.labelFilter=function(t,i){var n,e,n=this.dh,e=n.getSourceNameByFieldName(t)||t;if(1===arguments.length)return n.getLabelFilterInfo(t)||e&&n.getLabelFilterInfo(e);n.setLabelFilterInfo(e,i),this.refresh()},u.prototype.valueFilter=function(t,i){var n,e,n=this.dh,e=n.getSourceNameByFieldName(t);if(1===arguments.length)return n.getValueFilterInfo(t)||e&&n.getValueFilterInfo(e);n.setValueFilterInfo(e,i),this.refresh()},u.prototype.subtotalType=function(t,i){return this.subTotalType.apply(this,arguments)},u.prototype.subTotalType=function(t,i){var n=this,e=n.Ti;if(!bt(n.dh)){if(1===arguments.length)return n.dh.xy(t);try{n.dh.xy(t,i)}catch(t){e.jT(10,t.message)}n.refresh()}},u.prototype.layoutType=function(t){var i,n,e,i=this,n=i.dh;if(0===arguments.length)return i.CWt;if(i.CWt!==t){switch(e=i.CWt,i.CWt=t){case mt.PivotTableLayoutType.compact:i.outline=!0,i.outlineData=!0,i.compact=void 0,i.compactData=void 0;break;case mt.PivotTableLayoutType.outline:i.outline=!0,i.outlineData=!0,i.compact=!1,i.compactData=!1;break;case mt.PivotTableLayoutType.tabular:i.compact=!1,i.compactData=!1,i.outline=void 0,i.outlineData=void 0,i.options.subtotalsPosition===mt.SubtotalsPosition.top&&(i.options.subtotalsPosition=mt.SubtotalsPosition.bottom)}this.DT({pivotTable:this,layoutType:t,oldLayoutType:e,type:"layoutType",pivotType:0})}(0,dt.updateRowFieldsIsShowSubtotalTop)(n.B,i.options.subtotalsPosition),this.refresh()},u.prototype.dataPosition=function(t,i){var n,e,n=this;if(0===arguments.length)return n.dh.getSigmaValuePosition();e=n.getFieldsByArea(t+1).length,i<0?i=0:e<i&&(i=e),n.dh.setSigmaValuePosition(t,i),n.refresh()},u.prototype.getItemsByField=function(t){return this.dh.Kz(t)},u.prototype.showDataAs=function(t,i){if(1===arguments.length)return this.dh.getFieldInfoByName(t).Or;var n=this.dh.getFieldInfoByName(t).Or;i.showDataAs===pt.PivotShowDataAs.normal?this.eqt=!1:this.eqt=!0,this.dh.getFieldInfoByName(t).Or=i,n=n&&D({},n),this.DT({pivotTable:this,fieldName:t,oldShowDataAs:n,type:"showDataAs",pivotType:0}),this.refresh()},u.prototype.subtotalPosition=function(t,i){var n,e,r,n=this.dh.getFieldInfoByName(t),e=n&&n.Spi,r=bt(e)?mt.SubtotalsPosition.none:e?mt.SubtotalsPosition.top:mt.SubtotalsPosition.bottom;if(1===arguments.length)return r;r===i||!n||i!==mt.SubtotalsPosition.top&&i!==mt.SubtotalsPosition.bottom||(n.Spi=i===mt.SubtotalsPosition.top,this.DT({pivotTable:this,fieldName:t,isShowSubtotalTop:e,type:"isShowSubtotalTop",pivotType:0}),this.refresh())},u.prototype.getFieldsByArea=function(i){var n,t,e,e,r,r,n=this.dh,t;return(this.dh.nw(i)||[]).map(function(t){return r=t.Zc,i=n.Z[r],e=n.nw(i),e=(0,c.in)(e,r),r={fieldName:r,sourceName:t.a,dataType:t.W5,pivotArea:i,pivotIndex:e},t.W5!==pt.PivotDataType.string&&(r.start=t.DV,r.end=t.mn),r})},u.prototype.getField=function(t){var i,t,n,e,r,n,n,i,n=this.dh,e=n.getFieldInfoByName(t);return e?(r=n.Z[t],n=n.nw(r),n=(0,c.in)(n,t),t={fieldName:t,sourceName:e.a,dataType:e.W5,pivotArea:r,pivotIndex:n},e.W5!==pt.PivotDataType.string&&(t.start=e.DV,t.end=e.mn),t):null},u.prototype.addCalcField=function(t,i){this.dh.QVt(t,i),this.dh.q1=!0,this.refresh(),this.DT({pivotTable:this,fieldName:t,formula:i,type:"addCalcField",pivotType:0})},u.prototype.getCalcFields=function(){return this.dh.WVt()},u.prototype.removeCalcField=function(t){var i,n,e,e,r,o,e,a,s,u,i=this,n=t,e=i.dh.getFieldInfoByName(t);for(e&&(n=e.a),e=this.dh.L,o=(r=this.dh.Ti).getCalcFields(e),i.dh.HVt(t),i.dh.fit(n),i.dh.q1=!0,(e=this.Ti)&&(a=e.getParent()).ok(),this.refresh(),s=0;s<o.length;s++)(u=o[s]).Zc===t&&this.DT({pivotTable:this,fieldName:t,formula:u.D5,type:"removeCalcField",pivotType:0})},u.prototype.adjustRange=function(){var t,i,n,e,r,t,i=this.rZt.HWt[0].Sx,n=this.eZt.row,e=n,r=this.eZt.col;0<i&&n-(i+1)<0&&(this.eZt.row=i+1,this.DT({pivotTable:this,oldRow:e,oldCol:r,type:"adjustRange",pivotType:0}))},u.prototype.Uct=function(){var t,i,n,e,r,o,a,s,e,r,o,e,a,s,o,u,e,t=this,i=t.Ti,n=t.VCe;i.suspendPaint(),t.adjustRange(),r=(e=this.rZt.HWt)[0],o=e[1],a=e[2],s=e[3],e=e[4],r.setStartInfo(0,0),t.LYt={row:this.eZt.row-(r.Sx+1),col:this.eZt.col,rowCount:r.Sx,colCount:r.Tx},t.eZt.rowCount=o.Sx+s.Sx,t.eZt.colCount=o.Tx+a.Tx,o.setStartInfo(0,0),a.setStartInfo(0,o.Tx),s.setStartInfo(a.Sx,0),e.setStartInfo(a.Sx,s.Tx),n&&(Pt(i,t.LYt),Pt(i,t.eZt)),t.sqt(),t.uqt(),t.mJ.qJt(),(r=t.Ti&&t.Ti.getParent())&&r.NVt&&(o=r.NVt.range,e=t.getRange(),o&&(a=o.page,s=o.content,o=o.page?o.page.union(o.content):o.content,u=e.page,e=e.content,!n)&&o.rowCount&&o.colCount&&lt(s,e,t.Ti,t.Zc,!0,a,u)&&t.Ti.pivotTables.jT(!0),r.NVt=y),t.VCe=!1,i.pivotTables.qYt(),i.resumePaint()},u.prototype.getValue=function(t,i){var n,e,r,o,n,a,s,u,c,n,l,f,h,v,d,p,m,b,g,i,l,a,f,n=this,e=n.dh,r=t-this.eZt.row,o=i-this.eZt.col,n=n.rZt.HWt,a=n[0],s=n[1],u=n[2],c=n[3],n=n[4],l=0<a.Sx&&0<a.Tx,f=t,h=i;return l&&(f=t-this.LYt.row,h=i-this.LYt.col),l&&a.Sx>f?a.Sl(f,h):s.Sx>r?s.Tx>o?s.Sl(r,o):(v=u.Sl(r,o-s.Tx),g=(m=e.nw(2)[r-1])&&m.W5,b=m&&e.cC(m.a),2===g&&!b&&(i=(0,pt.parseStringToDate)(v))?i:v):c.Tx>o?(l=c.Sl(r-s.Sx,o),g=(m=e.nw(1)[o])&&m.W5,b=m&&e.cC(m.a),(0,pt.ht)(l)?l:2===g&&!b&&(a=(0,pt.parseStringToDate)(l))?a:this.CWt===mt.PivotTableLayoutType.compact?l+"":l):0===e.nw(3).length||(v=n.Sl(r-s.Sx,o-s.Tx))===dt.GC_EMPTY_VALUE?y:!this.cqt(c,t)||(this.isTitleRow(c,t)||this.isBlankRow(c,t))&&!this.isSubtotalRow(c,t)||(f=this.lqt(v),(0,pt.ht)(f))?v:f},u.prototype.Kbt=function(t,i,n){var e,r,o,a,s,u,o,c,l,f,t,e=t-this.eZt.row,r=i-this.eZt.col,o=this.rZt.HWt,a=o[0],s=o[1],u=o[2],o=o[3],c=0<a.Sx&&0<a.Tx,l=t,f=i;c&&(l=t-this.LYt.row,f=i-this.LYt.col),c&&a.Sx>l&&a.Kbt(l,f,n),s.Sx>e&&(s.Tx>r?s.Kbt(e,r,n):u.Kbt(e,r-s.Tx,n)),o.Tx>r&&(t=this.CWt===mt.PivotTableLayoutType.compact?n+"":n,o.Kbt(e-s.Sx,r,t))},u.prototype.lqt=function(t){var i,n,i=this;if(bt(t)){if(!i.eqt)if(i.options.showMissing){if(n=i.options.missingCaption,(0,dt.kWt)(t)&&!(0,pt.ht)(n))return n}else if((0,dt.kWt)(t))return 0}else if(t instanceof j.CalcError||t===1/0)return i.options.isShowErrorValue&&!bt(i.options.errorValueInfo)?i.options.errorValueInfo:t===1/0?j.Errors.Number:void 0},u.prototype.qYt=function(t,i){var n=this.getRange(),e=n.content,n=n.page;n&&this.fqt(t,i,n),this.fqt(t,i,e)},u.prototype.fqt=function(t,i,n){for(var e,e=n.row;e<n.row+n.rowCount;e++)t[e]=!0;for(e=n.col;e<n.col+n.colCount;e++)i[e]=!0},u.prototype.cqt=function(t,i){return 3===t.QWt&&this.eZt.rowCount+this.eZt.row>i},u.prototype.isSubtotalRow=function(t,i){var i=t.zWt[i-t.DQ-this.eZt.row];return i&&i.isSubtotal},u.prototype.isBlankRow=function(t,i){var i=t.zWt[i-t.DQ-this.eZt.row];return i&&i.isBlankRow},u.prototype.isTitleRow=function(t,i){var i;return this.CWt!==mt.PivotTableLayoutType.tabular&&!(!(i=t.zWt[i-t.DQ-this.eZt.row])||void 0!==i.isValueFieldDim&&i.isValueFieldDim)},u.prototype.sJt=function(t,i,n){var e,r,o,a,s,u,c,l,f,h,v,d,p,m,e,b,b,b,b,g,e=this.getPivotInfoImp(t,i,!0);if(e){if(r=gt,s=a=o=void 0,u=e.value,c=e.area,l=e.menuArea,f=e.valueFieldName,h=e.rowInfos,v=e.colInfos,d=e.colHeadFieldInfo,p=e.activeRowFieldInfo,m=e.activeColFieldInfo,e=this.hqt(t,i)&&this.hqt(t,i).formatter,bt(e)||(u=vt.Be.Re(u,e)),3!==l){switch(this.options.showMissing&&(s=this.options.missingCaption),c){case 3:if(!bt(h)){if(5===l||1===h.length&&h[0].fieldName===F){u=u||h[0].itemName||s,bt(u)||(r=[u]);break}if(p){for(;0<=p.index&&h[p.index]&&bt(h[p.index].itemName);)p.index=p.index-1;(b=h[p.index])&&(o=b.itemName+" ("+b.fieldName+")")}r=[o,a=wt().toolTipContent_Row+A(h)]}break;case 2:if(bt(d)&&!bt(v)){if(5===l||1===v.length&&v[0].fieldName===F){u=u||v[0].itemName||s,bt(u)||(r=[u]);break}if(m){for(;0<=m.index&&v[m.index]&&bt(v[m.index].itemName);)m.index=m.index-1;(b=v[m.index])&&(o=b.itemName+" ("+b.fieldName+")")}r=[o,a=wt().toolTipContent_Column+A(v)]}break;case 4:bt(f)||(bt(u=u||s)&&(u=wt().toolTipContent_NoValue),r=[f,o=wt().toolTipContent_Value+u],bt(h)||(b=wt().toolTipContent_Row+A(h),r.push(b)),bt(v))||(b=wt().toolTipContent_Column+A(v),r.push(b))}if(!bt(r)){for(g=0;g<r.length;g++)r[g]=L.j0(r[g]);n?r.unshift(wt().PivotTableForAccessibility+this.Zc):r[0]="<b>"+r[0]+"</b>",r=r.join("\r\n")}}return r}},u.prototype.getPivotInfo=function(t,i){var n,e,e,n=this,e=n.getRange();if((e.content.contains(t,i)||e.page&&e.page.contains(t,i))&&(e=n.getPivotInfoImp(t,i),!bt(e)))return e.row=t,e.col=i,e},u.prototype.getPivotInfoImp=function(t,i,n,e,r){var o,a,s,u,c,l,f,h,v,d,l,p,m,b,p,g,f,u,o=this,a=t-o.eZt.row,s=i-o.eZt.col;return o.Oy()?{menuArea:3}:(u=t-o.LYt.row,c=i-o.LYt.col,f=(l=o.rZt.HWt)[0],h=l[1],v=l[2],d=l[3],l=l[4],m=(p=o.dh).B,b=p.R,p=p.Q,f.Sx>u?((g=o.vqt(u,c,f)).row=t,g.col=i,(f=f.XWt(u,c))&&(g.pageFieldInfo={fieldName:f}),g.menuArea=0,g):h.Sx>a?h.Tx>s?((g=o.vqt(a,s,h)).row=t,g.col=i,u=h.ZWt[s],g.menuArea=3,a==h.Sx-1&&u?(g.cornerFieldInfo={fieldName:u.fieldName,isDim:u.isDim,isCompactRoot:u.isCompactRoot},u.isCompactRoot||(g.menuArea=2)):0==a&&0==s&&1===o.rot().length&&g.value&&(g.menuArea=1),g):o.dqt(a,s-h.Tx,v,b,!1,n,e,r):d.Tx>s?o.dqt(a-h.Sx,s,d,m,!0,n,e,r):o.pqt(a-h.Sx,s-h.Tx,[d,v,l],[m,b,p],n,e,r))},u.prototype.vqt=function(t,i,n){return{relativeRow:t,relativeColumn:i,value:n.Sl(t,i),area:n.QWt}},u.prototype.pqt=function(t,i,n,e,r,o,a){var s,u,c,n,l,f,e,h,f,v,d,d,p,u,l,c,s=this,u=n[0],c=n[1],n=n[2],l=e[0],f=e[1],e=e[2],h=s.IZt,d={},v=(d=1<s.dh.Q.length?s.dh.getSigmaValuePosition():d).positionType,d=d.positionIndex,p=s.CWt===mt.PivotTableLayoutType.compact,u=it(t,i,u,l,h,0===v?d:gt,!0,p,r,o,a),l=nt(t,i,c,f,h,1===v?d:gt,!0,p,r,o,a);return(c=s.vqt(t,i,n)).menuArea=4,!u||!1!==u.isValueFieldDim||bt(v)&&!a||(c.menuArea=3),u&&u.isBlankRow&&(c.menuArea=3),u&&(c.rowInfos=u.PJt),l&&!l.isBlankColumn&&(c.colInfos=l.FJt),f=0===v?u&&u.OJt:l&&l.OJt,bt(f)&&1===s.dh.Q.length&&(f=e[0].Zc),o&&1===s.dh.Q.length&&(f=this.dh.getFieldInfoByName(f).a),c.area=n.QWt,c.valueFieldName=f,c},u.prototype.dqt=function(t,i,n,e,r,o,a,s){var u,c,l,f,h,v,d,p,p,m,r,b,r,g,g,w,r,g,y,u=this,c=u.IZt,l=u.CWt===mt.PivotTableLayoutType.compact,h=u.vqt(t,i,n),v,p={},d=(p=1<u.dh.Q.length?u.dh.getSigmaValuePosition():p).positionType,p=p.positionIndex;return r?(r=(m=n.zWt)[t])&&(h.menuArea=2,r.isBlankRow&&(h.menuArea=3),r.isGrandTotal&&(h.menuArea=5),b=0===d?p:gt,(!l&&!bt(b)&&i===b&&r.valueFieldName||l&&r.isSigmaValue)&&(h.menuArea=4),a||(f=it(t,i,n,e,c,b,!1,l,o,a,s))&&(h.activeRowFieldInfo=f.activeRowFieldInfo,h.rowInfos=f.PJt,f.OJt)&&(h.valueFieldName=f.OJt)):0===t?(r="",(g=n.ZWt[i])?(r=g.fieldName,g=g.isCompactRoot,r&&(h.colHeadFieldInfo={fieldName:r,itemName:"",isRootCell:!0,isCompactRoot:g},h.menuArea=l?3:2)):0===e.length&&h.value&&1<=u.dh.Q.length?h.menuArea=4:h.menuArea=3):(r=(w=n.WWt)[i])&&(h.menuArea=2,g=r.isGrandTotal,(y=r.isBlankColumn)||(g&&(h.menuArea=5),bt(b=1===d?p:gt)||t-1!==b||(h.menuArea=4),a)||(f=nt(t,i,n,e,c,b,!1,l,o,a,s))&&(h.activeColFieldInfo=f.activeColFieldInfo,h.colInfos=f.FJt,f.OJt)&&(h.valueFieldName=f.OJt)),h},u.prototype.Oy=function(){var t=this.dh,i=t.G,n=t.B,e=t.R,t=t.Q;return!(0<i.length||0<n.length||0<e.length||0<t.length)},u.prototype.wZt=function(){return this.dh.queryItem()},u.prototype.Get=function(){return this.dh.Get()},u.prototype.bZt=function(){return this.dh.B},u.prototype.mZt=function(){return this.dh.R},u.prototype.gZt=function(){return this.dh.G},u.prototype.pZt=function(){return this.dh.Q},u.prototype.mqt=function(){return this.dh.getSigmaValuePosition().positionType},u.prototype.bit=function(){var t=this.dh;return[].concat(t.G,t.B,t.R)},u.prototype.rot=function(){var t=this.dh;return[].concat(t.Q)},u.prototype.getRange=function(){var t,i,n,e,r,o,i,t,a,s,u,c,t,t=this;return t.Oy()?{page:y,content:yt(t.eZt.row,t.eZt.col,18,3)}:(i=yt(n=(i=t.eZt).row,e=i.col,r=i.rowCount,o=i.colCount),t.LYt&&(t=yt(a=(t=t.LYt).row,s=t.col,u=t.rowCount,c=t.colCount)).colCount*t.rowCount?{page:t,content:i}:{page:y,content:i})},u.prototype.clone=function(t,i,n,e){var r,o,a,r,t,s,r=this,o,a=r.Ti.parent;if(!bt(t)&&0!==t.trim().length&&a&&(r=a.fMt.getPivotCacheByName(r.dh.L)))return new u(t=(0,dt.fJt)(t,a),i,n,e,void 0,void 0,void 0,s=a.UYt(r.getName(),t))},u.prototype.suspendLayout=function(){this.Xst<=0&&(this.bqt=this.getRange()),this.Xst++},u.prototype.resumeLayout=function(){this.Xst--,this.refresh()},u.prototype.refresh=function(){this.iM(!1)},u.prototype.iM=function(t,i){var t;this.Xst<=0&&(this.Xst=0,this.dh.q3(gt,t,gt,i),this.bqt=y,t=this.Ti)&&t.hP()&&t.repaint()},u.prototype.updateDataModel=function(){var t=this;switch(t.rZt.c5(),t.CWt){case mt.PivotTableLayoutType.outline:p.PivotTableOutlineLayout.render(t);break;case mt.PivotTableLayoutType.tabular:m.PivotTableTabularLayout.render(t);break;case mt.PivotTableLayoutType.compact:d.PivotTableCompactLayout.render(t)}},u.prototype.paint=function(t,i,n,e){var r,o,a,s,u,e;this.Ti.suspendPaint(),r=this.Ti,o=this.LYt,a=this.eZt,s=r.pivotTables.xJt,i||(r.suspendCalcService(),u=r.b3(),e=e?vt.StorageType.data:vt.StorageType.data|vt.StorageType.style,o&&o.rowCount*o.colCount&&(s?u&&u.gF(o.row,o.col,o.rowCount,o.colCount):r.KI(o.row,o.col,o.rowCount,o.colCount,3,e,!1,!1,!0)),a&&(s?u&&u.gF(a.row,a.col,a.rowCount,a.colCount):r.KI(a.row,a.col,a.rowCount,a.colCount,3,e,!1,!1,!0,!!this.options.enableDataValueEditing))),n||this.updateDataModel(),i||((u=r.b3())&&!n&&(a&&u.gF(a.row,a.col,a.rowCount,a.colCount),o)&&o.rowCount*o.colCount&&u.gF(o.row,o.col,o.rowCount,o.colCount),r.resumeCalcService(!1)),this.Ti.resumePaint()},u.prototype.gqt=function(t,i){var n,e,r,o,a,s,u,c,o,l,f,h,n=this,e=t-n.eZt.row,r=i-n.eZt.col,o=n.rZt.HWt,a=o[0],s=o[1],u=o[2],c=o[3],o=o[4],l=0<a.Sx&&0<a.Tx,f=t,h=i;return l&&(f=t-n.LYt.row,h=i-n.LYt.col),l&&a.Sx>f?a.ML(f,h):s.Sx>e?s.Tx>r?s.ML(e,r):u.ML(e,r-s.Tx):c.Tx>r?c.ML(e-s.Sx,r):o.ML(e-s.Sx,r-s.Tx)},u.prototype.wqt=function(t,i,n){var e=this,r=e.BJt;(r=r&&0!==Object.keys(r).length?r:new Q.PivotTableTheme).h5(t,i,n,e)},u.prototype.hqt=function(t,i){var n,e,r,o,e,o,r,e,n,n=this,e=n.UJt,r=n.QJt,o=n.WJt,e=e[t]&&e[t][i],o=o[t]&&o[t][i],r=r[e],e=n.gqt(t,i);if(r||o||e)return n=new vt.Style,bt(r)||n.h5(r),bt(o)||n.h5(o),bt(e)||n.h5(e),n},u.prototype.getStyle=function(t){for(var i,n,e,r,o,i,n=this.lZt,e=!1,o=n.length-1;0<=o;o--)rt(t,n[o].pivotArea)&&(e=!0,n[o].style)&&(r?r.compose(n[o].style):r=n[o].style.clone());if(e)return r},u.prototype.setStyle=function(t,i){var n,e,n=this;bt(t)||(t.references&&0<t.references.length&&ot(t),(e=n.yqt(t,i))&&this.DT({pivotTable:this,type:"setStyle"}),n.uqt(),n.refresh())},u.prototype.yqt=function(t,i,n,e){var n,r,o;if(!bt(t)&&(!n||i))return n=this,i?i.clone?r=i.clone():(r=new vt.Style).fromJSON(i,!1,gt):r=i,n.lZt.push(o={style:r,pivotArea:t,isFakeStyle:e}),!0},u.prototype.getHost=function(){return this.Ti},u.prototype.rqt=function(t,i){var n,e,r,n=this,e=[],r={};vt.GC$.extend(e,n.lZt),vt.GC$.extend(r,n.UJt),n.lZt=t||[],n.UJt=i||{},n.DT({type:"resetPivotStyle",areaModel:e,rangeModel:r,pivotTable:n,pivotType:0})},u.prototype.clearAll=function(){var t,i,n,e,r,o,o,a,s,t=this;for(t.suspendLayout(),n=(i=t.getFieldsByArea()).length,e=t.dh,r=n-1;0<=r;r--)o=i[r].fieldName,t.remove(i[r].fieldName),o=e.getSourceNameByFieldName(o),e.cC(o)&&e.cy(o,null,!0);for(t.rqt(),s=(a=t.mJ.QP()).length-1;-1<s;s--)t.mJ.XJt(a[s].conditionalRule);t.resumeLayout()},u.prototype.getConditionalRules=function(t){return this.mJ.YJt(t)},u.prototype.addConditionalRule=function(t,i){this.DT({pivotTable:this,type:"conditionalRulesChange",originalConditionalRules:this.mJ.qK.slice(),pivotType:0}),this.mJ.HJt(t,i)},u.prototype.removeConditionalRule=function(t){this.DT({pivotTable:this,type:"conditionalRulesChange",originalConditionalRules:this.mJ.qK.slice(),pivotType:0}),this.mJ.XJt(t)},u.prototype.tqt=function(t,i,n,e,r){this.mJ.tqt(t,i,n,e,r)},u.prototype.iqt=function(){this.mJ.iqt()},u.prototype.DJt=function(t){this.mJ.DJt(t)},u.prototype.Cqt=function(t,i,n){var e,r,o,a,s,u,c,l,f,h,v,d,p,m,b,g,w,y,C,A,N,I,T,S,x,M,D;if(t&&0<t.length&&n){for(r=(e=this).UJt,o=e.QJt,a=e.WJt,s=0,u=t.length;s<u;s++)if(c=t[s])for(l=z(n),f=c.row,h=c.col,v=c.rowCount,d=c.colCount,p=void 0,(l.borderLeft||l.borderRight||l.borderTop||l.borderBottom||l.borderHorizontal||l.borderVertical)&&Ct(p={},c,l),m=l.borderLeft,b=l.borderRight,g=l.borderTop,w=l.borderBottom,l.borderLeft=gt,l.borderRight=gt,l.borderTop=gt,l.borderBottom=gt,y=0;y<v;y++)for(r[f+y]||(r[f+y]={}),p&&p[f+y]&&!a[f+y]&&(a[f+y]={}),C=0;C<d;C++)bt(r[f+y][h+C])?(o[i]||(o[i]=z(l)),r[f+y][h+C]=i,p&&p[f+y]&&p[f+y][h+C]&&(A=new vt.Style,N=p[f+y][h+C],A.borderLeft=N.borderLeft?m:gt,A.borderRight=N.borderRight?b:gt,A.borderTop=N.borderTop?g:gt,A.borderBottom=N.borderBottom?w:gt,a[f+y][h+C]=A)):(o[I=r[f+y][h+C]+"-"+i]||(T=z(o[r[f+y][h+C]]),(S=z(l)).h5(T),o[I]=S,p&&p[f+y]&&p[f+y][h+C]&&(A=new vt.Style,N=p[f+y][h+C],A.borderLeft=N.borderLeft?m:gt,A.borderRight=N.borderRight?b:gt,A.borderTop=N.borderTop?g:gt,A.borderBottom=N.borderBottom?w:gt,a[f+y]&&a[f+y][h+C]&&A.h5(a[f+y][h+C]),a[f+y]||(a[f+y]={}),a[f+y][h+C]=A)),r[f+y][h+C]=I);if((x=n.formatter)&&"string"==typeof x&&P(x))for(M=0;M<t.length;M++)(D=t[M])&&e.Ti.SL(D.row||0,D.col||0,x)}},u.prototype.Iqt=function(t){return!(!0===t.labelOnly&&!0===t.dataOnly||!0===t.labelOnly&&!t.references&&bt(t.type)&&!t.grandRow&&!t.grandCol)},u.prototype.rJt=function(t,i){var n,e,r,n,r,o,n=this,e=n.eZt,r=n.rZt.HWt[4];return!n.Oy()&&0!==r.Sx&&0!==r.Tx&&(n=r.Sx,r=r.Tx,!!(o=yt(e.row+e.rowCount-n,e.col+e.colCount-r,n,r)).contains(t,i))},u.prototype.setNodeValue=function(t,i){return this.oJt(t,i,!1)},u.prototype.oJt=function(t,i,n){var e,r,o,a,e=this,r=e.dh;if(!bt(t))return"number"==typeof i?(t=e.Aqt(t),(0,pt.ht)(t)||(a=r.tQt(t),o=r.XVt(t,i),e.DT({type:"setNodeValue",pivotTable:e,nodeInfo:t,oldValue:a}))):(0,pt.ht)(i)&&(t=e.Aqt(t),(0,pt.ht)(t)||(a=r.tQt(t),o=r.iQt(t),e.DT({type:"setNodeValue",pivotTable:e,nodeInfo:t,oldValue:a}))),e.iM(n),o},u.prototype.Aqt=function(t,e){var r,o,a,s,u,i,n,c,r=this.dh,o=r.getAllFieldNameList(),a=r.X;if(!((t=(0,vt.RF)(t))&&t.fieldInfos&&0<t.fieldInfos.length&&(s=this.getCalcItems(),(u=!1,pt.o)(t.fieldInfos,function(t){var i=t.fieldName,n;if(e){if(!(n=a[i]))return}else if(!(n=r.getSourceNameByFieldName(i))){if(-1===o.indexOf(i))return;n=i}s.some(function(t){return t.sourceName===n})?u=!0:t.fieldName=n}),u))){if(t.valueInfo){if(i=t.valueInfo.sourceName,e){if(!(n=a[i]))return}else if(!(n=r.getSourceNameByFieldName(i))){if(-1===o.indexOf(i))return;n=i}if((c=this.getCalcFields()).some(function(t){return t.fieldName===i||t.fieldName===n}))return;t.valueInfo.sourceName=n}return t}},u.prototype.getNodeValue=function(t){var i=this,n=i.dh;if(!bt(t))return t=i.Aqt(t,!0),(0,pt.ht)(t)?y:n.tQt(t)},u.prototype.getNodeInfo=function(t,i){var n,e,n,t,i,n,e,r,t,n=this,e=n.dh;if(n.rJt(t,i)&&(t=(n=n.getPivotInfoImp(t,i)).valueFieldName,i=n.rowInfos,n=n.colInfos,e=e.getFieldInfoByName(t),!bt(e.a))&&!bt(e.Ar))return r={fieldInfos:[],valueInfo:{sourceName:t,subtotalType:e.Ar}},t=function(t){var i=t.fieldName,t=t.itemName;(0,pt.ht)(t)||i===wt().sigmaValue||r.fieldInfos.push({fieldName:i,fieldItem:t})},i&&0<i.length&&(0,pt.o)(i,t),n&&0<n.length&&(0,pt.o)(n,t),r},u.prototype.getOverwriteList=function(){var n,t,n=this.dh,t=n.eQt();return t&&0<t.length&&(0,pt.o)(t,function(t){var t=t.fieldInfos;t&&0<t.length&&(0,pt.o)(t,function(t){var i=n.getFieldNameBySourceName(t.fieldName);i&&(t.fieldName=i)})}),t},u.prototype.clearOverwriteList=function(){this.dh.rQt(),this.refresh()},u.prototype.getPivotAreaRanges=function(t){var i,n,e;return bt(t)||!this.Iqt(t)?[]:(i=this,t.grandRow||t.grandCol?i.Nqt(t):bt(t.references)?bt(t.type)?!0!==t.labelOnly?(n=i.rZt.HWt,e=i.eZt,[yt(n[4].DQ+e.row,n[4].jN+e.col,n[3].Sx,n[2].Tx)]):[]:i.Tqt(t):i.Mqt(t))},u.prototype.Nqt=function(t){var i,n,e,n,r,o,a,s,o,u,c,l,f,l,a,s,f,l,o,h,o,v,d,p,o,m,b,g,w,y,C,h,l,A,i=this,n=i.options.grandTotalPosition,e=n===mt.GrandTotalPosition.both||n===mt.GrandTotalPosition.row,n=n===mt.GrandTotalPosition.both||n===mt.GrandTotalPosition.col;if(e||n){if(a=(o=i.rZt.HWt)[4],s=o[3],o=o[2],u=t.references,c=t.references&&0<t.references.length,f=(l=i.eZt).row,l=l.col,a=yt(a.DQ+f,a.jN+l,s.Sx,o.Tx),s=yt(s.DQ+f,s.jN+l,s.Sx,s.Tx),f=yt(o.DQ+f+1,o.jN+l,o.Sx-1,o.Tx),l=i.dh.Q.length,h=(o=i.dh.getSigmaValuePosition()).positionType===pt.DataPosition.row,o=o.display,v=yt(a.row+a.rowCount-(o&&h?l:1),s.col,o&&h?l:1,s.colCount+a.colCount),d=yt(f.row,a.col+a.colCount-(o&&!h?l:1),f.rowCount+a.rowCount,o&&!h?l:1),o=t.offset,m=!0===t.grandRow&&e,b=!0===t.grandCol&&n,m)p=v;else{if(!b)return[];p=d}if(c&&(g={dataOnly:t.dataOnly,labelOnly:t.labelOnly,references:u},w=i.Mqt(g))&&0<w.length){for(y=[],C=0;C<w.length;C++)m&&(w[C]=v.getIntersect(w[C],0,0)),b&&w[C]&&(w[C]=d.getIntersect(w[C],0,0)),w[C]&&y.push(w[C]);return o?[]:y}if(!0===t.grandRow&&!0===t.grandCol&&e&&n&&!t.references&&(r=v.getIntersect(d,0,0)))return[r];if(c){if((g=G(t)).dataOnly=!0,g.labelOnly=!1,(w=i.Mqt(g))&&0<w.length){for(y=[],A=0;A<w.length;A++)(r=p.getIntersect(w[A],0,0))&&y.push(r);return o?[]:y=Nt(y)}}else if(h=t.grandRow?s:f,r=p.getIntersect(t.labelOnly&&!t.dataOnly?h:a,0,0))return o?t.labelOnly?(l=Ot(o,r.row,r.col,p.row+p.rowCount-1,p.col+p.colCount-1),[r.getIntersect(l)]):[]:[r]}return[]},u.prototype.Tqt=function(i){var t,n,e,r,o,r,a,s,t,u,c,l,f,n,h,u,v,d,n,f,s,h,p,c,m,b,g,w,y,C,A,v,u,e=this,r=e.eZt,o=r.row,r=r.col,a=e.rZt.HWt[2],s=a.DQ,t=a.jN,u=a.Sx,c=a.Tx,l=e.rZt.HWt[3],f=l.DQ,n=l.Tx,h=i.offset;if(i.type===mt.PivotAreaType.corner)return u=yt(o,r,u-1,n),bt(h)?[u]:[(d=yt(o+(v=jt(h,f-2,t-1)).row,r+v.col,v.rowCount,v.colCount)).getIntersect(u,u.rowCount,u.colCount)];if(i.type===mt.PivotAreaType.topRight)return f=yt(o+s,r+t+(n=a.ZWt.length),1,c-n),bt(h)?[f]:[(d=yt(o+s+(v=jt(h,0,c-n-1)).row,r+t+n+v.col,v.rowCount,v.colCount)).getIntersect(f,f.rowCount,f.colCount)];if(i.type!==mt.PivotAreaType.button||bt(i.fieldName)){if(i.type===mt.PivotAreaType.all)return(u=e.getRange()).page?[u.page,u.content]:[u.content]}else{for(s=e.dh.Z[i.fieldName],p=h=void 0,bt(s)&&i.fieldName===wt().Values&&((c=e.mqt())===pt.DataPosition.row?s=mt.PivotTableFieldType.rowField:c===pt.DataPosition.col&&(s=mt.PivotTableFieldType.columnField)),0===s?p=e.LYt:1===s?p={row:o+(h=l).DQ,col:r+h.jN}:2===s&&(p={row:o+(h=a).DQ,col:r+h.jN}),m=void 0,b=[],1===s?b=l.WWt:2===s&&(b=a.zWt),g=0;g<b.length;g++)b[g]&&b[g].path===i.fieldName&&(m=g);if(bt(m)){if(0===s){for(w=e.dh.G,g=0;g<w.length;g++)if(w[g]&&w[g].Zc===i.fieldName)return y=e.options.displayFieldsInPageFilterArea,C=e.options.reportFilterFieldsPerColumn,A=i.type!==mt.PivotAreaType.button,y===mt.DisplayFields.downThenOver?0===C?[yt(p.row+g,A?p.col+1:p.col,1,1)]:[new vt.Range(p.row+g%C,A?p.col+3*Math.floor(g/C)+1:p.col+3*Math.floor(g/C),1,1)]:0===C?[yt(p.row,A?p.col+3*g+1:p.col+3*g,1,1)]:[yt(p.row+Math.floor(g/C),A?p.col+g%C*3+1:p.col+g%C*3,1,1)]}else if(1===s&&e.CWt===mt.PivotTableLayoutType.compact&&(v=null==(n=null==(t=null==(h=l)?void 0:h.ZWt)?void 0:t[0])?void 0:n.compactFieldList)&&0<=(m=v.findIndex(function(t){return t===i.fieldName})))return[yt(p.row-1,p.col+m,1,1)];return[]}if(e.CWt===mt.PivotTableLayoutType.compact)return[yt(p.row-1,p.col,1,1)];if(1===s)return[yt(p.row-1,p.col+ +m,1,1)];if(2===s)return[yt(p.row,p.col+ +m-1,1,1)]}return[]},u.prototype.Mqt=function(t){var i,i,i,i,i,L,n,e,r,o,a,s,u,c,E,B,R,l,f,h,v,e,G,d,p,m,V,b,g,w,y,C,U,Q,A,W,z,N,I,T,Z,S,x,Y,H,J,q,x,M,K,D,M,X,k,$,j,tt,it,nt,O,et,_,F,M,rt,ot,at,st,A,ut,i,L,i,ct,P,lt,ft,ht,n=this;if(t=(0,vt.RF)(t),e=n.rZt.HWt[4],r=n.eZt.row,o=n.eZt.col,a=e.DQ,s=e.jN,u=n.rZt.HWt[3].Sx,c=n.rZt.HWt[2].Tx,E=n.dh.Z,B=n.options.subTotalsPosition,R=n.dh.Q.length,l=[],h=1===(f=t.references).length,e=t.offset,G=wt().Values,d=n.dh.getSigmaValuePosition(),e&&!0!==t.labelOnly)return l;for(p={},m=0,V=f.length;m<V;m++)p[g=(b=f[m]).fieldName]=b;for(y=n.dh.B,C=n.dh.R,A=Q=U=w=!1,m=y.length-1;0<=m;m--)p[y[m].Zc]&&(U=!0,W||(W=p[y[m].Zc],z=m),w||t.offset?p[y[m].Zc].xqt=!0:!1===w&&(w=!0));for(w=!1,m=C.length-1;0<=m;m--)p[C[m].Zc]&&(W||(W=p[C[m].Zc],z=m),!(Q=!0)===w?w=!0:p[C[m].Zc].xqt=!0);if(h&&f[0].fieldName===G&&(A=!0,z=d.positionIndex),e&&(U&&Q||!U&&!Q&&!A||!W&&!A))return l;for(m=0,V=f.length;m<V;m++){if(g=(b=f[m]).fieldName,N=b.items,I=t.labelOnly,T=t.dataOnly,Z=b.subtotal,!(S=[])===T&&bt(I)?I=T=!0:(!1===T&&!1===I||T===gt&&I===gt)&&(T=!0),g===G&&1<R)v=d.positionType===pt.DataPosition.row?1:2;else{if(g===G&&1===R&&(bt(N)||1===N.length&&N[0]===n.dh.Q[0].Zc)){I&&(S=[yt(Y=(x=d.positionType===pt.DataPosition.row)?r+a:r,H=x?o:o+s,J=x?u:1,q=x?1:c)],l.push(S)),T&&(S=[yt(r+a,o+s,u,c)],l.push(S));continue}v=E[g]}if(M=(x=n.dh.getFieldInfoByName(g))&&x.Spi,K=(0,dt.getActualSubtotalPosition)(B,M),M=D=void 0,1===v)M=n.rZt.HWt[3];else if(2===v)M=n.rZt.HWt[2];else{if(0!==v){l.push([]);continue}if(M=n.rZt.HWt[0],bt(N)&&t.labelOnly){for(X=n.dh.G,k=0;k<X.length;k++)if(X[k]&&X[k].Zc===g){if($=n.options.displayFieldsInPageFilterArea,j=n.options.reportFilterFieldsPerColumn,tt=t.type!==mt.PivotAreaType.button,$===mt.DisplayFields.downThenOver){if(0===j){S=[yt(n.LYt.row+k,tt?n.LYt.col+1:n.LYt.col,1,1)];break}S=[new vt.Range(n.LYt.row+k%j,tt?n.LYt.col+3*Math.floor(k/j)+1:n.LYt.col+3*Math.floor(k/j),1,1)];break}if(0===j){S=[yt(n.LYt.row,tt?n.LYt.col+3*k+1:n.LYt.col+3*k,1,1)];break}S=[yt(n.LYt.row+Math.floor(k/j),tt?n.LYt.col+k%j*3+1:n.LYt.col+k%j*3,1,1)];break}l.push(S);continue}}if(D=M&&M.YWt){if(it=void 0,bt(N))if((rt=(M=n.dh.getFieldInfoByName(g))&&M._items)&&0<rt.length){for(nt=n.dh.Q,O={},k=0;k<R;k++)O[nt[k].Zc]=k;for(k=0;k<rt.length;k++)rt[k]&&!bt(rt[k].value)&&(_=rt[k].value,F=D[g]&&D[g][_],bt(F)||(S=S.concat(n.Dqt(F,v,r,o,a,s,u,c,I,T,Z,K,h,g===wt().Values,_,O[_],b.xqt,gt,t.outline))))}else for(st in at=0,ot=D[g])ot.hasOwnProperty(st)&&(F=D[g]&&D[g][st],bt(F)||(S=S.concat(n.Dqt(F,v,r,o,a,s,u,c,I,T,Z,K,h,g===wt().Values,st,0,b.xqt,gt,t.outline))));else{for(nt=n.dh.Q,O={},k=0;k<R;k++)O[nt[k].Zc]=k;for(k=0,et=N.length;k<et;k++)_=N[k],F=D[g]&&D[g][_],bt(F)||(it=n.collapse(g,_),S=S.concat(n.Dqt(F,v,r,o,a,s,u,c,I,T,Z,K,h,g===wt().Values,N[k],O[N[k]],b.xqt,it,t.outline)))}l.push(S)}}if(ut=A=0,i=y.length+(d.display&&d.positionType===pt.DataPosition.row?1:0),L=C.length+(d.display&&d.positionType===pt.DataPosition.col?1:0),U?(n.CWt!==mt.PivotTableLayoutType.compact&&(ut=i-1-z),A=null!=(i=null==(i=null==l?void 0:l[0])?void 0:i[0])&&i.rowCount?l[0][0].rowCount-1:0):(A=null!=(i=null==(i=null==l?void 0:l[0])?void 0:i[0])&&i.rowCount?l[0][0].rowCount-1:L-1-z,ut=null!=(L=null==(i=null==l?void 0:l[0])?void 0:i[0])&&L.colCount?l[0][0].colCount-1:0),e&&!xt(e,A,ut))return[];if(h)return e?(i=l[0])&&i[0]?[Ot(e,(ct=i[0]).row,ct.col,A,ut)]:[]:l[0];for(P=l[0],m=1;m<l.length;m++){for(lt=[],k=0;k<P.length;k++)for(ft=0;ft<l[m].length;ft++)(ht=P[k]&&l[m][ft]&&P[k].getIntersect(l[m][ft]))&&lt.push(ht);P=lt}return P=Nt(P),e?P&&P[0]?[Ot(e,(ct=P[0]).row,ct.col,A,ut)]:[]:P},u.prototype.Dqt=function(t,i,n,e,r,o,a,s,u,c,l,f,h,v,d,p,m,b,g){var w,y,C,t,A,C,N,I,T,S,S,w=this,y=[],C=t.ranges,t=t.level,A=f===mt.SubtotalsPosition.top||f===mt.SubtotalsPosition.bottom;return C&&(C=ut(C),I=N=void 0,T=w.dh.getSigmaValuePosition(),1===i?(S=w.dh.B.length,N=1<t&&A&&!(2===t&&T.display&&T.positionType===pt.DataPosition.row&&S+1-T.positionIndex==1),I=T.display&&T.positionType===pt.DataPosition.row&&S-T.positionIndex<t?w.dh.Q.length:1,w.Sqt(y,C,t,n+r,e+o,a,s,u,c,l,f,h,N,I,v,d,p,m,b,g)):2===i&&(S=w.dh.R.length,N=1<t&&A&&!(2===t&&T.display&&T.positionType===pt.DataPosition.col&&S+1-T.positionIndex==1),I=T.display&&T.positionType===pt.DataPosition.col&&S-T.positionIndex<t?w.dh.Q.length:1,w.kqt(y,C,t,n+r,e+o,a,s,u,c,l,f,h,N,I,v,d,p,b))),y},u.prototype.Sqt=function(t,i,n,e,r,o,a,s,u,c,l,f,h,v,d,p,m,b,g,w){for(var y,C,A,N,I,T,S,x,M,D,y,C=this.layoutType(),A=!1===w&&C===mt.PivotTableLayoutType.outline,N=0,I=i.length;N<I;N++)bt(i[N])||(!s||c&&!d||((T=yt(0,0,0,0)).row=e+i[N].start,T.col=C===mt.PivotTableLayoutType.compact?r-1:r-n,T.rowCount=C===mt.PivotTableLayoutType.tabular||b||A?i[N].end-i[N].start+1:1,T.colCount=(C!==mt.PivotTableLayoutType.outline||!1===w)&&f?1:n,t.push(T)),!u||c&&!d||((S=yt(0,0,0,0)).row=e+i[N].start,S.col=r,S.rowCount=C===mt.PivotTableLayoutType.tabular||d||b||A?i[N].end-i[N].start+1:1,S.colCount=a,t.push(S)),h&&c&&!g&&!d&&(x=l===mt.SubtotalsPosition.top&&this.layoutType()!==mt.PivotTableLayoutType.tabular?e+i[N].start:e+i[N].end+1,l===mt.SubtotalsPosition.top&&C!==mt.PivotTableLayoutType.tabular||(s&&((T=yt(0,0,0,0)).row=x,T.col=r-(C===mt.PivotTableLayoutType.compact?1:n),T.rowCount=v,T.colCount=C===mt.PivotTableLayoutType.compact?1:n,t.push(T)),u&&((S=yt(0,0,0,0)).row=x,S.col=r,S.rowCount=v,S.colCount=a,t.push(S)))));u&&d&&(M=this.dh.Q.length,(D=yt(0,0,0,0)).row=e+o-(M-m),D.col=r,D.rowCount=1,D.colCount=a,t.push(D))},u.prototype.kqt=function(t,i,n,e,r,o,a,s,u,c,l,f,h,v,d,p,m,b){for(var g,w,y,C,A,N,g=0,w=i.length;g<w;g++)bt(i[g])||(!s||c&&!d||((y=yt(0,0,0,0)).row=e-n,y.col=r+i[g].start,y.rowCount=f?1:n,y.colCount=i[g].end-i[g].start+1,t.push(y)),!u||c&&!d||((C=yt(0,0,0,0)).row=e,C.col=r+i[g].start,C.rowCount=o,C.colCount=i[g].end-i[g].start+1,t.push(C)),h&&c&&!d&&(s&&((y=yt(0,0,0,0)).row=e-n,y.col=r+i[g].end+1,y.rowCount=n,y.colCount=v,t.push(y)),u)&&((C=yt(0,0,0,0)).row=e,C.col=r+i[g].end+1,C.rowCount=o,C.colCount=v,t.push(C)));u&&d&&(A=this.dh.Q.length,(N=yt(0,0,0,0)).row=e,N.col=r+a-(A-m),N.rowCount=o,N.colCount=1,t.push(N))},u.prototype.sqt=function(){var t,i,n,t=this,i=t.EZt,n=t.Ti;n.suspendPaint(),t.jqt(),t.options.mergeItem&&(t.Oqt(),t.Pqt()),n.resumePaint(),i.LZt=[],i.BZt=[]},u.prototype.jqt=function(){var t,i,n,e,r,t=this,i=t.EZt,n=t.Ti,e=i.GJt,r=i.RJt;0===r.length&&0===e.length||((0,pt.o)(r,function(t){n.removeSpan(t.row,t.col)}),(0,pt.o)(e,function(t){n.removeSpan(t.row,t.col)}),(0,pt.o)(t.VJt,function(t){n.getRange(t.row,t.col,t.rowCount,t.colCount).vAlign(t.vAlign).hAlign(t.hAlign)}),i.GJt=[],i.RJt=[],t.VJt=[])},u.prototype.Pqt=function(){var t,r,i,n,e,o,o,a,s,u,c,l,f,o,i,h,v,t=this,r=t.Ti,i=t.rZt.HWt[3],n=t.rZt.HWt[2],e=t.EZt,o=n.isHideFirstRow?2:3;(!i||i.Tx<2)&&(!n||n.Sx<o)||(t.GCe=!0,o=t.eZt,a=o.row,s=o.col,u=i.DQ,c=i.jN,l=n.DQ,f=n.jN,o=e.BZt,i=e.LZt,h=e.GJt,v=e.RJt,(0,pt.o)(i,function(t){var i=t.row,n=t.col,e=t.rowCount,t=t.colCount;i+=u+a,n+=c+s;try{r.addSpan(i,n,e,t),h.push({row:i,col:n,rowCount:e,colCount:t})}catch(t){}}),(0,pt.o)(o,function(t){var i=t.row,n=t.col,e=t.rowCount,t=t.colCount;i+=l+a,n+=f+s;try{r.addSpan(i,n,e,t),v.push({row:i,col:n,rowCount:e,colCount:t})}catch(t){}}),t.GCe=!1)},u.prototype.Oqt=function(){var t,i,n,e,r,o,a,s,a,t=this,i=t.Ti,n=t.VJt,e=t.rZt.HWt[3].getRange(),r=t.rZt.HWt[2].getRange(),o=t.rZt.HWt[1].getRange(),a=t.eZt,s=a.row,a=a.col;t.layoutType()!==mt.PivotTableLayoutType.compact&&n.push(t.Fqt(i.getRange(e.row+s,e.col+a,e.rowCount,e.colCount))),n.push(t.Fqt(i.getRange(r.row+s,r.col+a,r.rowCount,r.colCount))),n.push(t.Fqt(i.getRange(o.row+s,o.col+a,o.rowCount,o.colCount)))},u.prototype.Fqt=function(t){var i={row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount,vAlign:t.vAlign(),hAlign:t.hAlign()};return t.hAlign(1).vAlign(1),i},u.prototype.zRt=function(t){var i;return this.dh.getFieldInfoByName(t)},u.prototype.isSortValueField=function(t){var i,i,i,n,e,r,n,o;if(t)return 2!==(r=(e=this).mqt())&&(n=wt(),((null==(i=t.cornerFieldInfo)?void 0:i.fieldName)||(null==(i=t.colHeadFieldInfo)?void 0:i.fieldName))===n.Values||(o=n.sigmaValue,0===r&&3===t.area?null==(i=t.rowInfos)?void 0:i.some(function(t){return t.fieldName===o}):r===pt.DataPosition.col&&2===t.area&&(null==(n=t.colInfos)?void 0:n.some(function(t){return t.fieldName===o}))))},u.prototype.fromJson=function(t,i){var n,e,r,r,o,a,s,u,c,l,f,h,v,d,p,m,b,g,w,y,C,A,n=this;if(n.VCe=!0,n._qt(t),bt(t.multipleFieldFilters)?n.options.allowMultipleFiltersPerField=!0:n.options.allowMultipleFiltersPerField=t.multipleFieldFilters,bt(t.styleName)?n.theme("light0"):(e=M.BuiltInPivotTableThemeNames[t.styleName.toUpperCase()])?(r=t.styleName.replace("PivotStyle","").toLowerCase(),n.theme(r)):(r=t.style,(o=new Q.PivotTableTheme).fromJSON(r),n.theme(o)),!1===t.rowGrandTotals&&!1===t.colGrandTotals?n.options.grandTotalPosition=mt.GrandTotalPosition.none:!1===t.rowGrandTotals?n.options.grandTotalPosition=mt.GrandTotalPosition.row:!1===t.colGrandTotals?n.options.grandTotalPosition=mt.GrandTotalPosition.col:n.options.grandTotalPosition=mt.GrandTotalPosition.both,bt(t.showRowHeaders)||(n.options.showRowHeader=t.showRowHeaders),bt(t.showColHeaders)||(n.options.showColumnHeader=t.showColHeaders),bt(t.showRowStripes)||(n.options.bandRows=t.showRowStripes),bt(t.showColStripes)||(n.options.bandColumns=t.showColStripes),bt(t.pageOverThenDown)||(n.options.displayFieldsInPageFilterArea=t.pageOverThenDown?mt.DisplayFields.overThenDown:mt.DisplayFields.downThenOver),bt(t.pageWrap)||(n.options.reportFilterFieldsPerColumn=t.pageWrap),bt(t.showFilter)||(n.options.showFilter=t.showFilter),bt(t.showDrill)||(n.options.showDrill=t.showDrill),bt(t.showToolTip)||(n.options.showToolTip=t.showToolTip),bt(t.showMissing)||(n.options.showMissing=t.showMissing),bt(t.missingCaption)||(n.options.missingCaption=t.missingCaption),bt(t.indent)?n.options.rowLabelIndent=2:n.options.rowLabelIndent=t.indent+1,bt(t.errorCaption)||(n.options.errorValueInfo=t.errorCaption),bt(t.showError)||(n.options.isShowErrorValue=t.showError),bt(t.showDataTips)||(n.options.showToolTip=t.showDataTips),bt(t.showHeaders)||(n.options.showHeaders=t.showHeaders),bt(t.mergeItem)||(n.options.mergeItem=t.mergeItem),bt(t.dataCaption)||(n.cCi=t.dataCaption),bt(t.fillDownLabels)||(n.options.fillDownLabels=t.fillDownLabels),bt(t.printDrill)||(n.options.printDrill=t.printDrill),bt(t.itemPrintTitles)||(n.options.itemPrintTitles=t.itemPrintTitles),bt(t.fieldPrintTitles)||(n.options.fieldPrintTitles=t.fieldPrintTitles),bt(t.rowHeaderCaption)||(n.options.rowHeaderCaption=t.rowHeaderCaption),bt(t.colHeaderCaption)||(n.options.colHeaderCaption=t.colHeaderCaption),bt(t.enableDataValueEditing)||(n.options.enableDataValueEditing=t.enableDataValueEditing),!bt(t.formats))for(a=0;a<t.formats.length;a++)s=t.formats[a],bt(s.style)||S(s.style)||(u=void 0,u=(c=s.pivotArea).missed?c.pivotArea:n.excelPivotAreaToSheetPivotArea(c),(l=new vt.Style).fromJSON(s.style,!1,gt),n.yqt(u,l,!0));if(h=(f=n.Ti).conditionalFormats,!bt(t.pivotTableConditionFormats)&&h){for(v=[],d=[],a=0;a<t.pivotTableConditionFormats.length;a++)t.pivotTableConditionFormats[a]&&t.pivotTableConditionFormats[a].rule&&(v[t.pivotTableConditionFormats[a].rule.priority-1]=t.pivotTableConditionFormats[a]);for(a=v.length-1;0<=a;a--)v[a]&&d.push(v[a]);for(t.pivotTableConditionFormats=d,a=0;a<t.pivotTableConditionFormats.length;a++){for(p=t.pivotTableConditionFormats[a],m=[],b=0;b<p.pivotAreas.length;b++)u=void 0,u=(c=p.pivotAreas[b]).missed?c.pivotArea:n.excelPivotAreaToSheetPivotArea(c),m.push(u);p.rule&&(g=void 0,p.rule.ruleType?g=h.pJ(p.rule,f,!1):p.rule.priority&&i.conditionalFormats&&i.conditionalFormats.rules&&(g=h.pJ(i.conditionalFormats.rules[p.rule.priority-1],f,!1)),n.mJ.HJt(m,g,!0))}}if(bt(t.views)||n.views.fromJson(t.views),bt(t.altText)||(n.zJt=t.altText),bt(t.altTextSummary)||(n.ZJt=t.altTextSummary),bt(t.hideValuesRow)||(n.options.hideValuesRow=t.hideValuesRow),t.dataFields&&0<t.dataFields.length)for(y=0,C=w=t.dataFields;y<C.length;y++)A=C[y],bt(A.showDataAs)||(n.eqt=!0)},u.prototype.yh=function(t,i,n){var e,r,o,a,a,s,u,u,a,u,o,c,l,f,h,v,d,v,p,m,b,g,w,a,y,C,A,u,N,o,I,T,S,x,e=this;if(e.VCe=!0,r=i.styleManager,e.Lqt(t,r),bt(t.multipleFieldFilters)?e.options.allowMultipleFiltersPerField=!0:e.options.allowMultipleFiltersPerField=O(t.multipleFieldFilters),a=(o=k(t,"pivotTableStyleInfo"))&&o.name,a=(a=bt(a)?"PivotStyleLight0":a)||r.getDefaultStyleName("defaultPivotStyle"),(s=M.BuiltInPivotTableThemeNames[a.toUpperCase()])?(u=a.replace("PivotStyle","").toLowerCase(),e.theme(u)):(u=r.getPivotTableTheme(a),e.theme(u)),bt(o)||(e.options.showRowHeader=O(o.showRowHeaders,!1),e.options.showColumnHeader=O(o.showColHeaders,!1),bt(o.showRowStripes)||(e.options.bandRows=O(o.showRowStripes)),bt(o.showColStripes))||(e.options.bandColumns=O(o.showColStripes)),a=O(t.rowGrandTotals),u=O(t.colGrandTotals),e.options.grandTotalPosition=!1===a&&!1===u?mt.GrandTotalPosition.none:!1===a?mt.GrandTotalPosition.row:!1===u?mt.GrandTotalPosition.col:mt.GrandTotalPosition.both,bt(t.pageOverThenDown)||(e.options.displayFieldsInPageFilterArea=O(t.pageOverThenDown)?mt.DisplayFields.overThenDown:mt.DisplayFields.downThenOver),bt(t.pageWrap)||(e.options.reportFilterFieldsPerColumn=_(t.pageWrap)),(o=t.lossless)&&(bt(o.showFilter)||(e.options.showFilter=o.showFilter),bt(o.showToolTip)||(e.options.showToolTip=o.showToolTip),bt(o.enableDataValueEditing)||(e.options.enableDataValueEditing=o.enableDataValueEditing),bt(o.views)||e.views.fromJson(o.views)),bt(t.showDrill)||(e.options.showDrill=O(t.showDrill)),bt(t.showMissing)||(e.options.showMissing=O(t.showMissing)),bt(t.missingCaption)||(e.options.missingCaption=t.missingCaption),bt(t.indent)?e.options.rowLabelIndent=2:e.options.rowLabelIndent=_(t.indent)+1,bt(t.errorCaption)||(e.options.errorValueInfo=t.errorCaption),bt(t.showError)||(e.options.isShowErrorValue=O(t.showError)),bt(t.showDataTips)||(e.options.showToolTip=O(t.showDataTips)),bt(t.showHeaders)||(e.options.showHeaders=O(t.showHeaders)),bt(t.mergeItem)||(e.options.mergeItem=O(t.mergeItem)),bt(t.dataCaption)||(e.cCi=t.dataCaption),bt(t.printDrill)||(e.options.printDrill=O(t.printDrill)),bt(t.itemPrintTitles)||(e.options.itemPrintTitles=O(t.itemPrintTitles)),bt(t.fieldPrintTitles)||(e.options.fieldPrintTitles=O(t.fieldPrintTitles)),bt(t.rowHeaderCaption)||(e.options.rowHeaderCaption=t.rowHeaderCaption),bt(t.colHeaderCaption)||(e.options.colHeaderCaption=t.colHeaderCaption),c=k(t,"formats"),l=o&&o.pivotStyles,!bt(c)){for(c=c.c_||[],f=[],l&&Object.keys(l).forEach(function(t){var i=new vt.Style;i.fromJSON(l[t].style,!1,gt),f[t]={pivotArea:l[t].pivotArea,style:i}}),h=0;h<c.length;h++)if(v=c[h],d=_(v.dxfId),v=e.excelPivotAreaSJSToSheetPivotArea(k(v,"pivotArea")),p=new vt.Style,r.getDxf(d,p,gt,!0),p.fromJSON(p,!1,gt),f[h]){for(m=h+1;f[m];)m++;f[m]={pivotArea:v,style:p}}else f[h]={pivotArea:v,style:p};for(h=0;h<f.length;h++)e.yqt(f[h].pivotArea,f[h].style,!0)}if(b=e.Ti,g=b.conditionalFormats,w=!1,a=k(t,"conditionalFormats"),o&&o.conditionalFormats&&0<o.conditionalFormats.length)for(w=!0,y=o.conditionalFormats,h=0;h<y.length;h++)(C=y[h])&&(A=g.pJ(C.rule,b))&&e.mJ.HJt(C.pivotAreas,A,!0);else!bt(a)&&a.c_&&0<a.c_.length&&e.tCi(n,a,g,i,r);if(u=k(t,"extLst"),e.options.hideValuesRow=!1,bt(u)||(N=u.c_).forEach(function(t){var t,t,t=k(t,"pivotTableDefinition");bt(t)||(bt(t.altText)||(e.zJt=t.altText),bt(t.fillDownLabelsDefault)||(e.options.fillDownLabels=O(t.fillDownLabelsDefault)),bt(t.altTextSummary)||(e.ZJt=t.altTextSummary),e.options.hideValuesRow=O(t.hideValuesRow,!1),t=k(t,"conditionalFormats"),!0!==w&&!bt(t)&&t.c_&&0<t.c_.length&&e.tCi(n,t,g,i,r))}),o=k(t,"dataFields"))for(T=0,S=I=o.c_;T<S.length;T++)x=S[T],bt(x.showDataAs)||(e.eqt=!0)},u.prototype.tCi=function(t,i,n,e,r){var o,a,s,u,c,l,i,t,i,f,h,v,d,p,m,b,g,w,y,y,w,o=this,a=[],s=[],u=o.Ti,c=i.c_,l=I(t,"conditionalFormatting").filter(function(t){return!0===vt.NodeHelper.ur(t.pivot)}),i=k(t,"extLst");for(i&&(t=N(i,"conditionalFormattings"))&&0<(i=I(t,"conditionalFormatting")).length&&(l=l.concat(i.filter(function(t){return(t.isExtRule=!0)===vt.NodeHelper.ur(t.pivot)}))),f=function(n){var e,r,e=_(c[n].priority);l&&((0,pt.o)(l,function(i){var t=i.c_;if((0,pt.o)(t,function(t){if(+t.priority===e)return c[n].rule=t,r=i,!0}),r)return!0}),c[n].rule)&&(a[c[n].rule.priority-1]={pivotCf:c[n],sheetCf:r})},h=0;h<c.length;h++)f(h);for(h=a.length-1;0<=h;h--)a[h]&&s.push(a[h]);for(h=0;h<s.length;h++){for(v=s[h].pivotCf,p=(d=s[h].sheetCf).isExtRule,m=[],b=k(v,"pivotAreas").c_,g=0;g<b.length;g++)m.push(o.excelPivotAreaSJSToSheetPivotArea(b[g]));v.rule&&(w=d.sqref,p&&(w=(y=k(d,"sqref"))&&y.c_[0]),y=vt.range_parser.Dc(w),w=void 0,v.rule.type?w=n.xJ(v.rule,y,r,u,void 0,p):v.rule.priority&&d&&d.c_&&(w=n.xJ(d.c_[v.rule.priority-1],y,r,u,void 0,p)),w)&&o.mJ.HJt(m,w,!0)}},u.prototype._qt=function(t){for(var i,n,e,r,o,a,s,u,c,i=this,n=t.fields,e=0,r=n.length;e<r;e++)o=n[e],bt(o.numberFormat)||(a={labelOnly:!0,references:[{fieldName:o.name}]},(s=new vt.Style).formatter=o.numberFormat,i.yqt(a,s,!0,!0));if((u=t.dataFields)&&0<u.length)if(1!==(c=u.length)||bt(u[0].numberFormat))for(e=0;e<c;e++)o=u[e],bt(o.numberFormat)||(a={dataOnly:!0,references:[{fieldName:wt().Values,items:[o.name]}]},(s=new vt.Style).formatter=o.numberFormat,i.yqt(a,s,!0,!0));else a={dataOnly:!0},(s=new vt.Style).formatter=u[0].numberFormat,i.yqt(a,s,!0,!0)},u.prototype.Lqt=function(t,i){var n,e,r,o,a,s,u,c,l,n=this,e=k(t,"pivotFields");if(e)for(r=0,o=e.c_.length;r<o;r++)a=e.c_[r],bt(a.numFmtId)||(s={labelOnly:!0,references:[{fieldName:a.name}]},u=Tt(i,a),n.yqt(s,u,!0,!0));if(l=(c=k(t,"dataFields"))&&c.c_.length,c&&0<l)if(1!==l||bt(c.c_[0].numFmtId))for(r=0;r<l;r++)a=c.c_[r],bt(a.numFmtId)||(s={dataOnly:!0,references:[{fieldName:wt().Values,items:[a.name]}]},u=Tt(i,a),n.yqt(s,u,!0,!0));else s={dataOnly:!0},u=Tt(i,c.c_[0]),n.yqt(s,u,!0,!0)},u.prototype.excelPivotAreaToSheetPivotArea=function(t){var i,n,e,r,o,a,s,u,c,l,f,h,v,i,n=this,e=n.dh.Pq,r={};if(bt(t.labelOnly)||(r.labelOnly=t.labelOnly),bt(t.dataOnly)||(r.dataOnly=t.dataOnly),bt(t.grandCol)||(r.grandCol=t.grandCol),bt(t.grandRow)||(r.grandRow=t.grandRow),!1===t.outline&&(r.outline=!1),"axisRow"===t.axis?r.axis=mt.PivotAreaAxisType.row:"axisCol"===t.axis&&(r.axis=mt.PivotAreaAxisType.col),t.offset&&(r.offset=Mt(n.Ti,t.offset,!!t.references)),!bt(t.references)&&0<t.references.length){for(r.references=[],o=0;o<t.references.length;o++)if(s={},u=(a=t.references[o]).field===C||a.field===+C?{Zc:wt().Values,_items:[]}:e[a.field]){if(c=u.Zc,a.indexes){for(l=[],f=0,h=a.indexes.length;f<h;f++)v=a.indexes[f],bt(v)||l.push(c===wt().Values?n.dh.Q[v].Zc:u._items[v]&&u._items[v].value);0<l.length&&(s.items=l)}s.fieldName=c,bt(a.defaultSubtotal)||(s.subtotal=a.defaultSubtotal),r.references.push(s)}}else bt(t.type)||(r.type=at(t.type),i=t.field,r.fieldName=-2===i?wt().Values:null==(i=null==e?void 0:e[i])?void 0:i.Zc);return r},u.prototype.excelPivotAreaSJSToSheetPivotArea=function(t){var t,i,n,e,r,o,a,s,u,c,l,f,h,v,d,p,i=this,n=i.dh.Pq,e={};if(bt(t.labelOnly)||(e.labelOnly=O(t.labelOnly)),bt(t.dataOnly)||(e.dataOnly=O(t.dataOnly)),bt(t.grandCol)||(e.grandCol=O(t.grandCol)),bt(t.grandRow)||(e.grandRow=O(t.grandRow)),"0"===t.outline&&(e.outline=!1),"axisRow"===t.axis?e.axis=mt.PivotAreaAxisType.row:"axisCol"===t.axis&&(e.axis=mt.PivotAreaAxisType.col),t.offset&&(e.offset=Mt(i.Ti,t.offset,t.c_&&0<t.c_.length)),r=k(t,"references"),bt(r))bt(t.type)||(e.type=at(t.type),s=_(t.field),e.fieldName=-2===s?wt().Values:null==(t=null==n?void 0:n[s])?void 0:t.Zc);else for(r=r.c_,e.references=[],o=0;o<r.length;o++)if(a=r[o],u={},c=(s=T(a.field))===C||s===+C?{Zc:wt().Values,_items:[]}:n[s]){if(l=c.Zc,f=a.c_,!bt(f)){for(h=[],v=0,d=f.length;v<d;v++)p=_(f[v].v),bt(p)||h.push(l===wt().Values?i.dh.Q[p].Zc:c._items[p]&&c._items[p].value);0<h.length&&(u.items=h)}u.fieldName=l,bt(a.defaultSubtotal)||(u.subtotal=O(a.defaultSubtotal)),e.references.push(u)}return e},u.prototype.toJson=function(t,i){var n,e,r,o,a,s,u,c,l,f,h,v,d,s,s,s,u,L,u,s,u,l,a,c,o,r,l,c,p,m,b,g,w,y,C,A,N,I,T,S,y,x,M,D,k,j,O,_,F,P,_,E,n=this,e=n.getRange().content;if(!i||!i.ignoreStyle){switch(v=(h=n.dh)&&h.cft?h.cft:{},d=n.layoutType()){case mt.PivotTableLayoutType.outline:v.compact=!1,v.compactData=!1,v.outline=!0,v.outlineData=!0;break;case mt.PivotTableLayoutType.tabular:v.compact=!1,v.compactData=!1,v.outline=!1,v.outlineData=!1;break;default:v.outline=!0,v.outlineData=!0}if(bt(n.Zc)||(i&&i.newWorkSheetName&&n.Ti&&n.Ti.parent?(s=n.Ti.parent,v.name=n.Eqt=(0,dt.fJt)(n.Zc,s)):v.name=n.Zc),bt(n.options.allowMultipleFiltersPerField)||(v.multipleFieldFilters=n.options.allowMultipleFiltersPerField),(s=h.getSigmaValuePosition()).display&&s.positionType===pt.DataPosition.row&&(v.dataOnRows=!0),u=(s=n.theme())&&s.name(),bt(u)||((L=Q.PivotTableThemes[u.toLowerCase()])?(u=u.replace(/^[a-z]{1}/g,function(t){return t.toUpperCase()}),v.styleName="PivotStyle"+u):(v.styleName=u,v.style=s.toJSON())),bt(n.options.showRowHeader)||(v.showRowHeaders=n.options.showRowHeader),bt(n.options.showColumnHeader)||(v.showColHeaders=n.options.showColumnHeader),bt(n.options.bandRows)||(v.showRowStripes=n.options.bandRows),bt(n.options.bandColumns)||(v.showColStripes=n.options.bandColumns),bt(n.options.displayFieldsInPageFilterArea)||(v.pageOverThenDown=n.options.displayFieldsInPageFilterArea===mt.DisplayFields.overThenDown),bt(n.options.reportFilterFieldsPerColumn)||(v.pageWrap=n.options.reportFilterFieldsPerColumn),bt(n.options.showFilter)||(v.showFilter=n.options.showFilter),bt(n.options.showDrill)||(v.showDrill=n.options.showDrill),bt(n.options.showMissing)||(v.showMissing=n.options.showMissing),bt(n.options.showToolTip)||(v.showToolTip=n.options.showToolTip),bt(n.options.missingCaption)||(v.missingCaption=n.options.missingCaption),bt(n.options.fillDownLabels)||(v.fillDownLabels=n.options.fillDownLabels),bt(n.options.rowLabelIndent)||2===n.options.rowLabelIndent||(v.indent=n.options.rowLabelIndent-1),bt(n.options.printDrill)||(v.printDrill=n.options.printDrill),bt(n.options.itemPrintTitles)||(v.itemPrintTitles=n.options.itemPrintTitles),bt(n.options.fieldPrintTitles)||(v.fieldPrintTitles=n.options.fieldPrintTitles),bt(n.options.mergeItem)||(v.mergeItem=n.options.mergeItem),delete v.colGrandTotals,delete v.rowGrandTotals,bt(n.options.grandTotalPosition)||((u=n.options.grandTotalPosition)!==mt.GrandTotalPosition.none&&u!==mt.GrandTotalPosition.col||(v.colGrandTotals=!1),u!==mt.GrandTotalPosition.none&&u!==mt.GrandTotalPosition.row)||(v.rowGrandTotals=!1),bt(n.cCi)?v.dataCaption="Values":v.dataCaption=n.cCi,bt(n.options.errorValueInfo)||(v.errorCaption=n.options.errorValueInfo),bt(n.options.isShowErrorValue)||(v.showError=n.options.isShowErrorValue),bt(n.options.showToolTip)||(v.showDataTips=n.options.showToolTip),bt(n.options.showHeaders)||(v.showHeaders=n.options.showHeaders),bt(n.options.rowHeaderCaption)||(v.rowHeaderCaption=n.options.rowHeaderCaption),bt(n.options.colHeaderCaption)||(v.colHeaderCaption=n.options.colHeaderCaption),bt(n.options.enableDataValueEditing)||(v.enableDataValueEditing=n.options.enableDataValueEditing),bt(n.options.hideValuesRow)||(v.hideValuesRow=n.options.hideValuesRow),bt(n.views)||(v.views=n.views.toJson()),bt(n.zJt)||(v.altText=n.zJt),bt(n.ZJt)||(v.altTextSummary=n.ZJt),bt(v.createdVersion)&&(v.createdVersion=6),s=n.rZt&&n.rZt.HWt&&n.rZt.HWt&&n.rZt.HWt[4]&&n.rZt.HWt[4].DQ||0,u=n.rZt&&n.rZt.HWt&&n.rZt.HWt&&n.rZt.HWt[4]&&n.rZt.HWt[4].jN||0,l=n.gZt()&&n.gZt().length,a=n.mZt()&&n.mZt().length,c=n.bZt()&&n.bZt().length,o=n.pZt()&&n.pZt().length,r=n.mqt(),l&&(a||c||o)&&(a||r!==pt.DataPosition.col)||r===pt.DataPosition.row||1===o||a?v.firstHeaderRow=1:v.firstHeaderRow=0,v.firstDataRow=s,v.firstDataCol=u,l=n.dh.G&&n.dh.G.length,c=!bt(n.options.reportFilterFieldsPerColumn),n.options.displayFieldsInPageFilterArea===mt.DisplayFields.overThenDown?0===n.options.reportFilterFieldsPerColumn?(v.rowPageCount=1,v.colPageCount=l):(v.rowPageCount=c?Math.ceil(l/n.options.reportFilterFieldsPerColumn):1,v.colPageCount=c?Math.min(n.options.reportFilterFieldsPerColumn,l):l):0===n.options.reportFilterFieldsPerColumn?(v.rowPageCount=l,v.colPageCount=1):(v.rowPageCount=l&&Math.min(n.options.reportFilterFieldsPerColumn,l),v.colPageCount=l?Math.ceil(l/n.options.reportFilterFieldsPerColumn):1),v.ref=U&&U.rangesToFormula([e],0,0,15,!1),h.PVt(),n.lZt&&0<n.lZt.length){for(v.formats=[],p=0;p<n.lZt.length;p++)if(b=(m=n.lZt[p]).pivotArea,!ht(g=m.style)&&!m.isFakeStyle&&(w=n.sheetPivotAreaToExcelPivotArea(b),v.formats.push({style:g,pivotArea:w=w||{pivotArea:b,missed:!0}}),b.references)&&1===b.references.length&&m.style&&!bt(m.style.formatter))if(y=n.dh,b.references[0].fieldName===wt().Values){for(A=(C=y.Q).length,N={},I=0;I<A;I++)N[C[I].Zc]=I;if(!(T=b.references[0].items))for(T=[],S=0;S<A;S++)T.push(C[S].Zc);for(S=0;S<T.length;S++)bt(N[T[S]])||(C[N[T[S]]].bbt=m.style.formatter)}else!b.labelOnly||b.dataOnly||b.references[0].items&&0!==b.references[0].items.length||(y=y.DB(b.fieldName))&&(y.bbt=m.style.formatter);for(D in f=(t=t||{data:n.Ti.Ut.sheetModels[3].toJSON(3,i)}).data.dataTable,x=n.UJt,M=n.WJt,x)if(x.hasOwnProperty(D))for(j in k=x[D])k.hasOwnProperty(j)&&(bt(f[D])&&(f[D]={}),bt(f[D][j])&&(f[D][j]={}),g=z(n.QJt[k[j]]),(O=M[D]&&M[D][j])&&g.h5(O),f[D][j].style&&g.h5(f[D][j].style),f[D][j].style=g)}if(n.mJ.qK&&0<n.mJ.qK.length)for(v.pivotTableConditionFormats=[],p=0;p<n.mJ.qK.length;p++){for(F=(_=n.mJ.qK[p]).pivotAreas,P=[],S=0;S<F.length;S++)w=(w=n.sheetPivotAreaToExcelPivotArea(F[S]))||{pivotArea:F[S],missed:!0},P.push(w);_=ft(_.conditionalRule,_.conditionalRule.toJSON(n.Ti)),v.pivotTableConditionFormats.push(E={rule:_,pivotAreas:P})}return h.toJson(n,v),v.rowItems=n.Bqt(!0),v.columnItems=n.Bqt(!1),n.options.subtotalsPosition===mt.SubtotalsPosition.none?(v.enabledSubtotalsDefault=!1,v.subtotalsOnTopDefault=!1):n.options.subtotalsPosition===mt.SubtotalsPosition.bottom?(v.subtotalsOnTopDefault=!1,delete v.enabledSubtotalsDefault):n.options.subtotalsPosition===mt.SubtotalsPosition.top&&(delete v.subtotalsOnTopDefault,delete v.enabledSubtotalsDefault),v.insertBlankRowDefault=!!n.options.insertBlankLineAfterEachItem,v}t=t||{data:n.Ti.Ut.sheetModels[3].toJSON(3,i)},o=(r=n.rZt.HWt)[0],a=r[1],s=r[2],u=r[3],c=r[4],l=n.LYt,f=t.data.dataTable,R(l.row+o.DQ,l.col+o.jN,f,o.dataTable,B),R(e.row+a.DQ,e.col+a.jN,f,a.dataTable,B),R(e.row+s.DQ,e.col+s.jN,f,s.dataTable,B),R(e.row+u.DQ,e.col+u.jN,f,u.dataTable,B),R(e.row+c.DQ,e.col+c.jN,f,c.dataTable,B)},u.prototype.wh=function(t,i,n){var e,r,o,a,s,s,n,s,u,n,i,c,L,n,c,n,l,c,i,n,f,h,n,v,d,h,p,d,p,v,m,b,g,w,y,C,A,C,N,I,T,S,x,M,w,D,k,p,j,E,O,B,_,R,F,G,P,V,d,r,c,i,n,e=this,r=e.getRange().content;switch(bt(t)&&(t={n_:"sheetData"}),a=(o=e.dh).sc||{n_:"pivotTableDefinition"},s=e.layoutType(),a.xmlns=gt,a["xmlns:mc"]=gt,a["mc:Ignorable"]=gt,a["xmlns:xr"]=gt,a.r_=[13,14,15,16],s){case mt.PivotTableLayoutType.outline:a.compact="0",a.compactData="0",a.outline="1",a.outlineData="1";break;case mt.PivotTableLayoutType.tabular:a.compact="0",a.compactData="0",a.outline="0",a.outlineData="0";break;default:a.outline="1",a.outlineData="1"}if(bt(e.Zc)||(n&&n.newWorkSheetName&&e.Ti&&e.Ti.parent?(s=e.Ti.parent,e.Eqt=(0,dt.fJt)(e.Zc,s),a.name=Z(e.Eqt)):a.name=Z(e.Zc)),!1===e.options.allowMultipleFiltersPerField&&(a.multipleFieldFilters=W(e.options.allowMultipleFiltersPerField)),(n=o.getSigmaValuePosition()).display&&n.positionType===pt.DataPosition.row&&(a.dataOnRows="1"),s=a.c_=[],u=i.styleManager,(n=e.theme())?(i={n_:"pivotTableStyleInfo"},c=n.name(),bt(c)||((L=Q.PivotTableThemes[c.toLowerCase()])?(c=c.replace(/^[a-z]{1}/g,function(t){return t.toUpperCase()}),i.name="PivotStyle"+c):(i.name=c,(n=n.wh(u))&&0<n.length&&(c={n_:"tableStyle",name:c,table:0,count:n.length,c_:n},u.addTableStyle(c)))),e.options.showRowHeader&&(i.showRowHeaders="1"),e.options.showColumnHeader&&(i.showColHeaders="1"),i.showRowStripes=W(e.options.bandRows,1),i.showColStripes=W(e.options.bandColumns,1),s.push(i)):s.push({n_:"pivotTableStyleInfo",showRowStripes:"1",showColStripes:"1"}),e.options.displayFieldsInPageFilterArea===mt.DisplayFields.overThenDown&&(a.pageOverThenDown="1"),0<e.options.reportFilterFieldsPerColumn&&(a.pageWrap=""+e.options.reportFilterFieldsPerColumn),!1===e.options.showMissing&&(a.showMissing="0"),bt(e.options.missingCaption)||(a.missingCaption=e.options.missingCaption),!bt(e.options.rowLabelIndent)&&2!==e.options.rowLabelIndent&&0<=e.options.rowLabelIndent-1&&(a.indent=""+(e.options.rowLabelIndent-1)),e.options.printDrill&&(a.printDrill="1"),e.options.itemPrintTitles&&(a.itemPrintTitles="1"),e.options.fieldPrintTitles&&(a.fieldPrintTitles="1"),e.options.mergeItem&&(a.mergeItem="1"),bt(e.options.grandTotalPosition)||((n=e.options.grandTotalPosition)!==mt.GrandTotalPosition.none&&n!==mt.GrandTotalPosition.col||(a.colGrandTotals="0"),n!==mt.GrandTotalPosition.none&&n!==mt.GrandTotalPosition.row)||(a.rowGrandTotals="0"),bt(e.cCi)?a.dataCaption="Values":a.dataCaption=e.cCi,bt(e.options.errorValueInfo)||(a.errorCaption=e.options.errorValueInfo),e.options.isShowErrorValue&&(a.showError="1"),!1===e.options.showHeaders&&(a.showHeaders="0"),bt(e.options.colHeaderCaption)||(a.colHeaderCaption=e.options.colHeaderCaption),bt(e.options.rowHeaderCaption)||(a.rowHeaderCaption=e.options.rowHeaderCaption),bt(a.createdVersion)&&(a.createdVersion="7"),bt(a.updatedVersion)&&(a.updatedVersion="7"),!1===e.options.showToolTip&&(a.showDataTips="0"),!1===e.options.showFilter&&(a.showHeaders="0"),!1===e.options.showDrill&&(a.showDrill="0"),l=a.lossless={},bt(e.options.fillDownLabels)||(a.lossless.fillDownLabels=e.options.fillDownLabels),bt(e.options.enableDataValueEditing)||(a.lossless.enableDataValueEditing=e.options.enableDataValueEditing),bt(e.views)||(a.lossless.views=e.views.toJson()),c=e.rZt&&e.rZt.HWt&&e.rZt.HWt&&e.rZt.HWt[4]&&e.rZt.HWt[4].DQ||0,i=e.rZt&&e.rZt.HWt&&e.rZt.HWt&&e.rZt.HWt[4]&&e.rZt.HWt[4].jN||0,n=e.gZt()&&e.gZt().length,v=e.mZt()&&e.mZt().length,d=e.bZt()&&e.bZt().length,h=e.pZt()&&e.pZt().length,p=e.mqt(),n=n&&(v||d||h)&&(v||p!==pt.DataPosition.col)||p===pt.DataPosition.row||1===h||v?1:0,d=e.dh.G&&e.dh.G.length,p=!bt(e.options.reportFilterFieldsPerColumn),h=e.options.displayFieldsInPageFilterArea===mt.DisplayFields.overThenDown?0===e.options.reportFilterFieldsPerColumn?(f=1,d):(f=p?Math.ceil(d/e.options.reportFilterFieldsPerColumn):1,p?Math.min(e.options.reportFilterFieldsPerColumn,d):d):0===e.options.reportFilterFieldsPerColumn?(f=d,1):(f=d&&Math.min(e.options.reportFilterFieldsPerColumn,d),d?Math.ceil(d/e.options.reportFilterFieldsPerColumn):1),v={n_:"location",ref:U.rangesToFormula([r],0,0,15,!1)},0<=c&&(v.firstDataRow=""+c),0<=i&&(v.firstDataCol=""+i),0<=n&&(v.firstHeaderRow=""+n),0<f&&(v.rowPageCount=""+f),0<h&&(v.colPageCount=""+h),s.push(v),o.PVt(),e.lZt&&0<e.lZt.length){for(m=[],b=0;b<e.lZt.length;b++)if(w=(g=e.lZt[b]).pivotArea,!ht(y=g.style)&&!g.isFakeStyle&&((C=u.getDxfIndex(y,!0))!==gt&&((A=e.sheetPivotAreaToSJSPivotArea(w,!0))?m.push({n_:"format",dxfId:C,c_:[A]}):(l.pivotStyles||(l.pivotStyles={}),l.pivotStyles[b]=g)),w.references)&&1===w.references.length&&g.style&&!bt(g.style.formatter))if(C=e.dh,w.references[0].fieldName===wt().Values){for(I=(N=C.Q).length,T={},S=0;S<I;S++)T[N[S].Zc]=S;if(!(x=w.references[0].items))for(x=[],M=0;M<I;M++)x.push(N[M].Zc);for(M=0;M<x.length;M++)bt(T[x[M]])||(N[T[x[M]]].bbt=g.style.formatter)}else!w.labelOnly||w.dataOnly||w.references[0].items&&0!==w.references[0].items.length||(w=C.DB(w.fieldName))&&(w.bbt=g.style.formatter);for(j in D=e.UJt,k=e.WJt,m.length&&((p={n_:"formats",c_:m}).count=""+m.length,s.push(p)),D)if(D.hasOwnProperty(j))for(O in E=D[j])E.hasOwnProperty(O)&&(bt(t[j])&&(t[j]={}),bt(t[j][O])&&(t[j][O]={}),y=z(e.QJt[E[O]]),(B=k[j]&&k[j][O])&&y.h5(B),t[j][O].style&&y.h5(t[j][O].style),t[j][O].s=u.getStyleIndex(y))}if(o.wh(e,a),e.mJ.qK&&0<e.mJ.qK.length){for(R=!(_=[]),b=0;b<e.mJ.qK.length;b++){for(G=(F=e.mJ.qK[b]).pivotAreas,P=[],M=0;M<G.length;M++)(A=e.sheetPivotAreaToSJSPivotArea(G[M],!1))?P.push(A):R=!0;P.length<=0||(ft(F.conditionalRule,V={n_:"conditionalFormat",c_:[{n_:"pivotAreas",count:""+P.length,c_:P}]}),_.push(V))}if(s.push({n_:"conditionalFormats",count:""+_.length,c_:_}),!0===R)for(l.conditionalFormats||(l.conditionalFormats=[]),b=0;b<e.mJ.qK.length;b++)F=e.mJ.qK[b],l.conditionalFormats[b]={pivotAreas:F.pivotAreas,rule:F.conditionalRule.toJSON(e.Ti)}}return(d=e.mc(!0))&&0<d.length&&s.push({n_:"rowItems",c_:d,count:d.length}),(r=e.mc(!1))&&0<r.length&&s.push({n_:"colItems",c_:r,count:r.length}),delete(c={n_:"pivotTableDefinition",r_:[2]}).c_,e.zJt&&(c.altText=e.zJt),e.ZJt&&(c.altTextSummary=e.ZJt),e.options.hideValuesRow&&(c.hideValuesRow="1"),i={n_:"pivotTableDefinition16"},e.options.subtotalsPosition===mt.SubtotalsPosition.none?(i.EnabledSubtotalsDefault="0",i.SubtotalsOnTopDefault="0"):e.options.subtotalsPosition===mt.SubtotalsPosition.bottom?i.SubtotalsOnTopDefault="0":e.options.subtotalsPosition===mt.SubtotalsPosition.top&&delete i.SubtotalsOnTopDefault,e.options.insertBlankLineAfterEachItem&&(i.InsertBlankRowDefault="1"),n=[],(e.zJt||e.ZJt||e.options.hideValuesRow)&&n.push({n_:"ext",r_:[49,1],c_:[c]}),n.push({n_:"ext",r_:[51,52],c_:[i]}),a.c_.push({n_:"extLst",c_:n}),Y(a,["location","pivotFields","rowFields","rowItems","colFields","colItems","pageFields","dataFields","formats","conditionalFormats","pivotTableStyleInfo","filters","extLst"]),a},u.prototype.sheetPivotAreaToExcelPivotArea=function(t){var i,n,e,r,r,o,a,s,u,c,l,f,h,v,d,p,m,b,g,w,i=this,n={},e=i.dh;if(n.type=st(t.type),n.offset=kt(t.offset),r=e.DB(t.fieldName))for(n.field=r.lp,o=[],0===(r=i.dh.Z[t.fieldName])?(n.axis="axisPage",o=i.dh.G):1===r?(n.axis="axisRow",o=i.dh.B):2===r&&(n.axis="axisCol",o=i.dh.R),a=_t(e,r),s=0;s<o.length;s++)o[s]&&o[s].Zc===t.fieldName&&(n.fieldPosition=a<=s?s+1:s);else t.fieldName===wt().Values&&1<e.Q.length&&(n.field="-2",e.x2===pt.DataPosition.col?n.axis="axisCol":e.x2===pt.DataPosition.row&&(n.axis="axisRow"),n.fieldPosition=e.P2);if(n.dataOnly=t.dataOnly,n.labelOnly=t.labelOnly,!0===t.labelOnly&&n.dataOnly===gt&&(n.dataOnly=!1),!0===t.labelOnly&&!0===n.dataOnly&&(n.dataOnly=!1,n.labelOnly=!1),!1===t.outline&&(n.outline=t.outline),n.grandRow=t.grandRow,n.grandCol=t.grandCol,bt(t.axis)||(n.axis=t.axis===mt.PivotAreaAxisType.row?"axisRow":"axisCol"),t.references&&0<t.references.length){for(u=[],c=0;c<t.references.length;c++){if(l={},h=void 0,(f=t.references[c]).fieldName===wt().Values){for(l.field=C,d=(v=e.Q).length,p={},m=0;m<d;m++)p[v[m].Zc]=m;if(f.items&&0<f.items.length){for(b=[],m=0;m<f.items.length;m++){if(p[f.items[m]]===gt)return;b.push(p[f.items[m]])}l.indexes=b}}else{if(h=e.DB(f.fieldName),bt(h))continue;if(g=h.tl(e),l.field=h.lp,f.items&&0<f.items.length){for(b=[],m=0;m<f.items.length;m++)w=h.cs(f.items[m],g),bt(w)||b.push(w);l.indexes=b}}l.defaultSubtotal=f.subtotal,u.push(l)}0<u.length&&(n.references=u)}return n},u.prototype.sheetPivotAreaToSJSPivotArea=function(t,i){var n,e,r,o,o,o,a,s,u,i,o,c,l,f,h,v,d,p,m,b,g,w,n,e={n_:"pivotArea"},r=this.dh,o=st(t.type);if(o&&"normal"!==o&&(e.type=o),e.offset=kt(t.offset),o=r.DB(t.fieldName))for(-1!==o.lp&&(e.field=""+o.lp),o=r.Z[t.fieldName],a=[],i&&(0===o?(e.axis="axisPage",a=r.G):1===o?(e.axis="axisRow",a=r.B):2===o&&(e.axis="axisCol",a=r.R)),s=_t(r,o),u=0;u<a.length;u++)a[u]&&a[u].Zc===t.fieldName&&(e.fieldPosition=""+(s<=u?u+1:u));else t.fieldName===wt().Values&&1<r.Q.length&&(e.field="-2",r.x2===pt.DataPosition.col?e.axis="axisCol":r.x2===pt.DataPosition.row&&(e.axis="axisRow"),e.fieldPosition=""+r.P2);if(i=t.dataOnly,!0===(o=t.labelOnly)&&i===gt&&(i=!1),!0===o&&!0===i&&(o=i=!1),e.dataOnly=W(i,gt),!1===t.outline&&(e.outline="0"),!0===o&&(e.labelOnly="1"),!0===t.grandRow&&(e.grandRow="1"),!0===t.grandCol&&(e.grandCol="1"),bt(t.axis)||(e.axis=t.axis===mt.PivotAreaAxisType.row?"axisRow":"axisCol"),t.references&&0<t.references.length){for(c=[],l=0;l<t.references.length;l++){if(f={n_:"reference"},v=void 0,(h=t.references[l]).fieldName===wt().Values){for(f.field=C,p=(d=r.Q).length,m={},b=0;b<p;b++)m[d[b].Zc]=b;if(h.items&&0<h.items.length)for(f.count=""+h.items.length,f.c_=[],b=0;b<h.items.length;b++){if(m[h.items[b]]===gt)return;f.c_.push({n_:"x",v:m[h.items[b]]})}}else{if(v=r.DB(h.fieldName),bt(v))continue;if(g=v.tl(r),f.field=v.lp,h.items&&0<h.items.length){for(f.c_=[],b=0;b<h.items.length;b++)w=v.cs(h.items[b],g),bt(w)||f.c_.push({n_:"x",v:w+""});f.count=""+f.c_.length}else f.count="0"}!0===h.subtotal&&(f.defaultSubtotal="1"),c.push(f)}0<c.length&&(e.c_=[{n_:"references",count:c.length+"",c_:c}])}return e},u.prototype.Bqt=function(t){var i,n,e,r,o,a,s,u,c,l,f,h,v,d,p,m,i=this;if(i.Oy())return[];if(n=i.rZt.HWt,e=t?n[3].zWt:n[2].WWt,r=[],o=[],a=i.dh,s=i.layoutType()===mt.PivotTableLayoutType.tabular,u=i.options.subtotalsPosition===mt.SubtotalsPosition.top,t&&0===a.B.length||!t&&0===a.R.length)for(c=0;c<e.length;c++)(l={pivotItemIndexes:[]}).pivotItemIndexes.push(c),r.push(l);else for(f={},h=i.dh.getLabelSortMap(),c=0;c<e.length;c++)if(l={},v=e[c],!bt(v)){for(d=v.path.split(pt.Separator),l.pivotItemIndexes=[],p=0;p<d.length;p++)m=f[p]||i.lCi(p,t,h),f[p]=f[p]||m,d[p]===o[p]?l.repeatCount=l.repeatCount?l.repeatCount+1:1:l.pivotItemIndexes.push(m?m[d[p]]:+d[p]);o=d,0===v.grandTotalLevel?l.type="grand":t&&v.isBlankRow?(l.type="blank",delete l.repeatCount):!v.isSubtotal||0===v.collapseIndex||u&&!s||(l.type="default",delete l.repeatCount,0===l.pivotItemIndexes.length&&l.pivotItemIndexes.push(0)),v.valueFieldName&&(l.dataFieldIndex=a.RVt(v.valueFieldName)),r.push(l)}return r},u.prototype.mc=function(t){var i,n,e,r,o,a,s,u,c,l,f,h,v,d,p,m,b,g,w,y,y,C,C,i=this;if(!i.Oy()){if(n=i.rZt.HWt,e=t?n[3].zWt:n[2].WWt,r=[],o=i.dh,a=i.layoutType()===mt.PivotTableLayoutType.tabular,s=i.options.subtotalsPosition===mt.SubtotalsPosition.top,u=[],t&&0===o.B.length||!t&&0===o.R.length)for(c=0;c<e.length;c++)l={n_:"x"},0!==c&&(l.v=c),u.push({n_:"i",c_:[l]});else for(f={},h=i.dh.getLabelSortMap(),v=0,d=e;v<d.length;v++)if(p=d[v],m={n_:"i"},!bt(p)){for(b=p.path.split(pt.Separator),m.c_=[],g=void 0,w=0;w<b.length;w++)y=f[w]||i.lCi(w,t,h),f[w]=f[w]||y,b[w]===r[w]?g=g?g+1:1:0<=+b[w]&&(y=y?y[b[w]]:b[w],!bt(y)&&0<y?m.c_.push({n_:"x",v:y}):m.c_.push({n_:"x"}));r=b,m.r=0<g?g:gt,0===p.grandTotalLevel?m.t="grand":t&&p.isBlankRow?(m.t="blank",delete m.r):!p.isSubtotal||0===p.collapseIndex||s&&!a||(m.t="default",C=f[b.length-1],delete m.r,0===m.c_.length&&m.c_.push({n_:"x",v:C&&C[b[b.length-1]]})),p.valueFieldName&&0<(C=o.RVt(p.valueFieldName))&&(m.i=""+C),u.push(m)}return u}},u.prototype.lCi=function(t,i,n){var e,r,i,t,o,e,r=this.dh,i=(i?r.B:r.R)[t].a,t=null==n?void 0:n.customSortMap[i];return t=t||(o=r.bl(i)).DAe()},u.prototype.Rqt=function(){var n,t,n={},t=this.dh.bit();return(0,pt.o)(t,function(t,i){var t=t.Zc;n[t]=i}),n},u.prototype.evaluateGetPivotDataFunction=function(t,i){for(var n,e,r,o,a,s,u,c,l,f,h,f,v,d,p,m,b,g,w,u,y,C,A,N,I,T,S,T,x,x,M,D,M,D,k,n=this,e=[],r=n.IZt,o=n.Rqt(),a=n.dh,s=a.getSigmaValuePosition().positionType,u=a.B.length,c=a.Q.length,l=0;l<i.length;l++){if(h=(f=i[l]).fieldName,f=f.itemName,v=o[h],bt(v))return j.Errors.Reference;if(d=void 0,!r[h])return j.Errors.Reference;if(p=a.FC(h),f instanceof Date&&(f=(0,dt.formatDateToString)(f)),(d=2===p.W5&&p.cC()&&"number"==typeof f?(m=p.Rs)===pt.DateGroupType.years?p.AQt&&p.AQt[f]:f:r[h].indexOf(f))<0)return j.Errors.Reference;e[v]=d}for(l=(b=e.slice(0,u)).length-1;0<=l&&b[l]===gt;l--)b.pop();for(g=b.join(pt.Separator),l=(w=e.slice(u)).length-1;0<=l&&w[l]===gt;l--)w.pop();for(u=w.join(pt.Separator),y={},C={},A=n.rZt.HWt[3].zWt,N=n.rZt.HWt[2].WWt,I=n.rZt.HWt[4].dataTable,l=0;l<A.length;l++)S=(T=A[l]).path,T=T.valueFieldName,0===s&&1<c?(bt(y[S])&&(y[S]={}),y[S][T]=l):y[S]=l;for(l=0;l<N.length;l++)S=(x=N[l]).path,x=x.valueFieldName,1===s&&1<c?(bt(C[S])&&(C[S]={}),C[S][x]=l):C[S]=l;if(0<a.Q.length&&(M=a.v_(t),D=a.getFieldInfoByName(t),t=M&&M.Zc||D&&D.Zc),bt(t))return j.Errors.Reference;if(M=y[g]instanceof Object?y[g][t]:y[g],D=C[u]instanceof Object?C[u][t]:C[u],bt(M)||bt(D))return j.Errors.Reference;try{k=I[M][D],n.options.showMissing&&bt(k)&&(k={value:n.options.missingCaption})}catch(t){return j.Errors.Reference}return k&&void 0!==k.value?k&&k.value:null},u.prototype.uqt=function(){var t,i,n,e,r,o,a,s,t=this;if(!(0<t.Xst)){for(i=t.lZt.concat([]),t.UJt={},t.WJt=[],t.lZt=[],t.QJt={},n={},e=[],r=i.length-1;0<=r;r--)(o=i[r])&&o.pivotArea&&(a=tt(o.pivotArea),o.style||(n[a]=!0),n[a]||e.push(o));for(r=e.length-1;0<=r;r--)t.yqt((o=e[r]).pivotArea,o.style,gt,o.isFakeStyle);for(r=0;r<t.lZt.length;r++)o=t.lZt[r],s=t.getPivotAreaRanges(o.pivotArea),t.Cqt(s,r,o.style)}},u.prototype.getAllFields=function(t){return this.dh.getAllFieldNameListWithoutCalcField(t)},u.prototype.Gqt=function(){var e,t,e=this,t=e.getFieldsByArea();(0,pt.o)(t,function(t){var t,i,n,i,t=t.sourceName;e.dh.isFilter(t)&&(n=(i=e.dh.getFilterInfo(t)).labelFilter,i=i.valueFilter,[null==n?void 0:n.condition,null==n?void 0:n.textItem,i].some(Boolean))&&e.dh.clearFilterInfo(t,0)})},u.prototype.dispose=function(){f.prototype.dispose.call(this);var t=this;t.Ti=y,t.rZt=y,t.lZt=y,t.WJt=y,t.UJt=y,t.QJt=y,t.options=y,t.eZt=y,t.LYt=y,t.HSt=y,t.zSt=y,t.IZt=y,t.EZt=y,t.VJt=y,t.BJt=y,t.bqt=y,bt(t.mJ)||(t.mJ.L0(),t.mJ=y),bt(t.views)||(t.views.L0(),t.views=y)},M.PivotTable=u},"./dist/plugins/pivot/pivot-ui/dropdown-list.js":function(L,t,i){"use strict";var n,e,r,h,u,i,c,o,E,B,a,R,l,s,f,v,d,G,V,U,Q,W,z,p,m,b,g,w,y,C,A,Z,N,I,Y,H,J,q,K,X,$,tt,it,nt,et,r,rt,ot,at,st,ut,ct,lt,ft,e,ht,vt,T,dt,pt,mt,bt,gt,wt,yt;function S(t,i,n,e,r,o,a){var t=T.call(this,t,0)||this;return t.dh=i,t.Vqt=n,t.rYt=e,t.Uqt=r,t.RPt=o,t.Cut=a,t}function x(t,i,n,e,r,o,a){var t=dt.call(this,t,i,n,e,r,o)||this;return t.Qqt=a,t.Wqt="244px",t}function M(t,i,n,e,r,o,a){var t=pt.call(this,t,i,n,e,r,o)||this;return t.Wqt="95px",t.Qqt=a,t}function D(t,i,n,e,r,o,a){var t=mt.call(this,t,i,n,e,r,o)||this;return t.Cut=a,t}function k(t,i,n,e,r,o,a){return bt.call(this,t,i,n,e,r,o,a)||this}function j(t,i,n,e,r,o,a){var t=gt.call(this,t,i,n,e,r,o)||this;return t.Cut=a,t}function O(t,i,n,e,r,o,a){var t=wt.call(this,t,i,n,e,r,o)||this;return t.Cut=a,t}function _(t,i,n,e,r,o,a){var t=yt.call(this,t,i,n,e,r,o)||this;return t.Cut=a,t}function F(t){for(var i,n,i="",n=0;n<t.child.length;n++)i+=Ct(t.child[n]);return'<div class="'.concat(t.className,'" height="21px">\n            ').concat(i,'\n            <span class="').concat(t.ListSpan,'"></span>\n            </div>')}function Ct(t){return'<div class="'.concat(t.class,'" command="').concat(t.command,'">\n                <div class="').concat(t.iconClass,'"></div>\n                <div class="').concat(t.linkClass,'">').concat(t.text,"</div>\n            </div>")}function P(t,i){var n,e,r,n=0;switch(t){case 0:n=i.G.length;break;case 1:n=i.B.length;break;case 2:n=i.R.length;break;case 3:n=i.Q.length;break;default:return 0}return e=0,(r=i.getSigmaValuePosition()).display&&r.positionType===t-1&&e++,n+e}function At(t,i){var n,e,r,o,t,n=i.dh,e=i.rYt,r=i,o=i.Vqt,t=(0,h.GC$)(t).attr("command");"ClearFilter"===t?(n.wVt({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:e,pivotName:o,command:t,clearType:1}}),i.Cut.close(),i.close()):isNaN(+t)?(i.Cut.close(),i.close()):(i.Cut.close(),i.close(),n.wVt({cmd:"createDialogForLabelFilter",sheetName:"",cmdOption:{fieldName:e,pivotName:o,host:r,command:t}}))}n=this&&this.__extends||(ft=function(t,i){return(ft=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}ft(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.PivotNumberFilter=t.PivotDateSecondaryFilterDialog=t.PivotDateFilterDialog=t.PivotStringFilterDialog=t.PivotValuesDialog=t.PivotCacheFieldsDropdownDialog=t.PivotDropDown=void 0,e=i("@spreadjs/js-sheets-common"),r=i("./dist/plugins/pivot/pivot.ns.js"),h=i("Core"),u=i("Pivot"),i=new e.Common.ResourceManager(r.SR,"PivotTables"),c=i.getResource.bind(i),a=(o="gc-drop-down-list")+"-block",l=o+"-icon",s=o+"-link",f=(R=o+"-item")+" "+(B=o+"-item-noHover"),v=o+"-span",d=R+" "+(E=o+"-link-hover"),G="icon-Move-Report",V="icon-Move-Row",U="icon-Move-Col",Q="icon-Move-Value",W="icon-Move-Remove",z="icon-Move-Setting",p="icon-Be-Used",m="clear-filter-icon-default",b="clear-filter-icon",g="label-of-string",w="valueFilter",y="label-of-number",C="label-of-date",A="sub-label-of-date",Z="all-date",N=null,I=void 0,H=function(){return[{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_DropDownList_Up,command:"moveUp",class:d,iconClass:l,linkClass:s},{text:c().PivotPanel_DropDownList_Down,command:"moveDown",class:d,iconClass:l,linkClass:s},{text:c().PivotPanel_DropDownList_Beginning,command:"moveBeginning",class:d,iconClass:l,linkClass:s},{text:c().PivotPanel_DropDownList_End,command:"moveEnd",class:d,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_DropDownList_ReportFilter,command:"moveReportFilter",class:d,iconClass:l+" "+G,linkClass:s},{text:c().PivotPanel_DropDownList_Row,command:"moveRow",class:d,iconClass:l+" "+V,linkClass:s},{text:c().PivotPanel_DropDownList_Col,command:"moveCol",class:d,iconClass:l+" "+U,linkClass:s},{text:c().PivotPanel_DropDownList_Values,command:"moveValue",class:d,iconClass:l+" "+Q,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_DropDownList_Remove,command:"removeField",class:d,iconClass:l+" "+W,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_DropDownList_Set,command:"fieldSet",class:d,iconClass:l+" "+z,linkClass:s}]}]},J=function(){return[{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_Fields_MoveTo_ReportField,command:"AddToReportField",class:d,iconClass:l+" "+G,linkClass:s},{text:c().PivotPanel_Fields_MoveTo_RowLabel,command:"AddToRowLabel",class:d,iconClass:l+" "+V,linkClass:s},{text:c().PivotPanel_Fields_MoveTo_ColLabel,command:"AddToColLabel",class:d,iconClass:l+" "+U,linkClass:s},{text:c().PivotPanel_Fields_MoveTo_Value,command:"AddToValue",class:d,iconClass:l+" "+Q,linkClass:s}]}]},q=function(){return[{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:d+" "+g,iconClass:m+" "+l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_ValueFilterOrLabel_Equals,command:u.PivotCaptionFilterOperator.equalsTo,class:d+" "+g,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_NotEqual,command:u.PivotCaptionFilterOperator.notEqualsTo,class:d+" "+g,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_ValueFilterOrLabel_IsBeginWith,command:u.PivotCaptionFilterOperator.beginsWith,class:d+" "+g,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_NotBegin,command:u.PivotCaptionFilterOperator.doesNotBeginWith,class:d+" "+g,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_End,command:u.PivotCaptionFilterOperator.endsWith,class:d+" "+g,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_NotEndWith,command:u.PivotCaptionFilterOperator.doesNotEndWith,class:d+" "+g,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_ValueFilterOrLabel_Contain,command:u.PivotCaptionFilterOperator.contains,class:d+" "+g,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_NotContain,command:u.PivotCaptionFilterOperator.doesNotContain,class:d+" "+g,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_ValueFilterOrLabel_GreaterThan,command:u.PivotCaptionFilterOperator.greaterThan,class:d+" "+g,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_GreaterOrTo,command:u.PivotCaptionFilterOperator.greaterThanOrEqualsTo,class:d+" "+g,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_LessThan,command:u.PivotCaptionFilterOperator.lessThan,class:d+" "+g,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_LessOrTo,command:u.PivotCaptionFilterOperator.lessThanOrEqualsTo,class:d+" "+g,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_ValueFilterOrLabel_Between,command:u.PivotCaptionFilterOperator.between,class:d+" "+g,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_NotBetween,command:u.PivotCaptionFilterOperator.notBetween,class:d+" "+g,iconClass:l,linkClass:s}]}]},K=function(){return[{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:d+" "+C,iconClass:m+" "+l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_ValueFilterOrLabel_Equals,command:u.PivotDateFilterOperator.equalsTo,class:d+" "+C,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_ValueFilterOrLabel_Before,command:u.PivotDateFilterOperator.before,class:d+" "+C,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_After,command:u.PivotDateFilterOperator.after,class:d+" "+C,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_Between,command:u.PivotDateFilterOperator.Between,class:d+" "+C,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_ValueFilterOrLabel_Tomorrow,command:u.PivotDateFilterOperator.tomorrow,class:d+" "+C,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_Today,command:u.PivotDateFilterOperator.today,class:d+" "+C,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_Yesterday,command:u.PivotDateFilterOperator.yesterday,class:d+" "+C,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_ValueFilterOrLabel_NextWeek,command:u.PivotDateFilterOperator.nextWeek,class:d+" "+C,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_ThisWeek,command:u.PivotDateFilterOperator.thisWeek,class:d+" "+C,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_LastWeek,command:u.PivotDateFilterOperator.lastWeek,class:d+" "+C,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_ValueFilterOrLabel_NextMonth,command:u.PivotDateFilterOperator.nextMonth,class:d+" "+C,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_ThisMonth,command:u.PivotDateFilterOperator.thisMonth,class:d+" "+C,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_LastMonth,command:u.PivotDateFilterOperator.lastMonth,class:d+" "+C,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_ValueFilterOrLabel_NextQuarter,command:u.PivotDateFilterOperator.nextQuarter,class:d+" "+C,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_ThisQuarter,command:u.PivotDateFilterOperator.thisQuarter,class:d+" "+C,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_LastQuarter,command:u.PivotDateFilterOperator.lastQuarter,class:d+" "+C,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_ValueFilterOrLabel_NextYear,command:u.PivotDateFilterOperator.nextYear,class:d+" "+C,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_ThisYear,command:u.PivotDateFilterOperator.thisYear,class:d+" "+C,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_LastYear,command:u.PivotDateFilterOperator.lastYear,class:d+" "+C,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_ValueFilterOrLabel_YearToDate,command:u.PivotDateFilterOperator.yearToDate,class:d+" "+C,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_QuarterToDate,command:u.PivotDateFilterOperator.dateToDate+"-1",class:d+" "+C,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_MonthToDate,command:u.PivotDateFilterOperator.dateToDate+"-2",class:d+" "+C,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_ParallelYearToDate,command:u.PivotDateFilterOperator.dateToDate+"-3",class:d+" "+C,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_ParallelQuarterToDate,command:u.PivotDateFilterOperator.dateToDate+"-4",class:d+" "+C,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_ParallelMonthToDate,command:u.PivotDateFilterOperator.dateToDate+"-5",class:d+" "+C,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_ValueFilterOrLabel_AllDates,command:"all Dates",class:d+" "+Z,iconClass:l,linkClass:s}]}]},X=function(){return[{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:d+" "+y,iconClass:m+" "+l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_ValueFilterOrLabel_Equals,command:u.PivotCaptionFilterOperator.equalsTo,class:d+" "+y,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_NotEqual,command:u.PivotCaptionFilterOperator.notEqualsTo,class:d+" "+y,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_ValueFilterOrLabel_IsBeginWith,command:u.PivotCaptionFilterOperator.beginsWith,class:d+" "+y,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_NotBegin,command:u.PivotCaptionFilterOperator.doesNotBeginWith,class:d+" "+y,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_End,command:u.PivotCaptionFilterOperator.endsWith,class:d+" "+y,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_NotEndWith,command:u.PivotCaptionFilterOperator.doesNotEndWith,class:d+" "+y,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_ValueFilterOrLabel_Contain,command:u.PivotCaptionFilterOperator.contains,class:d+" "+y,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_NotContain,command:u.PivotCaptionFilterOperator.doesNotContain,class:d+" "+y,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_ValueFilterOrLabel_GreaterThan,command:u.PivotCaptionFilterOperator.greaterThan,class:d+" "+y,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_GreaterOrTo,command:u.PivotCaptionFilterOperator.greaterThanOrEqualsTo,class:d+" "+y,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_LessThan,command:u.PivotCaptionFilterOperator.lessThan,class:d+" "+y,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_LessOrTo,command:u.PivotCaptionFilterOperator.lessThanOrEqualsTo,class:d+" "+y,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_ValueFilterOrLabel_Between,command:u.PivotCaptionFilterOperator.between,class:d+" "+y,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_NotBetween,command:u.PivotCaptionFilterOperator.notBetween,class:d+" "+y,iconClass:l,linkClass:s}]}]},$=function(){return[{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_LabelOrValue_ClearFilter,command:"ClearFilter",class:d+" "+w,iconClass:m+" "+l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_ValueFilterOrLabel_Equals,command:u.PivotValueFilterOperator.equalsTo,class:d+" "+w,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_NotEqual,command:u.PivotValueFilterOperator.notEqualsTo,class:d+" "+w,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_ValueFilterOrLabel_GreaterThan,command:u.PivotValueFilterOperator.greaterThan,class:d+" "+w,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_GreaterOrTo,command:u.PivotValueFilterOperator.greaterThanOrEqualsTo,class:d+" "+w,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_LessThan,command:u.PivotValueFilterOperator.lessThan,class:d+" "+w,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_LessOrTo,command:u.PivotValueFilterOperator.lessThanOrEqualsTo,class:d+" "+w,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_ValueFilterOrLabel_Between,command:u.PivotValueFilterOperator.between,class:d+" "+w,iconClass:l,linkClass:s},{text:c().PivotPanel_ValueFilterOrLabel_NotBetween,command:u.PivotValueFilterOperator.notBetween,class:d+" "+w,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:c().PivotPanel_ValueFilter_Top10,command:"Top10",class:d+" "+w,iconClass:l,linkClass:s}]}]},tt=function(){return[{disAble:!1,className:a,ListSpan:v,child:[{text:c().Q1,command:u.PivotDateFilterOperator.Q1,class:d+" "+A,iconClass:l,linkClass:s},{text:c().Q2,command:u.PivotDateFilterOperator.Q2,class:d+" "+A,iconClass:l,linkClass:s},{text:c().Q3,command:u.PivotDateFilterOperator.Q3,class:d+" "+A,iconClass:l,linkClass:s},{text:c().Q4,command:u.PivotDateFilterOperator.Q4,class:d+" "+A,iconClass:l,linkClass:s}]},{disAble:!1,className:a,ListSpan:v,child:[{text:c().Jan,command:u.PivotDateFilterOperator.M1,class:d+" "+A,iconClass:l,linkClass:s},{text:c().Feb,command:u.PivotDateFilterOperator.M2,class:d+" "+A,iconClass:l,linkClass:s},{text:c().Mar,command:u.PivotDateFilterOperator.M3,class:d+" "+A,iconClass:l,linkClass:s},{text:c().Apr,command:u.PivotDateFilterOperator.M4,class:d+" "+A,iconClass:l,linkClass:s},{text:c().May,command:u.PivotDateFilterOperator.M5,class:d+" "+A,iconClass:l,linkClass:s},{text:c().Jun,command:u.PivotDateFilterOperator.M6,class:d+" "+A,iconClass:l,linkClass:s},{text:c().Jul,command:u.PivotDateFilterOperator.M7,class:d+" "+A,iconClass:l,linkClass:s},{text:c().Aug,command:u.PivotDateFilterOperator.M8,class:d+" "+A,iconClass:l,linkClass:s},{text:c().Sep,command:u.PivotDateFilterOperator.M9,class:d+" "+A,iconClass:l,linkClass:s},{text:c().Oct,command:u.PivotDateFilterOperator.M10,class:d+" "+A,iconClass:l,linkClass:s},{text:c().Nov,command:u.PivotDateFilterOperator.M11,class:d+" "+A,iconClass:l,linkClass:s},{text:c().Dec,command:u.PivotDateFilterOperator.M12,class:d+" "+A,iconClass:l,linkClass:s}]}]},(e=it=it||{})[e.teamLeader=1]="teamLeader",e[e.teamMiddle=2]="teamMiddle",e[e.teamTail=3]="teamTail",ht=nt={filters:0,0:"filters",rows:1,1:"rows",columns:2,2:"columns",values:3,3:"values"},vt=et={string:1,1:"string",number:2,2:"number",date:3,3:"date"},T=h.zc,n(S,T),S.prototype.rQ=function(t,i){var n,e,n=this;n.u_=t,n.LEt=i,(e=n.WX(t.x,t.y)).html(this.zqt(this.Zqt(i))),this.$c()},S.prototype.$c=function(){T.prototype.$c.call(this),this.Yqt(),this.aY(),this.Hqt()&&this.uf()},S.prototype.Hqt=function(){return!1},S.prototype.WX=function(t,i){var n=this.Xc();return n.css(["left","top","height"],[t,i,this.Wqt]),n.css("position","fixed"),n.addClass(o+" gc-no-user-select"),n},S.prototype.Yqt=function(){var t,i,n,e,r,o,a,s,u,i,c,l,c,n,o,f,t=this,i=t.Wc,n=(0,h.GC$)(t.Ti);n.hasClass("filter-condition")&&(e=t.Cut.qc().getBoundingClientRect(),r=(0,h.GC$)(t.Cut.Wc),o=n.position(),a=r.position(),s=r[0].getBoundingClientRect(),u=(0,h.GC$)(i).width(),i=(0,h.GC$)(i).height(),l=(c=document.documentElement).clientWidth,c=c.clientHeight,n=n.width(),o=o.top,e.left+n+a.left+u>=l?t.u_.x=-u+s.left:t.u_.x=n+s.left,e.top+o+a.top+i>=c?(t.u_.y=r.height()-i+s.top,Math.abs(r.height()-i)>a.top&&((f=t.Xc()).css(["height","overflow-y","overflow-x"],[r.height()+"px","scroll","hidden"]),t.u_.y=s.top)):t.u_.y=o+s.top,t.WX(t.u_.x,t.u_.y))},S.prototype.close=function(){this.KX(),this.eG(),T.prototype.close.call(this)},S.prototype.eG=function(){this.Vqt=I,this.rYt=I,this.Uqt=I,this.RPt=I,this.Cut=N,this.Ti=N,this.dh=N},n(x,dt=r=S),x.prototype.zqt=function(t){for(var i,n,i="",n=0;n<t.length;n++)i+=F(t[n]);return i},x.prototype.Zqt=function(t){return this.rT=h.GC$.extend(!0,[],H()),this.initSeatData(t,this.rT[0].child),this.initAreaData(t,this.rT[1].child),this.initSettingData(t,this.rT[3].child),this.rT},x.prototype.aY=function(){var i=this;(0,h.GC$)("."+R).bind("click",function(t){(0,h.GC$)(this).hasClass(B)||(i.uf(),i.sendCommand(this),i.close())})},x.prototype.KX=function(){(0,h.GC$)("."+R).unbind("click")},x.prototype.sendCommand=function(t){var i,n,e,r,o,i=this,n=i.Uqt,e=i.RPt,r=i.dh,o=(0,h.GC$)(t).attr("command");switch(o){case"moveUp":o="moveField",e--;break;case"moveDown":o="moveField",e++;break;case"moveBeginning":o="moveField",e=0;break;case"moveEnd":o="moveField",e=P(n,r)+1;break;case"moveReportFilter":o="moveField",e=P(n=0,r);break;case"moveRow":o="moveField",e=P(n=1,r);break;case"moveCol":o="moveField",e=P(n=2,r);break;case"moveValue":o="moveField",e=P(n=3,r)}i.dh.wVt({cmd:o,sheetName:"",cmdOption:{fieldName:i.rYt,targetArea:n,targetIndex:e,pivotName:i.Vqt,isSusPaint:i.Qqt}})},x.prototype.initSeatData=function(t,i){if(t.isAlone)for(var n=0;n<i.length;n++)i[n].class=f;else t.location!==it.teamMiddle&&(t.location===it.teamLeader?(i[0].class=f,i[2].class=f):(i[1].class=f,i[3].class=f))},x.prototype.initAreaData=function(t,i){switch(t.area){case 0:i[0].class=f;break;case 1:i[1].class=f;break;case 2:i[2].class=f;break;case 3:i[3].class=f}t.isSigma&&(i[0].class=f,i[3].class=f)},x.prototype.initSettingData=function(t,i){3===t.area&&(i[0].text=c().PivotPanel_DropDownList_ValueSet,i[0].command="openValueFieldSettingDialogCmd",i[0].class=d),t.isSigma&&(i[0].class=f)},t.PivotDropDown=x,n(M,pt=r),M.prototype.zqt=function(t){return F(t[0])},M.prototype.Zqt=function(){return this.rT=h.GC$.extend(!0,[],J()),this.rT},M.prototype.aY=function(){var i=this;(0,h.GC$)("."+E).bind("click",function(t){i.sendCommand(this),i.close()})},M.prototype.KX=function(){(0,h.GC$)("."+E).unbind("click")},M.prototype.sendCommand=function(t){var i,n,e,i=this,n=i.Uqt||-1,e;switch((0,h.GC$)(t).attr("command")){case"AddToReportField":n=0;break;case"AddToRowLabel":n=1;break;case"AddToColLabel":n=2;break;case"AddToValue":n=3}i.dh.wVt({cmd:"AddField",sheetName:"",cmdOption:{fieldName:i.rYt,targetArea:n,pivotName:i.Vqt,isSusPaint:i.Qqt}})},t.PivotCacheFieldsDropdownDialog=M,n(D,mt=r),D.prototype.zqt=function(t){for(var i,n,i="",n=0;n<t.length;n++)i+=F(t[n]);return i},D.prototype.Hqt=function(){return!0},D.prototype.Zqt=function(t){var i,n,e;for(this.rT=h.GC$.extend(!0,[],$()),t.existed&&0!==t.existed.length?this.rT[0].child[0].iconClass=b+" "+l:this.rT[0].child[0].class=f,n=i=0;n<t.existed.length;n++)for(i=t.existed[n],e=1;e<this.rT.length;e++){if(!(i>=this.rT[e].child.length)){this.rT[e].child[i].iconClass+=" "+p;break}i-=this.rT[e].child.length}return this.rT},D.prototype.aY=function(){var s=this;(0,h.GC$)(s.Ti).bind("mouseleave",function(t){s.close()}),(0,h.GC$)("."+w).bind("click",function(t){var i,n,e,r,o,a,i=s.dh,n=s.rYt,e=this,r=s.Vqt,o=(0,h.GC$)(this).attr("command");"ClearFilter"===o?(i.wVt({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:n,pivotName:r,command:o,clearType:2}}),s.Cut.close(),s.close()):isNaN(+o)&&"Top10"!==o?(s.Cut.close(),s.close()):(a=c().getValueFilterItemText(),s.Cut.close(),s.close(),i.wVt({cmd:"createDialogForValueFilter",sheetName:"",cmdOption:{fieldName:n,pivotName:r,host:e,content:a,command:o}}))})},D.prototype.KX=function(){(0,h.GC$)(this.Ti).unbind("mouseleave"),(0,h.GC$)("."+w).unbind("click")},D.prototype.sendCommand=function(){},t.PivotValuesDialog=D,n(k,bt=r),k.prototype.zqt=function(t){for(var i,n,i="",n=0;n<t.length;n++)i+=F(t[n]);return i},k.prototype.Hqt=function(){return!0},k.prototype.Zqt=function(t){var i,n,e;for(this.rT=h.GC$.extend(!0,[],q()),t.existed&&0!==t.existed.length?this.rT[0].child[0].iconClass=b+" "+l:this.rT[0].child[0].class=f,n=i=0;n<t.existed.length;n++)for(i=t.existed[n],e=1;e<this.rT.length;e++){if(!(i>=this.rT[e].child.length)){this.rT[e].child[i].iconClass+=" "+p;break}i-=this.rT[e].child.length}return this.rT},k.prototype.aY=function(){var i=this;(0,h.GC$)("."+g).bind("click",function(t){At(this,i)}),(0,h.GC$)(i.Ti).bind("mouseleave",function(t){i.close()})},k.prototype.KX=function(){(0,h.GC$)(this.Ti).unbind("mouseleave"),(0,h.GC$)("."+g).unbind("click")},k.prototype.sendCommand=function(){},t.PivotStringFilterDialog=k,n(j,gt=r),j.prototype.zqt=function(t){for(var i,n,i="",n=0;n<t.length;n++)i+=F(t[n]);return i},j.prototype.Hqt=function(){return!0},j.prototype.Zqt=function(t){var i,n,e,r,o,a,s;for(this.rT=h.GC$.extend(!0,[],K()),i=t.existed,n=this.rT,i&&0!==i.length?this.rT[0].child[0].iconClass=b+" "+l:n[0].child[0].class=f,o=1;o<n.length;o++)for(r=n[o].child,a=0;a<r.length;a++)for(e=+r[a].command,s=0;s<i.length;s++)if(i[s]>u.PivotDateFilterOperator.Q1&&i[s]<=u.PivotDateFilterOperator.M12&&(n[9].child[0].iconClass=l+" "+p),i[s]===e){n[o].child[a].iconClass+=" "+p,i.splice(s,1);break}return this.rT},j.prototype.aY=function(){var u=this;(0,h.GC$)(u.Ti).bind("mouseleave",function(t){u.close()}),(0,h.GC$)("."+C).bind("click",function(t){var i,n,e,r,o,a,i=c().getDateLabelFilterItemText(),n=u.dh,e=u.rYt,r=document.body,o=u.Vqt,a=(0,h.GC$)(this).attr("command");"ClearFilter"===a?(n.wVt({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:e,pivotName:o,clearType:1}}),u.Cut.close(),u.close()):(u.Cut.close(),u.close(),n.wVt({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:e,pivotName:o,host:r,command:a,dateLabel:i,isWholeDay:!1}}))}),(0,h.GC$)("."+Z).bind("mouseenter",function(t){var i,n,e,r,o,a,o,n,s,i=this,n=u.dh,e=u.Vqt,r=u.rYt,o=u.LEt,a=[];o.existed.forEach(function(t){24<=t&&t<=39&&a.push(t)}),o=new ct(i,n,e,r,N,N,u),n=i.getBoundingClientRect(),o.rQ(s={x:0,y:0},{existed:a,dataType:2}),o.Wc.css(["position","left","top"],["fixed",n.right+"px",n.bottom-(0,h.GC$)(o.Wc).height()+"px"])})},j.prototype.KX=function(){(0,h.GC$)(this.Ti).unbind("mouseleave"),(0,h.GC$)("."+C).unbind("click"),(0,h.GC$)("."+Z).unbind("mouseenter")},j.prototype.sendCommand=function(){},t.PivotDateFilterDialog=j,n(O,wt=r),O.prototype.zqt=function(t){for(var i,n,i="",n=0;n<t.length;n++)i+=F(t[n]);return i},O.prototype.Hqt=function(){return!0},O.prototype.Zqt=function(t){var i,n,e;for(this.rT=h.GC$.extend(!0,[],tt()),n=i=0;n<t.existed.length;n++)for(i=t.existed[n]-24,e=0;e<this.rT.length;e++){if(this.rT[e].child[i]){this.rT[e].child[i].iconClass+=" "+p;break}i-=this.rT[e].child.length}return this.rT},O.prototype.aY=function(){var s=this;(0,h.GC$)(s.Ti).bind("mouseleave",function(t){s.close()}),(0,h.GC$)("."+A).bind("click",function(t){var i,n,e,r,o,a,i=s.dh,n=s.rYt,e=this,r=s.Vqt,o=(0,h.GC$)(this).attr("command"),a=s.Cut;a.Cut.close(),a.close(),s.close(),i.wVt({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:n,pivotName:r,host:e,command:o,isWholeDay:!1}})})},O.prototype.KX=function(){(0,h.GC$)(this.Ti).unbind("mouseleave"),(0,h.GC$)("."+A).unbind("click")},O.prototype.sendCommand=function(){},ct=O,t.PivotDateSecondaryFilterDialog=ct,n(_,yt=r),_.prototype.zqt=function(t){for(var i,n,i="",n=0;n<t.length;n++)i+=F(t[n]);return i},_.prototype.Hqt=function(){return!0},_.prototype.Zqt=function(t){var i,n,e;for(this.rT=h.GC$.extend(!0,[],X()),t.existed&&0!==t.existed.length?this.rT[0].child[0].iconClass=b+" "+l:this.rT[0].child[0].class=f,n=i=0;n<t.existed.length;n++)for(i=t.existed[n],e=1;e<this.rT.length;e++){if(!(i>=this.rT[e].child.length)){this.rT[e].child[i].iconClass+=" "+p;break}i-=this.rT[e].child.length}return this.rT},_.prototype.aY=function(){var i=this;(0,h.GC$)(i.Ti).bind("mouseleave",function(t){i.close()}),(0,h.GC$)("."+y).bind("click",function(t){At(this,i)})},_.prototype.KX=function(){(0,h.GC$)(this.Ti).unbind("mouseleave"),(0,h.GC$)("."+y).unbind("click")},_.prototype.sendCommand=function(){},t.PivotNumberFilter=_},"./dist/plugins/pivot/pivot-ui/filter-dialog.js":function(L,t,i){"use strict";var n,e,r,c,s,i,u,l,E,B,R,G,f,h,v,d,V,o,p,m,a,b,g,w,y,C,U,Q,W,z,Z,Y,A,N,H,J,q,K,I,T,X,$,tt,S,it,nt,et,rt,x,ot,M,D,r,at,st,ut,ct,k,lt,ft,ht;function j(t,i,n){return k.call(this,t,i,n)||this}function O(t,i,n,e,r,o){var t=lt.call(this,t,2e3,!0)||this;return t.Jqt=i,t.dh=n,t.rYt=e,t.Vqt=r,t.qqt=o,t.uf(),t.$c(),t}function _(t,i,n,e,r,o,a,s){var t=ft.call(this,t,2e3,!0)||this;return t.Kqt=i,t.dh=e,t.rYt=r,t.Vqt=o,t.Xqt=n,t.qqt=a,t.$qt=s,t.uf(),t.$c(),t}function F(t,i,n,e,r,o){var t=ht.call(this,t,2e3,!0)||this;return t.Jqt=i,t.dh=n,t.rYt=e,t.Vqt=r,t.qqt=o,t.uf(),t.$c(),t}function P(t,i){var n="",e="";return i&&(n="type = 'number'",e=H),t?'<input class="'.concat(C+" "+w+" "+e,'" ').concat(n,' width=100px></input>\n                    <div class="').concat(U,'">').concat(l().AndJoiner,'</div>\n                <input class="').concat(C+" "+w+" "+e,'" ').concat(n," width=100px></input>"):'<input class="'.concat(b+" "+w+" "+e,'" ').concat(n,"></input>")}n=this&&this.__extends||(ct=function(t,i){return(ct=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}ct(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.DateFilterDialog=t.ValueFilter=t.LabelFilter=t.opi=void 0,e=i("@spreadjs/js-sheets-common"),r=i("./dist/plugins/pivot/pivot.ns.js"),c=i("Core"),s=i("Pivot"),i=new e.Common.ResourceManager(r.SR,"PivotTables"),u=e.Common.zf.j0,l=i.getResource.bind(i),E=e.Formatter.GeneralFormatter,B="filter-dialog-container",R="label-title-class",G="label-filter-body",f="label-title",h="cancel-icon",v="cancel-class",d="label-show",V="split-line",o="prompt-info",p="ok-label",m="filter-confirm",a="label-select",b="label-input",g="confirm-class",w="label_input",y="input-between-container",C="input-between",U="and-joiner",Q="top-ten-content",W="filter-value-dialog-container",z="value-title-class",Z="split-line-class",Y="value-filter-body",A="value-select",N="field-value",H="value-filter",J="filter-top-ten-container",q="top-ten-filter-body",K="split-line-of-top-ten",I="value-of-top-ten",T="top-ten-select",X="top-ten-title-class",$="close-dialog",tt="by-joiner-class",S="top-ten",it="filter-date-dialog-container",nt="date-title-class",et="date-filter-body",rt="date-split-line",x="date-select",ot="is-whole-days",M=null,D=void 0,k=c.Ase,n(j,k),j.prototype.Eot=function(){var t=this,i=t.Wc.width(),n=t.Wc.height(),e=t.Fc.width(),t=t.Fc.height();this.Wc.css(["position","left","top"],["absolute",(e-i)/2+"px",(t-n)/2+"px"])},j.prototype.api=function(t){var i=this;!t&&i.rf()&&(i.Wc.css("display","none"),i.uf()),t&&(i.Wc.css("display","block"),i.tf()||i.nf())},j.prototype.$c=function(){var t=this;t.Wc.html(t.tKt()),k.prototype.$c.call(this),t.Eot(),t.aY()},j.prototype.lQ=function(){this.KX(),this.eG(),k.prototype.close.call(this)},t.opi=r=j,n(O,lt=r),O.prototype.$c=function(){var t=this;lt.prototype.$c.call(this),t.iKt()},O.prototype.eG=function(){this.Jqt=M,this.rYt=D,this.Vqt=D,this.qqt=D,this.Ti=M,this.dh=M},O.prototype.tKt=function(){for(var t,i,n,n,e,r,t="",i=this.Jqt,n=this.qqt,e=0;e<i.length;e++)t+=this.b0(i[e],e);return n=n>=s.PivotCaptionFilterOperator.between?P(!0):P(!1),r=u(this.rYt),'<div class="'.concat(B,'">\n                    <div class="').concat(R,'">\n                        <span class="').concat(f,'">').concat(l().Label_Title+"("+r+")",'</span>\n                        <span class="').concat(v+" "+h,'">\xd7</span>\n                    </div>\n                    <div class="').concat(G,'">\n                        <div class="').concat(g,'">\n                            <span class="').concat(d,'">').concat(l().Label_Show,'</span>\n                            <span class="').concat(V,'"></span>\n                        </div>\n                        <div class="').concat(g,'">\n                            <select class="').concat(a,'">').concat(t,'</select>\n                            <div class="').concat(y,'">\n                                ').concat(n,'\n                            </div>\n                        </div>\n                        <div class="').concat(g,'">\n                            <span class="').concat(o,'">').concat(l().Use_Single_Character,'</span>\n                            <span class="').concat(o,'">').concat(l().Use_Series_Characters,'</span>\n                        </div>\n                        <div>\n                            <span class="').concat(v+" "+m,'">').concat(l().Cancel,'</span>\n                            <span class="').concat(p+" "+m,'">').concat(l().Ok,"</span>\n                        </div>\n                    </div>\n                </div>")},O.prototype.b0=function(t,i){var n="";return i===this.qqt&&(n="selected"),'<option command="'.concat(i,'" ').concat(n,">").concat(t,"</option>")},O.prototype.aY=function(){var s,t,s=this,t=s.Wc[0];(0,c.GC$)("."+v,t).bind("click",function(t){s.lQ()}),(0,c.GC$)("."+p,t).bind("click",function(t){var i,n,e,e,i,n,r,o,a,i=(0,c.GC$)("."+b)[0],n=M,e=(0,c.GC$)("."+C);0<e.length&&(i=e[0],n=e[1]),e=i?i.value:M,i=n?n.value:M,n=s.qqt,r=s.dh,o=s.rYt,a=s.Vqt,r.wVt({cmd:"updateCondition",sheetName:"",cmdOption:{fieldsModel:r,fieldName:o,pivotName:a,selectValue:n,inputValue:e,inputValueEnd:i}}),s.lQ()}),(0,c.GC$)("."+a,t).bind("change",function(t){var i=(0,c.GC$)(this.options[this.selectedIndex]).attr("command");s.nKt(i)})},O.prototype.KX=function(){var t=this.Wc[0];(0,c.GC$)("."+v,t).unbind("click"),(0,c.GC$)("."+p,t).unbind("click"),(0,c.GC$)("."+a,t).unbind("change")},O.prototype.nKt=function(t){var i=this,t=+t,n;(t>=s.PivotCaptionFilterOperator.between&&i.qqt<s.PivotCaptionFilterOperator.between||t<s.PivotCaptionFilterOperator.between&&i.qqt>=s.PivotCaptionFilterOperator.between)&&(n=t>=s.PivotCaptionFilterOperator.between?P(!0):P(!1),(0,c.GC$)("."+y).html(n)),i.qqt=t},O.prototype.iKt=function(){var t,i,n,t,i,n,i,n,e,i,n,t,n,t=this,i=t.dh,n=t.rYt,t=t.qqt,i=i.getFilterInfo(i.getSourceNameByFieldName(n));i&&i.labelFilter&&i.labelFilter.condition&&(i=(n=i.labelFilter.condition.toJSON()).val,n=n.operator,e=i[0],i=i[1],n===t)&&(t=(n=(0,c.GC$)("."+w))[0],n=n[1],t.value=e,n)&&(n.value=i)},t.LabelFilter=O,n(_,ft=r),_.prototype.$c=function(){var t=this;ft.prototype.$c.call(this),t.eKt()},_.prototype.eG=function(){this.Kqt=M,this.rYt=D,this.Vqt=D,this.qqt=D,this.Ti=M,this.dh=M},_.prototype.eKt=function(){var t=this;t.$qt?t.rKt():t.iKt()},_.prototype.tKt=function(){return this.$qt?this.oKt():this.aKt()},_.prototype.oKt=function(){for(var t,i,n,e,t="",i=this.Xqt,n=0;n<i.length;n++)t+=this.b0(i[n],n);return e=u(this.rYt),'<div class="'.concat(J,'">\n                    <div class="').concat(X,'">\n                        <span class="').concat(f,'">').concat(l().Top_Ten_Filter+"("+e+")",'</span>\n                        <span class="').concat(v+" "+h,'">\xd7</span>\n                    </div>\n                    <div class="').concat(q,'">\n                        <div class="').concat(g,'">\n                            <span class="').concat(d,'">').concat(l().TopTenShow,'</span>\n                            <span class="').concat(K,'"></span>\n                        </div>\n                        <div class="').concat(g+" "+Q,'">\n                            <select class="').concat(T,'">\n                                <option>').concat(l().Top,"</option>\n                                <option>").concat(l().Bottom,'</option>\n                            </select>\n                            <input class="').concat(I,'" type="number" value=10 min=1></input>\n                            <select class="').concat(T,'">\n                                <option>').concat(l().Top_Item,"</option>\n                                <option>").concat(l().Top_Percent,"</option>\n                                <option>").concat(l().Top_Sum,'</option>\n                            </select>\n                            <div class="').concat(tt,'">').concat(l().ByJoiner,'</div>\n                            <select class="').concat(T,'">').concat(t,'</select>\n                        </div>\n                        <div class="').concat($,'">\n                            <span class="').concat(v+" "+m,'">').concat(l().Cancel,'</span>\n                            <span class="').concat(p+" "+m+" "+S,'">').concat(l().Ok,"</span>\n                        </div>\n                    </div>\n                </div>")},_.prototype.aKt=function(){for(var t,i,n,n,e,r,o,a,t="",i=this.Kqt,n=this.qqt,e=0;e<i.length;e++)t+=this.b0(i[e],e);for(r="",o=this.Xqt,e=0;e<o.length;e++)r+=this.b0(o[e],e);return n=n===s.PivotValueFilterOperator.between||n===s.PivotValueFilterOperator.notBetween?P(!0,!0):P(!1,!0),a=u(this.rYt),'<div class="'.concat(W,'">\n                    <div class="').concat(z,'">\n                        <span class="').concat(f,'">').concat(l().Value_Title+"("+a+")",'</span>\n                        <span class="').concat(v+" "+h,'">\xd7</span>\n                    </div>\n                    <div class="').concat(Y,'">\n                        <div class="').concat(g,'">\n                            <span class="').concat(d,'">').concat(l().Value_Show,'</span>\n                            <span class="').concat(Z,'"></span>\n                        </div>\n                        <div class="').concat(g,'">\n                            <select class="').concat(A,'">').concat(r,'</select>\n                            <select class="').concat(A+" "+N,'">').concat(t,'</select>\n                            <div class="').concat(y,'">\n                                ').concat(n,'\n                            </div>\n                        </div>\n                        <div>\n                            <span class="').concat(v+" "+m,'">').concat(l().Cancel,'</span>\n                            <span class="').concat(p+" "+m,'">').concat(l().Ok,"</span>\n                        </div>\n                    </div>\n                </div>")},_.prototype.b0=function(t,i){var n="";return i===this.qqt&&(n="selected"),'<option command="'.concat(i,'" ').concat(n,">").concat(t,"</option>")},_.prototype.aY=function(){var n,t,n=this,t=n.Wc[0];(0,c.GC$)("."+v,t).bind("click",function(t){n.lQ()}),(0,c.GC$)("."+p,t).bind("click",function(t){(0,c.GC$)(this).hasClass(S)?n.sKt():n.uKt(),n.lQ()}),(0,c.GC$)("."+N).bind("change",function(t){var i=(0,c.GC$)(this.options[this.selectedIndex]).attr("command");n.nKt(i)})},_.prototype.rKt=function(){var t,i,n,t,n,t,t,e,r,t,t=this,i=t.Xqt,n=t.dh,t=t.rYt,n=n.getFilterInfo(n.getSourceNameByFieldName(t));n&&n.valueFilter&&n.valueFilter.conditionByName&&(t=n.valueFilter.condition).getConditionType()===s.PivotConditionType.top10&&(e=(t=t.toJSON()).val,r=t.type,t=t.operator,(0,c.GC$)("."+T)[2].selectedIndex=i.indexOf(n.valueFilter.conditionByName),(0,c.GC$)("."+T)[0].selectedIndex=0<t?0:1,(0,c.GC$)("."+T)[1].selectedIndex=r,(0,c.GC$)("."+I).attr("value",e))},_.prototype.nKt=function(t){var i=this,t=+t,n;(t>=s.PivotValueFilterOperator.between&&i.qqt<s.PivotValueFilterOperator.between||t<s.PivotValueFilterOperator.between&&i.qqt>=s.PivotValueFilterOperator.between)&&(n=t>=s.PivotValueFilterOperator.between?P(!0,!0):P(!1,!0),(0,c.GC$)("."+y).html(n)),i.qqt=t},_.prototype.iKt=function(){var t,i,n,t,i,n,i,n,e,i,n,t,n,t=this,i=t.dh,n=t.rYt,t=t.qqt,i=i.getFilterInfo(i.getSourceNameByFieldName(n));i&&i.valueFilter&&i.valueFilter.condition&&(i=(n=i.valueFilter.condition.toJSON()).val,n=n.operator,e=i[0],i=i[1],n===t)&&(t=(n=(0,c.GC$)("."+w))[0],n=n[1],t.value=e,n)&&(n.value=i)},_.prototype.KX=function(){var t=this.Wc[0];(0,c.GC$)("."+v,t).unbind("click"),(0,c.GC$)("."+p,t).unbind("click"),(0,c.GC$)("."+N).unbind("change")},_.prototype.uKt=function(){var t,i,n,i,e,r,o,o,n,i,e,r,a,t,t=this,i=(0,c.GC$)("."+A),n=i[0],i=i[1],e=(0,c.GC$)("."+b)[0],r=M,o=(0,c.GC$)("."+C);0<o.length&&(e=o[0],r=o[1]),o=(0,c.GC$)(n.options[n.selectedIndex]).text(),n=(0,c.GC$)(i.options[i.selectedIndex]).attr("command"),i=e?e.value:M,e=r?r.value:M,r=t.dh,a=t.rYt,t=t.Vqt,r.wVt({cmd:"updateValueCondition",sheetName:"",cmdOption:{fieldsModel:r,fieldName:a,pivotName:t,valueOfField:o,valueOfFieldValue:n,inputValue:i,inputValueEnd:e}})},_.prototype.sKt=function(){var t,i,n,e,r,o,a,e,r,o,a,e,t=this,i=t.dh,n=t.Vqt,e=(0,c.GC$)("."+T),r=e[0],o=(0,c.GC$)("."+I)[0],a=e[1],e=e[2],r=(0,c.GC$)(r.options[r.selectedIndex]).text(),o=o.value,a=(0,c.GC$)(a.options[a.selectedIndex]).text(),e=(0,c.GC$)(e.options[e.selectedIndex]).text();i.wVt({cmd:"TopTenCondition",sheetName:"",cmdOption:{fieldsModel:i,fieldName:t.rYt,valueFieldName:e,pivotName:n,TopOrBottomValue:r,inputValue:o,selectTypeValue:a}})},t.ValueFilter=_,n(F,ht=r),F.prototype.$c=function(){var t=this;ht.prototype.$c.call(this),t.iKt()},F.prototype.eG=function(){this.rYt=D,this.Vqt=D,this.qqt=D,this.Jqt=M,this.Ti=M,this.dh=M},F.prototype.tKt=function(){for(var t,i,n,e,r,t="",i=this.Jqt,e=0;e<i.length;e++)t+=this.b0(i[e],e);return n=this.qqt>=s.PivotDateFilterOperator.Between?P(!0):P(!1),r=u(this.rYt),'<div class="'.concat(it,'">\n                    <div class="').concat(nt,'">\n                        <span class="').concat(f,'">').concat(l().DateFilterTitle+"("+r+")",'</span>\n                        <span class="').concat(v+" "+h,'">\xd7</span>\n                    </div>\n                    <div class="').concat(et,'">\n                        <div class="').concat(g,'">\n                            <span class="').concat(d,'">').concat(l().DateShow,'</span>\n                            <span class="').concat(rt,'"></span>\n                        </div>\n                        <div class="').concat(g,'">\n                            <select class="').concat(x,'">').concat(t,'</select>\n                            <div class="').concat(y,'">\n                                ').concat(n,'\n                            </div>\n                        </div>\n                        <div class="').concat(g,'">\n                            <input type="checkbox" id="WholeDays" name="WholeDays" class="').concat(ot,'">\n                            <label for="WholeDays">').concat(l().WholeDays,'</label>\n                        </div>\n                        <div>\n                            <span class="').concat(v+" "+m,'">').concat(l().Cancel,'</span>\n                            <span class="').concat(p+" "+m,'">').concat(l().Ok,"</span>\n                        </div>\n                    </div>\n                </div>")},F.prototype.b0=function(t,i){var n="";return i===this.qqt&&(n="selected"),'<option command="'.concat(i,'" ').concat(n,">").concat(t,"</option>")},F.prototype.aY=function(){var u,t,u=this,t=u.Wc[0];(0,c.GC$)("."+v,t).bind("click",function(t){u.lQ()}),(0,c.GC$)("."+p,t).bind("click",function(t){var i,n,e,r,o,r,i,n,e,a,s,i=(0,c.GC$)("."+x)[0],n=(0,c.GC$)("."+b)[0],e=M,r=(0,c.GC$)("."+C),o=(0,c.GC$)("."+ot)[0].checked;0<r.length&&(n=r[0],e=r[1]),r=(0,c.GC$)(i.options[i.selectedIndex]).attr("command"),i=n?n.value:M,n=e?e.value:M,e=u.dh,a=u.rYt,s=u.Vqt,e.wVt({cmd:"dialogForDateFilter",sheetName:"",cmdOption:{fieldName:a,pivotName:s,command:r,isWholeDay:o,value1:i,value2:n}}),u.lQ()}),(0,c.GC$)("."+x).bind("change",function(t){var i=(0,c.GC$)(this.options[this.selectedIndex]).attr("command");u.nKt(i)})},F.prototype.nKt=function(t){var i=this,t=+t,n;(t>=s.PivotDateFilterOperator.Between&&i.qqt<s.PivotDateFilterOperator.Between||t<s.PivotDateFilterOperator.Between&&i.qqt>=s.PivotDateFilterOperator.Between)&&(n=t>=s.PivotDateFilterOperator.Between?P(!0):P(!1),(0,c.GC$)("."+y).html(n)),i.qqt=t},F.prototype.iKt=function(){var t,i,n,e,i,n,i,r,n,r,e,n,t,n,o,t,t=this,i=t.dh,n=t.rYt,e=t.qqt,i=i.getFilterInfo(i.getSourceNameByFieldName(n));i&&i.labelFilter&&i.labelFilter.condition&&(i=(n=i.labelFilter.condition.toJSON()).isWholeDay,r=n.operator,n=n.val,r===e)&&(r=n[0],e=n[1],r=(n=t.formatDate(r,e)).value1,e=n.value2,t=(0,c.GC$)("."+w),n=(0,c.GC$)("#WholeDays"),o=t[0],t=t[1],o.value=r,t&&e&&0<e.length&&(t.value=e),n.attr("checked",i))},F.prototype.formatDate=function(t,i){var n,e,n,n=new E,e=n.getPreferredEditingFormatter(t),n=n.getPreferredEditingFormatter(i);return{value1:e.format(t),value2:n.format(i)}},F.prototype.KX=function(){var t=this.Wc[0];(0,c.GC$)("."+v,t).unbind("click"),(0,c.GC$)("."+p,t).unbind("click"),(0,c.GC$)("."+x).unbind("change")},t.DateFilterDialog=F},"./dist/plugins/pivot/pivot-ui/pivot-date-group-dialog.js":function(t,i,n){"use strict";var e,h,r,s,n,r,u,o,c,l,f,v,d,p,m,b,a,g,w,y,C,A,N,I,T,S;function x(t,i,n,e,r,o,a,s,u,c,l){var t,f;return void 0===l&&(l="m/d/yyyy"),(f=t=S.call(this,t,0,!0)||this).cKt=i,f.rYt=n,f.dh=e,f.T=o&&h.Be.Re(o,l)||"",f.lKt=r&&h.Be.Re(r,l),f.fKt=f.lKt===f.T,f.gd=s&&h.Be.Re(s,l)||"",f.hKt=a&&h.Be.Re(a,l),f.vKt=f.hKt===f.gd,f.dKt=u,f.W3=c,f.uf(),t}e=this&&this.__extends||(T=function(t,i){return(T=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}T(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PivotDateGroupDialog=void 0,h=n("Core"),r=n("@spreadjs/js-sheets-common"),s=n("Pivot"),n=n("./dist/plugins/pivot/pivot.ns.js"),r=new r.Common.ResourceManager(n.SR,"PivotTables"),u=r.getResource.bind(r),o=h.mt.En,c="cancel-icon",l="cancel-class",f="ok-label",v="filter-confirm",d="date-group-startingAt-isActive",p="date-group-startingAt-value",m="date-group-endingAt-isActive",b="date-group-endingAt-value",a="date-group-by-value",g="date-group-dialog-sub-container",w="date_group_dialog_group-by-subContainer",y="date-group-by",C="date-group-by-selected",A="click",N="change",S=h.zc,e(x,S),x.prototype.$c=function(){this.pKt(),S.prototype.$c.call(this),this.Eot(),this.Fz()},x.prototype.pKt=function(){var t=(0,h.GC$)(o("div"));t[0].innerHTML=this.mKt(),this.Wc.append(t)},x.prototype.Fz=function(){var a=this;(0,h.GC$)("."+l).bind(A,function(t){a.lQ()}),(0,h.GC$)("."+f).bind(A,function(t){var i,n,e,r,o,i=a.cKt,n=a.rYt,e=(0,h.GC$)("."+p).val().trim(),r=(0,h.GC$)("."+b).val().trim(),o=a.dKt;a.dh.wVt({cmd:"pivotTableGroup",cmdOption:{dataType:s.PivotDataType.date,fieldName:n,pivotName:i,startingAtValue:e,endingAtValue:r,groupByValueArray:o,selections:a.W3}}),a.lQ()}),(0,h.GC$)("."+y).bind(A,function(t){var i=parseInt((0,h.GC$)(this).attr("value"),10);-1<a.dKt.indexOf(i)?((0,h.GC$)("."+y).css("border","initial"),(0,h.GC$)(this).removeClass(C),a.dKt.splice(a.dKt.indexOf(i),1)):((0,h.GC$)("."+y).css("border","initial"),(0,h.GC$)(this).addClass(C),(0,h.GC$)(this).css("border","1px dotted rgb(255,135,34)"),a.dKt.push(i))}),(0,h.GC$)("."+p).bind(N,function(t){(a.fKt=!1,h.GC$)("."+d)[0].checked=!1}),(0,h.GC$)("."+b).bind(N,function(t){(a.vKt=!1,h.GC$)("."+m)[0].checked=!1}),(0,h.GC$)("."+d).bind(A,function(t){this.checked&&(0,h.GC$)("."+p).val(a.lKt)}),(0,h.GC$)("."+m).bind(A,function(t){this.checked&&(0,h.GC$)("."+b).val(a.hKt)})},x.prototype.mKt=function(){var t,i,n,e,r,o,a,t=y+(-1<this.dKt.indexOf(s.DateGroupType.seconds)?" "+C:""),i=y+(-1<this.dKt.indexOf(s.DateGroupType.minutes)?" "+C:""),n=y+(-1<this.dKt.indexOf(s.DateGroupType.hours)?" "+C:""),e=y+(-1<this.dKt.indexOf(s.DateGroupType.days)?" "+C:""),r=y+(-1<this.dKt.indexOf(s.DateGroupType.months)?" "+C:""),o=y+(-1<this.dKt.indexOf(s.DateGroupType.quarters)?" "+C:""),a=y+(-1<this.dKt.indexOf(s.DateGroupType.years)?" "+C:"");return'<div class="date-group-dialog-container">\n                    <div class="date-group-dialog-header">\n                        <span class="date-group-dialog-header-title">'.concat(u().grouping,'</span>\n                        <span class="').concat(l+" "+c,'">\xd7</span>\n                    </div>\n                    <div class="date-group-dialog-content">\n                        <div class="date-group-dialog-content-header">\n                            <span>').concat(u().auto,'</span>\n                            <span class="date-group--header-horizontal-auto-line"></span>\n                        </div>\n                        <div class="').concat(g,'">\n                            <input type="checkbox" class="').concat(d,'" ').concat(this.fKt?"checked":"unchecked",">\n                            <span>").concat(u().startingAt,'</span>\n                            <input class="').concat(p,'" value = "').concat(this.T,'"></input>\n                        </div>\n                        <div class="').concat(g,'">\n                            <input type="checkbox" class="').concat(m,'" ').concat(this.fKt?"checked":"unchecked",">\n                            <span>").concat(u().endingAt,'</span>\n                            <input class="').concat(b,'" value = "').concat(this.gd,'"></input>\n                        </div>\n                        <div class="').concat(g,'">\n                            <span style = "display: inline-block;">').concat(u().groupBy,'</span>\n                            <span class="date-group--header-horizontal-group-line"></span>\n                            <div class="').concat(w,'">\n                                <span value = ').concat(s.DateGroupType.seconds,' class="').concat(t,'">').concat(u().seconds,"</span>\n                                <span value = ").concat(s.DateGroupType.minutes,' class="').concat(i,'">').concat(u().minutes,"</span>\n                                <span value = ").concat(s.DateGroupType.hours,' class="').concat(n,'">').concat(u().hours,"</span>\n                                <span value = ").concat(s.DateGroupType.days,' class="').concat(e,'">').concat(u().days,"</span>\n                                <span value = ").concat(s.DateGroupType.months,' class="').concat(r,'">').concat(u().months,"</span>\n                                <span value = ").concat(s.DateGroupType.quarters,' class="').concat(o,'">').concat(u().quarters,"</span>\n                                <span value = ").concat(s.DateGroupType.years,' class="').concat(a,'">').concat(u().years,'</span>\n                            </div>\n                        </div>\n                        <div class="date-group-dialog-bottom-confirm">\n                            <span class="').concat(l+" "+v,'">').concat(u().Cancel,'</span>\n                            <span class="').concat(f+" "+v,'">').concat(u().Ok,"</span>\n                        </div>\n                    </div>\n                </div>")},x.prototype.Eot=function(){var t=this,i=t.Wc.width(),n=t.Wc.height(),e=t.Fc.width(),t=t.Fc.height();this.Wc.css(["position","left","top","z-index"],["absolute",(e-i)/2+"px",(t-n)/2+"px",1001])},x.prototype.eG=function(){this.dh=null},x.prototype.KX=function(){(0,h.GC$)("."+l).unbind(A),(0,h.GC$)("."+f).unbind(A)},x.prototype.lQ=function(){this.eG(),this.KX(),S.prototype.close.call(this)},i.PivotDateGroupDialog=x},"./dist/plugins/pivot/pivot-ui/pivot-field-setting-dialog.js":function(L,t,i){"use strict";var n,a,s,E,u,e,r,B,i,o,c,R,l,f,h,v,d,p,m,b,g,w,y,C,A,N,I,T,S,x,M,D,k,r,e,G,V,j,O,U,Q;function W(t){var i,t,i,t=new B.PivotFieldSettingNumberFormatDialog(t,t.bKt,t.gKt,t.bbt);return t.$c(),t}function _(t,i,n,e,r){var o,i,o=O.call(this,document.body,999,!0)||this;return o.YC=374,o.ZC=317.5,o.k1=!1,o.bbt="",o.wKt=[],o.yKt=i,o.dh=t,o.rYt=n,o.CKt=n,o.Vqt=e,o.RN=r,i=o.dh.getFieldInfoByName(n),o.IKt=i.a,o.AKt=i.getSubTotalType(),o.NKt(r),o.uf(),o}function F(t,i,n,e){var t=U.call(this,t,c().ValueSetting,i,n,e)||this;return t.TKt(),t.Dn(),t.MKt(),t.Fz(),t}function P(t,i,n,e,r,o,a){var t=Q.call(this,t,c().FieldSetting,i,n,e)||this;return t.xKt=r,t.Opi=o,t.Ppi=a,t.TKt(),t.Dn(),t.Fz(),t}n=this&&this.__extends||(j=function(t,i){return(j=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}j(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),a=this&&this.__spreadArray||function(t,i,n){if(n||2===arguments.length)for(var e=0,r=i.length,o;e<r;e++)!o&&e in i||((o=o||Array.prototype.slice.call(i,0,e))[e]=i[e]);return t.concat(o||Array.prototype.slice.call(i))},Object.defineProperty(t,"__esModule",{value:!0}),t.PivotDimFieldSettingDialog=t.PivotValuesFieldSettingDialog=t.PivotSettingBaseDialog=void 0,s=i("Core"),E=i("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),u=i("Pivot"),e=i("@spreadjs/js-sheets-common"),r=i("./dist/plugins/pivot/pivot.ns.js"),B=i("./dist/plugins/pivot/pivot-ui/pivot-field-setting-number-format-dialog.js"),i=new e.Common.ResourceManager(r.SR,"PivotTables"),o=e.Common.zf.j0,c=i.getResource.bind(i),R=s.mt.En,l=".pivot-field-content-base-field-item.active",f=".pivot-field-content-base-item-item.active",h="pivot-field-content-hide",v="pivot-field-content-base-item-item",d=".pivot-field-show-value-as-content-base-item",p=".pivot-field-show-value-as-content-base-field",m=".pivot-field-show-value-as-content-type-list",b=".pivot-field-setting-control-format",g=".pivot-field-setting-control-ok",w=".pivot-field-setting-control-cancel",y=".gc-filter-dialog-close",C=".pivot-field-custom-name",A="gc-sjs-field-settings-layout-showNoData",N="gc-sjs-field-settings-layout-showSubtotalTop",I="click",T="change",S="active",x="disable",M="pivot-field-content-item",D="pivot-field-summarize-item",k="pivot-field-summarize-content",r=function(){return'\n        <div class="pivot-field-summarize-header">\n            <div id="SummarizeValue" class="'.concat(D," ").concat(S,'">').concat(c().SummarizeValue,'</div>\n            <div id="ShowValueAs" class="').concat(D,'">').concat(c().ShowValueAs,"</div>\n        </div>\n    ")},O=s.zc,n(_,O),_.prototype.NKt=function(t){var i,n,e,r,o,a,s,a,s,i=this;if(t)for(n=0;n<t.length;n++)if((e=t[n]&&t[n].pivotArea)&&(r=e.references))for(o=0;o<r.length;o++)if(s=(a=r[o]).items,a=a.fieldName,s&&-1<s.indexOf(i.rYt)||a===i.rYt){(s=t[n].style)&&s.formatter&&(i.bbt=s.formatter);break}},_.prototype.$c=function(){O.prototype.$c.call(this),this.Eot()},_.prototype.Eot=function(){var t=this,i=t.Wc.width(),n=t.Wc.height(),e=t.Fc.width(),t=t.Fc.height();this.bKt=(e-i)/2+"px",this.gKt=(t-n)/2+"px",this.Wc.css(["position","left","top","z-index"],["absolute",this.bKt,this.gKt,1001])},_.prototype.dialogHeader=function(t){return'\n            <div style="width: 100%; height: 34px; background-color: rgb(255, 255, 255); padding: 0px 0px 0px 12px; box-sizing: border-box;">\n                <span style="float: left; height: 34px; line-height: 34px; display: inline-block;">\n                    '.concat(t,'\n                </span>\n                <span class="gc-filter-dialog-close gc-pivot-dialog-close" style="float: right; height: 34px; line-height: 30px; display: inline-block; font-size: 28px; width: 54px; text-align: center;">\xd7</span>\n            </div>\n        ')},_.prototype.dialogFieldNameArea=function(t,i){var n="pivot-field-row-wrap";return t=o(t),i=o(i),'\n            <div class ="pivot-field-setting-name-area">\n                <div class='.concat(n,">\n                    <label>").concat(c().SourceName," </label> <span>").concat(t,"</span>\n                </div>\n                <div class=").concat(n,">\n                    <label>").concat(c().CustomName,' </label> <span><input class="pivot-field-custom-name" type="text" value="').concat(i,'"></span>\n                </div>\n            </div>\n        ')},_.prototype.dialogFooter=function(t){var t=t===u.PivotDataType.number||t===u.PivotDataType.date?c().NumberFormat:c().LabelFormat;return'\n            <div class="pivot-field-setting-footer">\n                <div class="pivot-field-setting-control-wrap-left">\n                    <input class= "pivot-field-setting-control-format" type ="button" value= "'.concat(t,'">\n                </div>\n                <div class="pivot-field-setting-control-wrap"><input class= "pivot-field-setting-control pivot-field-setting-control-ok" type ="button" value= "').concat(c().Ok,'">\n                    <input class= "pivot-field-setting-control pivot-field-setting-control-cancel" type ="button" value= "').concat(c().Cancel,'">\n                </div>\n            </div>\n        ')},_.prototype.Dn=function(){var t=(0,s.GC$)(R("div"));t.addClass("gc-pivot-field-setting-wrapper gc-popup ui-widget gc-filter-dialog-style"),t[0].innerHTML="".concat(this.dialogHeader(this.yKt),'\n                <div class="gc-pivot-field-setting-content">\n                    ').concat(this.dialogFieldNameArea(this.IKt,this.rYt),"\n                    ").concat(this.wKt.join("\n"),"\n                </div>\n            ").concat(this.dialogFooter(this.dh.rBt(this.rYt))),this.Wc.append(t),(0,s.GC$)(".pivot-field-content-item[data-subtype='"+this.AKt+"']",this.Wc[0]).addClass(S),this.Wc.width(this.YC),this.Wc.height(this.ZC)},_.prototype.eG=function(){this.dh=null,this.rYt=void 0},_.prototype.lQ=function(){this.eG(),O.prototype.close.call(this)},_.prototype.lf=function(t){var i;return!(!this.Wc||!O.prototype.hf.call(this,this.Wc.get(0),t))||this.DKt&&O.prototype.hf.call(this,this.DKt.get(0),t)},t.PivotSettingBaseDialog=e=_,n(F,U=e),F.prototype.TKt=function(){this.SKt()},F.prototype.MKt=function(){var t,i,n,e,r,o,t=this,i=this.dh.getFieldInfoByName(t.rYt).Or;if(i&&(t.kKt=i.showDataAs,t.jKt=i.baseFieldName,t.OKt=i.baseFieldItem,n=i.showDataAs+"",(0,s.GC$)(m,this.Wc[0]).value=n,-1<["4","7","8","9","10","11","12","13"].indexOf(n))){for((0,s.GC$)(p).removeClass(x),e=a(a([],t.dh.nw(1),!0),t.dh.nw(2),!0),r=0;r<e.length;r++)if(e[r].Zc===i.baseFieldName){t.PKt=r;break}if(-1<["4","8","9"].indexOf(n))if((0,s.GC$)(d).removeClass(x),1===i.baseFieldItemType)t.FKt=1,t._Kt=1,t.OKt=c().BaseItemNext;else if(2===i.baseFieldItemType)t.FKt=0,t._Kt=0,t.OKt=c().BaseItemPrevious;else for(o=a([],t.dh.Kz(i.baseFieldName),!0),r=0;r<o.length;r++)if(o[r]+""===i.baseFieldItem){t.FKt=r+2;break}}},F.prototype.SKt=function(){var t,i,n,t=this.LKt(),i=this.EKt(),n=this.BKt();this.wKt.push('\n            <div class="pivot-field-summarize-area">\n            '.concat(t,"\n            ").concat(i,"\n            ").concat(n,"\n            </div>\n        "))},F.prototype.LKt=r,F.prototype.EKt=function(){return'\n        <div class="'.concat(k,'">\n            <div class="').concat(k,'-header">').concat(c().SummarizeValueField,'</div>\n            <div class="').concat(k,'-desc">').concat(c().ChooseType,'</div>\n            <ul class="').concat(k,'-list">\n                <li data-subtype="8" class="').concat(M,'">').concat(c().Sum,'</li>\n                <li data-subtype="1" class="').concat(M,'">').concat(c().Count,'</li>\n                <li data-subtype="0" class="').concat(M,'">').concat(c().Average,'</li>\n                <li data-subtype="3" class="').concat(M,'">').concat(c().Max,'</li>\n                <li data-subtype="4" class="').concat(M,'">').concat(c().Min,'</li>\n                <li data-subtype="5" class="').concat(M,'">').concat(c().Product,'</li>\n                <li data-subtype="2" class="').concat(M,'">').concat(c().CountNumbers,'</li>\n                <li data-subtype="6" class="').concat(M,'">').concat(c().StdDev,'</li>\n                <li data-subtype="7" class="').concat(M,'">').concat(c().StdDevp,'</li>\n                <li data-subtype="9" class="').concat(M,'">').concat(c().Var,'</li>\n                <li data-subtype="10" class="').concat(M,'">').concat(c().Varp,"</li>\n            </ul>\n        </div>\n        ")},F.prototype.BKt=function(){return'\n        <div class="pivot-field-show-value-as-content pivot-field-content-hide">\n            <div class="pivot-field-show-value-as-content-header">'.concat(c().ShowValueAsField,'</div>\n            <select name="list" class="pivot-field-show-value-as-content-type-list">\n                <option value="0">').concat(c().noCalculation,'</option>\n                <option value="1">').concat(c().percentGrandTotal,'</option>\n                <option value="3">').concat(c().percentColumnTotal,'</option>\n                <option value="2">').concat(c().percentRowTotal,'</option>\n                <option value="4">').concat(c().percentEllipsis,'</option>\n                <option value="5">').concat(c().percentParentRowTotal,'</option>\n                <option value="6">').concat(c().percentParentColumnTotal,'</option>\n                <option value="7">').concat(c().percentParentTotal,'</option>\n                <option value="8">').concat(c().difference,'</option>\n                <option value="9">').concat(c().percentDifference,'</option>\n                <option value="10">').concat(c().runningTotal,'</option>\n                <option value="11">').concat(c().percentRunningTotal,'</option>\n                <option value="12">').concat(c().rankSmallestLargest,'</option>\n                <option value="13">').concat(c().rankLargestSmallest,'</option>\n                <option value="14">').concat(c().index,'</option>\n            </select>\n            <div class="pivot-field-show-value-as-content-base-field-list">\n                <div>').concat(c().baseField,'</div>\n                <ul class="pivot-field-show-value-as-content-base-field ').concat(x,'">\n                </ul>\n            </div>\n            <div class="pivot-field-show-value-as-content-base-item-list">\n                <div>').concat(c().baseItem,'</div>\n                <ul class="pivot-field-show-value-as-content-base-item  ').concat(x,'">\n                </ul>\n            </div>\n        </div>\n        ')},F.prototype.Fz=function(){var o=this;(0,s.GC$)(y,this.Wc[0]).bind(I,function(){o.lQ()}),(0,s.GC$)(w,this.Wc[0]).bind(I,function(){o.lQ()}),(0,s.GC$)(C,this.Wc[0]).bind(T,function(){o.k1=!0,o.rYt=(0,s.GC$)(this).val()}),(0,s.GC$)(".".concat(M),this.Wc[0]).bind(I,function(){(0,s.GC$)(".".concat(M,".").concat(S)).removeClass(S),o.k1=!0,o.AKt=+(0,s.GC$)(this).addClass(S).attr("data-subtype");var t=o.dh.getFieldInfoByName(o.CKt).a,t=o.dh.FG(t,t,o.AKt);(0,s.GC$)(C).val(t),o.rYt=t}),(0,s.GC$)(g,this.Wc[0]).bind(I,function(){var t=(0,u.ht)(o.kKt)?"0":o.kKt+"",i,n=o.jKt,e=o.OKt,r=o._Kt;-1<["4","7","8","9","10","11","12","13"].indexOf(t)&&-1<["4","8","9"].indexOf(t)&&(i={value:e,index:r}),o.dh.wVt({cmd:"UpdatePivotValueFieldCmd",sheetName:"",cmdOption:{pivotName:o.Vqt,oldFieldName:o.CKt,subtotalType:o.AKt,fieldName:o.rYt,showValueAsType:parseInt(t,10),baseField:n,baseItem:i},formatter:o.bbt}),o.bbt="",o.lQ()}),(0,s.GC$)(".".concat(D),this.Wc[0]).bind(I,function(){var t,t;(0,s.GC$)(".".concat(D,".").concat(S)).removeClass(S),(0,s.GC$)(".pivot-field-content-hide").removeClass(h),(0,s.GC$)(this).addClass(S),(0,s.GC$)(p).empty(),"SummarizeValue"===this.id?(0,s.GC$)(".pivot-field-show-value-as-content").addClass(h):(-1<o.kKt&&((0,s.GC$)(m)[0].value=o.kKt,-1<o.PKt)&&((0,s.GC$)(p).removeClass(x),-1<o.FKt)&&(0,s.GC$)(d).removeClass(x),(0,s.GC$)(".".concat(k)).addClass(h),o.RKt=a(a([],o.dh.nw(1),!0),o.dh.nw(2),!0),o.RKt.forEach(function(t,i){var n=document.createElement("li");n.className="pivot-field-content-base-field-item",n.value=i,-1<o.PKt&&o.PKt===i&&n.classList.add(S),n.innerText=t.Zc,(0,s.GC$)(p)[0].appendChild(n)}),-1<o.FKt&&(t=o.dh.getFieldInfoByName(o.rYt).Or,(t=a([],o.dh.Kz(t.baseFieldName),!0)).unshift(c().BaseItemNext),t.unshift(c().BaseItemPrevious),t.forEach(function(t,i){var n=document.createElement("li");n.className=v,n.value=i,n.innerText=t,i===o.FKt&&n.classList.add(S),(0,s.GC$)(d)[0].appendChild(n)})))}),(0,s.GC$)(p,this.Wc[0]).bind(I,function(t){var t,t;this.classList.contains(x)||"LI"!==t.target.tagName||((0,s.GC$)(l).removeClass(S),(0,s.GC$)(d).empty(),t.target.classList.add(S),t=t.target.textContent,o.jKt=t,["4","8","9"].indexOf(o.kKt+"")<0)||((t=a([],o.dh.Kz(t),!0)).unshift(c().BaseItemNext),t.unshift(c().BaseItemPrevious),t.forEach(function(t,i){var n=document.createElement("li");n.className=v,n.value=i,n.innerText=t,0===i&&n.classList.add(S),(0,s.GC$)(d)[0].appendChild(n)}))}),(0,s.GC$)(d,this.Wc[0]).bind(I,function(t){this.classList.contains(x)||"LI"!==t.target.tagName||((0,s.GC$)(f).removeClass(S),t.target.classList.add(S),o.OKt=t.target.textContent,o._Kt=t.target.value)}),(0,s.GC$)(m,this.Wc[0]).bind(T,function(t){var t,i,t,t=t.target.value;(0,s.GC$)(d).empty(),o.bbt=void 0,o.kKt=parseInt(t,10),-1<["4","7","8","9","10","11","12","13"].indexOf(t)?((0,s.GC$)(p).removeClass(x),0<(0,s.GC$)(".pivot-field-content-base-field-item").length&&((0,s.GC$)(".pivot-field-content-base-field-item")[0].classList.add(S),i=o.RKt[0].Zc,o.jKt=i,-1<["4","8","9"].indexOf(t))&&((0,s.GC$)(d).removeClass(x),(t=a([],o.dh.Kz(i),!0)).unshift(c().BaseItemNext),t.unshift(c().BaseItemPrevious),t.forEach(function(t,i){var n=document.createElement("li");n.className=v,0===(n.value=i)&&(n.classList.add(S),o._Kt=0),n.innerText=t,(0,s.GC$)(d)[0].appendChild(n)}))):((0,s.GC$)(d).addClass(x),(0,s.GC$)(p).addClass(x),(0,s.GC$)(l).removeClass(S),(0,s.GC$)(f).removeClass(S))}),(0,s.GC$)(b,this.Wc[0]).bind(I,function(){var t=W(o);o.DKt=t.Xc()})},F.prototype.KX=function(){(0,s.GC$)(y).unbind(I),(0,s.GC$)(p).unbind(I),(0,s.GC$)(d).unbind(I),(0,s.GC$)(m).unbind(T),(0,s.GC$)(b).unbind(I)},F.prototype.lQ=function(){this.KX(),U.prototype.lQ.call(this)},t.PivotValuesFieldSettingDialog=F,n(P,Q=e),P.prototype.TKt=function(){this.SKt()},P.prototype.GKt=r,P.prototype.VKt=function(){return'\n        <div class="field-settings-layout-container">\n                <span class="gc-sjs-field-settings-layout-style">'.concat(c().Layout,'</span>\n                <div class="gc-sjs-field-settings-layout-line"></div>\n                <div class="gc-sjs-field-settings-layout-showNoData-container">\n                    <input type="checkbox" ').concat(this.xKt?"checked":""," class=").concat(A,'>\n                    <span class="gc-sjs-field-settings-layout-showNoData-label">').concat(c().showNoData,'</span>\n                </div>\n                <div class="gc-sjs-field-settings-layout-showNoData-container">\n                    <input type="checkbox" ').concat(this.Ppi===E.PivotTableLayoutType.tabular?"disabled":""," ").concat(this.Opi?"checked":""," class=").concat(N,'>\n                    <span class="gc-sjs-field-settings-layout-showNoData-label">').concat(c().showSubtotalTop,"</span>\n                </div>\n        </div>")},P.prototype.SKt=function(){var t=this.VKt();this.wKt.push('\n            <div class="pivot-field-summarize-area">\n                '.concat(t,"\n            </div>\n        "))},P.prototype.Fz=function(){var i=this;(0,s.GC$)(y,this.Wc[0]).bind(I,function(){i.lQ()}),(0,s.GC$)(w,this.Wc[0]).bind(I,function(){i.lQ()}),(0,s.GC$)(C,this.Wc[0]).bind(T,function(){i.k1=!0,i.rYt=(0,s.GC$)(this).val()}),(0,s.GC$)("."+A,this.Wc[0]).bind(I,function(){i.xKt=this.checked}),(0,s.GC$)("."+N,this.Wc[0]).bind(I,function(){i.Opi=this.checked}),(0,s.GC$)(b,this.Wc[0]).bind(I,function(){var t=W(i);i.DKt=t.Xc()}),(0,s.GC$)(g,this.Wc[0]).bind(I,function(){i.dh.wVt({cmd:"UpdatePivotFieldCmd",sheetName:"",cmdOption:{pivotName:i.Vqt,oldFieldName:i.CKt,fieldName:i.rYt,showNoData:i.xKt,showSubtotalTop:i.Opi},formatter:i.bbt}),i.bbt="",i.lQ()})},P.prototype.KX=function(){(0,s.GC$)(y).unbind(I),(0,s.GC$)(w).unbind(I),(0,s.GC$)(C).unbind(T),(0,s.GC$)(b).unbind(I),(0,s.GC$)(g).unbind(I)},P.prototype.lQ=function(){this.KX(),Q.prototype.lQ.call(this)},t.PivotDimFieldSettingDialog=P},"./dist/plugins/pivot/pivot-ui/pivot-field-setting-number-format-dialog.js":function(t,i,n){"use strict";var e,o,r,a,n,a,s,u,c,l,f,h,v,d,p,m,b;function g(t,i,n,e){var r=b.call(this,null,1e4)||this;return r.Pc=!0,r.A0=n,r.I0=i,r.UKt=t,r.bbt=e,r.pKt(),r}e=this&&this.__extends||(m=function(t,i){return(m=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}m(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PivotFieldSettingNumberFormatDialog=void 0,o=n("Core"),r=o.mt.En,a=n("@spreadjs/js-sheets-common"),n=n("./dist/plugins/pivot/pivot.ns.js"),a=new a.Common.ResourceManager(n.SR,"PivotTables"),s=a.getResource.bind(a),u=".pivot-field-number-format-show-value",c=".pivot-field-number-format-sample-value",l=o.mt.St,f=null,h=void 0,v="click",d="active",b=o.zc,e(g,b),g.prototype.Eot=function(){this.Wc.css(["position","left","top"],["absolute",this.I0,this.A0])},g.prototype.eG=function(){this.UKt=f,this.bbt=h},g.prototype.lQ=function(){this.KX(),this.eG(),b.prototype.close.call(this)},g.prototype.KX=function(){(0,o.GC$)(".pivot-field-content-number-format-item").unbind(v),(0,o.GC$)(".pivot-field-setting-number-format-control-ok").unbind(v),(0,o.GC$)(".gc-filter-dialog-close",this.Wc[0]).unbind(v),(0,o.GC$)(".pivot-field-setting-number-format-control-cancel").unbind(v),(0,o.GC$)(u).unbind(v)},g.prototype.$c=function(){b.prototype.$c.call(this),this.QKt(),this.Fz(),this.Eot()},g.prototype.Fz=function(){var n=this;(0,o.GC$)(".pivot-field-content-number-format-item",this.Wc[0]).bind(v,function(t){(0,o.GC$)(".pivot-field-content-number-format-item.active").removeClass(d),this.classList.add(d),(0,o.GC$)(u)[0].value=this.innerText,l(this.innerText)||((0,o.GC$)(c)[0].value=o.Be.Re(12345,this.innerText))}),(0,o.GC$)(".pivot-field-setting-number-format-control-ok",this.Wc[0]).bind(v,function(){var t,i,t=(0,o.GC$)(u)[0].value,i=s().CustomFormats;i.indexOf(t)<0&&i.push(t),n.UKt.bbt=(0,o.GC$)(u)[0].value,n.lQ()}),(0,o.GC$)(".gc-filter-dialog-close",this.Wc[0]).bind(v,function(){n.lQ()}),(0,o.GC$)(".pivot-field-setting-number-format-control-cancel",this.Wc[0]).bind(v,function(){n.lQ()}),(0,o.GC$)(u,this.Wc[0]).bind("input",function(){if(!l(this.value))try{(0,o.GC$)(c)[0].value=o.Be.Re(12345,this.value)}catch(t){}})},g.prototype.pKt=function(){var t=(0,o.GC$)(r("div"));t.addClass("gc-pivot-field-setting-wrapper gc-popup ui-widget gc-filter-dialog-style"),t[0].innerHTML=this.WKt()+'<div class="gc-pivot-field-setting-content">'+this.zKt()+"</div>"+this.ZKt(),this.Wc.append(t)},g.prototype.WKt=function(){return'<div style="width: 100%; height: 34px; background-color: rgb(255, 255, 255); padding: 0px 0px 0px 12px; box-sizing: border-box;"><span style="float: left; height: 34px; line-height: 34px; display: inline-block;">'.concat(s().FormatCells,'</span>\n        <span class="gc-filter-dialog-close gc-pivot-dialog-close" style="float: right; height: 34px; line-height: 30px; display: inline-block; font-size: 28px; width: 54px; text-align: center;">\xd7</span></div>')},g.prototype.ZKt=function(){return'<div class="pivot-field-setting-footer">\n        <div class="pivot-field-setting-control-wrap"><input class= "pivot-field-setting-control pivot-field-setting-number-format-control-ok" type ="button" value= "'.concat(s().Ok,'">\n            <input class= "pivot-field-setting-control pivot-field-setting-number-format-control-cancel" type ="button" value= "').concat(s().Cancel,'">\n            </div>\n        </div>')},g.prototype.zKt=function(){var t=this.YKt();return'\n        <div class="pivot-field-number-format-area">\n            <div class="pivot-field-summarize-header">\n                <div style="margin-top: 6px" id="SummarizeValue" class="pivot-field-summarize-item active">'.concat(s().Number,"</div>\n            </div>\n            ").concat(t,"\n        </div>\n        ")},g.prototype.YKt=function(){return'\n            <div style="background: white; padding-bottom: 10px;" class="gc-pivot-field-setting-content">\n                <div class="pivot-field-summarize-area">\n                    <div class="pivot-field-show-value-as-content-header">'.concat(s().Sample,'</div>\n                    <input class="pivot-field-number-format-sample-value" value="12345" disabled="disabled" />\n                    <div class="pivot-field-show-value-as-content-header">').concat(s().Type,'</div>\n                    <input class="pivot-field-number-format-show-value" />\n                    <ul class="pivot-field-number-format-content-list">\n                    </ul>\n                </div>\n            </div>\n        ')},g.prototype.QKt=function(){var t,e,r,t=s().CustomFormats,e=this;e.bbt&&t.indexOf(e.bbt)<0&&t.push(e.bbt),r=null,t.forEach(function(t,i){var n=document.createElement("li");n.className="pivot-field-content-number-format-item",n.value=i,n.innerText=t,e.bbt||0!==i?e.bbt===t&&(n.classList.add(d),(0,o.GC$)(u)[0].value=t,l(t)||((0,o.GC$)(c)[0].value=o.Be.Re(12345,t),r=n)):(n.classList.add(d),(0,o.GC$)(u)[0].value=t),(0,o.GC$)(".pivot-field-number-format-content-list")[0].appendChild(n)}),r&&r.scrollIntoView()},i.PivotFieldSettingNumberFormatDialog=g},"./dist/plugins/pivot/pivot-ui/pivot-filter-dialogs.js":function(L,t,i){"use strict";var E,n,B,v,R,d,i,G,s,V,o,e,U,r,Q,a,u,c,W,l,f,h,p,z,m,b,g,Z,w,y,Y,C,A,H,J,q,K,X,$,tt,it,nt,et,N,I,rt,T,S,x,M,ot,D,at,st,k,j,ut,ct,lt,O,ft,ht,vt,dt,pt,mt,bt,gt,wt,yt,_;function F(){}function P(t,i,n,e){var t=_.call(this,t,1e3)||this;return t.jTe=v.DialogFeatureType.filter,t.dh=i,t.Vqt=n,t.Zue=e,t}E=this&&this.__extends||(wt=function(t,i){return(wt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}wt(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.PivotFilterDialog=void 0,n=i("@spreadjs/js-sheets-common"),B=i("./dist/plugins/pivot/pivot.ns.js"),v=i("Core"),R=i("CellTypes"),d=i("Pivot"),i=new n.Common.ResourceManager(B.SR,"PivotTables"),G=n.Common.zf.j0,s=i.getResource.bind(i),V=v.mt.En,o=n.Common.$T,e=n.Common.zf,U="gc-Filter-list",r="gc-Filter-list-block",Q="gc-Filter-list-select-block",a="gc-Filter-list-icon",u="gc-Filter-list-link",c="gc-Filter-list-item",W="gc-Filter-list-link-arrow",l="gc-Filter-list-sort-item",h="item-hover",p="item-noHover",z="clear-filter-icon-default",m="clear-filter-icon",b="gc-Filter-list-span",g="filter-list-box",Z="filter-confirm",w="filter-dialog-confirm",y="filter-confirm-enable",Y="filter-bottom-line",C="filter-sort-icon-one",A="filter-sort-icon-two",H="filter-list-box-icon",J="filter-list-box-container",q="filter-search",K="filter-list-box-host",X="filter-search-input",$="filter-select-all-container",tt="filter-select-icon",it="filter-select-all-link",nt="filter-check-all-icon",et="filter-uncheck-all-icon",N="check-all",I="uncheck-all",rt=f="gc-Filter-list-icon-selected",T="select-class",S="ok-class",x="cancel-class",M="filter-sort",ot="filter-sort-dialog",D="filter-condition",at="gc-pivot-search-box",st="gc-pivot-search-box-input-container",k="gc-pivot-search-box-input",j="gc-pivot-search-box-icon",ut="gc-pivot-search-box-icon-background-clear",ct="gc-Filter-list-resizable",lt="gc-Filter-list-button-container",O=null,ft=void 0,ht="px",vt=function(){return{type:2,child:[{text:s().PivotPanel_Sort_A_Z,className:l+" "+M,iconClass:a+" "+C,commandName:"asc"},{text:s().PivotPanel_Sort_Z_A,className:l+" "+M,iconClass:a+" "+A,commandName:"desc"},{text:s().PivotPanel_Sort_More,className:l+" "+ot,iconClass:a}]}},dt=function(){return{type:3,child:[{text:s().PivotPanel_Filter_Clear,className:l+" "+D,iconClass:a+" "+z,commandName:"ClearFilter"},{text:s().PivotPanel_Filter_Label,className:l+" "+h+" "+D,iconClass:a,commandName:"LabelFilter",rightArrow:!0},{text:s().PivotPanel_Filter_Value,className:l+" "+h+" "+D,iconClass:a,commandName:"ValueFilter",rightArrow:!0}]}},pt=function(){return{type:5,child:[{text:s().Cancel,className:"".concat(w," ").concat(y),commandName:"Cancel"},{text:s().Ok,className:"".concat(w," ").concat(y),commandName:"OK"}]}},yt=mt={selectFields:1,1:"selectFields",sortArea:2,2:"sortArea",filters:3,3:"filters",listBox:4,4:"listBox",confirmButton:5,5:"confirmButton"},F.getData=function(t,i,n){return F.getDataModel(t,i,n)},F.getDataModel=function(t,i,n){var e=[];return 1&t&&e.push(F.getSelectData(n)),2&t&&e.push(F.getSortSData(n)),4&t&&e.push(F.getFilterData(n,i)),8&t&&e.push(F.getListBoxData(n)),16&t&&e.push(F.getConfirmData()),e},F.getSelectData=function(t){var i,n,i={type:1,child:[]};if(t.areaFieldName)for(n=0;n<t.areaFieldName.length;n++)i.child.push({text:""}),i.child[n].text=t.areaFieldName[n];return i},F.getSortSData=function(t){var i,t,i=v.GC$.extend(!0,{},vt());return t.fieldIsNumber&&(i.child[0].text=s().PivotPanel_Sort_Smallest_Largest,i.child[1].text=s().PivotPanel_Sort_Largest_Smallest),t.isColOrRow?(i.child[0].className+=" "+h,i.child[1].className+=" "+h,i.child[2].className+=" "+h):(i.child[0].className+=" "+p,i.child[1].className+=" "+p,i.child[2].className+=" "+p),(0,d.ht)(t.sortInfo)||(t=i.child[t.sortInfo],(0,d.ht)(t))||(~t.iconClass.indexOf(C)?t.iconClass=t.iconClass.replace(C,f):~t.iconClass.indexOf(A)&&(t.iconClass=t.iconClass.replace(A,f))),i},F.getFilterData=function(t,i){var n=v.GC$.extend(!0,{},dt());return n.child[0].text=n.child[0].text.replace("{0}",'"'.concat(i,'"')),t.hasLabelCondition||t.hasValueCondition||t.hasLabelManual?n.child[0].className+=" "+h:n.child[0].className+=" "+p,t.hasLabelCondition&&(n.child[1].iconClass+=" "+rt,n.child[0].iconClass=a+" "+m),t.isDateType&&(n.child[1].text=s().PivotPanel_Date_Filter),t.hasValueCondition&&(n.child[2].iconClass+=" "+rt,n.child[0].iconClass=a+" "+m),n},F.getListBoxData=function(t){var i={type:4,child:[]};return i.child=t.fields,i},F.updateListBoxData=function(t,i,n){var e,r;if(t&&0!==t.child.length){if(e=t.child,0===i)for(r=0;r<e.length;r++)e[r].status=n;else e[i].status=n;return t}},F.getConfirmData=function(){return v.GC$.extend(!0,{},pt())},bt=F,_=v.zc,E(P,_),P.prototype.init=function(t,i,n,e){this.c5(),this.rYt=i,this.HKt=t,this.u_=n,this.LEt=e,this.JKt=!1,this.qKt=0,this.KKt=!1,this.XKt="",_.prototype.Hc.call(this),this.dh.getFieldInfoByName(i)?e.isDateType=2===this.dh.getFieldInfoByName(i).W5:e.isDateType=2===this.dh.hr(i);var t=bt.getData(t,i,e);this.open(t,n)},P.prototype.c5=function(){this.Vv&&(this.Vv.L0(),this.Vv=null)},P.prototype.open=function(t,i){for(var n,e,e,r,o,i,e,e,n=this,r="",o=0;o<t.length;o++)switch(t[o].type){case 1:r+=this.renderSelectField(t[o]);break;case 2:r+=this.renderSort(t[o]);break;case 3:r+=this.renderFilters(t[o]);break;case 4:r+=this.renderListBox(t[o]);break;case 5:r+=this.renderConfirm(t[o])}(i=this.WX(i.x,i.y)).html(r),e=this.rf(),this.$c(),e&&window.gcGlobal.cf(),this.$Kt(),this.tpi=i.width(),this.ipi=i.height(),null!=(e=this.Zue)&&e.allowResize&&(i.addClass(ct),this.Wue=new v.Ose(i[0],function(){n.Vv.Cg(),n.Vv.repaint()},40)),null!=(e=this.Zue)&&e.keepDialogSize&&(e=this.dh.npi)&&(i.width(e.width),i.height(e.height)),this.epi(),this.if()},P.prototype.epi=function(){var t=this.Xc();t.css(["minWidth","minHeight"],[this.tpi+ht,this.ipi+ht]),this.ipi=t.height(),this.tpi=t.width()},P.prototype.WX=function(t,i){var n=this.Xc();return n.css(["left","top"],[t,i]),n.addClass(U),n},P.prototype.$c=function(){_.prototype.$c.call(this)},P.prototype.close=function(){var t,i,i=this.Xc();null==(t=this.Zue)||!t.keepDialogSize||this.ipi===i.height()&&this.tpi===i.width()||(this.dh.npi={width:i.width(),height:i.height()}),this.KX(),this.eG(),_.prototype.close.call(this)},P.prototype.eG=function(){this.Wue&&this.Wue.disconnect(),this.Wue=O,this.tXt=O,this.iXt=O,this.dh=O,this.u_=O,this.LEt=O,this.Vv=O},P.prototype.aY=function(o){var a,s,a=this,s=this;o.bind(v.Events.CellClick,function(t,i){var n,e,n,n=a.tXt,e=i.sheet;e.Oi&&e.aR("transparent"),i.row>=n.length||(0===i.row?(s.KKt=!s.KKt,e.setValue(0,0,s.KKt)):(n=e.getValue(i.row,0),e.setValue(i.row,0,!n),n?s.qKt--:s.qKt++),s.nXt())}),o.bind(v.Events.TouchToolStripOpening,function(t,i){i.handled=!0}),o.bind(v.Events.ButtonClicked,function(t,i){var n,e,n,n=a.tXt,e=i.sheet;i.row>=n.length||(0===i.row?(s.KKt=!s.KKt,e.setValue(0,0,s.KKt)):(n=e.getValue(i.row,0),e.setValue(i.row,0,!n),n?s.qKt--:s.qKt++),s.nXt())}),(0,v.GC$)("."+N).bind("click",function(t){var i,n,e,r,i=a.tXt,n=o&&(0,v.jf)(o);if(!(i.length<=0)){if(n){for(n.suspendPaint(),e=0,r=1;r<i.length;r++)n.getRowVisible(r)&&(n.setValue(r,0,!0),e++);n.resumePaint(),s.qKt=e}(0,v.GC$)("."+S).addClass(y)}}),(0,v.GC$)("."+I).bind("click",function(t){var i,n,e,i=a.tXt,n=o&&(0,v.jf)(o);if(!(i.length<=0)){if(n){for(n.suspendPaint(),e=1;e<i.length;e++)n.getRowVisible(e)&&n.setValue(e,0,!1);n.resumePaint(),s.qKt=0}(0,v.GC$)("."+S).removeClass(y)}}),(0,v.GC$)("."+T).bind("change",function(t){var i,n,e,r,o,i=this.options[this.selectedIndex].value,n=s.dh,e=s.Vqt,r=s.u_,o=s.HKt;n.wVt({cmd:"updateListBox",sheetName:"",cmdOption:{fieldName:i,pivotName:e,configurationNumber:o,position:r,filterDialog:s}})}),(0,v.GC$)("."+S).bind("click",function(t){var i,n,e,r;(0,v.GC$)(this).hasClass(y)&&(i=s.rYt,n=s.dh,e=s.Vqt,r=s.eXt(),n.wVt({cmd:"filterFieldLabelValue",sheetName:"",cmdOption:{fieldName:i,pivotName:e,dataOfListBox:r}}),s.close())}),(0,v.GC$)("."+x).bind("click",function(t){s.close()}),(0,v.GC$)("."+M).bind("click",function(t){var i,n,e,r;(0,v.GC$)(this).hasClass(p)||(i=(0,v.GC$)(this).attr("command"),n=s.dh,e=s.rYt,r=s.Vqt,n.wVt({cmd:"pivotSort",sheetName:"",cmdOption:{fieldName:e,pivotName:r,commandName:i}}),s.close())}),(0,v.GC$)("."+ot).bind("click",function(t){var i,n,e;(0,v.GC$)(this).hasClass(p)||(i=s.dh,n=s.rYt,e=s.Vqt,s.close(),i.wVt({cmd:"createDialogForPivotSort",sheetName:"",cmdOption:{fieldName:n,pivotName:e}}))}),(0,v.GC$)("."+D).bind("click",function(t){var i,n,e,r,i=(0,v.GC$)(this).attr("command");(0,v.GC$)(this).hasClass(p)||"ClearFilter"!==i||(n=s.dh,e=s.rYt,r=s.Vqt,n.wVt({cmd:"ClearCommand",sheetName:"",cmdOption:{fieldName:e,pivotName:r,commandName:i,clearType:0}}),s.close())}),(0,v.GC$)("."+D).bind("mouseenter",function(t){var i,n,i,e,r,o,a,i=(0,v.GC$)(this),n=i.attr("command");i.hasClass(p)||"ClearFilter"===i.attr("command")||(i=s.dh,e=s.rYt,r=s.Vqt,a={x:s.u_.x,y:s.u_.y},i.wVt({cmd:"createFilterSecondaryMenu",sheetName:"",cmdOption:{fieldName:e,pivotName:r,commandName:n,host:o=this,position:a,filterDialog:s}}))}),(0,v.GC$)("."+k).bind("input",function(t){s.JKt=!0,s.XKt=this.value.toLocaleLowerCase(),s.rXt()}),(0,v.GC$)("."+j).bind("click",function(t){(0,v.GC$)("."+k).val(""),s.JKt=!1,s.XKt="",s.rXt()})},P.prototype.KX=function(){(0,v.GC$)("."+N).unbind("click"),(0,v.GC$)("."+I).unbind("click"),(0,v.GC$)("."+T).unbind("change"),(0,v.GC$)("."+S).unbind("click"),(0,v.GC$)("."+x).unbind("click"),(0,v.GC$)("."+M).unbind("click"),(0,v.GC$)("."+D).unbind("click"),(0,v.GC$)("."+D).unbind("mouseenter"),(0,v.GC$)("."+X).unbind("change"),(0,v.GC$)("."+k).unbind("input"),(0,v.GC$)("."+j).unbind("click")},P.prototype.renderSelectField=function(t){for(var i,n,i='<select class="'.concat(T,'" style="width:100%">'),n=0;n<t.child.length;n++)i+=this.renderDropDown(t.child[n].text);return"<div class='".concat(Q,"'>\n                    <div class='").concat(c,"'>\n                    ").concat(s().Select_Field,"\n                    </div>\n                    <div class='").concat(c,"'>\n                        ").concat(i,"\n                        </select>\n                    </div>\n                </div>")},P.prototype.renderSort=function(t){for(var i,n,i="",n=0;n<t.child.length;n++)i+=this.createItem(t.child[n]);return'<div class="'.concat(r,'">\n                    ').concat(i,'\n                    <div class="').concat(b,'"></div>\n                </div>')},P.prototype.renderFilters=function(t){for(var i,n,i="",n=0;n<t.child.length;n++)i+=this.createItem(t.child[n]);return'<div class="'.concat(r,'">\n                    ').concat(i,'\n                    <div class="').concat(b,'"></div>\n                </div>')},P.prototype.renderListBox=function(t){var i,n,e,t,r;for(this.iXt=J,this.tXt=t.child,i="",n=t.child,e=0;e<n.length;e++)if(!1===n[e].status){i=f+" "+a;break}return t=this.oXt(),r=this.aXt(),'<div class="'.concat(g,'">\n                    ').concat(t,"\n                    ").concat(r,'\n                    <div class="').concat(K,'">\n                    <div class="').concat(H,'">\n                        <div class="').concat(i,'"></div>\n                    </div>\n                    <div class="').concat(J,'"></div>\n                    </div>\n                <div>')},P.prototype.renderConfirm=function(t){return'<div class="'.concat(r,'">\n                    <div class="').concat(l," ").concat(lt,'">\n                        <div class="').concat(t.child[0].className+" "+x,'" command="').concat(t.child[0].commandName,'">').concat(t.child[0].text,'</div>\n                        <div class="').concat(t.child[1].className+" "+S,'" command="').concat(t.child[1].commandName,'">').concat(t.child[1].text,"</div>\n                    </div>\n                </div>")},P.prototype.renderDropDown=function(t){return t=G(t),"<option>".concat(t,"</option>")},P.prototype.createItem=function(t){return t.rightArrow?'<div class="'.concat(t.className,'" command="').concat(t.commandName,'">\n                        <div class="').concat(t.iconClass,'"></div>\n                        <div class="').concat(u,'">').concat(e.j0(t.text),'</div>\n                        <div class="').concat(W,'"></div>\n                    </div>'):'<div class="'.concat(t.className,'" command="').concat(t.commandName,'">\n                        <div class="').concat(t.iconClass,'"></div>\n                        <div class="').concat(u,'">').concat(e.j0(t.text),"</div>\n                    </div>")},P.prototype.$Kt=function(t){var i,i,n,e,r,e;t=t||this.tXt,i=this.iXt,(i=new v.Workbook(document.getElementsByClassName(i)[0],{sheetCount:1})).xU=!0,i.options.scrollByPixel=!0,n=(this.Vv=i).sheets[0],i.suspendEvent(),n.suspendPaint(),e=i.options,r=n.options,e.allowContextMenu=!1,e.showHorizontalScrollbar=!1,e.showVerticalScrollbar=!1,e.scrollbarMaxAlign=!0,e.tabStripVisible=!1,e.allowUserResize=!1,e.allowUserDragDrop=!1,e.allowUserDragFill=!1,e.allowUserZoom=!1,e.grayAreaBackColor="white",r.colHeaderVisible=!1,r.rowHeaderVisible=!1,r.selectionBackColor="transparent",r.selectionBorderColor="transparent",r.gridline={showVerticalGridline:!1,showHorizontalGridline:!1},r.isProtected=!0,n.defaults.rowHeight=21,n.defaults.colWidth=23,t.unshift({value:s().AddSearchResult,status:this.KKt,text:s().AddSearchResult}),this.sXt(),n.resumePaint(),i.resumeEvent(),this.aY(i),(e=(0,v.GC$)("."+g)).css("height","calc(100% - ".concat(this.Wc.height()-e.height(),"px)"))},P.prototype.uXt=function(){var t,i,n,t,t=this,i=t.Vv,n=t.qKt,t=t.JKt;(0,d.ht)(i)||(t&&n++,i.options.showVerticalScrollbar=8<n)},P.prototype.tst=function(t){var i,n,e,i,r,o,a,i=this,n=i.Vv,e=i.qKt,i=i.JKt;(0,d.ht)(n)||(r=(0,v.jf)(n),a=170,(o=n.options.showVerticalScrollbar)&&(a-=20),a<(t=i&&e&&t<v.q.Wt(s().AddSearchResult)?v.q.Wt(s().AddSearchResult):t)?(n.options.showHorizontalScrollbar=!0,r.autoFitColumn(1)):(n.options.showHorizontalScrollbar=!1,r.setColumnWidth(1,500)))},P.prototype.eXt=function(){var t,i,n,e,t,r,o,a,s,u,c,l,f,h,t=this,i=t.JKt,n=t.KKt,e=t.tXt,t=t.Vv,r=t&&(0,v.jf)(t),o={},a=!0;if(!(0,d.ht)(r)){if(i)if(n){for(u=1;u<e.length;u++)r.getRowVisible(u)&&((s=r.getValue(u,0))&&(a=!1),o[u]=e[u].status,e[u].status=s);if(a)for(l=0,f=c=Object.keys(o);l<f.length;l++)e[h=f[l]].status=o[h]}else for(u=1;u<e.length;u++)r.getRowVisible(u)&&r.getValue(u,0)?e[u].status=!0:e[u].status=!1;else for(u=1;u<e.length;u++)r.getValue(u,0)?e[u].status=!0:e[u].status=!1;e.shift()}return e},P.prototype.nXt=function(){var t=this;t.KKt||t.qKt?(0,v.GC$)("."+S).addClass(y):(0,v.GC$)("."+S).removeClass(y)},P.prototype.rXt=function(){var t,i,n,n,e,r,o,a,s,t=this,i=t.tXt,n=t.XKt;if(t.cXt(),(0,d.ht)(n)||n.length<1)t.JKt=!1,t.sXt();else if(e=(n=t.Vv)&&(0,v.jf)(n)){for(e.suspendPaint(),e.setRowVisible(0,!0),r=void(t.qKt=0),o=0,a=t.lXt(),s=1;s<i.length;s++)(r=i[s]).text&&a(r.text)?(e.setRowVisible(s,!0),e.setValue(s,0,!0),t.qKt++,o=r.textLength>o?r.textLength:o):e.setRowVisible(s,!1);0===t.qKt&&e.setRowVisible(0,!1),t.uXt(),t.tst(o),e.resumePaint()}},P.prototype.lXt=function(){var t,i,n,e,r,t,i=this.XKt,n=o.jJ(i);return n?(e=o.OJ(n),function(t){return r=e.exec(t),e.lastIndex=0,r&&0===r.index}):function(t){return-1<t.toLocaleLowerCase().indexOf(i)}},P.prototype.cXt=function(){var t,i,n,t,i=this.XKt,n=(0,v.GC$)("."+j);i?n.css("display","block"):n.css("display","none")},P.prototype.sXt=function(){var t,i,n,e,r,o,a,s,i,t=this,i=t.Vv,n=i&&(0,v.jf)(i),e=t.tXt,r=v.GC$.extend(!0,[],e);for(n.suspendPaint(),t.qKt=0,n.setRowVisible(0,!1),o=0,s=1;s<r.length;s++)(a=r[s]).status&&t.qKt++,n.setRowVisible(s,!0),(0,d.ht)(a.textLength)&&(e[s].textLength=v.q.Wt(a.text)),o=a.textLength>o?a.textLength:o;n.setDataSource(r),n.bindColumns([{name:"status",cellType:new R.CheckBox},{name:"text"}]),(i=n.getActualStyle(-1,2)).hAlign=0,n.setStyle(-1,2,i),t.uXt(),t.tst(o),n.resumePaint()},P.prototype.oXt=function(){return"<div class = '".concat(at,"'>\n            <div class = '").concat(st,"'>\n                <input class = '").concat(k,"' placeholder=\"").concat(s().search,"\"/>\n                <div class = '").concat(j,"'>\n                    <div class = '").concat(ut,"'></div>\n                </div>\n            </div>\n        </div>")},P.prototype.aXt=function(){var t=tt+" "+nt,i=tt+" "+et,n=it+" "+N,e=it+" "+I;return'<div class="'.concat($,'">\n                    <a class="').concat(n,'">\n                        <span class="').concat(t,'"></span>\n                        <span>').concat(s().PivotPanel_Filter_SelectAll,'</span>\n                    </a>\n                    <a class="').concat(e,'">\n                        <span class="').concat(i,'"></span>\n                        <span>').concat(s().PivotPanel_Filter_NoSelectAll,"</span>\n                    </a>\n                </div>")},P.prototype.if=function(){var t,i,i,n,e,r,o,a,s,u,c,u,l,t=(0,v.GC$)(this.Wc[0]),i=this.qc();0===t.length||(i=(0,v.GC$)(i).offset(),n=parseInt(t.css("left"),10)+i.left,e=parseInt(t.css("top"),10)+i.top,r=t.width(),o=t.height(),isNaN(n))||isNaN(e)||isNaN(r)||isNaN(o)||(s=a=0,c=(u=document.documentElement).clientWidth,u=u.clientHeight,(l=t[0].getBoundingClientRect()).left+r>c&&(s=l.left+r-c),l.top+o>u&&(a=l.top+o-u),(n<0||e<0||0<a||0<s)&&t.css({left:(n=(n-=s)<0?0:n)-i.left+"px",top:(e=(e-=a)<0?0:e)-i.top+"px"}))},t.PivotFilterDialog=P},"./dist/plugins/pivot/pivot-ui/pivot-number-group-dialog.js":function(t,i,n){"use strict";var e,s,r,o,u,n,a,c,l,f,h,v,d,p,m,b,g,w,y,C,A,N;function I(t,i,n,e,r,o,a,s,u){var t=N.call(this,t,0,!0)||this;return t.cKt=i,t.rYt=n,t.dh=e,t.T=o||0,t.lKt=r,t.fKt=r===t.T,t.gd=s||0,t.hKt=a,t.vKt=a===t.gd,t.fXt=u,t.uf(),t}e=this&&this.__extends||(A=function(t,i){return(A=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}A(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PivotNumberGroupDialog=void 0,s=n("Core"),r=n("@spreadjs/js-sheets-common"),o=n("./dist/plugins/pivot/pivot.ns.js"),u=n("Pivot"),n=new r.Common.ResourceManager(o.SR,"PivotTables"),a=n.getResource.bind(n),c=r.Common.zf,l=s.mt.En,f="cancel-icon",h="cancel-class",v="ok-label",d="filter-confirm",p="number-group-startingAt-isActive",m="number-group-startingAt-value",b="number-group-endingAt-isActive",g="number-group-endingAt-value",w="number-group-by-value",y="number-group-dialog-sub-container",N=s.zc,e(I,N),I.prototype.$c=function(){this.pKt(),N.prototype.$c.call(this),this.Eot(),this.Fz()},I.prototype.pKt=function(){var t=(0,s.GC$)(l("div"));t[0].innerHTML=this.mKt(),this.Wc.append(t)},I.prototype.Fz=function(){var a=this;(0,s.GC$)("."+h).bind("click",function(t){a.lQ()}),(0,s.GC$)("."+v).bind("click",function(t){var i,n,e,r,o,i=a.cKt,n=a.rYt,e=parseInt((0,s.GC$)("."+m).val().trim(),10),r=parseInt((0,s.GC$)("."+g).val().trim(),10),o=parseInt((0,s.GC$)("."+w).val().trim(),10);a.dh.wVt({cmd:"pivotTableGroup",cmdOption:{dataType:u.PivotDataType.number,fieldName:n,pivotName:i,startingAtValue:e,endingAtValue:r,groupByValue:o}}),a.lQ()}),(0,s.GC$)("."+m).bind("change",function(t){(a.fKt=!1,s.GC$)("."+p)[0].checked=!1}),(0,s.GC$)("."+g).bind("change",function(t){(a.vKt=!1,s.GC$)("."+b)[0].checked=!1}),(0,s.GC$)("."+p).bind("click",function(t){this.checked&&(0,s.GC$)("."+m).val(a.lKt)}),(0,s.GC$)("."+b).bind("click",function(t){this.checked&&(0,s.GC$)("."+g).val(a.hKt)})},I.prototype.mKt=function(){return'<div class="number-group-dialog-container">\n                 <div class="number-group-dialog-header">\n                     <span class="date-group-dialog-header-title">'.concat(a().grouping,'</span>\n                      <span class="').concat(h+" "+f,'">\xd7</span>\n                  </div>\n                  <div class="number-group-dialog-content">\n                        <div class="number-group-dialog-content-header">\n                            <span>').concat(a().auto,'</span>\n                            <span class="number-group--header-horizontal-line"></span>\n                        </div>\n                        <div class="').concat(y,'">\n                            <input type="checkbox" class="').concat(p,'" ').concat(this.fKt?"checked":"unchecked",">\n                            <span>").concat(a().startingAt,'</span>\n                            <input class="').concat(m,'" value = ').concat(this.T,'></input>\n                        </div>\n                        <div class="').concat(y,'">\n                            <input type="checkbox" class="').concat(b,'" ').concat(this.fKt?"checked":"unchecked",">\n                            <span>").concat(a().endingAt,'</span>\n                            <input class="').concat(g,'" value = ').concat(this.gd,'></input>\n                        </div>\n                        <div class="').concat(y,'">\n                            <span style = "margin-left: 24px">').concat(a().groupBy,'</span>\n                            <input class="').concat(w,'" value= ').concat(this.fXt,'></input>\n                        </div>\n                        <div class="number-group-dialog-bottom-confirm">\n                            <span class="').concat(h+" "+d,'">').concat(a().Cancel,'</span>\n                            <span class="').concat(v+" "+d,'">').concat(a().Ok,"</span>\n                        </div>\n                    </div>\n                </div>")},I.prototype.Eot=function(){var t=this,i=t.Wc.width(),n=t.Wc.height(),e=t.Fc.width(),t=t.Fc.height();this.Wc.css(["position","left","top","z-index"],["absolute",(e-i)/2+"px",(t-n)/2+"px",1001])},I.prototype.eG=function(){this.dh=null},I.prototype.KX=function(){(0,s.GC$)("."+h).unbind("click"),(0,s.GC$)("."+v).unbind("click")},I.prototype.lQ=function(){this.eG(),this.KX(),N.prototype.close.call(this)},i.PivotNumberGroupDialog=I},"./dist/plugins/pivot/pivot-ui/pivot-show-value-as-dialog.js":function(t,i,n){"use strict";var e,a,s,u,r,n,n,m,b,o,c,g,w,y,C,A,N,I,T,S,l,f,h,v,d;function p(t,i,n,e,r,o){var t,a,i,n,s,o,e,o,t=d.call(this,t,0,!0)||this;if(t.dh=i,t.rYt=n,t.Twt=o,t.Vqt=e,r){if(t.OJt=r.valueFieldName,a=void 0,i=t.dh.B,n=t.dh.R,4===r.menuArea)if(4===r.area){for(s=r.rowInfos&&r.rowInfos.length-1;0<=s;s--)if(r.rowInfos[s].fieldName!==b().sigmaValue){a=r.rowInfos[s];break}}else 3===r.area?(0===(o=r.activeRowFieldInfo&&r.activeRowFieldInfo.index)?o+=1:o===r.rowInfos&&r.rowInfos.length-1?o=r.rowInfos.length-2:o-=1,a=r.rowInfos[o]):2===r.area&&(o=e=void 0,i[0]?(e=i[0]&&i[0].Zc,o=i[0]._items[0].value):n[0]&&(e=n&&n[0].Zc,o=n[0]._items[0].value),a={fieldNameTemp:e,itemNameTemp:o});t.hXt=a.fieldName,t.vXt=a.itemName}return t.uf(),t.$c(),t}e=this&&this.__extends||(v=function(t,i){return(v=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}v(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),a=this&&this.__spreadArray||function(t,i,n){if(n||2===arguments.length)for(var e=0,r=i.length,o;e<r;e++)!o&&e in i||((o=o||Array.prototype.slice.call(i,0,e))[e]=i[e]);return t.concat(o||Array.prototype.slice.call(i))},Object.defineProperty(i,"__esModule",{value:!0}),i.PivotShowValueAsDialog=void 0,s=n("Core"),u=n("Pivot"),r=n("@spreadjs/js-sheets-common"),n=n("./dist/plugins/pivot/pivot.ns.js"),n=new r.Common.ResourceManager(n.SR,"PivotTables"),m=r.Common.zf.j0,b=n.getResource.bind(n),o=r.Common.zf,c=s.mt.En,g="show-value-as-dialog-container",w="show-value-as-dialog-header",y="show-value-as-dialog-content",C="cancel-icon",A="cancel-class",N="ok-label",I="filter-confirm",T="show-value-as-dialog-content-item",S="show-value-as-dialog-content-select",l=".baseFieldList",f=".baseFieldItem",d=s.zc,e(p,d),p.prototype.$c=function(){this.pKt(this.Twt,this.OJt,this.dXt()),d.prototype.$c.call(this),this.Eot(),this.Fz()},p.prototype.dXt=function(){return a(a([],this.dh.nw(1),!0),this.dh.nw(2),!0)},p.prototype.getBaseItemList=function(t){return a([],this.dh.Kz(t),!0)},p.prototype.pKt=function(t,i,n){var e=(0,s.GC$)(c("div"));e[0].innerHTML=this.mKt(t,i,n),this.Wc.append(e)},p.prototype.b0=function(t,i,n){var n=n?"selected":"";return'<option value="'.concat(i,'" ').concat(n,">").concat(m(t),"</option>")},p.prototype.Fz=function(){var o=this;(0,s.GC$)("."+A).bind("click",function(t){o.lQ()}),(0,s.GC$)("."+N).bind("click",function(t){var i,n,e,n,r,i=o.dh,n=(0,s.GC$)(l)[0],e=(0,s.GC$)(f)[0],n=n&&n.options[n.selectedIndex].text;e&&(r={index:e.selectedIndex,value:e.options[e.selectedIndex].text}),i.wVt({cmd:"UpdatePivotValueFieldCmd",sheetName:"",cmdOption:{showValueAsType:o.Twt,pivotName:o.Vqt,fieldName:o.rYt,baseField:n,baseItem:r}}),o.lQ()}),(0,s.GC$)(l).bind("change",function(t){var i,n,e,r;if(!(0,u.ht)((0,s.GC$)(f)[0])){for(i=(0,s.GC$)(this.options[this.selectedIndex]).text(),e="",(n=a([],o.dh.Kz(i),!0))&&0<n.length&&(n.unshift(b().BaseItemNext),n.unshift(b().BaseItemPrevious)),r=0;r<n.length;r++)e+=o.b0(n[r],r);(0,s.GC$)(f)[0].innerHTML=e}})},p.prototype.mKt=function(t,i,n){var e,r,o,a,s,u,c,l,f,h,v,d,p,a,e=[4,8,9],r="",o="",a=this.dh.getFieldInfoByName(this.OJt).Or;for(a&&(u=a.showDataAs,c=a.baseFieldName,l=a.baseFieldItem,f=a.baseFieldItemType),h=t===u&&c||this.hXt,v=0;v<n.length;v++)s=h===n[v].Zc,r+=this.b0(n[v].Zc,v,s);if((d=this.getBaseItemList(h))&&0<d.length)for(d.unshift(b().BaseItemNext),d.unshift(b().BaseItemPrevious),p=this.pXt(d,l,f),v=0;v<d.length;v++)o+=this.b0(d[v],v,p===v);return a=-1<e.indexOf(t)?' <div class="'.concat(T,'">\n                <span>').concat(b().BaseItemForDialog,'</span>\n                <select class="').concat(S,' baseFieldItem">').concat(o,"</select>\n               </div>"):"",'<div class="'.concat(g,'">\n                    <div class="').concat(w,'">\n                        <span>').concat(b().ShowValueAs+"("+m(i)+")",'</span>\n                        <span class="').concat(A+" "+C,'">\xd7</span>\n                    </div>\n                    <div class="').concat(y,'">\n                        <div>\n                            <span>').concat(b().CalculationForDialog,"</span>\n                            <span>").concat(b().showValueAsDialog[t],'</span>\n                        </div>\n\n                        <div class="').concat(T,'">\n                            <span>').concat(b().BaseFieldForDialog,'</span>\n                            <select class="').concat(S,' baseFieldList">').concat(r,"</select>\n                        </div>\n                        ").concat(a,'\n                        <div class="show-value-as-dialog-bottom-confirm">\n                            <span class="').concat(A+" "+I,'">').concat(b().Cancel,'</span>\n                            <span class="').concat(N+" "+I,'">').concat(b().Ok,"</span>\n                        </div>\n                    </div>\n                </div>")},p.prototype.pXt=function(t,i,n){var e,r,o,a,e,r=this.vXt;if(n===u.PivotShowDataAsBaseItemType.previous)return 0;if(n===u.PivotShowDataAsBaseItemType.next)return 1;if(!(o=0,u.ht)(i)||!(0,u.ht)(r))for(a=2;a<t.length;a++){if(i===t[a])return a;t[a]===r&&(o=a)}return o},p.prototype.Eot=function(){var t=this,i=t.Wc.width(),n=t.Wc.height(),e=t.Fc.width(),t=t.Fc.height();this.Wc.css(["position","left","top","z-index"],["absolute",(e-i)/2+"px",(t-n)/2+"px",1001])},p.prototype.eG=function(){this.dh=null},p.prototype.KX=function(){(0,s.GC$)("."+A).unbind("click"),(0,s.GC$)("."+N).unbind("click"),(0,s.GC$)(l).unbind("change")},p.prototype.lQ=function(){this.eG(),this.KX(),d.prototype.close.call(this)},i.PivotShowValueAsDialog=p},"./dist/plugins/pivot/pivot-ui/pivot-sort-dialog.js":function(L,t,i){"use strict";var n,h,E,B,R,G,V,U,Q,i,v,f,e,d,W,z,p,m,b,g,w,y,C,A,Z,N,Y,H,J,I,u,q,K,T,S,X,$,tt,x,M,D,c,l,k,j,it,nt,et,O,rt,ot,_,F,P,at,st,ut,ct,lt,ft,ht,vt,dt,pt,mt;function r(t,i,n,e,r){var o=vt.call(this,t,2e3,!0)||this;return o.Ise=function(){(0,h.GC$)(".rangeSelectFocusItem",o.Wc[0]).focus(),window.removeEventListener("mousemove",o.Sse),o.Mse=!1},o.spi=e,o.rYt=n,o.Mf=i,o.hce=r,o.$c(),o.uf(),o}function o(t,i,n,e,r){var t=dt.call(this,t,2e3,!0)||this;return t.cpi=e,t.dh=n,t.Mf=i,t.hce=r,t.LJt=n.z.filter(function(t){return t instanceof Q.PivotTable})[0],t.uf(),t.$c(),t}function a(t,i,n,e,r,o){var t,r,t=pt.call(this,t,2e3,!0)||this;return t.dh=n,t.rYt=e,t.Vqt=r,t.Mf=o,t.Xqt=i,(r=n.getSortInfo(e))&&r.sortValueFieldName?t.upi=r.sortValueFieldName:t.upi=e,t.nrt=r,t.uf(),t.$c(),t}function s(t,i,n,e,r){var t,n,i,r,t=mt.call(this,t,2e3,!0)||this;return t.LJt=n,t.lpi=e,t.Mf=i,t.fpi=!!r,r||(n=e.rowInfos,i=e.colInfos,r=v().sigmaValue,n&&1===n.length&&n[0].fieldName===r&&(t.fpi=!0),i&&1===i.length&&i[0].fieldName===r&&(t.fpi=!0)),t.uf(),t.$c(),t}function bt(t,i){var n,e;t&&0<t.length&&((n=t.some(function(t){return t.isGrandTotal}))||(-1!==(e=t.findIndex(function(t){return t.fieldName===v().sigmaValue}))&&(i.sortValueFieldName=t[e].itemName,t.splice(e,1)),i.sortByPivotReferences=t.map(function(t){return{fieldName:t.fieldName,items:[t.itemName]}})))}function gt(t,i,n){var e,r,n,o,a,t,n=3===t.options.grandTotalPosition||t.options.grandTotalPosition===n,o,a=t.rZt.HWt[4].getRange(),t=t.getRange().content;return n?i?(e=t.row+a.row,r=t.col+a.col+a.colCount-1):(r=t.col+a.col,e=t.row+a.row+a.rowCount-1):(e=t.row+a.row,r=t.col+a.col),{resultRow:e,resultCol:r}}n=this&&this.__extends||(ht=function(t,i){return(ht=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}ht(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(t,"__esModule",{value:!0}),t.SortValueDialog=t.SortFieldDialog=void 0,h=i("Core"),E=i("@spreadjs/js-sheets-common"),B=i("FormulaTextBox"),R=i("SheetsCalc"),G=i("./dist/plugins/pivot/pivot.ns.js"),V=i("Pivot"),U=i("./dist/plugins/pivot/pivot-ui/filter-dialog.js"),Q=i("./dist/plugins/pivot/pivot-table/pivot-table.js"),i=new E.Common.ResourceManager(G.SR,"PivotTables"),v=i.getResource.bind(i),f=E.Common.zf.j0,e=null,d=void 0,W=R.formulaToRanges,z=R.rangeToFormula,p="label-title",m="cancel-icon",b="cancel-class",g="label-show",w="split-line",y="ok-label",C="filter-confirm",A="confirm-class",Z="gc-pivot-sort-dialog-container",N="gc-sort-dialog-title",Y="gc-sort-dialog-body",H="gc-sort-more-options",J="gc-sort-close-dialog",I="gc-sort-summary",u="gc-sort-select",q="gc-sort-range-select",K="gc-sort-range-selector",T="gc-sort-range-input",S="gc-sort-disabled",X="gc-sort-range-select-button",$="gc-sort-range-select-container",tt="gc-sort-range-select-body",x="gc-pivot-sort-option",M="gc-pivot-sort-options-asc",D="gc-pivot-sort-options-desc",c="gc-pivot-sort-label-asc",l="gc-pivot-sort-label-desc",k="gc-pivot-sort-by-total",j="gc-pivot-sort-by-value",it="gc-pivot-sort-value-dialog-container",nt="gc-sort-value-dialog-body",et="gc-pivot-sort-half-split-area",O="gc-pivot-sort-direction-top-to-bottom",rt="gc-pivot-sort-direction-left-to-right",ot="gc-pivot-sort-direction",_="{{FIELD_NAME}}",F="{{SELECTED_FIELD_NAME}}",P="{{ORDER}}",at="{{ROW_COLUMN}}",st="{{AREA}}",vt=h.Ase,n(r,vt),r.prototype.$c=function(){var t=this;t.Wc.html(this.tKt()),vt.prototype.$c.call(this),t.lgi(),t.Eot(),t.aY()},r.prototype.Eot=function(){var t=this,i=t.Wc.width(),n=t.Wc.height(),e=t.Fc.width(),t=t.Fc.height();this.Wc.css(["position","left","top"],["absolute",(e-i)/2+"px",(t-n)/2+"px"])},r.prototype.lQ=function(){this.KX(),this.eG(),vt.prototype.close.call(this),this.hpi()},r.prototype.eG=function(){var t;this.vpi&&(this.vpi.endSelectMode(),this.vpi.workbook(e),this.vpi=e,this.Mf.parent.setActiveSheetIndex(this.dpi)),this.dpi=e,this.Ti=e,this.Mf=e},r.prototype.tKt=function(){var t,i,t,i=f(this.rYt);return'\n            <div class="'.concat($,'">\n                <div class="').concat(N,'">\n                    <span class="').concat(p,'">').concat(v().Sort_Field_Dialog_Title+" ("+i+")",'</span>\n                    <span class="').concat(b+" "+m,'">\xd7</span>\n                </div>\n                <div class="').concat(tt,'">\n                    <div class="').concat(A,'">\n                        <div class=').concat(K,"></div>\n                    </div>\n                </div>\n            </div>")},r.prototype.aY=function(){var i=this;(0,h.GC$)("."+b,i.Wc[0]).bind("click",function(t){i.lQ()}),i.bindMoveEvent((0,h.GC$)("."+N,i.Wc[0])[0])},r.prototype.KX=function(){var t=this;(0,h.GC$)("."+b,t.Wc[0]).unbind("click"),t.Mf.parent.unbind("RangeSelectEnding",t.ppi),window.removeEventListener("keydown",t.mpi,!0)},r.prototype.bpi=function(t){var i,n;return 1<t.length&&"="===(i=t.slice(0,1))&&(n=t.slice(1,t.length),isFinite(n))?n:t},r.prototype.mpi=function(t){"Enter"!==t.key&&"Escape"!==t.key||(this.spi=this.bpi(this.vpi.text()),this.lQ())},r.prototype.ppi=function(){this.spi=this.bpi(this.vpi.text()),this.lQ()},r.prototype.lgi=function(){var t,i,n,t=this,i=t.Mf.parent;t.dpi=i.getActiveSheetIndex(),n=(0,h.GC$)("."+K)[0],t.vpi=new B.FormulaTextBox(n,{rangeSelectMode:!0,absoluteReference:!0,needSheetName:!0},i),t.ppi=t.ppi.bind(t),i.bind("RangeSelectEnding",t,t.ppi),t.mpi=t.mpi.bind(t),window.addEventListener("keydown",t.mpi,!0),t.vpi.workbook(i),t.vpi.startSelectMode(t.spi),(0,h.GC$)("div[gcuielement$='gcAttachedFormulaTextBox']",n)[0].classList.add("rangeSelectFocusItem")},r.prototype.hpi=function(){var t=this;t.hce(t.spi)},ut=r,dt=U.opi,n(o,dt),o.prototype.$c=function(){var t=this;dt.prototype.$c.call(this),t.gpi(),t.wpi()},o.prototype.eG=function(){this.cpi=d,this.dh=d,this.LJt=d,this.spi=d,this.Mf=e,this.nrt=d,this.Ti=e},o.prototype.tKt=function(){var t,i,n,e,r,o,a,t,s,r,s,n,t=this,i=v(),n=t.cpi,e=f(n.fieldName),r=t.dh,o,a=1===r.Z[e]?i.Sort_In_Column:i.Sort_In_Row,t=t.spi||"",s=n.selectedFieldName,r=3===r.Z[s],s=n.sortInfo,n=!0;return s&&s.sortValueFieldName&&s.sortByPivotReferences&&(n=!1),'\n            <div class="'.concat(Z,'">\n                <div class="').concat(N,'">\n                    <span class="').concat(p,'">').concat(i.Sort_Field_Dialog_Title+" ("+e+")",'</span>\n                    <span class="').concat(b+" "+m,'">\xd7</span>\n                </div>\n                <div class="').concat(Y,'">\n                    <div class="').concat(A,'">\n                        <span class="').concat(g,'">').concat(i.Sort_Field_More_Dialog_Sort_By,'</span>\n                        <span class="').concat(w,'"></span>\n                    </div>\n                    <div class="').concat(A,'">\n                        <div class="').concat(r?"":S,'">\n                            <input type="radio" id="').concat(k,'" ').concat(n?"checked":"",' name="gc-pivot-sort-by">\n                            <label for="').concat(k,'">').concat(i.GrandTotal,'</label>\n                        </div>\n                        <div class="').concat(r?"":S,'">\n                            <input type="radio" id="').concat(j,'" ').concat(n?"":"checked",' name="gc-pivot-sort-by">\n                            <label for="').concat(j,'">').concat(i.Sort_Field_More_Dialog_Values_In_Selected_Area.replace(st,a),'</label>\n                        </div>\n                        <div class="').concat(q+(r&&!n?"":" "+S),'">\n                            <input class="').concat(T,'" value="').concat(t,'">\n                            <div class="').concat(X,'">\n                                <span></span>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="').concat(A,'">\n                        <span class="').concat(g,'">').concat(i.Sort_Field_Dialog_Summary,'</span>\n                        <span class="').concat(w,'"></span>\n                    </div>\n                    <div class="').concat(A,'">\n                        <div class="').concat(I,'"></div>\n                    </div>\n                    <div class="').concat(J,'">\n                        <span class= "').concat(b+" "+C,'">').concat(i.Cancel,'</span>\n                        <span class= "').concat(y+" "+C,'">').concat(i.Ok,"</span>\n                    </div>\n                </div>\n            </div>")},o.prototype.aY=function(){var n,e,n=this,e=n.Wc[0];(0,h.GC$)("."+b,e).bind("click",function(t){n.hpi(!1),n.lQ()}),(0,h.GC$)("."+y,e).bind("click",function(t){n.hpi(!0),n.lQ()}),(0,h.GC$)("."+X,e).bind("click",function(t){n.api(!1),new ut(n.qc(),n.Mf,n.cpi.fieldName,n.spi,function(t){n.spi=t,(0,h.GC$)("."+T)[0].value=t,n.api(!0),n.wpi()})}),(0,h.GC$)("#"+j,e).bind("change",function(t){var t,i,t=t.target.checked,i=(0,h.GC$)("."+q,e);t&&i.hasClass(S)&&i.removeClass(S),n.wpi()}),(0,h.GC$)("#"+k,e).bind("change",function(t){var t,i,t=t.target.checked,i=(0,h.GC$)("."+q,e);t&&!i.hasClass(S)&&i.addClass(S),n.wpi()}),(0,h.GC$)("."+T,e).bind("change",function(t){n.spi=t.target.value,n.wpi()}),n.bindMoveEvent((0,h.GC$)("."+N,n.Wc[0])[0])},o.prototype.KX=function(){var t=this.Wc[0];(0,h.GC$)("."+b,t).unbind("click"),(0,h.GC$)("."+y,t).unbind("click"),(0,h.GC$)("."+X,t).unbind("click"),(0,h.GC$)("#"+j,t).unbind("change"),(0,h.GC$)("#"+k,t).unbind("change"),(0,h.GC$)("."+T,t).unbind("change")},o.prototype.gpi=function(){var t,i,n,e,r,i,o,a,s,r,u,c,a,l,a,c,l,a,i,f,i,f,c,i,f,t=this,i=t.cpi,n=t.LJt,e=t.dh,r=i.fieldName,i=i.sortInfo,s=1===e.Z[r],r=e.Z[r],a=i&&i.sortValueFieldName&&i.sortByPivotReferences&&(c=(u=n.rZt.HWt[4]).getRange(),l=(a=n.getRange().content).row+c.row,a=a.col+c.col,c=n.getPivotInfo(l,a),l={},a=i.sortByPivotReferences.map(function(t){return{fieldName:e.getFieldNameBySourceName(t.fieldName),items:t.items}}),s?(f={fieldName:(i=c.rowInfos[0]).fieldName,items:[i.itemName]},i.isSubtotal&&(f.subtotal=!0),l.references=[f].concat(a)):(f={fieldName:(i=c.colInfos[0]).fieldName,items:[i.itemName]},i.isSubtotal&&(f.subtotal=!0),l.references=a.concat(f)),c=n.getPivotAreaRanges(l)[0])?(o=c.row,c.col):(o=(i=gt(n,s,r)).resultRow,i.resultCol),f=z(new h.Range(o,a,1,1),d,d,d);(0,h.GC$)("."+T,t.Wc[0]).val(f),t.spi=f},o.prototype.ypi=function(){var t,i,n,e,r,o,i,r,i,a,i,a,i,s,t=this,i=t.cpi,n=t.dh,e=t.Mf,r=i.isAsc,o=i.fieldName,i=i.selectedFieldName,r={sortType:r?0:1};if(o!==i&&(r.sortValueFieldName=i),!(0,h.GC$)("#"+k,t.Wc[0])[0].checked){if(!t.spi)return!1;if(0===(i=W(e,t.spi)).length||0<i.filter(function(t){return t.sheetName!==e.name()}).length)return!1;if(a=t.LJt,i=i[0].ranges[0],!(a=a.getPivotInfo(i.row,i.col))||4!==a.area)return!1;1===(i=n.Z[o])&&(s=a.colInfos),bt(s=2===i?a.rowInfos:s,r),t.nrt=r}return r},o.prototype.wpi=function(){var t,i,t=this,i=t.Wc[0];(0,h.GC$)("."+I,i)[0].innerText=t.Cpi()},o.prototype.Cpi=function(){var t,i,n,e,t,r,o,a,e,s,t,u,c,l,f,t=this,i=v(),n=t.ypi();if(!n)return t.nrt=d,i.Invalid_Sort_Range;if(e=t.dh,r=(t=t.cpi).fieldName,o=(null==n?void 0:n.sortValueFieldName)||t.selectedFieldName||r,a=e.Z[r],e=e.Z[o],s=t.isAsc,t=t.isDesc,!s&&!t)return i.Custom_Sort_Summary;if(r===o)return i.Sort_Summary_Pattern.replace(_,r).replace(P,s?i.Sort_Order_ASC:i.Sort_Order_DESC);if(u=i.Sort_Value_Summary_Pattern.replace(_,r).replace(F,o).replace(P,s?i.Sort_Order_ASC:i.Sort_Order_DESC),3===e)if(n&&n.sortValueFieldName&&n.sortByPivotReferences&&0<n.sortByPivotReferences.length)for(c=n.sortByPivotReferences,u=i.Sort_More_Summary_Pattern.replace(_,r).replace(F,o).replace(P,s?i.Sort_Order_ASC:i.Sort_Order_DESC).replace(at,1===a?i.Sort_In_Column:i.Sort_In_Row),l=0;l<c.length;l++)u+=(f=c[l]).items[0],l!==c.length-1&&(u+=":");else(0,h.GC$)("#"+j)[0].checked&&(u=i.Sort_More_Summary_Pattern.replace(_,r).replace(F,o).replace(P,s?i.Sort_Order_ASC:i.Sort_Order_DESC).replace(at,1===a?i.Sort_In_Column:i.Sort_In_Row),u+=i.GrandTotal);return u},o.prototype.hpi=function(t){var i,n,i=this,n=(0,h.GC$)("."+I,i.Wc[0])[0].innerText;t?(i.ypi(),i.hce(n,i.nrt)):i.hce(n)},ct=o,pt=U.opi,n(a,pt),a.prototype.$c=function(){var t=this;pt.prototype.$c.call(this),t.wpi()},a.prototype.eG=function(){this.dh=e,this.rYt=d,this.Vqt=d,this.upi=d,this.Xqt=d,this.nrt=d,this.Ti=e,this.Mf=e},a.prototype.Ipi=function(t){var i="";return t===this.upi&&(i="selected"),'<option value="'.concat(t,'" ').concat(i,">").concat(t,"</option>")},a.prototype.tKt=function(){for(var t,i,n,e,r,o,a,o,s,t=this,i=f(t.rYt),n="",e=0;e<t.Xqt.length;e++)n+=t.Ipi(t.Xqt[e]);return a=(o=(r=t.dh).getSortInfo(t.rYt))&&0===o.sortType,o=o&&1===o.sortType,a||o||(a=!0),s=v(),'\n            <div class="'.concat(Z,'">\n                <div class="').concat(N,'">\n                    <span class="').concat(p,'">').concat(s.Sort_Field_Dialog_Title+" ("+i+")",'</span>\n                    <span class="').concat(b+" "+m,'">\xd7</span>\n                </div>\n                <div class="').concat(Y,'">\n                    <div class="').concat(A,'">\n                        <span class="').concat(g,'">').concat(s.Sort_Field_Dialog_Sort_Options,'</span>\n                        <span class="').concat(w,'"></span>\n                    </div>\n                    <div class="').concat(A,'">\n                        <div>\n                            <input type="radio" id="').concat(M,'" ').concat(a?"checked":"",' name="').concat(x,'">\n                            <label for="').concat(M,'">').concat(s.Sort_Field_Dialog_Ascending_Sort,'</label>\n                            <select id="').concat(c,'" class="').concat(u+(a?"":" "+S),'">').concat(n,'</select>\n                        </div>\n                        <div>\n                            <input type="radio" id="').concat(D,'" ').concat(o?"checked":"",' name="').concat(x,'">\n                            <label for="').concat(D,'">').concat(s.Sort_Field_Dialog_Descending_Sort,'</label>\n                            <select id="').concat(l,'" class="').concat(u+(o?"":" "+S),'">').concat(n,'</select>\n                        </div>\n                    </div>\n                    <div class="').concat(A,'">\n                        <span class="').concat(g,'">').concat(s.Sort_Field_Dialog_Summary,'</span>\n                        <span class="').concat(w,'"></span>\n                    </div>\n                    <div class="').concat(A,'">\n                        <div class="').concat(I,'"></div>\n                    </div>\n                    <div class="').concat(J,'">\n                        <span class= "').concat(H+" "+C,'">').concat(s.Sort_Field_Dialog_More_Options,'</span>\n                        <span class= "').concat(b+" "+C,'">').concat(s.Cancel,'</span>\n                        <span class= "').concat(y+" "+C,'">').concat(s.Ok,"</span>\n                    </div>\n                </div>\n            </div>")},a.prototype.aY=function(){var e,r,e=this,r=this.Wc[0];(0,h.GC$)("."+u,r).bind("change",function(t){e.nrt&&(e.nrt=d),e.upi=t.target.value,e.wpi()}),(0,h.GC$)("#"+M,r).bind("change",function(t){var t,i,n,t=t.target.checked,i=(0,h.GC$)("#"+l,r),n=(0,h.GC$)("#"+c,r);t&&(n.hasClass(S)&&n.removeClass(S),i.hasClass(S)||i.addClass(S),e.nrt&&(e.nrt=d),e.upi=(0,h.GC$)("#"+c,r).val(),e.wpi())}),(0,h.GC$)("#"+D,r).bind("change",function(t){var t,i,n,t=t.target.checked,i=(0,h.GC$)("#"+l,r),n=(0,h.GC$)("#"+c,r);t&&(i.hasClass(S)&&i.removeClass(S),n.hasClass(S)||n.addClass(S),e.nrt&&(e.nrt=d),e.upi=(0,h.GC$)("#"+l,r).val(),e.wpi())}),(0,h.GC$)("."+H,r).bind("click",function(t){var i=!!(0,h.GC$)("#"+M,r)[0].checked,n=!!(0,h.GC$)("#"+D,r)[0].checked;e.api(!1),new ct(e.qc(),e.Mf,e.dh,{isAsc:i,isDesc:n,fieldName:e.rYt,pivotName:e.Vqt,selectedFieldName:e.upi,sortInfo:e.nrt},function(t,i){i&&(e.nrt=i),e.api(!0),e.Npi=t,(0,h.GC$)("."+I,r)[0].innerText=t})}),(0,h.GC$)("."+b,r).bind("click",function(t){e.lQ()}),(0,h.GC$)("."+y,r).bind("click",function(t){e.hpi(),e.lQ()}),e.bindMoveEvent((0,h.GC$)("."+N,e.Wc[0])[0])},a.prototype.KX=function(){var t=this.Wc[0];(0,h.GC$)("."+u,t).unbind("change"),(0,h.GC$)("#"+M,t).unbind("change"),(0,h.GC$)("#"+D,t).unbind("change"),(0,h.GC$)("."+H,t).unbind("click"),(0,h.GC$)("."+b,t).unbind("click"),(0,h.GC$)("."+y,t).unbind("click")},a.prototype.wpi=function(){var t,i,t=this,i=t.Wc[0];t.Npi=t.Cpi(),(0,h.GC$)("."+I,i)[0].innerText=t.Npi},a.prototype.Cpi=function(){var t,i,n,e,r,i,o,a,s,u,a,c,l,f,t=this,i=t.dh,n=t.rYt,e=t.upi||n,r=i.Z[n],i=i.Z[e],o=!(0,h.GC$)("#"+M).length||(0,h.GC$)("#"+M)[0].checked,a=!!(0,h.GC$)("#"+D).length&&(0,h.GC$)("#"+D)[0].checked,s=v();if(!o&&!a)return s.Custom_Sort_Summary;if(n===e)return s.Sort_Summary_Pattern.replace(_,n).replace(P,o?s.Sort_Order_ASC:s.Sort_Order_DESC);if(u=s.Sort_Value_Summary_Pattern.replace(_,n).replace(F,e).replace(P,o?s.Sort_Order_ASC:s.Sort_Order_DESC),c=null==(a=t.nrt)?void 0:a.sortByPivotReferences,3===i&&c&&0<c.length)for(u=s.Sort_More_Summary_Pattern.replace(_,n).replace(F,e).replace(P,o?s.Sort_Order_ASC:s.Sort_Order_DESC).replace(at,1===r?s.Sort_In_Column:s.Sort_In_Row),l=0;l<c.length;l++)u+=(f=c[l]).items[0],l!==c.length-1&&(u+=":");return u},a.prototype.hpi=function(){var t,i,n,e,r,o,a,s,u,u,a,a,o,t=this,i=t.dh,n=t.rYt,e=t.Vqt,r=t.nrt,o=t.Wc[0],a=v();if(t.Npi===a.Invalid_Sort_Range)(u=(s=i.z.filter(function(t){return t.Zc===e})[0]).Ti)&&u.jT(10,a.Invalid_Sort_Range);else{if(!r){if(u=!!(0,h.GC$)("#"+M,o)[0].checked,a=!!(0,h.GC$)("#"+D,o)[0].checked,!u&&!a)return;o=u?0:1,r=n===(a=t.upi)?{sortType:o}:{sortType:o,sortValueFieldName:a}}i.wVt({cmd:"sortPivotField",sheetName:"",cmdOption:{sortInfo:r,fieldName:n,pivotName:e}})}},t.SortFieldDialog=a,mt=U.opi,n(s,mt),s.prototype.$c=function(){var t=this;mt.prototype.$c.call(this),t.wpi()},s.prototype.eG=function(){this.LJt=d,this.lpi=d,this.Ti=e,this.Mf=e},s.prototype.tKt=function(){var t,i,n,e,r,o,a,s,u,c,i,u,i,c,u,c,c,a,s,r,l,o,t=this,i=t.LJt,n=t.lpi,e=v(),r=n.rowInfos,o=n.colInfos,a=r&&r.length,s=o&&o.length,u=f(r&&r[a-1]&&r[a-1].fieldName),c=f(o&&o[s-1]&&o[s-1].fieldName),i=i.dh,u=i.getSortInfo(u),i=i.getSortInfo(c),c=u||i,u=c&&0===c.sortType,c=c&&1===c.sortType;if(u||c||(u=!0),c=0===a||r&&0<r.filter(function(t){return t.isGrandTotal}).length,a=0===s||o&&0<o.filter(function(t){return t.isGrandTotal}).length,s=(r=t.fpi)?l=!!n.cornerFieldInfo:!(c||!a&&i),c&&a||!n.valueFieldName&&!r)throw new Error(e.Invalid_Field_Sort_By);return o=c||a||r,'\n            <div class="'.concat(it,'">\n                <div class="').concat(N,'">\n                    <span class="').concat(p,'">').concat(e.Sort_Value_Dialog_Title,'</span>\n                    <span class="').concat(b+" "+m,'">\xd7</span>\n                </div>\n                <div class="').concat(nt,'">\n                    <div class="').concat(A,'">\n                        <div class="').concat(A+" "+et,'">\n                            <div class="').concat(A,'">\n                                <span class="').concat(g,'">').concat(e.Sort_Field_Dialog_Sort_Options,'</span>\n                                <span class="').concat(w,'"></span>\n                            </div>\n                            <div class="').concat(A,'">\n                                <div>\n                                    <input type="radio" id="').concat(M,'" ').concat(u?"checked":"",' name="').concat(x,'">\n                                    <label for="').concat(M,'">').concat(e.Sort_Value_Dialog_Asc,'</label>\n                                </div>\n                                <div>\n                                    <input type="radio" id="').concat(D,'" ').concat(u?"":"checked",' name="').concat(x,'">\n                                    <label for="').concat(D,'">').concat(e.Sort_Value_Dialog_Desc,'</label>\n                                </div>\n                            </div>\n                        </div>\n                        <div class="').concat(A+" "+et+(o?" "+S:""),'">\n                            <div class="').concat(A,'">\n                                <span class="').concat(g,'">').concat(e.Sort_Value_Dialog_Sort_Direction,'</span>\n                                <span class="').concat(w,'"></span>\n                            </div>\n                            <div class="').concat(A,'">\n                                <div>\n                                    <input type="radio" id="').concat(O,'" ').concat(s?"checked":"",' name="').concat(ot,'">\n                                    <label for="').concat(O,'">').concat(e.Sort_Value_Dialog_Top_To_Bottom,'</label>\n                                </div>\n                                <div>\n                                    <input type="radio" id="').concat(rt,'" ').concat(s?"":"checked",' name="').concat(ot,'">\n                                    <label for="').concat(rt,'">').concat(e.Sort_Value_Dialog_Left_To_Right,'</label>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="').concat(A,'">\n                        <span class="').concat(g,'">').concat(e.Sort_Field_Dialog_Summary,'</span>\n                        <span class="').concat(w,'"></span>\n                    </div>\n                    <div class="').concat(A,'">\n                        <div class="').concat(I,'"></div>\n                    </div>\n                    <div class="').concat(J,'">\n                        <span class= "').concat(b+" "+C,'">').concat(e.Cancel,'</span>\n                        <span class= "').concat(y+" "+C,'">').concat(e.Ok,"</span>\n                    </div>\n                </div>\n            </div>")},s.prototype.aY=function(){var n,i,n=this,i=this.Wc[0];[M,D,O,rt].forEach(function(t){(0,h.GC$)("#"+t,i).bind("change",function(t){var i;t.target.checked&&n.wpi()})}),(0,h.GC$)("."+b,i).bind("click",function(t){n.lQ()}),(0,h.GC$)("."+y,i).bind("click",function(t){n.hpi(),n.lQ()}),n.bindMoveEvent((0,h.GC$)("."+N,n.Wc[0])[0])},s.prototype.KX=function(){var i=this.Wc[0];[M,D,O,rt].forEach(function(t){(0,h.GC$)("#"+t,i).unbind("change")}),(0,h.GC$)("."+b,i).unbind("click"),(0,h.GC$)("."+y,i).unbind("click")},s.prototype.wpi=function(){var t,i,t=this,i=t.Wc[0];(0,h.GC$)("."+I,i)[0].innerText=t.Cpi()},s.prototype.Cpi=function(){var t,i,n,i,e,r,o,r,a,t,n,s,i,u,r,n,c,l,f,t=this,i=t.LJt,n=t.lpi,i=i.dh,e=n.valueFieldName,r=t.Wc[0],o=(0,h.GC$)("#"+M,r)[0].checked,r=(0,h.GC$)("#"+O,r)[0].checked,a=v();if(t.fpi)return a.Sort_Summary_Pattern.replace(_,a.Values).replace(P,o?a.Sort_Order_ASC:a.Sort_Order_DESC);if(t=n.rowInfos,n=n.colInfos,s=(r?t[t.length-1]:n[n.length-1]).fieldName,i=i.Z[s],!t||0===t.length||!n||0===n.length)return a.Sort_Value_Summary_Pattern.replace(_,s).replace(F,e).replace(P,o?a.Sort_Order_ASC:a.Sort_Order_DESC);if((r=(u=r?n:t)&&0<u.length)&&-1!==(n=u.findIndex(function(t){return t.fieldName===a.sigmaValue}))&&(e=u[n].itemName,u.splice(n,1)),c=a.Sort_More_Summary_Pattern.replace(_,s).replace(F,e).replace(P,o?a.Sort_Order_ASC:a.Sort_Order_DESC).replace(at,1===i?a.Sort_In_Column:a.Sort_In_Row),r)for(l=0;l<u.length;l++){if((f=u[l]).isGrandTotal){c+=a.GrandTotal;break}c+=f.itemName,l!==u.length-1&&(c+=":")}return c},s.prototype.ypi=function(){var t,i,t,n,t,e,r,n,o,i,a,t=this,i=t.lpi,t=t.Wc[0],n=!!(0,h.GC$)("#"+M,t)[0].checked,t=(0,h.GC$)("#"+O,t)[0].checked,e,r,n={sortType:n?0:1,sortValueFieldName:i.valueFieldName},o=i.rowInfos,i=i.colInfos,a;return bt(t?i:o,n),n},s.prototype.hpi=function(){var t,i,n,e,i,r,t,t,o,n,t,t=this,i=t.LJt,n=t.lpi,e=i.dh,i=i.Zc;t.fpi?t.Api():(r=t.ypi())&&(t=t.Wc[0],t=(0,h.GC$)("#"+O,t)[0].checked,o=n.rowInfos,n=n.colInfos,t=(t?o[o.length-1]:n[n.length-1]).fieldName,e.wVt({cmd:"sortPivotField",sheetName:"",cmdOption:{sortInfo:r,fieldName:t,pivotName:i}}))},s.prototype.Api=function(){var t,i,n,i,t,e,t,t=this,i=t.LJt,n=i.dh,i=i.Zc,t=t.Wc[0],e=!!(0,h.GC$)("#"+D,t)[0].checked,t=n.Q.map(function(t){return t.Zc});t.sort(function(t,i){var t=t.localeCompare(i);return e?-1*t:t}),n.wVt({cmd:"sortPivotValueField",sheetName:"",cmdOption:{sortedFieldNames:t,pivotName:i,sortType:e?V.SortType.desc:V.SortType.asc}})},t.SortValueDialog=s},"./dist/plugins/pivot/pivot-ui/pivot-view-list-dialog.js":function(t,i,n){"use strict";var e,s,r,n,o,a,u,c,l,f,h;function v(t,i,n){var t=h.call(this,t,0)||this;return t.views=i,t.currentViewName="",t.width=n,t}e=this&&this.__extends||(f=function(t,i){return(f=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}f(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PivotViewListDialog=void 0,s=n("Core"),r=n("Pivot"),n=n("@spreadjs/js-sheets-common"),o="gc-panel-button-delete",a="gc-panel-view-name",u="gc-panel-selected-view",c=n.Common.zf.j0,h=s.zc,e(v,h),v.prototype.init=function(t){h.prototype.Hc.call(this),this.open(t)},v.prototype.open=function(t){var i,n,n,e,i="<ul>";(0,r.o)(this.views.all(),function(t){i+='<li>\n                        <span class="'.concat(a,'">').concat(c(t.name),'</span>\n                        <input type="button" class="gc-panel-button ').concat(o,'" value="\xd7"/>\n                    </li>')}),i+="</ul>",n=this.width||250,n='\n                <div class="gc-panel-viewList" style="width: '.concat(n,'px"">\n                    ').concat(i,"\n                </div>\n                "),(e=this.WX(t.x,t.y)).html(n),this.$c(),this.aY()},v.prototype.WX=function(t,i){var n=this.Xc();return n.css(["left","top"],[t,i]),n},v.prototype.$c=function(){h.prototype.$c.call(this)},v.prototype.close=function(){this.KX(),this.eG(),h.prototype.close.call(this)},v.prototype.eG=function(){this.Ti=null,this.views=null},v.prototype.if=function(){var t,i,n,e,r,o,a,t,t=(0,s.GC$)(this.Wc.get(0).firstElementChild),i=(0,s.GC$)(this.Wc);0!==t.length&&(n=t.width(),e=parseInt(i.css("left"),10),!isNaN(e))&&!isNaN(n)&&(r=0,a=(o=document.documentElement).clientWidth,(t=t[0].getBoundingClientRect()).left+n>a&&(r=t.left+n-a),e<0||0<r)&&i.css({left:(e=(e-=r)<0?0:e)+"px"})},v.prototype.aY=function(){var n=this;(0,s.GC$)("."+o).bind("click",function(t){var i,t,i=t.target.previousElementSibling.textContent,t=t.target.parentElement;n.views.remove(i),t.remove()}),(0,s.GC$)("."+a).bind("click",function(t){var t=t.target.textContent;(0,s.GC$)("#"+u).val(t),n.close()})},v.prototype.KX=function(){(0,s.GC$)("."+o).unbind("click"),(0,s.GC$)("."+a).unbind("click")},i.PivotViewListDialog=v},"./dist/plugins/pivot/pivot-util.js":function(t,r,i){"use strict";var n,a,e,o,s,u,c,l,f,h,i,v,d,p;function m(t,i,n){var t=t[i];return t&&0<t.length?t[n]:n}function b(t){return c(t)||""===t}function g(t,i,n){var e,r,e={_ps:{}};for(r in t)h(t,r)&&(y(e,r,i,n),e[r]=t[r]);return e}function w(t,i){t.forEach(function(t){i===o.SubtotalsPosition.top?t.Spi=!0:i===o.SubtotalsPosition.bottom?t.Spi=!1:delete t.Spi})}function y(t,r,o,a){Object.defineProperty(t,r,{get:function(){var t,i;return"calcItemAggregation"===r?(i=(t=o.dh).lw(),this._ps[r]=i=i?0:1):this._ps[r]},set:function(t){var i,n,e,n,i=this._ps[r],n=o.dh;i!==t?(o.DT({pivotTable:this,pn:r,old:i,value:t,type:"options"}),this._ps[r]=t,"calcItemAggregation"===r&&n.lw(t),"subTotalsPosition"===r&&(this._ps[e="subtotalsPosition"]=t,n.Dpi=t,w(n.B,t)),"subtotalsPosition"===r&&(this._ps[e="subTotalsPosition"]=t,n.Dpi=t,w(n.B,t))):"subTotalsPosition"!==r&&"subtotalsPosition"!==r||(n.Dpi=t,w(n.B,t)),"missingCaption"!==r||c(t)||"TRUE"!==(n=(t+"").toUpperCase())&&"FALSE"!==n||(this._ps.missingCaption="'"+t),"allowMultipleFiltersPerField"===r&&(!0==!!i&&!1==!!t&&o.Gqt(),o.dh)&&o.dh.DVt(!!t),"printDrill"!==r&&"itemPrintTitles"!==r&&"fieldPrintTitles"!==r&&"function"==typeof a&&a()},enumerable:!0})}function C(t,i){var n,e,n=t.split(r.nameSeparator);return isNaN(parseInt(n[n.length-1],10))?t+=r.nameSeparator+"1":(e=n[n.length-1],n.splice(n.length-1,1,r.nameSeparator+(parseInt(e,10)+1)),t=n.join("")),t=i.BQt[t]?C(t,i):t}function A(t,i){var n,e,r,o,a,s,a,s,a,u,n=[];if(i)for(e=t.pivotTables.all(),r=0;r<e.length;r++)s=(a=(o=e[r]).getRange()).page,a=a.content,s=s?s.union(a):a,a=-1===i.row?s.row:s.row-i.row,u=-1===i.col?s.col:s.col-i.col,i.containsRange(s)&&n.push({name:o.Zc,sheetName:t.name(),startPoint:[a,u]});return n}function N(t,o){var t,a,t=t.pivotTables.all(),a={};return(0,s.o)(t,function(t){var i,n,i,e,r;!t.Oy()&&(n=(i=t.getRange()).page,i=i.content,n&&(e=n.intersect(o.row,o.col,o.rowCount,o.colCount))&&(a[t.Zc]?a[t.Zc].push(o.getIntersect(n,0,0)):a[t.Zc]=[o.getIntersect(n,0,0)]),r=i.intersect(o.row,o.col,o.rowCount,o.colCount))&&(a[t.Zc]?a[t.Zc].push(o.getIntersect(i,0,0)):a[t.Zc]=[o.getIntersect(i,0,0)])}),a}function I(t){return-1<[s.PivotShowDataAs.percentOfTotal,s.PivotShowDataAs.percentOfRow,s.PivotShowDataAs.percentOfCol,s.PivotShowDataAs.percent,s.PivotShowDataAs.percentOfParentRow,s.PivotShowDataAs.percentOfParentCol,s.PivotShowDataAs.percentOfParent,s.PivotShowDataAs.percentDiff,s.PivotShowDataAs.percentOfRunningTotal].indexOf(t)}function T(t){for(var i,n,e,i=0,n=u;i<n.length;i++)if(!c(t[e=n[i]]))return!1;return!0}function S(t,i){if(c(t)||c(i)||""===i||!t[i])return i;for(var n=2;t[i+n];)n++;return i+n}function x(t){var i=l.Fe(l.culture()).DateTimeFormat,n=i.shortDatePattern;return 0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()&&0===t.getMilliseconds()||(n=i.defaultDatePattern),f.Pe(t,n)}function M(t){var i,n,i=t.type;if(!c(i))return(n={}).type=i&&"null"!==i?i:"null",c(t.value)||(n.val=t.value),c(t.maxValue)||(n.maxVal=t.maxValue),n}function D(t,i){return c(i)?t:t===o.SubtotalsPosition.top&&i||t===o.SubtotalsPosition.bottom&&i?o.SubtotalsPosition.top:t===o.SubtotalsPosition.bottom&&!i||t===o.SubtotalsPosition.top&&!i?o.SubtotalsPosition.bottom:t===o.SubtotalsPosition.none?o.SubtotalsPosition.none:void 0}Object.defineProperty(r,"__esModule",{value:!0}),r.iJt=r.$Yt=r.fJt=r.kWt=r.b0=r.FZt=r.getActualSubtotalPosition=r.writePivotDynamicFilter=r.PivotComparisonOperators=r.formatDateToString=r.R$=r.applyShowDataAsStyle=r.dz=r.cZt=r.nameSeparator=r.updateRowFieldsIsShowSubtotalTop=r.GC_EMPTY_VALUE=void 0,n=i("@spreadjs/js-sheets-common"),a=i("Core"),e=i("./dist/plugins/pivot/pivot.ns.js"),o=i("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),s=i("Pivot"),u=["backColor","foreColor","hAlign","vAlign","font","themeFont","formatter","borderLeft","borderTop","borderRight","borderBottom","locked","textIndent","wordWrap","showEllipsis","_showTip","shrinkToFit","backgroundImage","cellType","backgroundImageLayout","tabStop","textDecoration","imeMode","name","parentName","watermark","cellPadding","labelOptions","quotePrefix","diagonalDown","diagonalUp","isVerticalText","cellButtons","dropDowns","textOrientation"],c=n.Common.lt.ht,l=n.Common.CultureManager,f=n.Common.ct,h=n.Common.kh,i=new n.Common.ResourceManager(e.SR,"PivotTables"),v=i.getResource.bind(i),r.GC_EMPTY_VALUE="gc-empty-value",r.FZt=m,r.kWt=b,r.b0=g,r.updateRowFieldsIsShowSubtotalTop=w,r.nameSeparator="_",r.fJt=C,r.$Yt=A,r.iJt=N,r.cZt=T,r.dz=S,r.applyShowDataAsStyle=d=function(t,i,n,e){var r,i,o,i={dataOnly:!0,references:[{fieldName:v().Values,items:[i]}]},o=t.getStyle(i),r=(r=o?(0,a.RF)(o):r)||new a.Style;e?r.formatter=e:I(n)?r.formatter="0.00%":(delete r.formatter,T(r)&&(r=null)),t.setStyle(i,r)},r.R$=p=function(t,i,n){var e,i,r,i={dataOnly:!0,references:[{fieldName:v().Values,items:[i]}]},r=t.getStyle(i);(e=r?(0,a.RF)(r):e)&&"0.00%"===e.formatter&&I(n)&&(delete e.formatter,t.setStyle(i,e))},r.formatDateToString=x,r.PivotComparisonOperators={"-1":"none",0:"equal",4:"lessThan",3:"lessThanOrEqual",1:"notEqual",2:"greaterThan",5:"greaterThanOrEqual"},r.writePivotDynamicFilter=M,r.getActualSubtotalPosition=D},"./dist/plugins/pivot/pivot.ns.js":function(t,i,n){"use strict";Object.defineProperty(i,"__esModule",{value:!0}),i.SR=void 0;var n=n("./dist/plugins/pivot/pivot.res.en.js");i.SR={en:n}},"./dist/plugins/pivot/pivot.res.en.js":function(t,i,n){"use strict";var e,r;for(r in Object.defineProperty(i,"__esModule",{value:!0}),i.PivotPanel_ValueFilterOrLabel_NotEqual=i.PivotPanel_ValueFilterOrLabel_Equals=i.PivotPanel_LabelOrValue_ClearFilter=i.PivotPanel_Fields_MoveTo_Value=i.PivotPanel_Fields_MoveTo_ColLabel=i.PivotPanel_Fields_MoveTo_RowLabel=i.PivotPanel_Fields_MoveTo_ReportField=i.PivotPanel_DropDownList_ValueSet=i.PivotPanel_DropDownList_Set=i.PivotPanel_DropDownList_Remove=i.PivotPanel_DropDownList_Values=i.PivotPanel_DropDownList_Col=i.PivotPanel_DropDownList_Row=i.PivotPanel_DropDownList_ReportFilter=i.PivotPanel_DropDownList_End=i.PivotPanel_DropDownList_Beginning=i.PivotPanel_DropDownList_Down=i.PivotPanel_DropDownList_Up=i.PivotPanel_Update=i.EmptyPivotTable_PromptMessage2=i.EmptyPivotTable_PromptMessage1=i.PivotPanel_DeferUpdateText=i.PivotPanel_ValuesItemsTitle=i.PivotPanel_ColumnsItemsTitle=i.PivotPanel_RowsItemsTitle=i.PivotPanel_FiltersItemsTitle=i.PivotPanel_FieldAreaText=i.PivotPanel_SearchPlaceholder=i.PivotPanel_ReportText=i.PivotPanel_Title=i.Values=i.GrandTotal=i.RowLabels=i.MultipleItems=i.All=i.Total=i.ColumnLabels=i.SubtotalType_Prefix_10=i.SubtotalType_Prefix_9=i.SubtotalType_Prefix_8=i.SubtotalType_Prefix_7=i.SubtotalType_Prefix_6=i.SubtotalType_Prefix_5=i.SubtotalType_Prefix_4=i.SubtotalType_Prefix_3=i.SubtotalType_Prefix_2=i.SubtotalType_Prefix_1=i.SubtotalType_Prefix_0=i.NotExist=i.RepeatName=void 0,i.PivotPanel_ValueFilterOrLabel_LastYear=i.PivotPanel_ValueFilterOrLabel_ThisYear=i.PivotPanel_ValueFilterOrLabel_NextYear=i.PivotPanel_ValueFilterOrLabel_LastQuarter=i.PivotPanel_ValueFilterOrLabel_ThisQuarter=i.PivotPanel_ValueFilterOrLabel_NextQuarter=i.PivotPanel_ValueFilterOrLabel_LastMonth=i.PivotPanel_ValueFilterOrLabel_ThisMonth=i.PivotPanel_ValueFilterOrLabel_NextMonth=i.PivotPanel_ValueFilterOrLabel_LastWeek=i.PivotPanel_ValueFilterOrLabel_ThisWeek=i.PivotPanel_ValueFilterOrLabel_NextWeek=i.PivotPanel_ValueFilterOrLabel_Yesterday=i.PivotPanel_ValueFilterOrLabel_Today=i.PivotPanel_ValueFilterOrLabel_Tomorrow=i.PivotPanel_ValueFilterOrLabel_After=i.PivotPanel_ValueFilterOrLabel_Before=i.ValueFilterOrLabel_NotContain=i.ValueFilterOrLabel_Contain=i.ValueFilterOrLabel_NotEndWith=i.ValueFilterOrLabel_End=i.ValueFilterOrLabel_NotBegin=i.ValueFilterOrLabel_IsBeginWith=i.ValueFilterOrLabelSelect_NotBetween=i.ValueFilterOrLabelSelect_Between=i.ValueFilterOrLabelSelect_LessOrTo=i.ValueFilterOrLabelSelect_LessThan=i.ValueFilterOrLabelSelect_GreaterOrTo=i.ValueFilterOrLabelSelect_GreaterThan=i.ValueFilterOrLabel_NotBetween=i.ValueFilterOrLabel_Between=i.ValueFilterOrLabel_LessOrTo=i.ValueFilterOrLabel_LessThan=i.ValueFilterOrLabel_GreaterOrTo=i.ValueFilterOrLabel_GreaterThan=i.ValueFilterOrLabel_NotEqual=i.ValueFilterOrLabel_Equals=i.PivotPanel_ValueFilterOrLabel_NotContain=i.PivotPanel_ValueFilterOrLabel_Contain=i.PivotPanel_ValueFilterOrLabel_NotEndWith=i.PivotPanel_ValueFilterOrLabel_End=i.PivotPanel_ValueFilterOrLabel_NotBegin=i.PivotPanel_ValueFilterOrLabel_IsBeginWith=i.PivotPanel_ValueFilter_Top10=i.PivotPanel_ValueFilterOrLabel_NotBetween=i.PivotPanel_ValueFilterOrLabel_Between=i.PivotPanel_ValueFilterOrLabel_LessOrTo=i.PivotPanel_ValueFilterOrLabel_LessThan=i.PivotPanel_ValueFilterOrLabel_GreaterOrTo=i.PivotPanel_ValueFilterOrLabel_GreaterThan=void 0,i.Sort_Value_Dialog_Asc=i.Sort_Value_Dialog_Sort_Direction=i.Sort_Value_Dialog_Title=i.Sort_Field_More_Dialog_Values_In_Selected_Area=i.Sort_Field_More_Dialog_Sort_By=i.Sort_Field_More_Dialog_Title=i.Sort_Field_Dialog_More_Options=i.Sort_Field_Dialog_Descending_Sort=i.Sort_Field_Dialog_Ascending_Sort=i.Sort_Field_Dialog_Summary=i.Sort_Field_Dialog_Sort_Options=i.Sort_Field_Dialog_Title=i.TopTenShow=i.Top_Ten_Filter=i.Value_Title=i.Value_Show=i.Use_Series_Characters=i.Use_Single_Character=i.Label_Show=i.Label_Title=i.PivotPanel_Filter_Search=i.PivotPanel_Filter_NoSelectAll=i.PivotPanel_Filter_SelectAll=i.Select_Field=i.CustomFormats=i.Type=i.Sample=i.FormatCells=i.Number=i.LabelFormat=i.NumberFormat=i.Cancel=i.Ok=i.PivotPanel_Date_Filter=i.PivotPanel_Filter_Value=i.PivotPanel_Filter_Label=i.PivotPanel_Filter_Clear=i.PivotPanel_Sort_More=i.PivotPanel_Sort_Largest_Smallest=i.PivotPanel_Sort_Smallest_Largest=i.PivotPanel_Sort_Z_A=i.PivotPanel_Sort_A_Z=i.PivotPanel_ValueFilterOrLabel_Custom=i.PivotPanel_ValueFilterOrLabel_AllDates=i.PivotPanel_ValueFilterOrLabel_ParallelQuarterToDate=i.PivotPanel_ValueFilterOrLabel_ParallelMonthToDate=i.PivotPanel_ValueFilterOrLabel_ParallelYearToDate=i.PivotPanel_ValueFilterOrLabel_QuarterToDate=i.PivotPanel_ValueFilterOrLabel_MonthToDate=i.PivotPanel_ValueFilterOrLabel_YearToDate=void 0,i.SummarizeValue=i.CustomName=i.SourceName=i.ValueSetting=i.FieldSetting=i.WholeDays=i.DateShow=i.DateFilterTitle=i.IsNotBetween=i.IsBetween=i.IsAfterOrEqual=i.IsAfter=i.IsBeforeOrEqual=i.IsBefore=i.Dec=i.Nov=i.Oct=i.Sep=i.Aug=i.Jul=i.Jun=i.May=i.Apr=i.Mar=i.Feb=i.Jan=i.Q4=i.Q3=i.Q2=i.Q1=i.AndJoiner=i.ByJoiner=i.Top_Sum=i.Top_Percent=i.Top_Item=i.Bottom=i.Top=i.Invalid_Field_Sort_By=i.Invalid_Sort_Range=i.Sort_More_Summary_Pattern=i.Sort_Value_Summary_Pattern=i.Sort_Summary_Pattern=i.Sort_In_Column=i.Sort_In_Row=i.Sort_Order_DESC=i.Sort_Order_ASC=i.Custom_Sort_Summary=i.Sort_Value_Dialog_Left_To_Right=i.Sort_Value_Dialog_Top_To_Bottom=i.Sort_Value_Dialog_Desc=void 0,i.days=i.hours=i.minutes=i.seconds=i.groupBy=i.endingAt=i.startingAt=i.auto=i.grouping=i.baseItem=i.baseField=i.showValueAsDialog=i.index=i.rankLargestSmallest=i.rankSmallestLargest=i.percentRunningTotal=i.runningTotal=i.percentDifference=i.difference=i.percentParentTotal=i.percentParentColumnTotal=i.percentParentRowTotal=i.percentEllipsis=i.percentRowTotal=i.percentColumnTotal=i.percentGrandTotal=i.noCalculation=i.DateFormatError=i.sigmaValueTemp=i.sigmaValue=i.Varp=i.Var=i.StdDevp=i.StdDev=i.CountNumbers=i.Product=i.Min=i.Max=i.Average=i.Count=i.Sum=i.ChooseType=i.ShowValueAsField=i.SummarizeValueField=i.BaseItemPrevious=i.BaseItemNext=i.BaseItemForDialog=i.BaseFieldForDialog=i.CalculationForDialog=i.ShowValueAs=void 0,i.ALL_DATES_IN=i.TIMELINE_PLACE_HOLDER=i.showSubtotalTop=i.showNoData=i.Layout=i.AddSearchResult=i.search=i.SlicerNameInFormula=i.PivotTableErrorFormula=i.PivotTableMoveCalcItemFieldToReport=i.PivotTableCalcItemHasMultipleDataField=i.PivotTableHasSameItemName=i.PivotTableSubtotalType=i.PivotTableHasNumberOrDateGroup=i.PivotTableCalcItemHasTowCacheField=i.PivotTableForAccessibility=i.PivotTableErrorMessage_InvalidReference=i.PivotTableErrorMessage_InvalidGroup=i.PivotTableErrorMessage_InvalidChange=i.PivotTableErrorMessage_Overlap=i.PivotTableErrorMessage_EmptySourceFieldName=i.PivotTableErrorMessage_Protect=i.PivotTableErrorMessage_EmptyFieldName=i.PivotTableErrorMessage_DuplicatedFieldName=i.PivotTableErrorMessage_EditWhenDefer=i.PivotTableErrorMessage_ExistData=i.PivotTableErrorMessage_MakeChange=i.PivotTableErrorMessage_ShowDetail=i.getValueFilterItemText=i.getDateLabelFilterItemText=i.getStringLabelFilterItemText=i.deferLayoutUpdate=i.toolTipContent_NoValue=i.toolTipContent_Value=i.toolTipContent_Column=i.toolTipContent_Row=i.DefaultPivotTableViewName=i.EmptyValueFieldError=i.param_error=i.Group=i.Views=i.FieldAreaLimited=i.SourceDataOnlyOne=i.SourceNotIsTableNameOrFormula=i.SourceError=i.NoHaveSpread=i.numberOfDays=i.years=i.quarters=i.months=void 0,i.PivotTableErrorMessage_ExistTable=i.TIME_LEVEL_DAYS=i.TIME_LEVEL_MONTHS=i.TIME_LEVEL_QUARTERS=i.TIME_LEVEL_YEARS=i.AllDatesIn_December=i.AllDatesIn_November=i.AllDatesIn_October=i.AllDatesIn_September=i.AllDatesIn_August=i.AllDatesIn_July=i.AllDatesIn_June=i.AllDatesIn_May=i.AllDatesIn_April=i.AllDatesIn_March=i.AllDatesIn_February=i.AllDatesIn_January=i.AllDatesIn_Quarter4=i.AllDatesIn_Quarter3=i.AllDatesIn_Quarter2=i.AllDatesIn_Quarter1=i.DateNotBetween=i.DateOlderThanOrEqual=i.DateOlderThan=i.DateNewerThanOrEqual=i.DateNewerThan=i.DateNotEqual=i.QUARTER_MAP=i.INVALID_DATE_SELECTION=i.ALL_PERIODS=void 0,i.RepeatName="Repeat Name",i.NotExist="Not Exist",i.SubtotalType_Prefix_0="Average of ",i.SubtotalType_Prefix_1="Count of ",i.SubtotalType_Prefix_2="CountNums of ",i.SubtotalType_Prefix_3="Max of ",i.SubtotalType_Prefix_4="Min of ",i.SubtotalType_Prefix_5="Product of ",i.SubtotalType_Prefix_6="StdDev of ",i.SubtotalType_Prefix_7="StdDevp of ",i.SubtotalType_Prefix_8="Sum of ",i.SubtotalType_Prefix_9="Var of ",i.SubtotalType_Prefix_10="Varp of ",i.ColumnLabels="Column Labels",i.Total=" Total",i.All="All",i.MultipleItems="Multiple Items",i.RowLabels="Row Labels",i.GrandTotal="Grand Total",i.Values="Values",i.PivotPanel_Title="PivotTable Fields",i.PivotPanel_ReportText="Choose fields to add to report",i.PivotPanel_SearchPlaceholder="Search",i.PivotPanel_FieldAreaText="Drag fields between areas below:",i.PivotPanel_FiltersItemsTitle="Filters",i.PivotPanel_RowsItemsTitle="Rows",i.PivotPanel_ColumnsItemsTitle="Columns",i.PivotPanel_ValuesItemsTitle="Values",i.PivotPanel_DeferUpdateText="Defer Layout Update",i.EmptyPivotTable_PromptMessage1="Click in this area to work with the PivotTable report",i.EmptyPivotTable_PromptMessage2="Turn on the PivotTable Field List to work with the PivotTable",i.PivotPanel_Update="Update",i.PivotPanel_DropDownList_Up="Move Up",i.PivotPanel_DropDownList_Down="Move Down",i.PivotPanel_DropDownList_Beginning="Move to Beginning",i.PivotPanel_DropDownList_End="Move to End",i.PivotPanel_DropDownList_ReportFilter="Move to Report Filter",i.PivotPanel_DropDownList_Row="Move to Row Labels",i.PivotPanel_DropDownList_Col="Move to Column Labels",i.PivotPanel_DropDownList_Values="Move to Values",i.PivotPanel_DropDownList_Remove="Remove Field",i.PivotPanel_DropDownList_Set="Field Settings...",i.PivotPanel_DropDownList_ValueSet="Value Field Settings...",i.PivotPanel_Fields_MoveTo_ReportField="Add to Report Filter",i.PivotPanel_Fields_MoveTo_RowLabel="Add to Row Labels",i.PivotPanel_Fields_MoveTo_ColLabel="Add to Column Labels",i.PivotPanel_Fields_MoveTo_Value="Add to Values",i.PivotPanel_LabelOrValue_ClearFilter="Clear Filter",i.PivotPanel_ValueFilterOrLabel_Equals="Equals...",i.PivotPanel_ValueFilterOrLabel_NotEqual="Does Not Equal...",i.PivotPanel_ValueFilterOrLabel_GreaterThan="Greater Than...",i.PivotPanel_ValueFilterOrLabel_GreaterOrTo="Greater Than Or Equal To...",i.PivotPanel_ValueFilterOrLabel_LessThan="Less Than...",i.PivotPanel_ValueFilterOrLabel_LessOrTo="Less Than Or Equal To...",i.PivotPanel_ValueFilterOrLabel_Between="Between...",i.PivotPanel_ValueFilterOrLabel_NotBetween="Not Between...",i.PivotPanel_ValueFilter_Top10="Top 10...",i.PivotPanel_ValueFilterOrLabel_IsBeginWith="Begins With...",i.PivotPanel_ValueFilterOrLabel_NotBegin="Does Not Begin With...",i.PivotPanel_ValueFilterOrLabel_End="Ends With...",i.PivotPanel_ValueFilterOrLabel_NotEndWith="Does Not End With...",i.PivotPanel_ValueFilterOrLabel_Contain="Contains...",i.PivotPanel_ValueFilterOrLabel_NotContain="Does Not Contain...",i.ValueFilterOrLabel_Equals="equals",i.ValueFilterOrLabel_NotEqual="does not equal",i.ValueFilterOrLabel_GreaterThan="greater than",i.ValueFilterOrLabel_GreaterOrTo="greater than or equal to",i.ValueFilterOrLabel_LessThan="less than",i.ValueFilterOrLabel_LessOrTo="less than or equal to",i.ValueFilterOrLabel_Between="between",i.ValueFilterOrLabel_NotBetween="not between",i.ValueFilterOrLabelSelect_GreaterThan="is greater than",i.ValueFilterOrLabelSelect_GreaterOrTo="is greater than or equal to",i.ValueFilterOrLabelSelect_LessThan="is less than",i.ValueFilterOrLabelSelect_LessOrTo="is less than or equal to",i.ValueFilterOrLabelSelect_Between="is between",i.ValueFilterOrLabelSelect_NotBetween="is not between",i.ValueFilterOrLabel_IsBeginWith="begins with",i.ValueFilterOrLabel_NotBegin="does not begin with",i.ValueFilterOrLabel_End="ends with",i.ValueFilterOrLabel_NotEndWith="does not end with",i.ValueFilterOrLabel_Contain="contains",i.ValueFilterOrLabel_NotContain="does not contain",i.PivotPanel_ValueFilterOrLabel_Before="Before...",i.PivotPanel_ValueFilterOrLabel_After="After...",i.PivotPanel_ValueFilterOrLabel_Tomorrow="Tomorrow",i.PivotPanel_ValueFilterOrLabel_Today="Today",i.PivotPanel_ValueFilterOrLabel_Yesterday="Yesterday",i.PivotPanel_ValueFilterOrLabel_NextWeek="Next Week",i.PivotPanel_ValueFilterOrLabel_ThisWeek="This Week",i.PivotPanel_ValueFilterOrLabel_LastWeek="Last Week",i.PivotPanel_ValueFilterOrLabel_NextMonth="Next Month",i.PivotPanel_ValueFilterOrLabel_ThisMonth="This Month",i.PivotPanel_ValueFilterOrLabel_LastMonth="Last Month",i.PivotPanel_ValueFilterOrLabel_NextQuarter="Next Quarter",i.PivotPanel_ValueFilterOrLabel_ThisQuarter="This Quarter",i.PivotPanel_ValueFilterOrLabel_LastQuarter="Last Quarter",i.PivotPanel_ValueFilterOrLabel_NextYear="Next Year",i.PivotPanel_ValueFilterOrLabel_ThisYear="This Year",i.PivotPanel_ValueFilterOrLabel_LastYear="Last Year",i.PivotPanel_ValueFilterOrLabel_YearToDate="Year to Date",i.PivotPanel_ValueFilterOrLabel_MonthToDate="Month to Date",i.PivotPanel_ValueFilterOrLabel_QuarterToDate="Quarter to Date",i.PivotPanel_ValueFilterOrLabel_ParallelYearToDate="Parallel Year to Date",i.PivotPanel_ValueFilterOrLabel_ParallelMonthToDate="Parallel Month to Date",i.PivotPanel_ValueFilterOrLabel_ParallelQuarterToDate="Parallel Quarter to Date",i.PivotPanel_ValueFilterOrLabel_AllDates="All Dates in Period",i.PivotPanel_ValueFilterOrLabel_Custom="Custom Filter...",i.PivotPanel_Sort_A_Z="Sort A to Z",i.PivotPanel_Sort_Z_A="Sort Z to A",i.PivotPanel_Sort_Smallest_Largest="Sort Smallest to Largest",i.PivotPanel_Sort_Largest_Smallest="Sort Largest to Smallest",i.PivotPanel_Sort_More="More Sort Options...",i.PivotPanel_Filter_Clear="Clear Filter From {0}",i.PivotPanel_Filter_Label="Label Filters",i.PivotPanel_Filter_Value="Value Filters",i.PivotPanel_Date_Filter="Date Filters",i.Ok="OK",i.Cancel="Cancel",i.NumberFormat="Number Format",i.LabelFormat="Label Format",i.Number="Number",i.FormatCells="Format Cells",i.Sample="Sample",i.Type="Type",i.CustomFormats=["General","0","0.00","#,##0","#,##0.00","#,##0;(#,##0)","#,##0;[Red](#,##0)","#,##0.00;(#,##0.00)","#,##0.00;[Red](#,##0.00)","$#,##0;($#,##0)","$#,##0;[Red]($#,##0)","$#,##0.00;($#,##0.00)","$#,##0.00;[Red]($#,##0.00)","0%","0.00%","0.00E+00","##0.0E+0","# ?/?","# ??/??","m/d/yyyy","d-mmm-yy","d-mmm","mmm-yy","h:mm AM/PM","h:mm:ss AM/PM","hh:mm","hh:mm:ss","m/d/yyyy hh:mm","mm:ss","mm:ss.0","@","[h]:mm:ss",'$ #,##0;$ (#,##0);$ "-";@',' #,##0; (#,##0); "-";@','$ #,##0.00;$ (#,##0.00);$ "-"??;@',' #,##0.00; (#,##0.00); "-"??;@',"hh:mm:ss","00000","# ???/???","000-00-0000","dddd, mmmm dd, yyyy","m/d;@","[<=9999999]###-####;(###) ###-####","# ?/8"],i.Select_Field="Select field",i.PivotPanel_Filter_SelectAll="Check All",i.PivotPanel_Filter_NoSelectAll="Uncheck All",i.PivotPanel_Filter_Search="search",i.Label_Title="Label Filter",i.Label_Show="Show items for which the label",i.Use_Single_Character="Use ? to represent any single character",i.Use_Series_Characters="Use * to represent any series characters",i.Value_Show="Show items for which",i.Value_Title="Value Filter",i.Top_Ten_Filter="Top 10 Filter ",i.TopTenShow="show",i.Sort_Field_Dialog_Title="Sort",i.Sort_Field_Dialog_Sort_Options="Sort options",i.Sort_Field_Dialog_Summary="Summary",i.Sort_Field_Dialog_Ascending_Sort="Ascending (A to Z) by:",i.Sort_Field_Dialog_Descending_Sort="Descending (Z to A) by:",i.Sort_Field_Dialog_More_Options="More Options...",i.Sort_Field_More_Dialog_Title="More Sort Options",i.Sort_Field_More_Dialog_Sort_By="Sort By",i.Sort_Field_More_Dialog_Values_In_Selected_Area="Values in selected {{AREA}}",i.Sort_Value_Dialog_Title="Sort By Value",i.Sort_Value_Dialog_Sort_Direction="Sort direction",i.Sort_Value_Dialog_Asc="Smallest to Largest",i.Sort_Value_Dialog_Desc="Largest to Smallest",i.Sort_Value_Dialog_Top_To_Bottom="Top to Bottom",i.Sort_Value_Dialog_Left_To_Right="Left to Right",i.Custom_Sort_Summary="Custom Sort",i.Sort_Order_ASC="ascending order",i.Sort_Order_DESC="descending order",i.Sort_In_Row="row",i.Sort_In_Column="column",i.Sort_Summary_Pattern="Sort {{FIELD_NAME}} in {{ORDER}}",i.Sort_Value_Summary_Pattern="Sort {{FIELD_NAME}} by {{SELECTED_FIELD_NAME}} in {{ORDER}}",i.Sort_More_Summary_Pattern="Sort {{FIELD_NAME}} by {{SELECTED_FIELD_NAME}} in {{ORDER}} using values in this {{ROW_COLUMN}}:\r\n",i.Invalid_Sort_Range="The Sort Reference is not valid. Make sure that it's within the data you want to sort, and the first Sort By box isn't the same or blank.",i.Invalid_Field_Sort_By="Cannot determine which PivotTable field to sort by.",i.Top="Top",i.Bottom="Bottom",i.Top_Item="Items",i.Top_Percent="Percent",i.Top_Sum="Sum",i.ByJoiner="by",i.AndJoiner="and",i.Q1="Quarter 1",i.Q2="Quarter 2",i.Q3="Quarter 3",i.Q4="Quarter 4",i.Jan="January",i.Feb="February",i.Mar="March",i.Apr="April",i.May="May",i.Jun="June",i.Jul="July",i.Aug="August",i.Sep="September",i.Oct="October",i.Nov="November",i.Dec="December",i.IsBefore="is before",i.IsBeforeOrEqual="is before or equal to",i.IsAfter="is after",i.IsAfterOrEqual="is after or equal to",i.IsBetween="is between",i.IsNotBetween="is not between",i.DateFilterTitle="Date Filter",i.DateShow="Show items for which the date",i.WholeDays="Whole Days",e=n("./dist/plugins/pivot/lr.gcn.js"))e.hasOwnProperty(r)&&(i[r]=e[r]);function o(){return[i.ValueFilterOrLabel_Equals,i.ValueFilterOrLabel_NotEqual,i.ValueFilterOrLabel_IsBeginWith,i.ValueFilterOrLabel_NotBegin,i.ValueFilterOrLabel_End,i.ValueFilterOrLabel_NotEndWith,i.ValueFilterOrLabel_Contain,i.ValueFilterOrLabel_NotContain,i.ValueFilterOrLabelSelect_GreaterThan,i.ValueFilterOrLabelSelect_GreaterOrTo,i.ValueFilterOrLabelSelect_LessThan,i.ValueFilterOrLabelSelect_LessOrTo,i.ValueFilterOrLabelSelect_Between,i.ValueFilterOrLabelSelect_NotBetween]}function a(){return[i.ValueFilterOrLabel_Equals,i.ValueFilterOrLabel_NotEqual,i.IsBefore,i.IsBeforeOrEqual,i.IsAfter,i.IsAfterOrEqual,i.IsBetween,i.IsNotBetween]}function s(){return[i.ValueFilterOrLabel_Equals,i.ValueFilterOrLabel_NotEqual,i.ValueFilterOrLabelSelect_GreaterThan,i.ValueFilterOrLabelSelect_GreaterOrTo,i.ValueFilterOrLabelSelect_LessThan,i.ValueFilterOrLabelSelect_LessOrTo,i.ValueFilterOrLabelSelect_Between,i.ValueFilterOrLabelSelect_NotBetween]}i.FieldSetting="Field Settings",i.ValueSetting="Value Field Settings",i.SourceName="Source Name:",i.CustomName="Custom Name:",i.SummarizeValue="Summarize Values By",i.ShowValueAs="Show Value As",i.CalculationForDialog="Calculation: ",i.BaseFieldForDialog="Base Field: ",i.BaseItemForDialog="Base Item: ",i.BaseItemNext="(next)",i.BaseItemPrevious="(previous)",i.SummarizeValueField="Summarize values field by",i.ShowValueAsField="Show value as",i.ChooseType="Choose the type of calculation that you want to use to summarize data from the selected field",i.Sum="Sum",i.Count="Count",i.Average="Average",i.Max="Max",i.Min="Min",i.Product="Product",i.CountNumbers="Count Numbers",i.StdDev="StdDev",i.StdDevp="StdDevp",i.Var="Var",i.Varp="Varp",i.sigmaValue="\u2211 Values",i.sigmaValueTemp="Values",i.DateFormatError="This isn't a valid date",i.noCalculation="No Calculation",i.percentGrandTotal="% of Grand Total",i.percentColumnTotal="% of Column Total",i.percentRowTotal="% of Row Total",i.percentEllipsis="% Of ...",i.percentParentRowTotal="% of Parent Row Total",i.percentParentColumnTotal="% of Parent Column Total",i.percentParentTotal="% of Parent Total ...",i.difference="Difference From ...",i.percentDifference="% Difference From ...",i.runningTotal="Running Total In ...",i.percentRunningTotal="% Running Total In ...",i.rankSmallestLargest="Rank Smallest to Largest ...",i.rankLargestSmallest="Rank Largest to Smallest ...",i.index="Index",i.showValueAsDialog=["","","","","% Of ","","","% of Parent Total ","Difference From ","% Difference From ","Running Total In ","% Running Total In ","Rank Smallest to Largest ","Rank Largest to Smallest ",""],i.baseField="Base field:",i.baseItem="Base item:",i.grouping="Grouping",i.auto="Auto",i.startingAt="Starting at:",i.endingAt="Ending at:",i.groupBy="By:",i.seconds="Seconds",i.minutes="Minutes",i.hours="Hours",i.days="Days",i.months="Months",i.quarters="Quarters",i.years="Years",i.numberOfDays="Number of days",i.NoHaveSpread="workbook exception",i.SourceError="Source data exception, cannot create PivotTable report",i.SourceNotIsTableNameOrFormula="source data not is table name and formula",i.SourceDataOnlyOne="This command requires at least two rows of source data. You cannot use the command on a selection in only row",i.FieldAreaLimited="The field you are moving cannot be placed in that area of the report.",i.Views="Views",i.Group="Group",i.param_error="the param is null or undefine",i.EmptyValueFieldError="You need at least one field in the Values area in order to apply a value filter",i.DefaultPivotTableViewName="PivotView",i.toolTipContent_Row="Row: ",i.toolTipContent_Column="Column: ",i.toolTipContent_Value="Value: ",i.toolTipContent_NoValue="No value",i.deferLayoutUpdate="Defer Layout Update",i.getStringLabelFilterItemText=o,i.getDateLabelFilterItemText=a,i.getValueFilterItemText=s,i.PivotTableErrorMessage_ShowDetail="Cannot show or hide detail for this selection",i.PivotTableErrorMessage_MakeChange="We can't make this change for the selected cells because it will affect a PivotTable. Use the field list to change the report. If you are trying to insert or delete cells, move the PivotTable and try again.",i.PivotTableErrorMessage_ExistData="There's already data in {}. Do you want to replace it?",i.PivotTableErrorMessage_EditWhenDefer="The PivotTable report cannot be edited with the Defer Layout Update check box selected. To edit the report, clear the Defer Layout Update check box at the bottom of the PivotTable Field List.",i.PivotTableErrorMessage_DuplicatedFieldName="PivotTable field name already exists.",i.PivotTableErrorMessage_EmptyFieldName="Cannot enter a null value as an item or field name in a PivotTable report.",i.PivotTableErrorMessage_Protect="That command cannot be performed while a protected sheet contains another PivotTable report based on the same source data. To remove protection from the sheet that has the other report, click the sheet tab, and then click Unprotect Sheet(Review tab, Changes group). Then try the command again.",i.PivotTableErrorMessage_EmptySourceFieldName="The PivotTable field name is not valid. To create a PivotTable report, you must use data that is organized as a list with labeled columns. If you are changing the name of a PivotTable field, you must type a new name for the field.",i.PivotTableErrorMessage_Overlap="A PivotTable report cannot overlap another PivotTable report.",i.PivotTableErrorMessage_InvalidChange="We can't change this part of the PivotTable.",i.PivotTableErrorMessage_InvalidGroup="Cannot group that selection.",i.PivotTableErrorMessage_InvalidReference="Reference isn't valid.",i.PivotTableForAccessibility="PivotTable: \r\nPivotTable Name: ",i.PivotTableCalcItemHasTowCacheField="If one or more fields in the PivotTable have calculated items, no fields can be used in the data area two or more times, or in the data area and another area at the same time. If you are trying to add a field, remove the calculated items and add the field again. If you are trying to add a calculated item, change the PivotTable report so that no field is used more than once and then add the calculated item.",i.PivotTableHasNumberOrDateGroup="This PivotTable report field is grouped, You cannot add a calculated item to a grouped field. To ungroup the field, make sure it is in the row or column area, select one of the items of the grouped field, click the Ungroup button in the Group group on the Analyze tab, and then insert the calculated item. After inserted, you can group the items of the field again.",i.PivotTableSubtotalType="Averages, standard deviations, and variances are not supported when a PivotTable report has calculated items.",i.PivotTableHasSameItemName="Calculated item or field could not be created because another item or field of the same name exists.",i.PivotTableCalcItemHasMultipleDataField="Multiple data Fields of the same field are not supported when a PivotTable report has calculated items.",i.PivotTableMoveCalcItemFieldToReport="This field cannot be placed in the report filter because it contains calculated items.To place this field in the report filter,first delete the calculated items.",i.PivotTableErrorFormula="An item name cannot be found. Check that you've typed the name correctly and the item is present in the PivotTable report.",i.SlicerNameInFormula="Slicer",i.search="Search",i.AddSearchResult="Add current selection to filter",i.Layout="Layout",i.showNoData="Show items with no data",i.showSubtotalTop="Display subtotals at the top of each group",i.TIMELINE_PLACE_HOLDER="{TL}",i.ALL_DATES_IN="All dates in ",i.ALL_PERIODS="All Periods",i.INVALID_DATE_SELECTION="Invalid Date Selection!",i.QUARTER_MAP=["","Q1","Q2","Q3","Q4"],i.DateNotEqual="Not "+i.TIMELINE_PLACE_HOLDER,i.DateNewerThan="After "+i.TIMELINE_PLACE_HOLDER,i.DateNewerThanOrEqual="After or on "+i.TIMELINE_PLACE_HOLDER,i.DateOlderThan="Before "+i.TIMELINE_PLACE_HOLDER,i.DateOlderThanOrEqual="Before or on"+i.TIMELINE_PLACE_HOLDER,i.DateNotBetween="Not Between "+i.TIMELINE_PLACE_HOLDER,i.AllDatesIn_Quarter1=i.ALL_DATES_IN+i.QUARTER_MAP[1],i.AllDatesIn_Quarter2=i.ALL_DATES_IN+i.QUARTER_MAP[2],i.AllDatesIn_Quarter3=i.ALL_DATES_IN+i.QUARTER_MAP[3],i.AllDatesIn_Quarter4=i.ALL_DATES_IN+i.QUARTER_MAP[4],i.AllDatesIn_January=i.ALL_DATES_IN+i.Jan,i.AllDatesIn_February=i.ALL_DATES_IN+i.Feb,i.AllDatesIn_March=i.ALL_DATES_IN+i.Mar,i.AllDatesIn_April=i.ALL_DATES_IN+i.Apr,i.AllDatesIn_May=i.ALL_DATES_IN+i.May,i.AllDatesIn_June=i.ALL_DATES_IN+i.Jun,i.AllDatesIn_July=i.ALL_DATES_IN+i.Jul,i.AllDatesIn_August=i.ALL_DATES_IN+i.Aug,i.AllDatesIn_September=i.ALL_DATES_IN+i.Sep,i.AllDatesIn_October=i.ALL_DATES_IN+i.Oct,i.AllDatesIn_November=i.ALL_DATES_IN+i.Nov,i.AllDatesIn_December=i.ALL_DATES_IN+i.Dec,i.TIME_LEVEL_YEARS="YEARS",i.TIME_LEVEL_QUARTERS="QUARTERS",i.TIME_LEVEL_MONTHS="MONTHS",i.TIME_LEVEL_DAYS="DAYS",i.PivotTableErrorMessage_ExistTable="A PivotTable report cannot overlap a table."},"./dist/plugins/pivot/sheet-range-to-pivot-area.js":function(L,t,i){"use strict";var v,n,g,y,i,n,C,A,h,e,c,l,f,d,N,I,T,S,p,x,M,D,E,k,i,r,n,o,a,B,a,s,u,R,G,V,U,m,a;function b(t,i){return{condition:t,checker:i}}function Q(t,i,n,e,r,o){for(var a,s,u,c,u,a=j(r,n.row,n.col),s=0;s<t.length;s++)if(c=(u=t[s]).conditions,u=u.pivotArea,c.every(function(t){return W(t,i,n,e,r,a,o)}))return et(u,i,n,e,a,r,o);return h}function W(t,i,n,e,r,o,a){var s,u,c,s=t.condition,u,c;return(0,t.checker)(z(s,i,n,e,r,a),i,o,r,a)}function z(t,i,n,e,r,o){var t;return"boolean"==typeof t||void 0!==(t=(0,v.RF)(t)||{}).value&&(t.value=Z(t.value,r,e,o,n,i)),t}function Z(t,i,n,e,r,o){var a,s,u,c;if(t!==A){if(a=function(t){return Y(t,i,n,e,r,o)},"object"!=typeof t)return a(t);switch(s=t.value1,u=t.operator,c=t.value2,u){case 6:return a(s)-a(c);case 5:return a(s)+a(c);case 8:return a(s)/a(c);case 7:return a(s)*a(c);default:return a(s)}}}function Y(t,i,n,e,r,o){var a,s,u,c,l,f,h,h,v,h,d,p,m,b,g,w,s=j(i,r.row,r.col),u=3===e;switch(t){case I:return i.getFieldsByArea(y.PivotTableFieldType.columnField).length;case N:return i.getFieldsByArea(y.PivotTableFieldType.rowField).length;case S:return n.rowCount;case T:return n.colCount;case x:if(s){if(u&&i.layoutType()===y.PivotTableLayoutType.compact)return 1;if(!(c=u?s.rowInfos:s.colInfos))return 1;for(l=c.length-1;c[l]&&c[l].itemName===A;)l--;if(f=c[l],h=(u?i.rZt.HWt[3]:i.rZt.HWt[2]).YWt,f&&(v=h[h=(h=f.fieldName)===C().sigmaValue?C().Values:h][f.itemName].ranges)){for(h=o.row,d=o.col,f.isBlankRow&&(h-=i.options.subtotalsPosition===y.SubtotalsPosition.bottom?2:1),m=p=v.indexOf(u?h:d),b=1;v[p-1]!==A&&v[p-1]===v[p]-1;)b++,p--;for(;v[m+1]!==A&&v[m+1]===v[m]+1;)b++,m++;return b}}break;case D:return null!=s&&s.rowInfos?s.rowInfos.length-1:0;case M:return null!=s&&s.colInfos?s.colInfos.length-(!i.options.showHeaders&&i.dh.getSigmaValuePosition().display?1:0):0;case k:if(s&&(g=!1,c=u?s.rowInfos:s.colInfos)){for(w=0;w<c.length;w++)if(!0===(null==(a=c[w])?void 0:a.isSubtotal)){g=!0;break}if(g)return u?o.row:o.col}break;default:return+t}}function j(t,i,n){return t.getPivotInfoImp(i,n)}function H(t,i){var n,e,r,o,a,n,s,u,c,l,f,h,v,d;if(t&&i){for(n=i.row,e=i.col,r=i.rowCount,o=i.colCount,a=j(t,n,e),n=j(t,n+r-1,e+o-1),l=[],-1!==(c=tt(s=a.area,u=n.area)).indexOf(0)&&(f=it(0,t),l=X(t,h=i.getIntersect(f,0,0))),v=1;v<5;v++)-1!==c.indexOf(v)&&(f=it(v,t),d=[],(h=i.getIntersect(f,0,0))&&w(h,h.row,h.col,t,d,t.rZt.HWt[v]),l=l.concat(K(d,v,t)));return l}}function w(t,i,n,e,r,o){var a,s,u,c,l,f,h,a=i,s=n,u=j(e,i,n),c=O(u),l=o.QWt;if(1===l||2===l&&0===u.relativeRow)(1===l&&!u.cornerFieldInfo||2===l&&!u.colHeadFieldInfo)&&(s=t.col+t.colCount-1,1===l)&&i===t.row&&(a=t.row+t.rowCount-(1===t.rowCount?1:2));else{for(h=n+1;h<n+t.colCount;h++){if(q(f=u,u=j(e,a,h),a,h,t,c,o,!1)){s=h-1;break}h===n+t.colCount-1&&(s=h)}for(h=i+1;h<i+t.rowCount;h++){if(q(f=u?u:f,u=j(e,h,s),h,s,t,c,o,!0)){a=h-1;break}h===i+t.rowCount-1&&(a=h)}}r.push(new v.Range(i,n,a-i+1,s-n+1)),a===t.row+t.rowCount-1&&s===t.col+t.colCount-1||(s===t.col+t.colCount-1?w(t,a+1,t.col,e,r,o):w(t,i,s+1,e,r,o))}function O(t,i,n){var e,r,o,a,e=t.rowInfos,r=t.colInfos,o=m.none;if(e&&!n)for(a=0;a<e.length;a++)(e[a].isSubtotal||e[a].isGrandTotal)&&(o+=m.row);if(r&&!i)for(a=0;a<r.length;a++)(r[a].isSubtotal||r[a].isGrandTotal)&&(o+=m.col);return o}function J(t,i,n){var e,r,o,a,r;if(t&&i){if((e=t.length)!==(r=i.length))return 1;for(o=e-2;-1<o;o--)if(t[o].itemName!==i[o].itemName)return 1;return a=t[e-1],r=i[r-1],n!==e&&a.fieldName===r.fieldName&&a.fieldName===C().sigmaValue&&a.itemName!==r.itemName}}function q(t,i,n,e,r,o,a,s){var u,n,e,r,c,l,u=a.QWt;if(n>r.row+r.rowCount-1||e>r.col+r.colCount-1)return 1;if(t&&i)if(s){if(3===a.QWt){if((n=a.zWt)&&(e=n[t.relativeRow],r=n[i.relativeRow],e)&&r&&e.YAt!==r.YAt)return 1}else if(J(t.rowInfos,i.rowInfos,a.ZWt.length))return 1}else if(J(t.colInfos,i.colInfos,a.ZWt.length))return 1;if(4===u&&o){if(s&&o===m.col&&O(i,!0)||!s&&o===m.row&&O(i,void 0,!0))return 1}else if(O(i))return 1;if(3===u&&!o&&!s)return 1;if(2===u&&!o&&s)return 1;if(o)if(3===u&&s){if(c=a.zWt[i.relativeRow],l=a.zWt[i.relativeRow-1],c.path!==l.path)return 1}else if(2!==u||s){if(4===u&&(o&m.row&&s||o&m.col&&!s))return 1}else if(c=a.WWt[i.relativeColumn],l=a.WWt[i.relativeColumn-1],c.path!==l.path)return 1}function K(t,i,n){var e;switch(i){case 1:e=R;break;case 2:e=G;break;case 3:e=V;break;case 4:e=U;break;default:return}return $(n,t,i,e)}function X(t,i){for(var n,e,r,o,n=[],e=i.row;e<i.row+i.rowCount;e++)for(r=i.col;r<i.col+i.colCount;r++)(o=j(t,e,r)).relativeColumn%3==1?n.push({labelOnly:!0,references:[{fieldName:o.pageFieldInfo.fieldName}]}):o.relativeColumn%3==0&&n.push({labelOnly:!0,type:y.PivotAreaType.button,fieldName:o.pageFieldInfo.fieldName});return n}function $(o,t,a,s){var u,c,i,l,f,u=[],c=o.rZt.HWt[a].getRange(),i=o.getRange().content,l=i.row,f=i.col;return(0,g.o)(t,function(t){var i,n,e,r,i,n,i=t.row,n=t.col,e=t.rowCount,r=t.colCount,i={row:i-c.row-l,col:n-c.col-f,rowCount:e,colCount:r},n=Q(s,i,t,c,o,a);n!==h&&u.push(n)}),u}function tt(t,i){return 0===i?[0]:1===i?[1]:3===i?1===t?[1,3]:[3]:2===i?1===t?[1,2]:[2]:4===i?1===t?[1,2,3,4]:2===t?[2,4]:3===t?[3,4]:4===t?[4]:void 0:void 0}function it(t,i){var n,t;return i.Oy()||(0,g.ht)(t)?h:0===t?i.getRange().page:((t=(n=i.rZt.HWt)[t].getRange()).row+=i.eZt.row,t.col+=i.eZt.col,t)}function _(t){return t===C().sigmaValue?C().Values:t}function F(t,i){var n=i.rowCount-1,i=i.colCount-1;1!==t.rowCount&&t.row+t.rowCount-1==n&&(t.rowCount=e),1!==t.colCount&&t.col+t.colCount-1==i&&(t.colCount=e),t.row===n&&(t.row=e),t.col===i&&(t.col=e)}function nt(t,i,n,e,r){var o,n,o,n=(0,v.RF)(n)||{};n.offset=A,null!=(o=n.references)&&o.forEach(function(t){t.xqt=!0}),(o=i.getPivotAreaRanges(n))&&o[0]&&(t.row=e.row-o[0].row,t.col=e.col-o[0].col,F(t,o[0]))}function et(t,i,n,e,r,o,a){var s,u,r,r,r,u,r,s=(0,v.RF)(t)||{};if(t.fieldName===c){if(!(r=rt(r,n,a)))return h;s.fieldName=_(r)}if(t.references===l&&(s.references=ot(n,o)),r=!0===t.grandRow&&!0===t.grandCol,t.references===f){if(0===(u=at(n,o)).length&&!r)return null;s.references=u}if(t.references===f+l){if(0===(u=st(n,o)).length&&!r)return null;s.references=u}return t.references===d&&(s.references=[{fieldName:C().Values}]),s.references&&0===s.references.length&&delete s.references,!0===t.grandRow&&t.labelOnly&&(r=o.rZt.HWt[3].ZWt.length,i.colCount!==r)&&(s.offset={row:0,col:i.col,rowCount:1,colCount:i.colCount}),!0===t.grandCol&&t.labelOnly&&ut(o,i,s),t.offset===p&&(u={row:i.row,col:i.col,rowCount:i.rowCount,colCount:i.colCount},2===a?(r=o.rZt.HWt[2].ZWt.length,0===u.row?(u.col-=r,F(u,new v.Range(0,0,1,e.colCount-r))):nt(u,o,s,n,i)):1===a?F(u,new v.Range(0,0,e.rowCount-1,e.colCount)):3===a&&nt(u,o,s,n,i),s.offset=u),s}function rt(t,i,n){var e;switch(n){case 1:return(e=t.cornerFieldInfo).fieldName||h;case 2:if(e=t.colHeadFieldInfo)return e.fieldName;e=t.activeColFieldInfo;break;case 3:e=t.activeRowFieldInfo}return e?e.name:h}function ot(o,a){for(var s,u,t,i,s=[],u=o.row,t=function(e){var t,r,i,n,n,t=j(a,u,e),r=t.colInfos;r?(0,g.o)(r,function(t,i){var n;e===o.col?(n={fieldName:_(t.fieldName),items:[t.itemName]},t.isSubtotal&&t.collapseIndex===A&&(n.subtotal=!0),s[i]=n):i!==r.length-1||s[i].items.includes(t.itemName)||s[i].items.push(t.itemName)}):(n=(i=a.rZt.HWt[2]).WWt)&&(n=n[t.relativeColumn])&&""===n.path&&n.valueFieldName&&s.push({fieldName:C().Values,items:[n.valueFieldName]})},i=o.col;i<o.col+o.colCount;i++)t(i);return s}function at(t,i){for(var n,e,r,o,a,s,u,c,l,f,h,v,n=[],e=t.col,r=i.layoutType()===y.PivotTableLayoutType.tabular,o=t.row;o<t.row+t.rowCount;o++)if(s=(a=j(i,o,e)).rowInfos)for(u=0,c=s.length;u<c;u++){if(!0===(l=s[u]).isBlankRow)return[];o===t.row&&l.itemName!==A?(f={fieldName:_(l.fieldName),items:[l.itemName]},v=void 0,(h=i.zRt(f.fieldName))&&(v=h.Spi),!l.isSubtotal||l.collapseIndex!==A||v&&!r||(f.subtotal=!0),n[u]=f):u===s.length-1&&n[u]&&!n[u].items.includes(l.itemName)&&n[u].items.push(l.itemName)}return n}function st(o,i){for(var t,a,s,n,e,r,u,c,l,f,h,v,d,p,m,b,t=[],a=[],s=o.row,n=o.col,e=i.layoutType()===y.PivotTableLayoutType.tabular,r=o.row;r<o.row+o.rowCount;r++)if(c=(u=j(i,r,n)).rowInfos)for(f=l=0,h=c.length;f<h;f++){if(!0===(v=c[f]).isBlankRow)return[];r===o.row?(0,g.ht)(v.fieldName)||(0,g.ht)(v.itemName)||(d={fieldName:_(v.fieldName),items:[v.itemName]},m=void 0,(p=i.zRt(d.fieldName))&&(m=p.Spi),!v.isSubtotal||v.collapseIndex!==A||m&&!e||(d.subtotal=!0),t[l]&&(l+=1),t[l]=d):(l!==c.length-1||(0,g.ht)(v.itemName)||(t[l].items?t[l].items.includes(v.itemName)||t[l].items.push(v.itemName):t[l].items=[v.itemName]),l+=1)}for(b=function(n){var t,e,r,t,e=j(i,s,n).colInfos;e&&(r=0,g.o)(e,function(t){var i;n===o.col?t.fieldName&&t.itemName&&(i={fieldName:_(t.fieldName),items:[t.itemName]},t.isSubtotal&&t.collapseIndex===A&&(i.subtotal=!0),a[r]&&(r+=1),a[r]=i):(r!==e.length-1||(0,g.ht)(t.itemName)||(a[r].items?a[r].items.push(t.itemName):a[r].items=[t.itemName]),r+=1)})},r=o.col;r<o.col+o.colCount;r++)b(r);return t.concat(a)}function ut(t,i,n){var t,e,r,o,a,s,t,t=t.rZt.HWt[2],e=t.getRange(),r=e.rowCount-1,o=0,a=t.WWt;if(a)for(s=a.length-1;0<=s;s--)if(a[s]&&!0!==a[s].isGrandTotal){o=s;break}t=e.colCount-o,i.rowCount===r&&i.colCount===t||(n.offset={row:i.row-1,col:i.col-o-1,rowCount:i.rowCount,colCount:i.colCount})}function P(t,i){var n,e;if(t===A)return!0;switch(n=t.value,e=t.operator){case 1:return n<i;case 2:return n<=i;case 3:return i<n;case 4:return i<=n;default:return i===n}}function ct(t,i,n){var e,t,r,e=t.rowInfos,t=t.colInfos,r=!1;return i&&e&&0<e.length&&(0,g.o)(e,function(t){t.isGrandTotal&&(r=!0)}),n&&t&&0<t.length&&(0,g.o)(t,function(t){t.isGrandTotal&&(r=!0)}),r}Object.defineProperty(t,"__esModule",{value:!0}),t.rangeToAreas=void 0,v=i("Core"),n=i("@spreadjs/js-sheets-common"),g=i("Pivot"),y=i("./dist/plugins/pivot/pivot-core/pivot-core-interface.js"),i=i("./dist/plugins/pivot/pivot.ns.js"),n=new n.Common.ResourceManager(i.SR,"PivotTables"),C=n.getResource.bind(n),A=void 0,h=null,e=1/0,c="__FieldName__",l="__ColInfo__",f="__RowInfo__",d="__Values__",N="__RowFieldCount__",I="__ColFieldCount__",T="__FullCol__",p="__Offset__",x="__FullItem__",M="__SameRow__",D="__SameCol__",E="__BlankRow__",k="__Subtotal__",R=[{conditions:[b({value:{value1:S="__FullRow__",operator:6,value2:1}},i=function(t,i,n,e,r){return P(t,i.row)}),b({value:1},n=function(t,i,n,e,r){return P(t,i.rowCount)}),b({value:1},o=function(t,i,n,e,r){return P(t,i.colCount)})],pivotArea:{type:y.PivotAreaType.button,labelOnly:!0,fieldName:c}},{conditions:[b({value:0},i),b({value:0},r=function(t,i,n,e,r){return P(t,i.col)}),b({value:{value1:S,operator:6,value2:1}},n),b({value:T},o)],pivotArea:{type:y.PivotAreaType.corner,labelOnly:!0}},{conditions:[],pivotArea:{type:y.PivotAreaType.corner,labelOnly:!0,offset:p}}],G=[{conditions:[b({value:0},i),b({value:I,operator:2},r),b({value:1},n),b({value:{value1:T,operator:6,value2:I}},o),b(!0,a=function(t,i,n,e,r){return t?n.value===h:n.value!==h})],pivotArea:{type:y.PivotAreaType.topRight}},{conditions:[b({value:0},i),b({value:I,operator:2},r),b({value:1},n),b(!0,a)],pivotArea:{type:y.PivotAreaType.topRight,offset:p}},{conditions:[b({value:1},o),b(!0,u=function(t,i,n,e,r){return t&&ct(n,!1,!0)})],pivotArea:{labelOnly:!0,grandCol:!0}},{conditions:[b({value:0},i),b({value:1},n),b({value:1},o),b(!(s=function(t,i,n,e,r){return t&&ct(n,!0,!1)}),a),b(!(a=function(t,i,n,e,r){var t;return!1!==t||(2===r||3===r)&&0<(null==(t=e.getFieldsByArea(2===r?y.PivotTableFieldType.columnField:y.PivotTableFieldType.rowField))?void 0:t.length)}),a)],pivotArea:{type:y.PivotAreaType.button,labelOnly:!0,fieldName:c}},{conditions:[b({value:k},r),b({value:I},n)],pivotArea:{labelOnly:!0,references:l}},{conditions:[b({value:k},r)],pivotArea:{labelOnly:!0,references:l,offset:p}},{conditions:[b({value:x,operator:2},o)],pivotArea:{labelOnly:!0,references:l}},{conditions:[],pivotArea:{labelOnly:!0,references:l,offset:p}}],V=[{conditions:[b({value:1},n),b(!0,s)],pivotArea:{labelOnly:!0,grandRow:!0}},{conditions:[b({value:k},i),b({value:N},o)],pivotArea:{labelOnly:!0,references:f}},{conditions:[b({value:k},i)],pivotArea:{labelOnly:!0,references:f,offset:p}},{conditions:[b({value:x,operator:2},n)],pivotArea:{labelOnly:!0,references:f}},{conditions:[],pivotArea:{labelOnly:!0,references:f,offset:p}}],U=[{conditions:[b({value:0},i),b({value:0},r),b({value:1},n),b({value:1},o),b(!0,B=function(t,i,n,e,r){var t,t;return t&&!(0<(null==(t=n.rowInfos)?void 0:t.length)||0<(null==(t=n.colInfos)?void 0:t.length))})],pivotArea:{dataOnly:!0,references:d}},{conditions:[b(!0,s),b(!0,u)],pivotArea:{grandRow:!0,grandCol:!0,references:f+l}},{conditions:[b({value:1},n),b(!0,s)],pivotArea:{grandRow:!0,references:f+l}},{conditions:[b({value:1},o),b(!0,u)],pivotArea:{grandCol:!0,references:f+l}},{conditions:[],pivotArea:{references:f+l}}],t.rangeToAreas=H,(a=m=m||{})[a.none=0]="none",a[a.row=1]="row",a[a.col=2]="col"},"./node_modules_local/@spreadjs/js-pivot/dist/gc.pivot.js":function(t,i,o){var n,i,a,e;!function(){"use strict";var n,e,t;function r(t){var i,i,i=e[t];return void 0!==i||(i=e[t]={exports:{}},n[t].call(i.exports,i,i.exports,r)),i.exports}n={"./pivot-entry.ts":function(t,i,n){var e,r,o,a,e=this&&this.__createBinding||(Object.create?function(t,i,n,e){void 0===e&&(e=n);var r=Object.getOwnPropertyDescriptor(i,n);r&&("get"in r?i.__esModule:!r.writable&&!r.configurable)||(r={enumerable:!0,get:function(){return i[n]}}),Object.defineProperty(t,e,r)}:function(t,i,n,e){t[e=void 0===e?n:e]=i[n]}),r=this&&this.__exportStar||function(t,i){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(i,n)||e(i,t,n)};Object.defineProperty(i,"__esModule",{value:!0}),i.mXt=i.SR=void 0,o=n("./src/pivotEngine.res.en.ts"),i.SR={en:o.resource},r(n("./src/pivot-interface.ts"),i),r(n("./src/pivot-util.ts"),i),r(n("./src/pivot-condition.ts"),i),r(n("./src/pivot-cache.ts"),i),r(n("./src/data-analyzer.ts"),i),r(n("./src/pivot-engine.ts"),i),r(n("./src/pivot-calc-engine.ts"),i),a=n("./src/pivot-sort.ts"),Object.defineProperty(i,"mXt",{enumerable:!0,get:function(){return a.mXt}})},"./src/data-analyzer.ts":function(a,K,t){var I,Y,H,X,x,J,i,t,i,c,z,h,s,u,f,M,D,r,d,p,b,y,C,A,N,m,T,S,_,l,$,tt,W,Z,g,w,F,P,L,Q,q;function it(t,i,n){if((0,X.ht)(t)&&(0,X.ht)(i))return z;if((0,X.ht)(t))return i;if((0,X.ht)(i)&&4!==n)return t;if(t instanceof x.CalcError)return t;if(i instanceof x.CalcError)return i;switch(n){case 0:return t+i;case 1:return t-i;case 2:var e;return 0===t||0===i?0:0*(e=t*i)!=0?x.Errors.Number:e;case 3:return 0===i?x.Errors.DivideByZero:t/i;case 5:return u(t,i);case 6:return s(t,i);case 4:return f(t)}}function k(t){return!(0,X.ht)(t)&&M(+t)}function st(t,i,n,e){var r,o,a,s,i,u,c,l,f,h,r=[],o=[],a=[],s=0;for(""!==i&&(s=(i=i.split(K.Separator)).length,r=r.concat(i)),c=0,l=u=Object.keys(n);c<l.length;c++)f=l[c],o.push({fieldInfo:""===f?r:r.concat(f.split(K.Separator)),calcIndex:n[f]});return h=t.bXt,e.forEach(function(t,i){a[i]=h[t]}),E(t,o,a=a.splice(t.gXt,s).concat(a.splice(0,t.gXt)))}function E(t,i,r){for(var o,n,e,a,s,u,o=t.wXt,n=[],e=function(t){var e={fieldInfos:[],calcIndex:t.calcIndex};t.fieldInfo.forEach(function(t,i){var n=o.getField(r[i]);e.fieldInfos.push({fieldName:r[i],fieldItem:n.getFieldsItemList()[t]})}),n.push(e)},a=0,s=i;a<s.length;a++)e(u=s[a]);return n}function n(t,i){this.yXt={},this.CXt={},this.IXt={},this.CZt={},this.AXt={},this.NXt={},this.TXt={},this.MXt=!1,this.wY=[],this.DU=t,this.wXt=i}function B(t,i){var i=i.getField(t);return!(!i||(0,X.ht)(i.D5))}function e(t,i,n,e,r){var u,c;this.xXt={},this.sx={},u=this,c=[],(0,X.o)(t,function(t,i){var n=t.index,e=t.displayName,r=t.isDim,o=t.isGroupField,a=t.getGroupItem,s=t.databaseField,t=t.dataFieldIndex;r&&(c.push({index:n,fieldName:e,isGroupField:o,getGroupItem:a,databaseField:s,dataFieldIndex:t}),u.xXt[e]=i,u.sx[e]=i)}),u.DXt=c,u.SXt=u.kXt(i,n),u.jXt=u.OXt(u.SXt),u.PXt=u.kXt(e,n),u.FXt=u.kXt(r,n,!0),u._Xt={},u.LXt={},u.tx=[],u.EXt=[]}function R(t,i){var d;(0,X.ht)(i)||i.length<1||(d=t.wY,(0,X.o)(i,function(t){for(var i,n,e,r,o,a,s,u,c,l,f,h,v,s,i=t.cacheName,n=t.subTotalTypes,e=t.isCalculatedField,r=0,o=d;r<o.length;r++)u=(s=(a=o[r])[i].calc).count,c=s.sum,l=s.max,f=s.min,h=s.sumx2,v=s.product,s=s.len,a[i].calcResult=(0,K.BXt)({count:u,sum:c,max:l,min:f,sumx2:h,product:v,len:s},n)}))}function G(t,i,n,e,r,o,a,s,u,c,l,f,h){var v,d,p,m,b,g,w,y,C,A,N,I,T,S,x;if(!(t.YAt>=s||0===t.oYt.length)){if(v=i.wXt,p=(d=t.oYt)[0].rYt,m=n[t.YAt].sourceName,b={},g=i.gXt,u[p])for(w=void 0,t.YAt<g&&(w=i.RXt.columnNodeInfo),C=0,A=y=V(v,m,a,f,r,g);C<A.length;C++)N=A[C],o.itemKeys&&(0,X.ht)(o.itemKeys[N])&&(0,X.ht)(b[N])&&(a.push({pathStr:N,dimName:p}),b[N]=1,j(i,n,e,r,a,s,t.YAt<i.gXt,w,c,l,f,h),a.pop());for(I=0,T=d;I<T.length;I++)S=T[I],(x=void 0,X.ht)(b[S.pathStr])&&(a.push({pathStr:S.pathStr,dimName:S.rYt}),G(S,i,n,e,r,x=S.YAt===i.gXt?i.RXt.columnNodeInfo:o.itemKeys[S.pathStr],a,s,u,c,l,f,h),a.pop())}}function j(t,i,n,e,r,o,a,s,u,c,l,f){var h,v,d,p,m,b,g,w,y,h,C,A,N,v,d,m,h,I,T,h=r.length,v=t.wXt;if(h<o){if(d=i[h].sourceName,p=i[h].displayName,m=t.gXt,a===h<t.gXt)for(g=0,w=b=V(v,d,r,l,e,m);g<w.length;g++)y=w[g],r.push({pathStr:y,dimName:p}),j(t,i,n,e,r,o,a,s,u,c,l,f),r.pop();else if(h=s&&s.itemKeys,!(0,X.ht)(h))for(A=0,N=C=Object.keys(h);A<N.length;A++)y=N[A],r.push({pathStr:y,dimName:p}),j(t,i,n,e,r,o,a,s.itemKeys[y],u,c,l,f),r.pop()}else v=t.Nkt,d=t.yZt,m=(0,K.GXt)(),h=t.nv(),I=o-t.gXt,T=t.RXt,v.addChildItem(r,m,h,t,f,i,n,c.rootPosition,t.gXt,!1,"",!1,0,v.UZt,u,!1,T.rowNodeInfo),d.addChildItem(rt(r,t.gXt),m,h,t,f,i,n,c.headerPosition,I,!0,"",!1,0,d.UZt,u,!1,T.columnNodeInfo)}function V(t,i,n,e,r,o){for(var a,s,u,c,l,L,f,h,v,d,p,m,b,g,w,y,C,A,N,I,E,T,S,x,M,D,k,j,O,_,o,F,P,a=t.getField(i),s=a.y1||i,l=n.length,L,f=l<o?0:o,h=r[i],v=l-1;f<=v;v--)if(s===(u=(c=t.getField(e[v])).y1||e[v])){if(d=n[v].pathStr,p=c.Rs,m=a.Rs,b={3:H.DateGroupType.days,4:H.DateGroupType.months,5:H.DateGroupType.quarters},!(g=void 0,X.ht)(m)&&!(0,X.ht)(p)&&b[m]&&b[p])g=U(p,m,d);else if((0,X.ht)(m)&&(0,X.ht)(p))g=ht(t,i,e[v],d,r[i]);else if(0===d)g=[0];else if(c.DH().length-1===d)g=[a.DH().length-1];else{for(w=a.DH(),y=a.M(),C=[],A=0,N=w;A<N.length;A++)I=N[A],C.push(y[I]);C.pop(),C.shift(),g=C}if(h.isAll)return g;for(T={},S=[],x=0,M=E=h.items;x<M.length;x++)T[I=M[x]]=!0;for(D=0,k=g;D<k.length;D++)T[j=k[D]]&&S.push(j);return S}if(h.isAll){for(w=a.DH(),y=a.M(),g=[],O=0,_=w;O<_.length;O++)I=_[O],g.push(y[I]);return g}if(o=Object.keys(h.items),a.cC()){for(y=[],F=0,P=o;F<P.length;F++)I=P[F],y.push(a.AQt[I]);return y}return o}function U(t,i,n){var e,r,o,a,s;if(i<t){if(t!==H.DateGroupType.quarters)return lt(n);if(e=ft(n),i!==H.DateGroupType.days)return e;for(r=[],o=0,a=e;o<a.length;o++)s=a[o],r=r.concat(lt(s));return r}return t===H.DateGroupType.days?(s=ut(n),i===H.DateGroupType.quarters?ct(s[0]):s):ct(n)}function ut(t){for(var i,n,i=r.length,n=0;n<i;n++)if(r[n]<=t&&r[n+1]>t)return[n]}function ct(t){return 0===t?[0]:13===t?[5]:[Math.floor((t-1)/3)+1]}function lt(t){var i,n,e,i=[];for((0,X.ht)(r[t])||(n=r[t],e=r[t+1]);n<e;n++)i.push(n);return i}function ft(t){var i,n,e,r,i=[],r=[0,1,4,7,10,13,14];for((0,X.ht)(r[t])||(n=r[t],e=r[t+1]);n<e;n++)i.push(n);return i}function ht(t,i,n,e,r){var i,t,o,a,n,s,u,c,l,f,u,h,v,d,p,i=t.getField(i),t=t.getField(n),a=[];if(i.cC())n=t.DH()[+e],s=i.VXt,u=i.AQt,o=s&&u&&u[s[n]],(0,X.ht)(o)||a.push(o);else for(u=(c=t.N)[f=(l=t.cx)[+e]],h=i.P,v=0,d=u;v<d.length;v++)o=h[p=d[v]],a.push(o);return a}function vt(t){var i,n,e;if(!(0,X.ht)(t))for(i=0,n=t;i<n.length;i++)if((e=n[i]).showDataAs!==H.PivotShowDataAs.normal)return 1}function dt(t,i,n,e,r,o,a,s){var u,c,l,f,h,v,u=t.Nkt,c=t.gXt;if(0!==c&&a-c!=0)for(l=[],f=0,h=s;f<h.length;f++)pt(u,t,i,n,e,l,a,r,o,(v=h[f]).cacheName)}function pt(t,i,n,e,r,o,a,s,u,c){var l,f,h,v,d;for(t.YAt===i.gXt&&O(t,i,n,e,r,l=i.RXt.columnNodeInfo.itemKeys,o,a,s,u,!1,c),h=0,v=f=t.oYt;h<v.length;h++)d=v[h],o.push({pathStr:d.pathStr,dimName:d.rYt}),pt(d,i,n,e,r,o,a,s,u,c),o.pop()}function O(t,i,n,e,r,o,a,s,u,c,l,f){var h,v,d,p,m,b,h,g,w,y,C,A,N,I,T,h,v,S,x,M,D,h=a.length;if(h<s)if(v=Object.keys(o),l)for(d=n[h],p=0,m=v;p<m.length;p++)b=m[p],a.push({pathStr:b,dimName:d.displayName}),O(null,i,n,e,r,o[b].itemKeys,a,s,u,c,l,f),a.pop();else{for(g={},w=(h=t.oYt)[0].rYt,y=h[0].kYt,C=0,A=h;C<A.length;C++)g[(N=A[C]).pathStr]=1,y||(a.push({pathStr:N.pathStr,dimName:w}),O(N,i,n,e,r,o[N.pathStr].itemKeys,a,s,u,c,l,f),a.pop());for(I=0,T=v;I<T.length;I++)b=T[I],(0,X.ht)(g[b])&&(a.push({pathStr:b,dimName:w}),O(t,i,n,e,r,o[b].itemKeys,a,s,u,c,!0,f),a.pop())}else h=i.Nkt,v=i.yZt,S=(0,K.GXt)(),x=i.nv(),M=s-i.gXt,D=i.RXt,h.addChildItem(a,S,x,i,f,n,e,c.rootPosition,i.gXt,!1,"",!1,0,h.UZt,u,!1,D.rowNodeInfo),v.addChildItem(rt(a,i.gXt),S,x,i,f,n,e,c.headerPosition,M,!0,"",!1,0,v.UZt,u,!1,D.columnNodeInfo)}function mt(t,i,n,e,r,o,a,s){for(var u,c,l,f,u={subtotalManager:t,queryItems:i,positionInfo:e,contextList:r,rowDeep:o,pathInfo:[],cacheName:null,filedShowSubtotalTopInfo:n,itemsMap:s,measure:null,currentNode:t.UXt(),level:0,parentField:{}},c=0,l=a;c<l.length;c++)f=l[c],u.cacheName=f.cacheName,u.measure=f,u.level=0,nt(u)}function nt(t){var i,n,e,r,o,a,s,u,c,l,f,h,v,d,p,m,b,n,g,w,y,C,A,N,C,I,T,S,L,x,M,D,E,k,j,B,O,C,R,_,G,V,F,U,Q,W,z,P,Z,Y,i=t.subtotalManager,n=t.currentNode,e=t.queryItems,r=t.filedShowSubtotalTopInfo,o=t.positionInfo,a=t.contextList,s=t.rowDeep,u=t.pathInfo,c=t.cacheName,l=t.itemsMap,f=t.measure,h=t.level,v=t.parentField,d=i.UXt(),m=n&&n.oYt||[],n=i.wXt,y=!0;if(!(h>=i.fieldNameOrders.length)){if(b=i.originOrders[h],A=(C=i.QXt)[b],(g=n.getField(A)).cC()){if(p=g.y1,C=i.originOrders.indexOf(C[p]),i.originOrders.indexOf(b)>C&&0<=C)return;for(N=(I=n.getField(p)).ty,T=0;T<m.length;)w=m[T],v[p]=g.DH()[w.pathStr],u.push({pathStr:w.pathStr,dimName:b}),t.currentNode=w,t.level=h+1,nt(t),delete v[p],u.pop(),T++;for(S=0,L=N;S<L.length;S++)x=L[S],M=g.AQt[g.VXt[x]],(0,X.ht)(M)||(l[A].isAll||l[A].items[M])&&(v[p]=x,u.push({pathStr:M,dimName:b}),et(d,h+1,e,r,i,u,c,o,a,s,l,{fieldName:p,calcItem:x,calcLevel:I.WXt[I.M()[x]]},f,v),u.pop())}else for(N=g.ty,T=0;T<m.length;)if((w=m[T]).zXt&&!y)T+=1;else{if(N&&0<N.length&&y){for(D=0,E=N;D<E.length;D++)x=E[D],k=g.M()[x],!l[A].isAll&&!l[A].items[k]||v[A]&&v[A].indexOf(x)<0||(u.push({pathStr:k,dimName:b}),et(d,w.YAt,e,r,i,u,c,o,a,s,l,{fieldName:A,calcItem:x,calcLevel:g.WXt[k]},f,v),u.pop());y=!1}u.push({pathStr:w.pathStr,dimName:b}),t.currentNode=w,t.level=h+1,nt(t),u.pop(),T++}if(!m.length){for(j=0,B=N;j<B.length;j++)x=B[j],O=g.M()[x],(l[A].isAll||l[A].items[O])&&(u.push({pathStr:O,dimName:b}),et(d,h+1,e,r,i,u,c,o,a,s,l,{fieldName:A,calcItem:x,calcLevel:g.WXt[O]},f,v),u.pop());if(k=[],l[A].isAll)for(C=g.DH(),R=g.M(),_=0,G=C;_<G.length;_++)V=G[_],k.push(R[V]);else k=k.concat(Object.keys(l[A].items));for(F=0,U=k;F<U.length;F++){if(O=U[F],u.push({pathStr:O,dimName:b}),t.currentNode=null,t.level=h+1,g.cC()&&(p=g.y1,Q=g.cx[O],M=g.AQt[Q],!(0,X.ht)(M)))for(v[p]=[],W=g.VXt,P=0,Z=z=Object.keys(W);P<Z.length;P++)W[Y=Z[P]]===Q&&v[p].push(Y);nt(t),delete v[p],u.pop()}}delete v[p]}}function et(t,i,n,e,r,o,a,s,u,c,l,f,h,v){var d,L,p,m,E,b,g,w,y,C,B,A,N,I,T,S,R,x,M,G,V,D,p,U,k,j,O,Q,W,_,z,F,P,Z,d=r.wXt,L=r.QXt;if(i<n.length)if((p=n[i]).isDim){if(m=p.sourceName,E=p.displayName,g=b=void 0,y=(w=d.getField(m)).DH(),C=!1,w.cC()){for(b=w.y1,B=d.getField(b),A=0,N=o;A<N.length;A++)if(L[(I=N[A]).dimName]===b){g=B.D[I.pathStr],C=!0;break}y=C?(v[b]=g,[w.VXt[g]]):w.DH()}else if((0,X.ht)(v[m])){for(T=void 0,S=0,R=o;S<R.length;S++)if(I=R[S],(T=d.getField(r.QXt[I.dimName])).cC()&&T.y1===m){y=Y([],T.N[T.cx[I.pathStr]],!0);break}}else y=[v[m]];for(x=void 0,M=0,G=y;M<G.length;M++)V=G[M],D=w.M()[V],(l[m].isAll||l[m].items[D])&&(w.WXt[D]&&w.WXt[D]>f.calcLevel&&(x={fieldName:m,calcItem:V,calcLevel:w.WXt[D]}),o.push({pathStr:D,dimName:E}),et(t,i+1,n,e,r,o,a,s,u,c,l,x||f,h,v),x=void 0,o.pop());delete v[b]}else et(t,i+1,n,e,r,o,a,s,u,c,l,f,h,v);else if(p=r.ZXt(),U=o.length-c,k=r.nv(),j=yt(o),D=(0,J.getPathStr)(j,r.fieldNameOrders),O=void 0,W=(Q=gt(r,j,f,h,k)).value,wt((O=(0,K.YXt)(0)).calc,W),O.calcResult=Q.calcResult,(0,X.ht)(r.pathPool[D])||(k=r.pathPool[D],(0,X.ht)(r.wY[k][a])))for(t.addChildItem(o,O,k,r,a,n,e,s.rootPosition,c,!1,"",!1,0,t.UZt,u,!0),p.addChildItem(rt(o,c),O,k,r,a,n,e,s.headerPosition,U,!0,"",!1,0,p.UZt,u,!0),r.pathPool[D]=k,r.wY[k][a]=O,P=0,Z=h.subTotalTypes;P<Z.length;P++)F=Z[P],ot(r,j,H.SubtotalType[F],h.cacheName);else for(bt(r.wY[k][a],O.calc,h.subTotalTypes),_=0,z=h.subTotalTypes;_<z.length;_++)F=z[_],ot(r,j,H.SubtotalType[F],h.cacheName)}function bt(t,i,n){var e=t.calc,r=e.count,o=e.sum,a=e.product,s=e.max,u=e.min,c=e.sumx2,e=e.len,r=it(r,i.count,0),o=it(o,i.sum,0),a=it(a,i.product,2),s=it(s,i.max,5),u=it(u,i.min,6),c=it(c,i.sumx2,0),e=it(e,i.len,0);t.calc={count:r,sum:o,max:s,min:u,sumx2:c,product:a,len:e},t.calcResult=(0,K.BXt)(t.calc,n)}function rt(t,i){var t,i,t=Y([],t,!0),i=t.splice(0,i);return t.push.apply(t,i),t}function gt(t,i,n,e,r){for(var o,a,n,s,u,c,l,f,h,v,d,p,m,b,o=t.wXt,a=n.fieldName,n=n.calcItem,s={},u={},c=o.HXt,l=c.calcService,f=c.calcSource,h,v=o.zRt(a).sh[n].calcExpression,m=0,b=e.subTotalTypes;m<b.length;m++){d=b[m];try{p=H.SubtotalType[d],f.setCalcInfo(p,t,i,e.cacheName,v,r),(0,X.ht)(v)?u[p]=z:u[p]=l.MX.evaluateExpression(v,f.getEvaluatorContext({row:0,col:0},!1),!1,!0,!1),isNaN(+u[p])&&(u[p]=0)}catch(t){u[p]=x.Errors.Reference}finally{s[p]=u[p]}}return{calcResult:s,value:u}}function wt(t,i){t&&(t.count=i.countNums,t.len=i.count,t.max=i.max,t.min=i.min,t.product=i.product,t.sum=i.sum,t.sumx2=i.sum2)}function ot(t,i,n,e){var i,r,o,i,a,o,r,i,r,i,i,r=t.wXt,o=t.fieldNameOrders,i=(0,J.getPathStr)(i,o),a,o=r.JXt[i];o&&(r=(i=r.HXt).calcService,(i=i.calcSource).setCalcInfo(n,t,o.pathInfo,e,o.expression),r=(0,X.ht)(o.expression)?null:r.MX.evaluateExpression(o.expression,i.getEvaluatorContext({row:0,col:0},!1),!1,!0,!1),isNaN(+r)&&(r=0),(i=t.wY[o.calcResultIndex])&&i[e]&&(t.wY[o.calcResultIndex][e].calcResult[n]=r,wt(t.wY[o.calcResultIndex][e].calc,((i={})[n]=r,i))),ot(t,o.pathInfo,n,e))}function yt(t){for(var i,n,e,r,i={},n=0,e=t;n<e.length;n++)i[(r=e[n]).dimName]=r.pathStr;return i}function at(t){for(var i,n,e,r,o,a,s,u,c,i={},r=0,o=t;r<o.length;r++)if(n=(a=o[r]).isALL)i[a.sourceName]={isAll:a.isALL,items:null};else{for(e={},s=0,u=a.items;s<u.length;s++)e[c=u[s]]=1;i[a.sourceName]={isAll:a.isALL,items:e}}return i}function Ct(r,t){(0,X.o)(t,function(t){var i,n,e,i=r.Pq[t.sourceName],n=i;!1===i.qXt&&(t.databaseField=!1,t.dataFieldIndex=i.l,n=r.KXt(i.l)),i.cx&&(t.isGroupField=!0,e=(0,X.isEmptyObject)(n.P),t.getGroupItem=function(t){var t=e?t:n.D[t];return i.AQt[i.S(t)]})})}function At(t,i){for(var n,e,r,o,a,n=[],e=t.Pq,r=0,o=i.length;r<o;r++)(a=e[i[r].sourceName])&&(0,X.ht)(a.P)&&n.push(a.Zc);t.dot(n)}function Nt(t,i,n,e,r,o){var i,t,i=t.r$t(i,e,r),t=t.r$t(n,e,r);return o===H.SortType.desc?t-i:i-t}function It(t,i){this.NQt={},this.XXt=t,this.lp=i,this.NQt={}}function o(){}function v(t,i,n,e,r,o,a,s){this.QZt=0,this.$Xt=0,this._Xt={},this.oYt=[],this.lYt=i,this.nodeName=t,this.rYt=a,this.zZt=r,this.SYt=o,this.zXt=s,e||(this.HZt=n.nv())}I=this&&this.__assign||function(){return(I=Object.assign||function(t){for(var i,n,e,r,n=1,e=arguments.length;n<e;n++)for(r in i=arguments[n])Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r]);return t}).apply(this,arguments)},Y=this&&this.__spreadArray||function(t,i,n){if(n||2===arguments.length)for(var e=0,r=i.length,o;e<r;e++)!o&&e in i||((o=o||Array.prototype.slice.call(i,0,e))[e]=i[e]);return t.concat(o||Array.prototype.slice.call(i))},Object.defineProperty(K,"__esModule",{value:!0}),K.QueryNode=K.DataAnalyzer=K.PivotSlicerCache=K.PivotQueryList=K.PivotSubtotalManager=K.BXt=K.t$t=K.YXt=K.GXt=K.i$t=K.ErrorsMap=K.EmptyValue=K.Separator=void 0,H=t("./src/pivot-interface.ts"),X=t("./src/pivot-util.ts"),x=t("CalcEngine"),J=t("./src/pivot-cache.ts"),i=t("Common"),t=t("./pivot-entry.ts"),i=new i.Common.ResourceManager(t.SR),c=i.getResource.bind(i),z=null,h=void 0,s=Math.min,u=Math.max,f=Math.sqrt,M=isNaN,K.Separator="-&-",K.EmptyValue=x.Errors.Null,D="gc-empty-value",r=[0,1,32,61,92,122,153,183,214,245,275,306,336,367,368],K.ErrorsMap={100:x.Errors.Calc,7:x.Errors.DivideByZero,29:x.Errors.Name,42:x.Errors.NotAvailable,0:x.Errors.Null,36:x.Errors.Number,23:x.Errors.Reference,99:x.Errors.Spill,15:x.Errors.Value},d=14,K.i$t=p=function(t,i){var n,e,r,o,a,s,u,n,n=i.calc;!(0,X.ht)(t)&&(0,X.jh)(t)?(e=n.count,r=n.sum,o=n.max,a=n.min,s=n.sumx2,u=n.product,n=n.len,e=it(e,1,0),r=it(r,t,0),o=it(o,t,5),a=it(a,t,6),s=it(s,it(t,t,2),0),u=it(u,t,2),n=it(n,t===c().blank?h:1,0),i.calc={count:e,sum:r,max:o,min:a,sumx2:s,product:u,len:n}):i.calc.len=it(i.calc.len,t===c().blank?h:1,0)},K.GXt=b=function(){return{calc:{len:z,count:z,sum:z,max:z,min:z,sumx2:z,product:z}}},K.YXt=y=function(t){return(0,X.ht)(t)?{calc:{sum:null}}:(0,X.jh)(t)?{calc:{len:1,count:1,sum:t,max:t,min:t,sumx2:t*t,product:t}}:t instanceof x.CalcError?{calc:{len:1,count:h,sum:t,max:t,min:t,sumx2:t,product:t}}:t===c().blank?{calc:{len:h,count:h,sum:h,max:h,min:h,sumx2:h,product:h}}:{calc:{len:1,count:0,sum:0,max:0,min:0,sumx2:0,product:0}}},C=function(t,i){var i,n,e,r,o,a,s,u,i=i.calc,n,e,r,o,a,s,u;return t({sum:i.sum,count:i.count,max:i.max,min:i.min,sumx2:i.sumx2,product:i.product,len:i.len})},K.t$t=A=function(t){switch(t){case H.SubtotalType.average:return function(t){var i=t.sum,t=t.count;return i instanceof x.CalcError?i:it(i,t,3)};case H.SubtotalType.count:return function(t){var i;return t.len};case H.SubtotalType.countNums:return function(t){var i;return t.count};case H.SubtotalType.max:return function(t){var i;return t.max};case H.SubtotalType.min:return function(t){var i;return t.min};case H.SubtotalType.product:return function(t){var i;return t.product};case H.SubtotalType.stdDev:return function(t){var i,n,t,n,t,i,i=t.count,n=t.sumx2,t=t.sum;return(0,X.ht)(i)||0===i?null:(n=it(it(i,n,2),it(t,t,2),1),t=it(i,it(i,1,1),2),i=it(0,it(n,t,3),5),it(i,null,4))};case H.SubtotalType.stdDevp:return function(t){var i,n,t,n,t,i,i=t.count,n=t.sumx2,t=t.sum,n=it(it(i,n,2),it(t,t,2),1),t=it(i,i,2);if(!(0,X.ht)(n)||!(0,X.ht)(t))return i=it(0,it(n,t,3),5),it(i,null,4)};case H.SubtotalType.sum:return function(t){return t&&t.sum};case H.SubtotalType.varr:return function(t){var i,n,t,n,t,i=t.count,n=t.sumx2,t=t.sum;return(0,X.ht)(i)||0===i?null:(n=it(it(i,n,2),it(t,t,2),1),t=it(i,it(i,1,1),2),it(0,it(n,t,3),5))};case H.SubtotalType.varp:return function(t){var i,n,t,n,t,i=t.count,n=t.sumx2,t=t.sum;return(0,X.ht)(i)||0===i?null:(n=it(it(i,n,2),it(t,t,2),1),t=it(i,i,2),it(0,it(n,t,3),5))}}},N=function(t,i){return i(t)},m=function(t,i,n,e,r,o){var a,s,u,c,l,f,h,a=t.showDataAs,s=o.baseMinorPath,u=o.baseMajorPath,c=o.percentOfBasePath,l=o.baseIndex;switch(a){case H.PivotShowDataAs.normal:return{baseIndex:-1};case H.PivotShowDataAs.percentOfTotal:return{baseIndex:n.n$t};case H.PivotShowDataAs.percentOfRow:return i.zEt?{baseIndex:n.n$t}:{baseIndex:n.JZt(i.zZt,!1)};case H.PivotShowDataAs.percentOfCol:return i.zEt?{baseIndex:n.n$t}:{baseIndex:n.JZt(i.SYt,!0)};case H.PivotShowDataAs.percent:case H.PivotShowDataAs.difference:case H.PivotShowDataAs.percentDiff:return{baseMinorPath:s,baseMajorPath:u};case H.PivotShowDataAs.percentOfParentRow:return{parentPath:r,minorPath:i.SYt};case H.PivotShowDataAs.percentOfParentCol:return{baseIndex:i.YAt>e?i.e$t:i.HZt};case H.PivotShowDataAs.percentOfParent:return-1<t.baseRootLevel?{percentOfBasePath:c,minorPath:i.SYt}:{baseIndex:l,percentOfBasePath:c};case H.PivotShowDataAs.runTotal:case H.PivotShowDataAs.percentOfRunningTotal:case H.PivotShowDataAs.rankAscending:case H.PivotShowDataAs.rankDescending:return{baseMinorPath:s,baseMajorPath:u};case H.PivotShowDataAs.index:return h=f=void 0,i.zEt?(f=n.n$t,h=n.n$t):(f=n.JZt(i.zZt,!1),h=n.JZt(i.SYt,!0),(0,X.ht)(f)&&(f=n.n$t),(0,X.ht)(h)&&(h=n.n$t)),{rowTotalIndex:f,colTotalIndex:h}}},T=function(t,i,n,e,r,o,a){var r,s,u,c,l,f,h,v,d,p,m,b,g,w,y,C,A,N,N,y,C,A,N,I,y,C,T,N,A,C,y,N,C,A,N,S,y,r=r.indexInfo,s=t.CZt[a];if(r&&(u=r.baseIndex,c=r.parentPath,l=r.minorPath,f=r.rowTotalIndex,h=r.colTotalIndex,v=r.baseMinorPath,d=r.baseMajorPath,p=r.percentOfBasePath,m=!1,s))switch(w=g=void 0,b=s.showDataAs){case H.PivotShowDataAs.normal:return t.r$t(n,i,e);case H.PivotShowDataAs.percentOfTotal:return g=t.r$t(n,i,e),w=t.r$t(t.n$t,i,e),M(+g)?g:M(+w)?w:0===w?x.Errors.DivideByZero:g/w;case H.PivotShowDataAs.percentOfRow:case H.PivotShowDataAs.percentOfCol:return g=t.r$t(n,i,e),w=t.r$t(u,i,e),(0,X.ht)(g)&&(g=0),(0,X.ht)(w)||0===w?x.Errors.DivideByZero:M(+g)?g:M(+w)?w:g/w;case H.PivotShowDataAs.percentOfParentCol:return g=t.r$t(n,i,e),w=t.r$t(u,i,e),M(+g)?x.Errors.Value:M(+w)?w:0===w?x.Errors.DivideByZero:g/w;case H.PivotShowDataAs.percent:return(0,X.ht)(t.bXt[t.CZt[a].baseFieldName])?x.Errors.NotAvailable:(A=C=!(y=void 0),s.baseRootLevel>o?D:(N=t.WZt(v))?0===N.level&&s.isHeaderOfPercentOrDiff?D:(y=N.indexList[d],k(g=t.r$t(n,i,e))?g:(m=(0,X.ht)(g),y===n?m?D:1:(m&&(C=!1),(0,X.ht)(y)?K.EmptyValue:!s.isNextOrPrevious&&t.o$t(y,i)?x.Errors.NotAvailable:k(w=t.r$t(y,i,e))?w:((0,X.ht)(w)&&(A=!1),C?A?0===w?x.Errors.DivideByZero:g/w:D:K.EmptyValue)))):x.Errors.NotAvailable);case H.PivotShowDataAs.percentOfParentRow:return N=t.WZt(l).indexList[c],g=t.r$t(n,i,e)||0,w=t.r$t(N,i,e),k(g)||k(w)?x.Errors.Value:(0,X.ht)(w)?D:0===w?x.Errors.DivideByZero:g/w;case H.PivotShowDataAs.percentOfParent:if((0,X.ht)(t.bXt[t.CZt[a].baseFieldName]))return x.Errors.NotAvailable;if(-1<s.baseRootLevel){if(!(y=t.WZt(l)))return x.Errors.NotAvailable;if(C=y.indexList[p],k(g=t.r$t(n,i,e)))return g;if(s.baseRootLevel+1>=o)return(0,X.ht)(g)?D:1;if(k(w=t.r$t(C,i,e)))return x.Errors.Value;if((0,X.ht)(w))return D}else if(g=t.r$t(n,i,e),w=t.r$t(u,i,e),(0,X.ht)(u))return M(+w)?D:x.Errors.Value;return 0===w?x.Errors.DivideByZero:g/w;case H.PivotShowDataAs.difference:return(0,X.ht)(t.bXt[t.CZt[a].baseFieldName])?x.Errors.NotAvailable:(A=void 0,s.baseRootLevel>o?D:(N=t.WZt(v))?0===N.level&&s.isHeaderOfPercentOrDiff?D:(A=N.indexList[d],(g=t.r$t(n,i,e))instanceof x.CalcError?g:(0,X.ht)(A)||(I=t.o$t(A,i))&&!s.isNextOrPrevious?x.Errors.NotAvailable:(w=t.r$t(A,i,e))instanceof x.CalcError?w:(g=0*g!=0?0:g)-(w=0*w!=0?0:w)):x.Errors.NotAvailable);case H.PivotShowDataAs.percentDiff:return(0,X.ht)(t.bXt[t.CZt[a].baseFieldName])?x.Errors.NotAvailable:(y=void 0,s.baseRootLevel>o?D:(C=t.WZt(v))?0===C.level&&s.isHeaderOfPercentOrDiff||(y=C.indexList[d])===n?D:k(g=t.r$t(n,i,e))?g:(0,X.ht)(g)?K.EmptyValue:(0,X.ht)(y)||!s.isNextOrPrevious&&t.o$t(y,i)?x.Errors.NotAvailable:k(w=t.r$t(y,i,e))?w:(0,X.ht)(w)?D:0===w?x.Errors.DivideByZero:(g-w)/w:x.Errors.NotAvailable);case H.PivotShowDataAs.runTotal:if((0,X.ht)(t.bXt[t.CZt[a].baseFieldName]))return x.Errors.NotAvailable;if(g=t.r$t(n,i,e),-1<s.baseRootLevel){if(o<s.baseRootLevel+1)return D}else if((T=t.WZt(l)).level>s.baseHeaderLevel+1)return g;return(0,X.ht)(g)&&(g=0),w=t.a$t(a,d,v),M(+w)||(M(+g)?w=g:w+=g,t.s$t(a,d,v,w)),w;case H.PivotShowDataAs.percentOfRunningTotal:return(0,X.ht)(t.bXt[t.CZt[a].baseFieldName])?x.Errors.NotAvailable:-1<s.baseRootLevel&&o<s.baseRootLevel+1?D:(g=t.r$t(n,i,e),(0,X.ht)(g)&&(g=0),w=t.a$t(a,d,v),M(+w)?w:(M(+g)?w=g:w+=g,t.s$t(a,d,v,w),0===(N=t.u$t(a,d,v))||M(+N)?(t.s$t(a,d,v,x.Errors.DivideByZero),x.Errors.DivideByZero):w/N));case H.PivotShowDataAs.rankAscending:return(0,X.ht)(t.bXt[t.CZt[a].baseFieldName])?x.Errors.NotAvailable:!(-1<s.baseRootLevel&&o<s.baseRootLevel+1)&&(A=t.r$t(n,i,e),C=t.c$t(a,d,v))?C[A]:D;case H.PivotShowDataAs.rankDescending:return(0,X.ht)(t.bXt[t.CZt[a].baseFieldName])?x.Errors.NotAvailable:!(-1<s.baseRootLevel&&o<s.baseRootLevel+1)&&(y=t.r$t(n,i,e),N=t.c$t(a,d,v))?N[y]:D;case H.PivotShowDataAs.index:return(g=t.r$t(n,i,e),C=t.r$t(t.n$t,i,e),A=t.r$t(f,i,e),N=t.r$t(h,i,e),0===g)?0:M(+g)?g:M(+C)?C:M(+A)?A:M(+N)?N:0==(y=A*N)?x.Errors.DivideByZero:(S=g*C)/y}},K.BXt=S=function(i,t){var n={};return(0,X.o)(t,function(t){n[H.SubtotalType[t]]=(0,K.t$t)(t)(i)}),n},_=function(t){return t===H.PivotShowDataAs.percentOfRunningTotal||t===H.PivotShowDataAs.rankAscending||t===H.PivotShowDataAs.rankDescending},l=function(t,i,n,e,r){var o,a,s,u,o=t.oYt,a=t.nodeName,s=r=void 0===r?"":r;if(n||(""!==s&&(s+=K.Separator),s+=a),(0,X.o)(o,function(t){l(t,i,!1,e,s)}),i[s]=t.HZt,!t.kYt&&e.MXt&&t.UZt)for(u in t.UZt)_(e.CZt[u].showDataAs)&&e.l$t(u,s,t.UZt[u].baseMinorPath)},$=function(t,i,n){var e,r,o,a,a,t,e=[];if(t.YAt<i&&0<t.oYt.length)for(r=0,o=t.oYt;r<o.length;r++)a=o[r],a=$(a,i,n).slice(0),e.push.apply(e,a);else if(t.YAt===i)return l(t,t={},!0,n),[t];return e},tt=function(t,i,n,e,r){var o,a,s,u,c,l,f,h,v,d,p,m,o=t.f$t;for(a in o)if(o.hasOwnProperty(a))for(v in u=(s=t.CZt[a]).cacheName,c=s.subtotalText,l=s.showDataAs,f=o[a],h=e?n:f)h.hasOwnProperty(v)&&(d=void 0,p=i[a].baseMajorPath,d=e?f[v]||v:f[v],m=n[v],(0,X.ht)(m)||(l===H.PivotShowDataAs.percentOfRunningTotal?t.h$t(a,d,p,m,u,c):t.v$t(a,d,p,m,u,c)))},W=function(t,i,n,e,L,E,r,B,o){var n,R,a,s,u,c,G,l,f,h,v,d,p,m,b,g,w,y,C,V,U,A,Q,N,I,T,W,S,x,M,D,M,k,z,Z,j,O,Y,_,H,F,J,P,q,P,n,o,n=$(i,n,t),R=t.MXt;if(n&&1===n.length){if(o)for(a=st(t,i.zZt,n[0],B),s=0,u=e;s<u.length;s++)for(l=0,f=G=(c=u[s]).subTotalTypes;l<f.length;l++)for(h=f[l],v=0,d=a;v<d.length;v++)m={fieldInfos:(p=d[v]).fieldInfos,valueInfo:{sourceName:c.cacheName,subtotalType:h}},b=r.tQt(m),g=t.d$t(p.calcIndex),(0,X.ht)(b)||(i.p$t(h,g[c.cacheName].calc,b),i.p$t(h,g[c.cacheName].calcResult,b));t.m$t(i.zZt,{indexList:n[0],level:i.YAt,visible:i.jft,collapse:i.b$t,baseSubtotalInfo:i.UZt,parentPath:L}),R&&tt(t,i.UZt,n[0],!1,!1)}else{for(w={},V=[],U={},(0,X.o)(e,function(t){V.push(t.cacheName),U[t.cacheName]=t.isCalculatedField}),A=0,Q=n;A<Q.length;A++)for(I in N=Q[A])if(N.hasOwnProperty(I))for(w[I]||(w[I]={}),T=0,W=V;T<W.length;T++)S=W[T],y=(y=(x=(x=t.d$t(w[I]))||{})[S])||{},(C=t.d$t(N[I])&&t.d$t(N[I])[S])&&C.calc&&(y.calc?U[S]?(E.g$t(r,x,S),y.calc=x[S].calc):(M=y.calc,D=C.calc,y.calc={count:it(M.count,D.count,0),sum:it(M.sum,D.sum,0),max:it(M.max,D.max,5),min:it(M.min,D.min,6),sumx2:it(M.sumx2,D.sumx2,0),product:it(M.product,D.product,2),len:it(M.len,D.len,0)}):y.calc=C.calc),M=t.nv(),w[I]=M,x[S]=y,t.w$t(M,i.zZt,x);if(o)for(a=st(t,i.zZt,w,B),k=0,z=e;k<z.length;k++)for(j=(Z=z[k]).subTotalTypes,S=Z.cacheName,O=0,Y=j;O<Y.length;O++)for(h=Y[O],_=0,H=a;_<H.length;_++)m={fieldInfos:(p=H[_]).fieldInfos,valueInfo:{sourceName:S,subtotalType:h}},b=r.tQt(m),g=t.d$t(p.calcIndex),(0,X.ht)(b)||i.p$t(h,g[S].calc,b);for(I in w)if(w.hasOwnProperty(I))for(F=0,J=e;F<J.length;F++)j=(P=J[F]).subTotalTypes,S=P.cacheName,(P=(q=(q=t.d$t(w[I]))||{})[S]).collapse=t.o$t(t.yXt[I],S),P.calcResult=(0,K.BXt)(P.calc,j),P.hasEffectChild=!0;R&&tt(t,i.UZt,w,!0,i.zEt),n=i.jft,o=i.b$t,t.m$t(i.zZt,{indexList:w,level:i.YAt,visible:n,collapse:o,baseSubtotalInfo:i.UZt,parentPath:L})}},n.prototype.getFieldCalcItem=function(t,i,n,e,r,o){var a,s,u,c,l,f,h,v,d,p,m,b,g,w,y,C,A,N,I,T,I,S,x,v,M,v,M,a=this,u=a.fieldNameOrders;if(!a.checkCalcInfo(t,n))throw new Error;for(l={},f=0,h=a.wXt,v=Object.keys(n),m=[],b=a.QXt,g=p=0,w=v;g<w.length;g++)l[y=w[g]]=n[y],c=n[y],s=h.getField(b[y]),(0,X.ht)(t[b[y]])?s.cC()&&(C=s.y1,m.push({groupName:y,originName:C})):c=s.y$t(t[b[y]]),s.WXt[c]&&(f++,a.fieldLabelItems[b[y]])&&!a.fieldLabelItems[b[y]][c]&&s.WXt[c]>p&&(d=s.sh[t[b[y]]].calcExpression,p=s.WXt[c]),l[y]=c;for(A=0,N=m;A<N.length;A++)T=(I=N[A]).groupName,I=I.originName,S=h.getField(I),x=void 0,s=h.getField(T),x=(0,X.ht)(l[b[I]])?t[I]:S.DH()[l[b[I]]],l[T]=s.AQt[s.VXt[x]];return d?(M=(v=h.HXt).calcService,(v=v.calcSource).setCalcInfo(e,a,l,r,d,o),(0,X.ht)(d)?z:M.MX.evaluateExpression(d,v.getEvaluatorContext({row:0,col:0},!1),!1,!0,!1)):void 0!==(M=a.getCalcValueImp(l,e,r))?M:0<f&&(0,J.getPathStr)(n,u)!==(0,J.getPathStr)(l,u)?void a.wXt.setUntreatedNodeInfo(l,n,a.fieldNameOrders,i,o):0},n.prototype.checkCalcInfo=function(t,i){for(var n,t,e,r,o,a,s,u,c,c,l,f,h,n=this,t=Object.keys(t),e=this.QXt,r=Object.keys(i),o=n.wXt,a={},s=0,u=r;s<u.length;s++)c=u[s],(c=o.getField(e[c]))&&!(0,X.ht)(c.y1)&&(a[c.y1]=!0);for(l=0,f=t;l<f.length;l++)if(h=f[l],(0,X.ht)(i[e[h]])&&(0,X.ht)(a[h]))return!1;return!0},n.prototype.getCalcValueImp=function(t,i,n){var e,t,r,r,t,o,a,o,t,s,u,c,l,f,o,e=this,r=e.fieldNameOrders,t=(0,J.getPathStr)(t,r),r=e.pathPool[t];return(0,X.ht)(r)?(o=e.LXt,a=e.EXt,r=o[t],(0,X.ht)(r)?void 0:(t=(o=a[r].subtotal[n].calc).count,s=o.sum,u=o.max,c=o.min,l=o.sumx2,f=o.product,o=o.len,a[r].subtotal[n].calcResult=(0,K.BXt)({count:t,sum:s,max:u,min:c,sumx2:l,product:f,len:o},[H.SubtotalType[i]]),a[r].subtotal[n].calcResult[i])):(t=e.wY[r]&&e.wY[r][n])&&t.calcResult[i]},n.prototype.buildCalcItemInfo=function(t,i,n,e,r){var o,a,s,u,c,l,f,h,v,d,p,m,b,g,w,o=this;for(R(o,i),o.pathPool=I({},t._Xt),o.LXt=t.LXt,o.EXt=t.EXt,a=o.C$t||{},s=[],c=u=0,l=r;c<l.length;c++)s[f=l[c]]=n[u],u++;for(o.fieldNameOrders=s,o.originOrders=Y([],n,!0),o.wXt.JXt={},o.fieldLabelItems={},o.QXt={},h=0,v=e;h<v.length;h++)if(d=v[h],o.QXt[d.displayName]=d.sourceName,o.QXt[d.sourceName]=d.displayName,a[d.sourceName]=!d.isHeader,!d.isALL){for(m={},b=0,g=p=d.items;b<g.length;b++)m[w=g[b]]=!0;o.fieldLabelItems[d.sourceName]=m}o.C$t=a},n.prototype.destroyCalcItemInfo=function(){var t=this;t.pathPool=null,t.LXt=null,t.EXt=null,t.fieldNameOrders=null,t.originOrders=null,t.fieldLabelItems=null,t.wXt.JXt=null},n.prototype.sf=function(t,i){var t,n,t=this.bXt[t]||t,n;return i&&i[t]||this.wXt.zRt(t).sf()},n.prototype.I$t=function(t,i,n){for(var e,r,o,a,s,u,c,l,f,h,v,d,p,m,b,g,w,y,C,A,N,l,C,I,T,S,x,M,D,D,e=!1,r=[],o={},a={},s=0,u=0,c=t;u<c.length;u++)f=!1,v=-1,d=(l=c[u]).showDataAs,p=l.baseFieldItemType,m=l.baseFieldName,b=l.baseFieldItem,g=l.baseFieldItemShared,w=l.fieldName,y=l.cacheName,C=l.subtotalType,e=!(h=void 0),A=n.indexOf(m),N=i.indexOf(m),m&&(h=-1<N,v=n.concat(i).indexOf(m)+1),f=this.A$t(l),l=H.SubtotalType[C],C=d===H.PivotShowDataAs.percentOfParent,I=d===H.PivotShowDataAs.rankAscending||d===H.PivotShowDataAs.rankDescending,S=(T=d===H.PivotShowDataAs.runTotal||d===H.PivotShowDataAs.percentOfRunningTotal)||I,x=this.N$t(d,p),M=d===H.PivotShowDataAs.difference||d===H.PivotShowDataAs.percentDiff||d===H.PivotShowDataAs.percent,D=Math.pow(2,0),r.push(D={showDataAsIndex:D,needBuildBasePath:f,showDataAs:d,baseFieldItemType:p,isNextOrPrevious:x,baseFieldName:m,baseFieldItem:b,baseFieldItemShared:g,isDifferenceOrPercent:M,isRankShowDataAs:I,cacheName:y,isHeaderOfPercentOrDiff:h,subtotalText:l,baseRootLevel:A,baseHeaderLevel:N,fieldName:w,needBuildPercentOfPath:C,actualBaseLevel:v,needBuildRunningTotalOrRankPath:S}),this.CZt[w]=D,T&&(this.AXt[w]={}),I&&(this.MXt=!0,this.f$t||(this.f$t={}),this.f$t[w]={},this.TXt[w]={},a[y]||(a[y]=[]),a[y].push(w)),x&&((0,X.ht)(this.T$t)&&(this.T$t=[]),this.T$t.push(w)),d===H.PivotShowDataAs.percentOfRunningTotal&&(this.f$t||(this.f$t={}),this.f$t[w]={},this.NXt[w]={},this.MXt=!0,a[y]||(a[y]=[]),a[y].push(w));return this.M$t=o,this.x$t=a,this.D$t=e,r},n.prototype.N$t=function(t,i){var n;return(t===H.PivotShowDataAs.difference||t===H.PivotShowDataAs.percentDiff||t===H.PivotShowDataAs.percent)&&i!==H.PivotShowDataAsBaseItemType.item},n.prototype.l$t=function(t,i,n){this.f$t[t][i]=n},n.prototype.a$t=function(t,i,n){var t,i,t=this.AXt[t],i=i+"||"+n;return t[i]||(t[i]={val:0}),t[i].val||0},n.prototype.u$t=function(t,i,n){var e;return this.NXt[t][i+"||"+n].cursor},n.prototype.h$t=function(t,i,n,e,r,o){var e,r;this.o$t(e,r)||(e=this.r$t(e,r,o),this.NXt[t][r=i+"||"+n]||(this.NXt[t][r]={cursor:0}),this.NXt[t][r].cursor+=e)},n.prototype.s$t=function(t,i,n,e){var r;this.AXt[t][i+"||"+n].val=e},n.prototype.c$t=function(t,i,n){var i,n,i=i+"||"+n,n=this.TXt[t];return n[i]||(n[i]=0),n[i]},n.prototype.v$t=function(t,i,n,e,r,o){var e,r;this.o$t(e,r)||(e=this.r$t(e,r,o),this.TXt[t][r=i+"||"+n]||(this.TXt[t][r]={}),this.TXt[t][r][e]=1)},n.prototype.S$t=function(){var t,i,n,e,r;for(t in this.TXt)if(this.TXt.hasOwnProperty(t))for(r in i=this.TXt[t],e=(n=this.CZt[t].showDataAs)===H.PivotShowDataAs.rankAscending?1:-1,i)i.hasOwnProperty(r)&&(i[r]=(0,X.k$t)(i[r],e))},n.prototype.A$t=function(t){var i,t,n,i=t.showDataAs,t=t.baseFieldItemType,n=!1;return n=i!==H.PivotShowDataAs.percent&&i!==H.PivotShowDataAs.difference&&i!==H.PivotShowDataAs.percentDiff?n:t===H.PivotShowDataAsBaseItemType.item},n.prototype.j$t=function(t){this.Nkt=t,this.n$t=t.HZt,t.e$t=t.HZt},n.prototype.UXt=function(){return this.Nkt},n.prototype.O$t=function(t){this.yZt=t,this.P$t=t.HZt,t.e$t=t.HZt},n.prototype.m$t=function(t,i){this.IXt[t]=i},n.prototype.F$t=function(t,i,n){var e,r,o,a,e=this;if(e.RXt={columnNodeInfo:null,rowNodeInfo:null},!(0,X.ht)(i)&&0<Object.keys(i).length||n)e.RXt.columnNodeInfo={},e.RXt.rowNodeInfo={};else if(!(0,X.ht)(t)&&0<t.length)for(r=0,o=t;r<o.length;r++)if((a=o[r]).showDataAs!==H.PivotShowDataAs.normal)return e.RXt.columnNodeInfo={},void(e.RXt.rowNodeInfo={})},n.prototype.WZt=function(t){return this.IXt[t]},n.prototype.ZXt=function(){return this.yZt},n.prototype.nv=function(){var t=this.DU;return this.DU=t+1,t},n.prototype._$t=function(t){return this.D$t[t]},n.prototype.d$t=function(t){return this.wY[t]},n.prototype.r$t=function(t,i,n){return this.d$t(t)&&this.d$t(t)[i].calcResult&&this.d$t(t)[i].calcResult[n]},n.prototype.o$t=function(t,i){return this.d$t(t)&&this.d$t(t)[i].collapse},n.prototype.vZt=function(t,i,n,e,r,o){var e,e=this.CZt[o]?T(this,i,t,n,e,r,o):this.r$t(t,i,n);return e},n.prototype.JZt=function(t,i){return(i?this.CXt:this.yXt)[t]},n.prototype.L$t=function(t,i,n,e){e?this.w$t(t,i,n):this.E$t(t,i,n)},n.prototype.E$t=function(t,i,n){this.wY[t]=n,this.yXt[i]=t},n.prototype.B$t=function(t,i){this.wY[t]=i},n.prototype.w$t=function(t,i,n){this.wY[t]=n,this.CXt[i]=t},n.prototype.L0=function(){var t=this;t.wY=z,t.DU=0,t.yXt=z,t.CXt=z,t.Nkt=z,t.yZt=z,t.CZt=z,t.wXt=z,t.D$t=!1,t.R$t=z,t.bXt=z,t.AXt=z,t.NXt=z,t.TXt=z,t.M$t=z,t.T$t=z,t.x$t=z,t.G$t=z,t.V$t=z,t.f$t=z},Z=n,K.PivotSubtotalManager=Z,e.prototype.kXt=function(t,o,a){var s,i,n,s={},i=[];for(n in(0,X.o)(t,function(t,i){var n,e,t,r,n=t.cacheName,e=t.index,t=t.subTotalType;B(n,o)&&(t=H.SubtotalType.sum),s[e]?s[e].subTotalTypes.push(t):(s[e]={cacheName:n,index:e,subTotalTypes:[t],isCalculatedField:a},(r=o.Pq[n]&&!(0,X.isEmptyObject)(o.Pq[n].P)&&o.Pq[n].D&&0<o.Pq[n].D.length)&&(s[e].itemsKeyList=o.Pq[n].D))}),s)s.hasOwnProperty(n)&&i.push(s[n]);return i},e.prototype.OXt=function(t){for(var i,n,e,i={},n=0,e=t.length;n<e;n++)i[t[n].cacheName]=n;return i},e.prototype.L0=function(){var t=this;t._Xt=z,t.SXt=z,t.jXt=z,t.PXt=z,t.FXt=z,t.tx=z,t.DXt=z,t.xXt=z,t.sx=z},e.prototype.U$t=function(t,i,n,e,r){for(var o,a,s,u,c,l,f,c,n,o,a={},s=0,u=this.PXt;s<u.length;s++)l=(c=u[s]).cacheName,f=c.index,c=c.itemsKeyList,a[l]||(a[l]=r?(0,K.GXt)():(0,K.YXt)(c?c[t[f]]:t[f]));return n=[n],e?this.EXt.push({path:i,indexes:n,subtotal:a})-1:this.tx.push({path:i,indexes:n,subtotal:a})-1},e.prototype.addItem=function(t,i,n,e){for(var r,e,o,a,s,u,c,l,f,h,v,d,p,l,p,r,m,e,r=this.DXt,e=e&&e.Q$t||{},o=[],a=[],s=n?this.LXt:this._Xt,u=0,c=r;u<c.length;u++)f=(l=c[u]).fieldName,h=l.index,v=l.isGroupField,d=l.getGroupItem,p=l.databaseField,l=l.dataFieldIndex,p=!1===p?t[l]:t[h],v&&(p=d(p)),o.push(f+"&"+p),a.push(p);m=s[r=o.join(K.Separator)],e=!!e[i],(0,X.ht)(m)?s[r]=this.U$t(t,a,i,n,e):this.dRt(m,t,i,n,e)},e.prototype.dRt=function(t,i,n,e,r){var o,a,e,s,u,c,l,f,c,o,a=(e?this.EXt:this.tx)[t];if(a.indexes.push(n),e=this.PXt,!r)for(s=0,u=e;s<u.length;s++)l=(c=u[s]).cacheName,f=c.index,c=c.itemsKeyList,(0,K.i$t)(c?c[i[f]]:i[f],a.subtotal[l])},e.prototype.W$t=function(t){for(var i,n,e,r,o,i=this.sx,n=[],e=0,r=t.length;e<r;e++)o=t[e],(0,X.ht)(i[o])||n.push(i[o]);return n},e.prototype.z$t=function(t,i){var n=this;return t.map(function(t){return{pathStr:i[t],dimName:n.DXt[t].fieldName}})},e.prototype.out=function(t,i,n,e,r,o,a,L,E,s,B,R,u,c){var l,f,h,v,d,p,m,b,g,w,y,C,A,N,o,I,w,T,S,x,x,G,M,D,k,V,U,j,O,_,F,Q,P,P,W,l=this,f=new Z(this.tx.length,t),h=t.Z$t&&!t.Z$t.isEmpty(),v=new q("","",f,!1,"","",""),d=new q("","",f,!1,"","","");if(f.j$t(v),f.O$t(d),f.F$t(s,u,h),f.collapseItems=a,p=f.I$t(s,n,e),m=e.length,f.gXt=m,d.YAt=0,v.YAt=0,v.zEt=!0,v.jft=!1,d.jft=!1,d.zEt=!0,s&&0<s.length&&v.Y$t(f,p,m,"",{},0),b=this.W$t(i),g=this.W$t(n.concat(e)),w=o.valuePositionInfo,y=o.insertBlankLineAfterEachItem,C=o.grandTotalPosition,A=o.subTotalsPosition,N=o.valueFieldLength,o=z,o=w.positionIndex,I=w.positionType,w=w.display,S=T=-1,(1<(x=this.SXt.length)||1===x&&1<this.SXt[0].subTotalTypes.length)&&w&&(I===H.DataPosition.col&&0===(S=o)&&(d.eYt=!0),I===H.DataPosition.row)&&0===(T=o)&&(v.eYt=!0),this.H$t(v,d,b,g,r,c,T,S,f,m,p,a),x=l.PXt.concat(l.FXt),f.wXt.hasCalcItem(r)&&(f.buildCalcItemInfo(this,x,i,r,b),mt(f,r,c,{rootPosition:T,headerPosition:S},p,m,x,at(r)),f.destroyCalcItemInfo()),0<x.length&&(u&&0<Object.keys(u).length&&this.J$t(f,r,c,at(r),u,p,{rootPosition:T,headerPosition:S},g.length,x),vt(s)||h)&&dt(f,r,c,at(r),p,{rootPosition:T,headerPosition:S},g.length,x),G=this.jXt,k={},V={},U={},(D=!(M={}),X.o)(r,function(t){var i,n,e,t,r,o,e,i=t.displayName,n=t.sourceName,e=t.valueFilter,t=t.sortInfo;e&&(r=e.conditionBySourceName,o=e.condition,e=L[e.conditionByName],M[i]={valueFieldName:r,condition:o,subTotalType:e},D=!0),t&&t.sortValueFieldName&&(k[i]={subtotalText:t.sortValueSubtotalText,cacheName:t.cacheName,sortByPivotReferences:t.sortByPivotReferences,sortByHeader:t.sortByHeader,sortType:t.sortType}),U[V[i]=n]=i}),r=z,f.R$t=k,f.bXt=V,f.G$t=B,f.V$t=R,j={},D)for(_=O=void 0,F=0,Q=E;F<Q.length;F++)P=Q[F],P=M[_=U[P]],W=this.SXt[G[P&&P.valueFieldName]],(0,X.ht)(W)||(-1<(O=n.indexOf(_))?d:(O=e.indexOf(_),v)).q$t(W,_,P,j,O,f);return v.K$t(x,j,f,!1,m,"",l,t,h?{}:z),d.K$t(x,j,f,!0,n.length,"",l,t,h?{}:z,i),f.S$t(),d.X$t(n.length,{},{insertBlankLineAfterEachItem:y,grandTotalPosition:C,subTotalsPosition:A,valueFieldLength:N,valuePosition:S},!0,a,f),0===n.length&&(d.KZt=0,d.vYt=-1!==S?N:1,d.wYt=0,d.yYt=-1!==S?N:1,d.XZt=-1!==S?N:1,d.$Zt=-1!==S?N:1),d.qZt=n.length,v.X$t(b.length-n.length,{},{insertBlankLineAfterEachItem:y,grandTotalPosition:C,subTotalsPosition:A,valueFieldLength:N,valuePosition:T},!1,a,f),b.length-n.length==0&&(v.KZt=0,v.vYt=-1!==T?N:0,v.wYt=-1!==T?N:1,v.yYt=-1!==T?N:0,v.XZt=-1!==T?N:0,v.$Zt=-1!==T?N:1,0===N)&&(v.$Zt=0,v.wYt=0),f},e.prototype.H$t=function(c,l,f,h,v,d,p,m,b,g,w,t){var y,i,n,C,A,N,y=this,i=this.SXt.length,n=this.tx,C=Math.max(h.length-g,0),A=b.RXt;0<i?(N=this.PXt.concat(this.FXt),(0,X.o)(n,function(t,i){for(var n,e,r,o,a,s,u,n=0,e=N;n<e.length;n++)r=e[n].cacheName,o=t.path,s=(a=t.subtotal)[r],u=y.z$t(h,o),l.addChildItem(u,s,i,b,r,v,d,m,C,!0,"",!1,0,l.UZt,w,!1,A.columnNodeInfo),c.addChildItem(y.z$t(f,o),s,i,b,r,v,d,p,g,!1,"",!1,0,c.UZt,w,!1,A.rowNodeInfo)})):(0,X.o)(n,function(t,i){var t=t.path;l.addChildItem(y.z$t(h,t),null,i,b,void 0,v,d,m,C,!0,"",!1,0),c.addChildItem(y.z$t(f,t),null,i,b,void 0,v,d,p,g,!1,"",!1,0)})},e.prototype.J$t=function(t,i,n,e,r,o,a,s,u){for(var c,l,f,h,v,d,p,m,b,g,w,c=t.Nkt,l=t.RXt,f=0<t.gXt?l.rowNodeInfo:l.columnNodeInfo,h=[],v=[],d=0,p=i;d<p.length;d++)m=p[d],v.push(m.sourceName);for(b=0,g=u;b<g.length;b++)G(c,t,i,n,e,f,h,s,r,o,a,v,(w=g[b]).cacheName)},e.prototype.$$t=function(t,i){for(var n,e,r,o,a,s,n=this,e=n.tx,r=0,o=e.length;r<o;r++)s=(a=e[r]).subtotal,n.tti(t,s,i)},e.prototype.tti=function(t,i,n){for(var e,r,o,e=this,r=0,o=n.length;r<o;r++)e.g$t(t,i,n[r].cacheName)},e.prototype.g$t=function(t,i,n){var e,r,e,t,n,o,e=t.HXt,r=e.calcService,e=e.calcSource;e.setMeasureNode(i),n=(t=t.zRt(n)).iti;try{o=r.MX.evaluateExpression(n,e.getEvaluatorContext({row:0,col:0},!1),!1,!0,!1)}catch(t){o=x.Errors.Reference}i[t.Zc]={calc:{sum:o},calcResult:o}},g=e,K.PivotQueryList=g,It.prototype.dU=function(t){var i=this.NQt;(0,X.ht)(i[t])&&(i[t]=1)},It.prototype.destroy=function(){this.NQt=null},w=It,K.PivotSlicerCache=w,o.prototype.Lh=function(r,t,o){var a,s,u,t,a=!0,s=[],u=[];return(0,X.o)(t,function(t){var i,n,i,e,i=!t.isALL;a&&i&&(a=!1),i&&(Array.isArray(t.items[0])?(n=[],(0,X.o)(t.items,function(t){n=n.concat(t)}),s.push(n)):(i=r.zRt(t.sourceName))&&(e=i.getIndexesList(t.items),s.push(e),o)&&(t.isDim?u.push(i.getFilterIndexesList()):u.push(e)))}),t=(0,X.amt)(s),u=(0,X.amt)(u),{isALL:a,indexes:t,filterIndexes:u}},o.prototype.nti=function(t,i,n,e){var r,o,i,a,s,a,u,c,l,f,h,v,d,p,m,b,r=i.isALL,o=i.indexes,i=i.filterIndexes;if(At(t,n),Ct(t,n),s=(a=t.eti(e)).normalFieldsInfos,a=a.calcFieldsInfos,u=[],c=new g(n,e,t,s,a),(0,X.o)(e,function(t){var t=t.index;-1===u.indexOf(t)&&u.push(t)}),f=(l=t.oQt).length,r)for(h=0;h<f;h++)c.addItem(l[h],h,!1,t);else{for(v=0,d=o;v<d.length;v++)p=d[v],c.addItem(l[p],p,!1,t);if(i&&0<i.length)for(m=0,b=i;m<b.length;m++)p=b[m],c.addItem(l[p],p,!0,t)}return 0<a.length&&c.$$t(t,a),c},o.prototype.TQt=function(t,i,n){var e,i,r,o,a,s,u,c,l,f,h,v,d,p,e,m,b,g,e=i.isALL,i=i.indexes,r=t.getField(n),o=t.oQt,a=o.length,s=r.lp,c=r.cC();if(c&&(l=this.rti(r.Zc,t),s=t.getField(r.y1).lp),f=new w(n,s),e)for(h=0;h<a;h++)u=c?r.AQt[l[h+""]]:o[h][s],f.dU(u);else for(v=0,d=i;v<d.length;v++)p=d[v],u=c?r.AQt[l[p+""]]:o[p][s],f.dU(u);if(0<(e=t.getCalcItems(n)).length)for(m=0,b=e;m<b.length;m++)g=b[m],p=r.P[g.calcItemName],f.dU(p);return f},o.prototype.rti=function(t,i){var n,e,r,o,a,s,u,c,l,f,h,n={},e=i.getField(t),r=e.A;if(!(0,X.ht)(r))for(a=0,s=o=Object.keys(r);a<s.length;a++)for(l=0,f=c=r[u=s[a]];l<f.length;l++)n[(h=f[l])+""]=e.N?e.cx[+u]:u;return n},K.DataAnalyzer=o,P=function(t,i){for(var n=i+1;n<t.length;n++)if(!t[n].b$t)return t[n];return z},L=function(t,i){for(var n=i-1;n<i&&0<=n;n--)if(!t[n].b$t)return t[n];return z},Q=function(t){for(var i,n,e,r,o,a,s,i=[],n=[],e=t.length,r=z,o=z,a=0,s=e-1;a<e;a++,s--)n[a]=r,r=t[a].b$t?r:a,i[s]=o,o=t[s].b$t?o:s;return{preMap:n,nextMap:i}},v.prototype.oti=function(t,i){var t;return this.YAt+1<=t?(""!==(t=this.zZt)&&(t+=K.Separator),t+i||""):this.zZt},v.prototype.ati=function(t,i){var t;return this.YAt+1>t?(""!==(t=this.SYt)&&(t+=K.Separator),t+i||""):this.SYt},v.prototype.sti=function(t,i,n,e,r,o){var a,o,a=this.nodeName;return(0,X.ht)(r.baseFieldName)||this.rYt!==r.baseFieldName||(a=o?this.rYt:r.baseFieldItemShared),o=e&&e.baseMajorPath?e.baseMajorPath:"",this.YAt<=n?(""!==o&&(o+=K.Separator),o+a||""):o},v.prototype.uti=function(t,i,n,e,r){var o,a,e,s,u,c,o=this.YAt,s=this.rYt;return e&&(c=e.childMajorPath||"",u=e.baseMajorPath||""),o<=n?(c&&""!==c?c+=K.Separator:c="",this.rYt!==r.baseFieldName&&(s=this.nodeName),e=o>r.baseRootLevel?(a=c+s,c+this.rYt):a=c+s,{currentMajorPath:a,childMajorPath:e}):{currentMajorPath:u,childMajorPath:c}},v.prototype.cti=function(t,i){var i,i=i&&i.baseMajorPathList?[].concat(i.baseMajorPathList):[];return this.YAt<=t&&""!==this.nodeName&&i.push(this.nodeName),i},v.prototype.lti=function(t,i,n){return!(0,X.ht)(i)&&t.length>=n&&(t[n]=i),t.join(K.Separator)},v.prototype.fti=function(t,i,n){return!(0,X.ht)(i)&&t.length>=n&&(t[n]=i),t.join(K.Separator)},v.prototype.hti=function(t,i,n){var e,e,r,o;return-1<i.baseRootLevel?(e=i.baseRootLevel+1,this.YAt<=e?this.zZt:t.percentOfBasePath):(e=i.baseHeaderLevel+1,o=r=void 0,{baseIndex:r=this.YAt<=e+n?this.HZt:t.baseIndex,percentOfBasePath:o=this.YAt<=e?this.zZt:t.percentOfBasePath})},v.prototype.vti=function(t,i,n,e,r,o){var a,o,a=this.nodeName;return(0,X.ht)(r.baseFieldName)||this.rYt!==r.baseFieldName||(a=o?this.rYt:r.baseFieldItemShared),o=e&&e.baseMinorPath?e.baseMinorPath:"",this.YAt>n?(""!==o&&(o+=K.Separator),o+a||""):o},v.prototype.dti=function(t,i,n,e,r){var o,a,e,s,u,c,o=this.YAt,s=this.rYt;return e&&(c=e.childMinorPath||"",u=e.baseMinorPath||""),n<o?(c&&""!==c?c+=K.Separator:c="",this.rYt!==r.baseFieldName&&(s=this.nodeName),e=o>r.baseHeaderLevel?(a=c+s,c+this.rYt):a=c+s,{currentMinorPath:a,childMinorPath:e}):{currentMinorPath:u,childMinorPath:c}},v.prototype.pti=function(t,i){var i,i=i&&i.baseMinorPathList?[].concat(i.baseMinorPathList):[];return this.YAt>t&&""!==this.nodeName&&i.push(this.nodeName),i},v.prototype.Tpi=function(t,i){for(var n,e,r,o,a,s,a,u,c,n=t.wXt,e="",r=i.length,o=0;o<r;o++)s=(a=i[o]).fieldName,a=a.items[0]+"",e+=(c=(u=n.getField(s)).M())[a],o!==r-1&&(e+=K.Separator);return e},v.prototype.addChildItem=function(t,i,n,e,r,o,a,s,u,c,l,f,h,v,d,p,m){var b,t,g,b,w,y,C,A,N,N,b,A,N;0<t.length?(b=t[0],t=t.slice(1),g=b.pathStr,b=b.dimName,w=0===t.length,y=l,A=a[b],(C=void 0,X.ht)(this._Xt[g])&&(""!==(N=this.lYt)&&(N+=K.Separator),this._Xt[g]=this.mti(g,N+g,e,w,u,g,c,b,p,A)),(C=this.oYt[this._Xt[g]]).pathStr=g,C.e$t=this.HZt,m&&C.YAt<=u&&((0,X.ht)(m.fieldName)&&(m.fieldName=C.rYt,m.level=C.YAt),m.itemKeys=m.itemKeys||{},N=m.itemKeys,(0,X.ht)(N[g])&&(N[g]={}),m=N[g]),C.YAt===s&&(C.eYt=!0),C.jft=f,C.b$t=C.bti(e.collapseItems,f),w?(C.kYt=!0,C.HZt=n,i&&void 0!==r&&(b=e.d$t(C.HZt),(0,X.ht)(b)&&(b={}),(0,X.ht)(b[r]))&&(b[r]={calc:I({},i.calc),calcResult:i.calcResult},e.B$t(C.HZt,b)),C.gti=n,d&&0<d.length&&(A=void 0,A=C.YAt<u||C.YAt===u&&(!C.oYt||C.oYt.length<1)?this.zZt:l,this.wti(e,u,d,c),C.wti(e,u,d,c),c?C.yti(e,d,u,A,v,this.QZt):C.Y$t(e,d,u,A,v,this.QZt))):(this.wti(e,u,d,c),C.wti(e,u,d,c),c||this.YAt<u&&(y=this.zZt),!c&&d?(this.Y$t(e,d,u,l,v,h),C.Y$t(e,d,u,y,v,this.QZt)):d&&c&&(this.yti(e,d,u,l,v,h),C.yti(e,d,u,y,v,this.QZt)),C.addChildItem(t,i,n,e,r,o,a,s,u,c,y,C.YAt!==u&&C.bti(e.collapseItems,f),this.QZt,C.UZt,d,p,m))):(this.kYt=!0,i&&void 0!==r&&(N=e.d$t(n),(0,X.ht)(N)&&(N={}),this.gti=n,N[r]={calc:i.calc,calcResult:i.calcResult},e.L$t(n,this.zZt,N,c)),this.gti=n,this.HZt=n),d&&0<d.length&&(c?this.yti(e,d,u,l,v,h):this.Y$t(e,d,u,l,v,h))},v.prototype.wti=function(t,i,n,e){n&&n.length&&this.YAt<=i&&(e?t.CXt[this.zZt]=this.HZt:t.yXt[this.zZt]=this.HZt)},v.prototype.Y$t=function(t,i,n,e,r,o){var a,s,u,c,l,f,h,v,d,p,l,f,l,l,f,h,l,f,h;if(!this.UZt)for(this.UZt={},a=0,s=i;a<s.length;a++)c=(u=s[a]).fieldName,l=u.needBuildBasePath,f=u.needBuildPercentOfPath,h=u.needBuildRunningTotalOrRankPath,v=u.isNextOrPrevious,this.UZt[c]||(this.UZt[c]={}),d=this.UZt[c],p=r?r[c]:{},l&&(d.baseMajorPath=this.sti(t,c,n,p,u),d.baseMinorPath=this.vti(t,c,n,p,u),(0,X.ht)(u.baseFieldName)||this.rYt!==u.baseFieldName||u.baseFieldItemShared!==this.nodeName?this.QZt=this.QZt|o:this.QZt=this.QZt|u.showDataAsIndex),v&&(d.baseMajorPathList=this.cti(n,p),d.baseMinorPathList=this.pti(n,p)),f&&(-1<u.baseRootLevel?d.percentOfBasePath=this.hti(p,u,n):(f=(l=this.hti(p,u,n)).percentOfBasePath,l=l.baseIndex,d.baseIndex=l,d.percentOfBasePath=f)),h&&(u.showDataAs===H.PivotShowDataAs.rankAscending||u.showDataAs===H.PivotShowDataAs.rankDescending?(f=(l=this.uti(t,c,n,p,u)).currentMajorPath,h=l.childMajorPath,d.baseMajorPath=f,d.childMajorPath=h,f=(l=this.dti(t,c,n,p,u)).currentMinorPath,h=l.childMinorPath,d.baseMinorPath=f,d.childMinorPath=h):(d.baseMinorPath=this.vti(t,c,n,p,u,!0),d.baseMajorPath=this.sti(t,c,n,p,u,!0))),v||(d.indexInfo=m(u,this,t,n,e,d))},v.prototype.bti=function(t,i){var i;return!!i||(i=this,!!(t&&t[i.rYt]&&t[i.rYt][i.nodeName]))},v.prototype.yti=function(t,i,n,e,r,o){var a,s,u,c,l,f,h,v,d,p,v,d,l;if(!this.UZt)for(this.UZt={},a=0,s=i;a<s.length;a++)c=(u=s[a]).fieldName,l=u.needBuildRunningTotalOrRankPath,f=u.needBuildPercentOfPath,h=u.isNextOrPrevious,v=u.needBuildBasePath,this.UZt[c]||(this.UZt[c]={}),d=this.UZt[c],p=r?r[c]:{},v&&(d.baseMajorPath=this.sti(t,c,n,p,u),d.baseMinorPath=this.vti(t,c,n,p,u),(0,X.ht)(u.baseFieldName)||this.rYt!==u.baseFieldName||u.baseFieldItemShared!==this.nodeName?this.QZt=this.QZt|o:this.QZt=this.QZt|u.showDataAsIndex),l&&(this.UZt[c].baseMajorPath=this.sti(t,c,n,p,u,!0),this.UZt[c].baseMinorPath=this.vti(t,c,n,p,u,!0)),h&&(this.UZt[c].baseMajorPathList=this.cti(n,p),this.UZt[c].baseMinorPathList=this.pti(n,p)),f&&(-1<u.baseRootLevel?this.UZt[c].percentOfBasePath=this.hti(p,u,n):(d=(v=this.hti(p,u,n)).percentOfBasePath,l=v.baseIndex,this.UZt[c].baseIndex=l,this.UZt[c].percentOfBasePath=d)),h||(this.UZt[c].indexInfo=m(u,this,t,n,e,this.UZt[c]))},v.prototype.X$t=function(t,i,n,e,r,o,a,s,u,c,L,E){var l,f,h,v,d,p,m,b,g,w,y,C,A,N,I,T,a,s,S,x,M,D,k,B,D,k,j,O,_,F,P,R,G,V,U,l=this,f=n.valuePosition,h=n.valueFieldLength;if(-1===f&&(h=1),l.Mpi(o,e),v=n.subTotalsPosition,d=this.Iti(o,e,a,s,u,c,L,E||0),0<l.oYt.length){for(I=N=A=C=y=w=g=b=m=p=0,T=l.oYt,a=l.Spi,S=(s=Q(l.oYt)).preMap,x=s.nextMap,M=T.length-1;0<=M;M--)D=T[S[M]],k=T[x[M]],D=(B=l.oYt[M]).X$t(t,i,n,e,r,o,D,k,l.oYt[M-1]||null,l.oYt[M+1]||null,d,this.QZt),(0,X.ht)(D)||(k=D.volume,j=D.subtotalVolume,O=D.blankRowVolume,_=D.topBlankRowVolume,F=D.titleRowCount,P=D.topSubtotalVolume,p+=k,b+=O,g+=_,w+=F,A+=R=D.tabularSubtotalVolume,N+=G=D.tabularTitleRowCount,C+=P,m+=j,y+=V=D.specialSubtotalVolume,I+=U=D.specialTopBlankVolume,D=z);l.YAt===t?(l.vYt=0,l.yYt=0,l.AYt=0,l.IYt=0,l.eYt?(l.KZt=h,l.zEt?(l.AYt=0,l.IYt=0):(l.AYt=1,l.IYt=1),l.wYt=1):(l.zEt?l.KZt=0:l.KZt=1,l.wYt=0,l.XZt=0,l.$Zt=0)):l.eYt?(l.yYt=h,l.KZt=p*h,l.vYt=(m+1)*h,l.AYt=(0===b?1:b)*h+(l.zEt?0:1),l.IYt=(0===g?1:g)*h,l.$Zt=N*h,l.XZt=(A+1)*h,l.wYt=(w+1)*h+(l.zEt?0:1)):f>l.YAt?(l.KZt=p,l.kpi=y,l.jpi=I,l.$Zt=N,l.yYt=C+h,l.vYt=m+h,l.AYt=b+(l.zEt?0:1),l.IYt=g,l.XZt=A+h,l.wYt=w+(l.zEt?0:1)):(l.KZt=p,l.AYt=b+(l.zEt?0:1),l.vYt=m+1,l.kpi=y,l.jpi=I,l.zEt||(1!==v||a?2===v&&a&&(l.vYt=m,l.YAt!==t-1)&&(l.AYt=b):(l.kpi=y+1,2<=t-l.YAt&&(l.jpi=I+1))),l.$Zt=N,l.XZt=A+1,l.wYt=w+(l.zEt?0:1),l.YAt===t-1?l.IYt=g+(l.zEt?0:1):l.IYt=g,-1===f&&l.zEt?l.yYt=C+1:l.yYt=0)}else l.zEt?l.KZt=0:f===t?(l.KZt=h,l.wYt=1):l.KZt=0===h?0:1,l.vYt=0,l.kpi=0,l.jpi=0,l.AYt=l.eYt?1:0,l.IYt=l.eYt?1:0,l.XZt=0,l.wYt=l.wYt||0,l.$Zt=0,l.yYt=0;return r&&r[l.rYt]&&r[l.rYt][this.nodeName]&&(l.KZt=0,l.vYt=0,l.AYt=f<t&&l.YAt<=f?h:1,l.IYt=f<t&&l.YAt<=f?h:1,l.$Zt=l.YAt<=f?h:1,l.wYt=l.YAt<=f?h+1:1,l.yYt=0,l.XZt=0,l.kpi=0,l.jpi=0),{volume:l.KZt||0,subtotalVolume:l.vYt,blankRowVolume:l.AYt,topBlankRowVolume:l.IYt||0,titleRowCount:l.wYt||0,topSubtotalVolume:l.yYt||0,tabularSubtotalVolume:l.XZt||0,tabularTitleRowCount:l.$Zt||0,specialSubtotalVolume:l.kpi||0,specialTopBlankVolume:l.jpi||0}},v.prototype.mti=function(t,i,n,e,r,o,a,s,u,c){var l,f,t,l,f,t=new v(t,i,n,e,this.oti(r,o),this.ati(r,o),s,u);return t.YAt=this.YAt+1,t.Spi=!!c,this.oYt.push(t)-1},v.prototype.p$t=function(t,i,n){switch(t){case H.SubtotalType.sum:i.sum=n;break;case H.SubtotalType.count:i.len=n;break;case H.SubtotalType.countNums:i.count=n;break;case H.SubtotalType.min:i.min=n;break;case H.SubtotalType.max:i.max=n}},v.prototype.K$t=function(O,_,F,P,L,t,E,B,R,G){var V,U,Q,V=this,U=this,Q=F.d$t(U.HZt);return U.Ati||(Q=Q||{},(0,X.o)(O,function(t){var i,n,t,e,r,o,a,s,u,c,l,f,h,v,d,p,m,b,g,w,y,C,A,N,I,T,S,T,x,M,D,k,j,i=t.cacheName,n=t.subTotalTypes,t=t.isCalculatedField,e=U.Nti(i,U.lYt,F,P).calc,r={};if(R)for(o=0,a=n;o<a.length;o++){for(s=a[o],u=[],c=0,l=Object.keys(R);c<l.length;c++)f=l[c],u.push({fieldName:f,fieldItem:R[f]});v=B.tQt(h={fieldInfos:u,valueInfo:{sourceName:i,subtotalType:s}}),(0,X.ht)(v)||(r[s]=v,U.p$t(s,e,v))}if(d=e.count,p=e.sum,m=e.max,b=e.min,g=e.sumx2,w=e.product,y=e.len,0<U.oYt.length){if(C=!1,t)E.g$t(B,Q,i),C=!!U.kYt,p=Q[i].calc.sum;else{for(A=F.bXt[U.oYt[0].rYt],N=U.oYt.length-1;-1<N;N--)(I=U.oYt[N]).Tti=N,I.kYt&&1===_[I.gti]?U.oYt.splice(N,1):(R&&(R[A]=B.getField(A).DH()[+I.pathStr]),S=(T=I.K$t(O,_,F,P,L,U.lYt,E,B,R,G)[i]).calc,T=T.hasEffectChild,C=C||T,!S||I.zXt&&!B.aggregateCalcItem()||(d=it(d,S.count,0),p=it(p,S.sum,0),w=it(w,S.product,2),m=it(m,S.max,5),b=it(b,S.min,6),g=it(g,S.sumx2,0),y=it(y,S.len,0)));R&&delete R[A]}if(P||V.xti(F,i,L,U.oYt),x=(0,K.BXt)({count:d,sum:p,max:m,min:b,sumx2:g,product:w,len:y},n),0<Object.keys(r).length)for(M=0,D=Object.keys(r);M<D.length;M++){switch(f=D[M],U.p$t(+f,e,v=r[f]),+f){case H.SubtotalType.sum:p=v;break;case H.SubtotalType.count:y=v;break;case H.SubtotalType.countNums:d=v;break;case H.SubtotalType.min:b=v;break;case H.SubtotalType.max:m=v}x[H.SubtotalType[+f]]=v}Q[i]={collapse:V.jft,hasEffectChild:C,calcResult:x,calc:{count:d,sum:p,max:m,min:b,sumx2:g,product:w,len:y}}}else{if(Q[i]=Q[i]||{},Q[i].collapse=V.jft,x=(0,K.BXt)({count:d,sum:p,max:m,min:b,sumx2:g,product:w,len:y},n),0<Object.keys(r).length)for(k=0,j=Object.keys(r);k<j.length;k++)f=j[k],x[H.SubtotalType[+f]]=r[f];Q[i].calcResult=x,Q[i].hasEffectChild=!!U.kYt}F.L$t(U.HZt,U.lYt,Q,P)}),P&&this.YAt<=L&&W(F,U,L,O,t,E,B,G,!!R),U.Ati=!0),Q},v.prototype.xti=function(t,i,n,e){0<e.length&&this.Dti(t,i,e)},v.prototype.Iti=function(t,i,n,e,r,o,a,s){var u,c,l,f,h,v,d,p,m,b,d,g,w,y,b,d,v;if(t){if(u=t.T$t){for(c={},l=0,f=u;l<f.length;l++)h=f[l],d=(v=t.CZt[h]).baseFieldItemType,p=v.baseHeaderLevel,m=v.baseRootLevel,b=v.actualBaseLevel,d!==H.PivotShowDataAsBaseItemType.item&&(d=d===H.PivotShowDataAsBaseItemType.next,w=g=void 0,y=i?p:b,i&&p+1===this.YAt||!i&&b===this.YAt?(d?(g=e&&e.nodeName,w=o&&o.nodeName,e?this.QZt=this.QZt|s:(this.QZt=this.QZt|v.showDataAsIndex,this.$Xt=this.$Xt|v.showDataAsIndex)):(g=n&&n.nodeName,w=r&&r.nodeName,n?this.QZt=this.QZt|s:(this.QZt=this.QZt|v.showDataAsIndex,this.$Xt=this.$Xt|v.showDataAsIndex)),c[h]=g):y<this.YAt&&a&&(g=a[h],c=a,this.QZt=this.QZt|s),b=g,(0,X.ht)(w)||(b=w),d=this.lti(this.UZt[h].baseMajorPathList||[],b,i?p:m),v=this.fti(this.UZt[h].baseMinorPathList||[],b,i?m:p),this.UZt[h].baseMajorPath=d,this.UZt[h].baseMinorPath=v,delete this.UZt[h].baseMajorPathList,delete this.UZt[h].baseMajorPathList,this.UZt[h].indexInfo={baseMajorPath:d,baseMinorPath:v});return c}return a}},v.prototype.Sti=function(t,i,n){var e,r,o,a,s,u,c,l,f,h,f,e=t.M$t[i];if(e)for(r=0,o=e;r<o.length;r++)for(a=o[r],s=t.CZt[a].subtotalText,u=0,c=n;u<c.length;u++)h=(f=(l=c[u]).UZt[a]).baseMinorPath,f=f.baseMajorPath,t.v$t(a,f,h,l.HZt,i,s)},v.prototype.Dti=function(t,i,n){var e,r,o,a,s,u,c,l,f,h,v,d,p,m,p;if(0!==n.length&&(e=n[0].kYt,r=t.x$t[i]))for(o=0,a=r;o<a.length;o++)if(s=a[o],c=(u=t.CZt[s]).subtotalText,l=u.baseHeaderLevel,f=u.showDataAs,(e||!(-1<l))&&!(n[0].YAt<t.gXt))for(h=0,v=n;h<v.length;h++)m=(p=(d=v[h]).UZt[s]).baseMajorPath,p=p.baseMinorPath,f===H.PivotShowDataAs.percentOfRunningTotal?t.h$t(s,m,p,d.HZt,i,c):t.v$t(s,m,p,d.HZt,i,c)},v.prototype.Mpi=function(t,i){var n,e,r,o,a,s,u,c,r,l,f,h,v,n=this;if(n._Xt&&0!==n.oYt.length){if(e=[],r=n.oYt[0].rYt,o=t.R$t[r],a=t.G$t,s=t.V$t,u=t.bXt[r]||r,c=t.sf(r,a),r=s[u],o)return n.Mti(o,t,i,r);if(c){for(l=0,f=n.oYt;l<f.length;l++)e[c[v=(h=f[l]).nodeName]]=h;return r===H.SortType.desc&&e.reverse(),n.oYt=e.filter(function(t){return t}),e=null,delete n._Xt,!0}return!1}},v.prototype.Mti=function(t,r,o,a){var i,s,u,n,e,c,l,f,i=this,s=t.subtotalText;if(!s)return!1;if(u=t.cacheName,!r.wXt.getField(u))return!1;if(e=!1,(n=t.sortByPivotReferences)&&t.sortByHeader===o){c=a===H.SortType.asc;try{l=i.Tpi(r,n),o||(f=r.WZt(l).indexList),i.oYt.sort(function(t,i){var n,e,e=o?(n=r.WZt(t.zZt).indexList[l],r.WZt(i.zZt).indexList[l]):(n=f[t.zZt],f[i.zZt]);return n===h&&e===h?Nt(r,t.HZt,i.HZt,u,s,a):n===h?c?-1:1:e===h?c?1:-1:Nt(r,n,e,u,s,a)}),e=!0}catch(t){}}return e||i.oYt.sort(function(t,i){return Nt(r,t.HZt,i.HZt,u,s,a)}),delete i._Xt,!0},v.prototype.q$t=function(r,o,a,s,u,c){var t,i,l,n,e,f,h,v,d,p,m,b,g,w,y,C,A,N,I,T,S,x,M,D,D,M,k,j,O,_,e,f,t=this,n=null,e=!1,f=r.cacheName,h=0,v=0,d=[],p=0,m=-1/0,b=1/0,g=0,w=1;if(0<t.oYt.length)if(t.oYt[0].rYt===o&&(n=(i=a).condition,l=i.subTotalType,e=n.sn===H.PivotConditionType.top10),e){for(y=[],A=[],(C=void 0,X.o)(t.oYt,function(t,i){var t,n,t,e,t,t=t.q$t(r,o,a,s,u,c),n=t.calc,t=t.indexList;A.push({calc:n,indexList:t}),t=(e=(0,K.BXt)(n,[l]))[H.SubtotalType[l]],y.push({index:i,value:t})}),C=n.evaluate(y),N=t.oYt.length-1;-1<N;N--)if(C[N])h+=(I=A[N].calc).count,p=it(p,I.sum,0),w=it(w,I.product,2),m=it(m,I.max,5),b=it(b,I.min,6),g=it(g,I.sumx2,0),v+=I.len;else{for(T=0,S=A[N].indexList;T<S.length;T++)x=S[T],s[x]=1;t.oYt.splice(N,1)}A=z}else for(N=t.oYt.length-1;-1<N;N--)if((M=t.oYt[N]).kYt&&1===s[M.gti])t.oYt.splice(N,1);else if(I=(D=M.q$t(r,o,a,s,u,c)).calc,D=D.indexList,0!==M.oYt.length||M.kYt){if(!(t.YAt<u)&&D&&I){if(M=!0,n&&(j=(k=(0,K.BXt)(I,[l]))[H.SubtotalType[l]],M=i.condition.evaluate(j),k=z),M)h+=I.count,p=it(p,I.sum,0),w=it(w,I.product,2),m=it(m,I.max,5),b=it(b,I.min,6),g=it(g,I.sumx2,0),v+=I.len,d=d.concat(D);else{for(O=0,_=D;O<_.length;O++)x=_[O],s[x]=1;t.oYt.splice(N,1)}I=D=z}}else t.oYt.splice(N,1);else if(t.kYt)return e=c.d$t(t.HZt)[f].calc,f=!0,n&&(j=(k=(0,K.BXt)(e,[l]))[H.SubtotalType[l]],f=i.condition.evaluate(j),k=z),f?{calc:e,indexList:[t.gti]}:(s[t.gti]=1,z);return{calc:{count:h,sum:p,product:w,max:m,min:b,sumx2:g,len:v},indexList:d}},v.prototype.Nti=function(t,i,n,e){var r,o,a,s,u,c,l,f,r=n.d$t(this.HZt);return(r=r||{})[t]&&this.kYt||(f=l=c=u=s=a=o=z,r[t]={calc:{count:o,sum:s,max:c,min:c,sumx2:f,product:o,len:s}}),n.L$t(this.HZt,i,r,e),r[t]},v.prototype.kti=function(t,i,n){var e,i,r,o,a,e=z,i=i[t.rYt];return e=i?{valueFieldName:r=i.conditionBySourceName,condition:o=i.condition,subTotalType:a=n[i.conditionByName]}:e},v.prototype.jti=function(){var n={};(0,X.o)(this.oYt,function(t,i){n[t.nodeName]=i}),this._Xt=n},q=v,K.QueryNode=q},"./src/overwrite-list.ts":function(t,i,n){var a,e;function r(){var t=this;t.Oti=[],t.Pti=[]}Object.defineProperty(i,"__esModule",{value:!0}),i.OverwriteList=void 0,a=n("./pivot-entry.ts"),r.prototype.setOverwriteNode=function(t,i){var n,e,t,n=this;"number"==typeof i&&(e=n.getOverwriteNode(t),(0,a.ht)(e)?(n.Oti.push((0,a.RF)(t)),n.Pti.push(i)):(t=n.Oti.indexOf(e),n.Pti[t]=i))},r.prototype.getOverwriteValue=function(t){var n,e,r,o,n=this,e=t.fieldInfos,r=t.valueInfo;return(0,a.o)(n.Oti,function(t,i){if(n.Fti(e,t.fieldInfos)&&n._ti(r,t.valueInfo))return o=n.Pti[i],!0}),o},r.prototype.getOverwriteNode=function(t){var i,n,e,r,i=this,n=t.fieldInfos,e=t.valueInfo;return(0,a.o)(i.Oti,function(t){if(i.Fti(n,t.fieldInfos)&&i._ti(e,t.valueInfo))return r=t,!0}),r},r.prototype.removeOverwriteNode=function(t){var i,t,t,i=this,t=i.getOverwriteNode(t);(0,a.ht)(t)||(t=i.Oti.indexOf(t),i.Oti.splice(t,1),i.Pti.splice(t,1))},r.prototype.getOverwriteList=function(){for(var t,i,n,e,r,t=this,i=[],n=t.Oti,e=0;e<n.length;e++)r=(0,a.RF)(n[e]),i.push({fieldInfos:r.fieldInfos,valueInfo:r.valueInfo,value:t.Pti[e]});return i},r.prototype.toJSON=function(){return this.isEmpty()?null:this.getOverwriteList()},r.prototype.fromJSON=function(t){var e=this;e.reset(),t&&0<t.length&&(0,a.o)(t,function(t){var i=t.fieldInfos,n=t.valueInfo,t=t.value;e.setOverwriteNode({fieldInfos:i,valueInfo:n},t)})},r.prototype.isEmpty=function(){return!this.Pti||0===this.Pti.length},r.prototype.reset=function(){this.Oti=[],this.Pti=[]},r.prototype.dispose=function(){this.Oti=null,this.Pti=null},r.prototype.Lti=function(t){return t&&t.sort(function(t,i){return t.fieldName===i.fieldName?t.fieldItem>i.fieldItem?1:-1:t.fieldName>i.fieldName?1:-1})},r.prototype.Fti=function(t,i){var n,e,r,o,a,n=this.Lti(t),e=this.Lti(i);if(!n||!e||n.length!==e.length)return!1;for(r=0;r<n.length;r++)if(o=n[r],a=e[r],o.fieldName!==a.fieldName||o.fieldItem!==a.fieldItem)return!1;return!0},r.prototype._ti=function(t,i){return t&&i&&t.sourceName===i.sourceName&&t.subtotalType===i.subtotalType},i.OverwriteList=r},"./src/pivot-cache.ts":function(p,t,i){var S,J,n,T,q,x,u,e,K,g,X,i,M,r,h,b,k,w;function o(t){return t instanceof Date?(0,q.formatDateToString)(t):isNaN(t)?t:""+t}function y(t,i){var n;switch(t){case"b":n=i?"1":"0";break;case"d":n=(0,q.kQt)(new Date(i));break;case"e":n=i._calcError;break;default:n=i}return(0,q.xmlEncode)(n)}function a(t){var i=this;i.W5=t.dataType,i.Zc=o(t.name),i.k={},i.W5!==T.PivotDataType.number&&(i.P={}),i.ty=[],i.Eti={},i.sh={},i.D=[],i.lp=t.index,i.WXt={},i.Bti={}}function d(t,i,n){var e=[];for(e.push({type:"s",value:"&lt;"+t});t-1+n<=i;)e.push({type:"s",value:t+q.NUMBER_GROUP_SEPARATOR+(t-1+n)}),t+=n;return e.push({type:"s",value:t+q.NUMBER_GROUP_SEPARATOR+(t-1+n)}),e.push({type:"s",value:"&gt;"+(t+=n)}),e}function j(t,i,n,e){var r,o;for(n&&n[0]===J.LESS+(0,q.formatDateToString)(t)?(n[0]="&lt;"+(0,q.formatDateToString)(t),e.autoStart=!1):n.unshift("&lt;"+(0,q.formatDateToString)(t)),n&&n[n.length-1]===J.MORE+(0,q.formatDateToString)(i)?(n[n.length-1]="&gt;"+(0,q.formatDateToString)(i),e.autoEnd=!1):n.push("&gt;"+(0,q.formatDateToString)(i)),r=[],o=0;o<n.length;o++)r.push({type:"s",value:n[o]});return r}function O(t,i,n){var e,r,o,a,s,u,c,e=t.N,r=n.fieldGroup.groupItems=[],o={},a=n.fieldGroup.discreteGroup=[];for(s in e)e.hasOwnProperty(s)&&(r.push({type:"s",value:s}),o[s]=r.length-1);for(u=0;u<i.D.length;u++)c=i.D[u],a.push(o[t.VXt[c]])}function _(t,i,n){var e=[];for(e.push({n_:"s",v:"&lt;"+t});t-1+n<=i;)e.push({n_:"s",v:t+q.NUMBER_GROUP_SEPARATOR+(t-1+n)}),t+=n;return e.push({n_:"s",v:t+q.NUMBER_GROUP_SEPARATOR+(t-1+n)}),e.push({n_:"s",v:"&gt;"+(t+=n)}),e}function F(t,i,n,e){var r,o;for(n&&n[0]===J.LESS+(0,q.formatDateToString)(t)?(n[0]="&lt;"+(0,q.formatDateToString)(t),e.autoStart="0"):n.unshift("&lt;"+(0,q.formatDateToString)(t)),n&&n[n.length-1]===J.MORE+(0,q.formatDateToString)(i)?(n[n.length-1]="&gt;"+(0,q.formatDateToString)(i),e.autoEnd="0"):n.push("&gt;"+(0,q.formatDateToString)(i)),r=[],o=0;o<n.length;o++)r.push({n_:"s",v:n[o]});return r}function P(t,i){var n,e,r,o,a,s,u,n=t.N,e=[],r={},o=[];for(a in n)n.hasOwnProperty(a)&&(o.push({n_:"s",v:a}),r[a]=o.length-1);for(s=0;s<i.D.length;s++)u=i.D[s],e.push({n_:"x",v:r[t.VXt[u]]});return{discreteGroup:o,discretePrs:e}}function m(t,i,n,e){var t;(0,q.ht)(e[i.Zc+n])&&(t=t.push({cacheName:i.Zc,index:i.lp,dataFieldIndex:i.l,subTotalType:n})-1,e[i.Zc+n]=t)}function s(t,i,n,e){var r,t,r=this;r.oQt=n?new Array(n.length):[],r.Zc=t,r.Rti=i,r.Pq={},r.Gti=0,r.EYt=e,r.Vti=0,r.lw=!0,i&&n&&(t=i.map(function(t){return r.Uti(t)}),r.uut(t,n)),r.SMt()}function $(t,i){var n,e,r,o,a,s,u,c,l;if(t){for(n=0,e=t;n<e.length;n++)r=e[n],o=it((0,q.xmlDecode)(r.name)),(0,q.ht)(o)||!i[o]||(0,q.ht)(r.lp)||(i[o].lp=r.lp);for(s=[],u=0,c=a=Object.keys(i);u<c.length;u++)l=c[u],s.push(i[l]);s.sort(function(t,i){return t.lp-i.lp}),s.forEach(function(t,i){t.lp=i})}}function C(t,i){var n,e,r,o,a,s,n=t.Pq;for(e in i)if(i.hasOwnProperty(e)&&n[e]&&(r=n[e])&&(0,q.ht)(r.P))for(r.k={},r.P={},r.D=[],o=t.oQt,a=r.lp,s=0;s<o.length;s++)o[s][a]=r.aQt(o[s][a],s,!1)}function c(t){switch(t){case"b":return T.PivotDataType.boolean;case"d":return T.PivotDataType.date;case"e":return T.PivotDataType.errorValue;case"m":return T.PivotDataType.noValue;case"n":return T.PivotDataType.number;case"s":return T.PivotDataType.string;default:return}}function L(t){var t=t.n_;return"s"===t?T.PivotDataType.string:"n"===t?T.PivotDataType.number:"d"===t?T.PivotDataType.date:"b"===t?T.PivotDataType.boolean:"e"===t?T.PivotDataType.errorValue:"m"===t?T.PivotDataType.noValue:void 0}function A(t){switch(t){case T.PivotDataType.boolean:return"b";case T.PivotDataType.date:return"d";case T.PivotDataType.errorValue:return"e";case T.PivotDataType.noValue:return"m";case T.PivotDataType.number:return"n";case T.PivotDataType.string:return"s";default:return"n"}}function N(t,i){var n=typeof t;return void 0===t?"m":"boolean"==n?"b":"number"==n?"n":"string"==n?"d"!==i||isNaN(Date.parse(t))?"s":"d":"e"}function E(n,t){var e,i,e={};for((0,q.o)(Object.keys(n),function(t){for(var i=0;i<n[t].length;i++)e[n[t][i]]=1}),i=0;i<t.length;i++)(0,q.ht)(e[t[i]])&&(n[t[i]]=[t[i]])}function l(t,i,n,e){var r=this;r.T=t,r.gd=i,r.groupItemsIndexMap={},r.groupItemsKeyIndexes={},"number"===e?((0,q.ht)(t)||(0,q.ht)(n)?r.Qti=i:r.Qti=t+Math.ceil((i-t)/n)*n,R(r,n,t,r.Qti)):B(r,n,t,i),r.Rs=n,r.type=e,r.name=this.getName(n)}function f(t,i){for(var n,e,r,o,n="",e=0,r=i;e<r.length;e++)n&&(n+="-&-"),n=(n=n+(o=r[e])+"&")+t[o];return n}function B(t,i,n,e){var r,o,a,s,u,c,l,f,h,r=M().dateResource,o=r.HOUR_GROUP_ITEMS.slice(),a=r.MINUTE_GROUP_ITEMS.slice(),s=r.SECOND_GROUP_ITEMS.slice();switch(i){case T.DateGroupType.seconds:t.groupItemsKeyList=s;break;case T.DateGroupType.minutes:t.groupItemsKeyList=a;break;case T.DateGroupType.hours:t.groupItemsKeyList=o;break;case T.DateGroupType.days:t.groupItemsKeyList=(0,q.Wti)();break;case T.DateGroupType.months:t.groupItemsKeyList=(0,q.zti)();break;case T.DateGroupType.quarters:t.groupItemsKeyList=(0,q.Zti)();break;case T.DateGroupType.years:if(n&&e){for(u=[],c=n.getFullYear(),l=e.getFullYear(),f=c;f<=l;f++)u.push((0,J.Yti)(f));t.groupItemsKeyList=u}break;default:t.groupItemsKeyList=[]}for(n&&t.groupItemsKeyList.unshift(J.LESS+(0,q.formatDateToString)(n)),e&&t.groupItemsKeyList.push(J.MORE+(0,q.formatDateToString)(e)),f=0;f<t.groupItemsKeyList.length;f++)h=t.groupItemsKeyList[f],t.groupItemsIndexMap[h]=[],t.groupItemsKeyIndexes[h]=f}function R(t,i,n,e){var r,o,a;for(t.groupItemsKeyList=[],t.groupItemsKeyList.push(J.LESS+n),r=n;r<e;)t.groupItemsKeyList.push(r+"-"+(r+i-1)),r+=i;for(t.groupItemsKeyList.push(J.MORE+e),o=0;o<t.groupItemsKeyList.length;o++)a=t.groupItemsKeyList[o],t.groupItemsIndexMap[a]=[],t.groupItemsKeyIndexes[a]=o}function G(t,i,n,e){var r,o,a,s,u;if(!(n-i<=0||e<=0)){for(r=t.k,o=t.D,a=t.P,(0,q.ht)(i)&&(i=t.T||V(t.D),t.rCi=!0),(0,q.ht)(n)&&(n=t.gd||U(t.D),t.oCi=!0),t.T=i,t.gd=n,t.Rs=e,t.y1=t.Zc,s=new w(i,n,e,"number"),t.Qti=s.Qti,u=0;u<o.length;u++)s.insertIndexToIndexMap(o[u],r[(0,q.isEmptyObject)(a)?""+o[u]:a[""+o[u]]]);t.cx=s.groupItemsKeyList,t.A=s.groupItemsIndexMap,t.AQt=s.groupItemsKeyIndexes,t.uQt()}}function V(t){for(var i,n,e,i=+t[0],n=1,e=t.length;n<e;n++)i=Math.min(i,+t[n]);return i}function U(t){for(var i,n,e,i=+t[0],n=1,e=t.length;n<e;n++)i=Math.max(i,+t[n]);return i}function Q(t){for(var i,n,e,i=t[0],n=1,e=t.length;n<e;n++)i=i<t[n]?i:t[n];return new Date(i)}function W(t){for(var i,n,e,i=t[0],n=1,e=t.length;n<e;n++)i=i>t[n]?i:t[n];return new Date(i)}function I(t,i,n){return(0,q.ht)(n)?(n=1,t.zRt(i)?t.zRt(i+n)?void 0:i+n:i):I(t,i,n+1)}function z(t,i,n){var e,r,o,a,s,u,c,l,f,h,v,d,p,m;if(n){for(n.sort(function(t,i){return t.by-i.by}),e=[],a=0;a<n.length;a++){if(s=n[a].start,u=n[a].end,c=n[a].by,(0,q.ht)(s)&&(s=(0,q.ht)(r)?r=i.T||Q(i.D):r),(u=(0,q.ht)(u)?(0,q.ht)(o)?o=i.gd||W(i.D):o:u)<=s)return;e.push(new w(s,u,c,"date"))}for(l=i.k,f=i.D,h=i.P,v=0,d=i.D.length;v<d;v++)for(p=0;p<e.length;p++)e[p].insertIndexToIndexMap(i.D[v],l[h[f[v]]]);for(i.cx=e[0].groupItemsKeyList,i.A=e[0].groupItemsIndexMap,i.AQt=e[0].groupItemsKeyIndexes,i.T=e[0].T,i.gd=e[0].gd,n[0].start===X&&(i.rCi=!0),n[0].end===X&&(i.oCi=!0),i.Rs=e[0].Rs,i.y1=i.Zc,i.uQt(),i.nZt=[],p=1;p<e.length;p++)(m=new b({dataType:i.W5,name:I(t,e[p].name)})).cx=e[p].groupItemsKeyList,m.A=e[p].groupItemsIndexMap,m.AQt=e[p].groupItemsKeyIndexes,m.T=e[p].T,m.gd=e[p].gd,n[p].start===X&&(m.rCi=!0),n[p].end===X&&(m.oCi=!0),m.Rs=e[p].Rs,m.y1=i.Zc,m.qXt=!1,m.l=i.lp,m.uQt(),i.nZt.push(m.Zc),t.addField(m)}}function tt(t){switch(t){case"seconds":return T.DateGroupType.seconds;case"minutes":return T.DateGroupType.minutes;case"hours":return T.DateGroupType.hours;case"days":return T.DateGroupType.days;case"months":return T.DateGroupType.months;case"quarters":return T.DateGroupType.quarters;case"years":return T.DateGroupType.years}}function D(t){switch(t){case T.DateGroupType.seconds:return"seconds";case T.DateGroupType.minutes:return"minutes";case T.DateGroupType.hours:return"hours";case T.DateGroupType.days:return"days";case T.DateGroupType.months:return"months";case T.DateGroupType.quarters:return"quarters";case T.DateGroupType.years:return"years"}}function it(t){var i,n,i=/_x00[0-1][0-9A-Fa-f]_/;return(0,q.ht)(t)||t.match(i)===g?t:t.replace(n=/(_x005[fF])?_x00([0-1][0-9A-Fa-f])_/g,function(t,i,n){var e=0;return n&&(e=parseInt(n,16)),i?"_x00"+n+"_":String.fromCharCode(e)}).replace(/(\r)+\n/g,"\r\n")}function Z(t){var i=g;switch(t){case"#DIV/0!":i=7;break;case"#N/A":i=42;break;case"#NAME?":i=29;break;case"#NULL!":i=0;break;case"#NUM!":i=36;break;case"#REF!":i=23;break;case"#VALUE!":i=15;break;case"#SPILL!":i=99}return i!==g?{_error:t,_code:i}:g}function v(t,i){if("s"===t||"string"===t)return it(i);var n;if("n"===t||"number"===t)return n=parseFloat(i),isNaN(n)?X:n;if("d"===t||"date"===t)return it(i);if("b"===t||"boolean"===t){if("1"===i||"t"===i)return!0;if("0"===i||"f"===i)return!1}return"e"===t||"errorValue"===t?Z(i):"m"===t||"noValue"===t?null:"x"===t?parseInt(i,10):i}S=this&&this.__spreadArray||function(t,i,n){if(n||2===arguments.length)for(var e=0,r=i.length,o;e<r;e++)!o&&e in i||((o=o||Array.prototype.slice.call(i,0,e))[e]=i[e]);return t.concat(o||Array.prototype.slice.call(i))},Object.defineProperty(t,"__esModule",{value:!0}),t.io=t.getPathStr=t.PivotCache=t.PivotCacheField=void 0,J=i("./pivot-entry.ts"),n=i("Common"),T=i("./src/pivot-interface.ts"),q=i("./src/pivot-util.ts"),x=i("CalcEngine"),u=i("./src/pivot-sort.ts"),e=i("./src/pivot-calc-engine.ts"),K=i("./src/overwrite-list.ts"),g=null,X=void 0,i=new n.Common.ResourceManager(J.SR),M=i.getResource.bind(i),r=n.Common.CultureManager,h=n.Common.kh,a.prototype.addCalcItem=function(t,i){var n,e,r,o,a,n=this,e=n.D,r=e.indexOf(t);r<0&&(r=e.push(t)-1),(o=n.k)[r]=[],(a=n.P)[t]=r,n.WXt[r]=i,n.uQt()},a.prototype.hasCalcItem=function(){return!!this.ty.length},a.prototype.cC=function(){return!!this.y1},a.prototype.up=function(){return this.ty.concat()},a.prototype.removeCalcItem=function(t){var i,n,e,r,o,a,s,u,c,l,f,h,v,d,p,m,i=this,n=i.D,e=n.indexOf(t);if(!(e<0)){for(n.splice(e,1),delete(r=i.k)[e],a=0,s=o=Object.keys(r);a<s.length;a++)e<(c=+(u=s[a]))&&(r[c-1]=r[u]);for(delete(l=i.WXt)[e],v=0,d=f=Object.keys(l);v<d.length;v++)e<(h=+(p=d[v]))&&(l[h-1]=l[h],delete l[h]);for(delete(m=i.P)[t];e<n.length;e++)m[n[e]]--;i.uQt()}},a.prototype.y$t=function(t){var i,n,i,n;return this.P[t]},a.prototype.Hti=function(t){return this.W5!==T.PivotDataType.date||(0,q.ht)(t)?t:(0,q.kQt)(t)+""},a.prototype.Jti=function(t,i){var n=this;if(n.W5!==T.PivotDataType.number)return n.aQt(t,i);n.qti(t,i)},a.prototype.Kti=function(t){return(0,q.ht)(t)||t===M().blank},a.prototype.Xti=function(t,i){var n,e,r,o,a,s,u,n,c,l,n=this,e=n.W5,r=n.D,o=n.P,a=o&&0<o.length,u=M().blank;if(r&&0<r.length){for(n=n.Kti(r[0]),c=0;c<r.length;c++)"number"==typeof(l=a?o[r[c]]:r[c])?(t.containsNumber=!0,isFinite(l)&&Math.floor(l)===l||(s=!1),(0,q.ht)(t.minValue)?t.minValue=l:t.minValue=Math.min(l,t.minValue),(0,q.ht)(t.maxValue)?t.maxValue=l:t.maxValue=Math.max(l,t.maxValue)):e===T.PivotDataType.date?"string"!=typeof l||isNaN(Date.parse(l))?(0,q.ht)(l)||l===u||(t.containsNonDate=!0):(t.containsDate=!0,(0,q.ht)(t.minDate)?t.minDate=l:t.minDate=Date.parse(l)<Date.parse(t.minDate)?l:t.minDate,(0,q.ht)(t.maxDate)?t.maxDate=l:t.maxDate=Date.parse(l)>Date.parse(t.minDate)?l:t.maxDate):"string"==typeof l&&l!==u&&(t.containsString=!0),!(0,q.ht)(l)&&l!==u||(t.containsBlank=!0);!0===t.containsNumber&&!1!==s&&(t.containsInteger=!0),(e!==T.PivotDataType.string||n)&&(0,q.ht)(t.containsString)&&(t.containsString=!1),e===T.PivotDataType.date&&(0,q.ht)(t.containsNonDate)&&(t.containsNonDate=!1)}},a.prototype.$ti=function(t,i){var n,e,r,o,a,s,i,u,n=this,e=i.containsString,r=i.containsNumber,o=i.containsDate,a=i.containsBlank,s=i.containsError,i=i.containsBool,u;1<[e,r,o,i].filter(Boolean).length&&(t.containsMixedTypes="1"),e&&t.containsMixedTypes||n.W5===T.PivotDataType.string||a||s||(t.containsSemiMixedTypes="0"),i&&(t.containsSemiMixedTypes="1")},a.prototype.tii=function(t){var i,n,e,r,o,a,s,u,c,l,f,h,v,d,p,m,b,g,w,y,i,C,A,N,N,I,i=this,n=i.W5,e=i.D,r=i.P,o=r&&0<r.length,a=M().blank,s={};if(e&&0<e.length){for(y=w=g=b=m=p=d=v=h=f=l=c=u=void 0,i=i.Kti(e[0]),C=0,A=e;C<A.length;C++)N=A[C],"number"==(I=typeof(N=o?r[N]:N))?(d=!0,isFinite(N)&&Math.floor(N)===N||(p=!1),m=(0,q.ht)(m)?N:Math.min(N,m),b=(0,q.ht)(b)?N:Math.max(N,b)):n===T.PivotDataType.date?"string"!=I||isNaN(Date.parse(N))?(0,q.ht)(N)||N===a||(l=!0):(f=!0,h=(0,q.ht)(h)||Date.parse(N)<Date.parse(h)?N:h,v=(0,q.ht)(v)||Date.parse(N)>Date.parse(v)?N:v):"string"==I&&N!==a?c=!0:N instanceof x.CalcError?g=!0:"boolean"==I&&(w=!0),!(0,q.ht)(N)&&N!==a||(u=!0),"string"==I&&255<N.length&&(y=!0);!0===d&&!1!==p&&(p=!0),(n!==T.PivotDataType.string||i)&&(0,q.ht)(c)&&(c=!1),n===T.PivotDataType.date&&(0,q.ht)(l)&&(l=!1),t.count=e.length+"",f&&(t.containsDate="1"),!1===l&&(t.containsNonDate="0"),!1!==c||g||w||(t.containsString="0"),g&&(c=!0),u&&(t.containsBlank="1"),y&&(t.longText="1"),d&&!f&&(t.containsNumber="1"),p&&!f&&(t.containsInteger="1"),f?(t.minDate=(0,q.kQt)(new Date(h)),t.maxDate=(0,q.kQt)(new Date(v))):(d||p)&&(t.minValue=m,t.maxValue=b),s={containsString:c,containsNumber:d,containsDate:f,containsBlank:u,containsError:g,containsBool:w}}return s},a.prototype.iii=function(t){var i=this,n=t.containsString,e=t.containsNumber,r=t.containsDate,o=t.containsBlank,a=0;n&&a++,e&&a++,r&&a++,1<a&&(t.containsMixedTypes=!0),t.containsString&&t.containsMixedTypes?t.containsSemiMixedTypes=!0:i.W5===T.PivotDataType.string||o||(t.containsSemiMixedTypes=!1)},a.prototype.qti=function(t,i){var n=this,e=n.k,r=n.Hti(t),o=n.D;(0,q.ht)(n.gd)&&(n.gd=t),(0,q.ht)(n.T)&&(n.T=t),n.gd=n.gd<t?t:n.gd,n.T=n.T>t?t:n.T,e[r]||(e[r]=[],o.push(r)),e[r].push(i)},a.prototype.aQt=function(i,t,n){var e,r,o,a,s,n,u,e,e=this,r=e.k,o=e.P,a=e.D,s=e.Bti,n=i=n&&2===e.W5?(0,q.nii)(i):i;if((0,q.ht)(i))n=M().blank;else if(2===e.W5){if("object"==typeof n)try{e.gd=e.gd<i?i:e.gd,e.T=e.T>i?i:e.T,n=(0,q.formatDateToString)(i)}catch(t){n=i}}else n=e.Hti(i);return e=o[n=(0,q.ht)(n)?M().blank:n],(0,q.ht)(e)&&(e=s[(n+"").toLowerCase()]),(0,q.ht)(e)?(u=a.push(n)-1,o[n]=u,s[(n+"").toLowerCase()]=u):u=e,(0,q.ht)(r[u])&&(r[u]=[]),r[u].push(t),u},a.prototype.eii=function(t,i){var n,e=this.k;e[t]||(e[t]=[]),e[t].push(i)},a.prototype.rii=function(){for(var t,i,n,e,r,o,a,t=this,i=t.D,n=0,e=i[n],r=i.length;n<r&&(!e||isNaN(Date.parse(e)));)e=i[++n];for(o=(0,J.parseStringToDate)(e),a=(0,J.parseStringToDate)(e);n<r;n++)o=(e=(0,J.parseStringToDate)(i[n]+""))<o?e:o,a=a<e?e:a;t.T=o,t.gd=a},a.prototype.oii=function(){for(var t,i,n,e,r,o,a,t=this,i=t.D,n=0,e=i[n],r=i.length-1;n<r&&((0,q.ht)(e)||isNaN(+e));)e=i[++n];for(a=o=e;n<i.length;n++)o=(e=i[n])<o?e:o,a=a<e?e:a;t.T=o,t.gd=a},a.prototype.getFieldsItemList=function(){return this.DH().concat()},a.prototype.getIndexesList=function(t){for(var i,n,e,r,o,i=this.aii(),n=[],e=0,r=t;e<r.length;e++)o=r[e],(0,q.ht)(i[o])||(n=n.concat(i[o]));return n},a.prototype.getFilterIndexesList=function(){for(var t,i,n,e,r,o,t=this.aii(),i=[],n,e=0,r=Object.keys(t);e<r.length;e++)o=r[e],(0,q.ht)(t[o])||(i=i.concat(t[o]));return i},a.prototype.DH=function(){return[].concat(this.cx||this.D)},a.prototype.aii=function(){return this.A||this.k},a.prototype.M=function(){return this.AQt||this.P},a.prototype.S=function(t){var i=this,n=i.W5;return i.VXt?i.VXt[t]:n===T.PivotDataType.number?(0,q.getNumberGroupItemKey)(i,t):n===T.PivotDataType.date?(0,q.getDateGroupItemKey)(i,t):void 0},a.prototype.sii=function(t,i){var n,e,n=this;n.N=t,e=n.VXt={},(0,q.o)(Object.keys(t),function(i){(0,q.o)(t[i],function(t){e[t]=i})}),(0,q.o)(i,function(t){(0,q.ht)(e[t])&&(e[t]=t)})},a.prototype.uii=function(){var t=this;delete t.T,delete t.gd,delete t.Rs,delete t.y1,delete t.cx,delete t.A,delete t.AQt,delete t.qXt,delete t.l,delete t.nZt},a.prototype.uQt=function(){var t,i,n,e,r,o,a,s,t=this,i={},n=t.W5,e=t.DH(),r=t.M(),o=1e3<e.length&&!t.needSort?e.concat():(0,u.mXt)(e.concat(),{sortType:T.SortType.asc,isDate:n===T.PivotDataType.date,isNumberGroup:n===T.PivotDataType.number&&!(0,q.ht)(t.cx),by:t.Rs},"en");if(o&&0<o.length){for(a=0,s=o.length;a<s;a++)i[r[o[a]]]=a;t.sQt=i}else t.sQt=g},a.prototype.DAe=function(){var t,i,n,e,r,o,a,s,t=this,i={},n=t.W5,e=t.DH(),r=t.M(),o=(0,u.mXt)(e.concat(),{sortType:T.SortType.asc,isDate:n===T.PivotDataType.date,isNumberGroup:n===T.PivotDataType.number&&!(0,q.ht)(t.cx),by:t.Rs},"en");if(o&&0<o.length){for(a=0,s=o.length;a<s;a++)i[r[o[a]]]=a;return i}return null},a.prototype.dispose=function(){var t=this;t.k=g,t.D=g,t.sQt=g,t.P=g,t.cx=g,t.A=g,t.AQt=g,t.VXt=g,t.Hti=g,t.cii=g,t.cft=g,t.Xnn=g,t.N=g,t.nZt=g,t.lii=g},a.prototype.fromJson=function(t,i){var n,e,r,o,a,n=this;if((0,q.ht)(t.name)||(n.Zc=t.name),(0,q.ht)(n.W5)&&!(0,q.ht)(i)&&(n.W5=c(i.type)),(e=t.entities)&&0<e.length)for(n.P||(n.P={}),n.D=[],r=M().blank,o=void 0,a=0;a<e.length;a++)e[a].isUnusedItem||(o=e[a].value,(0,q.ht)(o)&&(o=r),"object"!=typeof(o=2!==n.W5||isNaN(Date.parse(o))?o:(0,q.formatDateToString)(new Date(o)))||(0,q.ht)(o._error)&&(0,q.ht)(o._calcError)||(o=J.ErrorsMap[o._code]||J.ErrorsMap[0]),n.D.push(o),n.P[o]=a)},a.prototype.yh=function(t,i){var n,i,e,r,o,a,n=this;if((0,q.ht)(t.name)||(n.Zc=it((0,q.xmlDecode)(t.name))),(0,q.ht)(n.W5)&&!(0,q.ht)(i)&&(n.W5=c(i.n_)),(e=(i=(0,q.xr)(t,"sharedItems"))&&i.c_)&&0<e.length)for(n.P||(n.P={}),n.D=[],r=M().blank,o=void 0,a=0;a<e.length;a++)e[a].u||(o=v(e[a].n_,e[a].v),(0,q.ht)(o)&&(o=r),"object"!=typeof(o=2!==n.W5||isNaN(Date.parse(o))?o:(0,q.formatDateToString)(new Date(o)))||(0,q.ht)(o._error)&&(0,q.ht)(o._calcError)||(o=J.ErrorsMap[o._code]||J.ErrorsMap[0]),n.D.push(o),n.P[o]=a)},a.prototype.toJson=function(t){var i,n,e,r,o,a,s,u,c,l,f,h,v,f,o,t,o,i=this,n=(0,q.ht)(i.cft)?{}:i.cft,e=M().blank;if((0,q.ht)(i.Zc)||(n.name=i.Zc),(0,q.ht)(i.lp)||(n.lp=i.lp),(0,q.ht)(i.D5)||(n.formula=i.D5,n.databaseField=!1),!1===i.qXt&&(n.databaseField=!1),i.hasCalcItem()&&i.W5===T.PivotDataType.date&&(n.containsMixedTypes=!0,n.containsString=!0),!1!==n.databaseField&&(i.Xti(n,t),i.iii(n)),(0,q.isEmptyObject)(i.P))n.entities=[];else if(r=n.entities=[],(o=i.D)&&0<o.length){for(a=A(i.W5),u=!(s={}),c=0,l=o;c<l.length;c++)"e"===(v=N(h=f=l[c],a))?h=(null==h?void 0:h.toJSON)&&h.toJSON()||h._error:("s"===v&&255<f.length&&(n.longText=!0),u=!0),s[f=(h+"").toLowerCase()]||((0,q.ht)(h)||h===e?r.push({type:"m"}):r.push({type:v,value:h,isCalculatedItem:!!i.sh[h]}),s[f]=!0);u||(n.entities=[])}return t=(o=t&&t.getField(i.y1))&&o.lp,i.cx&&((0,q.ht)(i.T)?(0,q.isEmptyObject)(i.N)||(n.fieldGroup={base:t},O(i,o,n)):"number"==typeof i.T?(n.fieldGroup={startNum:i.T,endNum:i.gd,autoStart:!0===i.rCi,autoEnd:!0===i.oCi,groupInterval:i.Rs,base:t,hasRangeGroup:!0},n.fieldGroup.groupItems=d(i.T,i.gd,i.Rs)):i.T instanceof Date&&(n.fieldGroup={startDate:i.T&&new Date(i.T).toUTCString(),endDate:i.gd&&new Date(i.gd).toUTCString(),autoStart:!0===i.rCi,autoEnd:!0===i.oCi,groupBy:D(i.Rs),base:t,hasRangeGroup:!0},i.cx)&&(o=i.cx.concat(),o=j(i.T,i.gd,o,n.fieldGroup),n.fieldGroup.groupItems=o)),n},a.prototype.wh=function(t){var i,n,e,r,o,a,s,u,c,l,f,h,v,d,v,o,r,p,t,m,b,r,o,r,i=this,n=(0,q.ht)(i.Xnn)?{n_:"cacheField",c_:[]}:i.Xnn,e=M().blank,r={n_:"sharedItems"};if((0,q.ht)(i.lp)||(n.lp=i.lp),(0,q.ht)(i.Zc)||(n.name=(0,q.xmlEncode)(i.Zc)),(0,q.ht)(i.D5)||(n.formula=(0,q.xmlEncode)(i.D5),n.databaseField="0"),!1===i.qXt&&(n.databaseField="0"),i.hasCalcItem()&&i.W5===T.PivotDataType.date&&(r.containsMixedTypes=1,r.containsString=1),"0"!==n.databaseField&&(o=i.tii(r),i.$ti(r,o)),a=[],"0"!==n.databaseField&&!(0,q.isEmptyObject)(i.P)&&(s=i.D)&&0<s.length){for(u=A(i.W5),l=!(c={}),f=0;f<s.length;f++)"e"===(v=N(h=s[f],u))?h=h&&h.toJSON&&h.toJSON()||h._error:l=!0,c[d=(h+"").toLowerCase()]||((0,q.ht)(h)||h===e?a.push({n_:"m"}):(v={n_:v,v:y(v,h)},i.sh[h]&&(v.f=1),a.push(v)),c[d]=!0);l||(a=[])}return 0<a.length&&(r.c_=a,r.count=a.length,n.c_.push(r)),r=(o=t&&t.getField(i.y1))&&o.lp,i.cx&&(t={n_:"fieldGroup",base:r,c_:[]},(0,q.ht)(i.T)?(0,q.isEmptyObject)(i.N)||(o=(r=P(i,o)).discretePrs,r=r.discreteGroup,t.c_.push({n_:"groupItems",count:r.length,c_:r}),t.c_.push({n_:"discretePr",count:o.length,c_:o})):"number"==typeof i.T?(m={n_:"rangePr",groupInterval:i.Rs+"",startNum:i.T+"",endNum:i.gd+"",autoStart:!0===i.rCi?"1":"0",autoEnd:!0===i.oCi?"1":"0"},b={n_:"groupItems",c_:p=_(i.T,i.gd,i.Rs),count:p.length},t.c_.push(m),t.c_.push(b)):i.T instanceof Date&&(m={n_:"rangePr",groupBy:D(i.Rs),startDate:(0,q.kQt)(i.T),endDate:(0,q.kQt)(i.gd),autoStart:!0===i.rCi?"1":"0",autoEnd:!0===i.oCi?"1":"0"},p=i.cx.concat(),b={n_:"groupItems",c_:p=F(i.T,i.gd,p,m),count:p.length},t.c_.push(m),t.c_.push(b)),(0,J.Pr)(t,["rangePr","discretePr","groupItems"]),n.c_.push(t)),(0,J.Pr)(n,["sharedItems","fieldGroup"]),n},a.prototype.sf=function(){return this.sQt},b=a,t.PivotCacheField=b,s.prototype.hasCalcItem=function(t){for(var i,n,e,r,n,i=this,e=0,r=t;e<r.length;e++)if((n=r[e]).isDim&&0<(n=(n=i.getField(n.sourceName)).cC()?i.getField(n.y1):n).ty.length)return!0;return!1},s.prototype.aggregateCalcItem=function(t){var i=this;if((0,q.ht)(t))return i.lw;i.lw=!!t},s.prototype.setUntreatedNodeInfo=function(t,i,n,e,r){var o=this,t=f(t,n);o.JXt||(o.JXt={}),o.JXt[t]={calcResultIndex:r,expression:e,pathInfo:i}},s.prototype.getPivotCalcService=function(){var t;return this.HXt},s.prototype.SMt=function(){var t=this;t.HXt=new e.PivotCalcService,t.POt=new e.PivotCalcSource(t.HXt),t.POt.setPivotCache(t),t.HXt.fii(t.POt)},s.prototype.getDataRefer=function(){return this.EYt},s.prototype.getHeaderList=function(){var t,i,n,e,r,o,i,n=this.Pq,t=[];for(o in n)h(n,o)&&(r={name:(e=n[o]).Zc,dataType:e.W5,index:e.lp},(0,q.ht)(e.D5)||(r.fieldType=T.PivotSourceFieldType.isCalcField),(0,q.ht)(e.y1)||(r.fieldType=T.PivotSourceFieldType.isGroupField),t[e.lp]=r);return S([],t,!0)},s.prototype.hii=function(){var t,i,n,e,r,i=this;if((0,q.ht)(i.Rti)){for(r in e=void 0,t=[],n=i.Pq)h(n,r)&&(t[(e=n[r]).lp]={name:e.Zc,dataType:e.W5,index:e.lp});i.Rti=t}},s.prototype.dx=function(t,i){for(var n,e,r,o,a,s,u,c,l,f,h,v,d,p,m,m,b,g,w,y,C,A,N,I,T,n=this,e=[],r=[],s=n.getHeaderList(),u=n.oQt,c=[],f=n.Pq,h=[],v=[],p=M().blank,b=0,g=s;b<g.length;b++)(m=f[(w=g[b]).name]).cC()&&w.name!==m.y1||!(0,q.ht)(m.D5)?r.push(w.index):c.push(w.name),h.push(m.D),(m=m.P)&&0<Object.keys(m).length?v.push(1):v.push(0);if(e.push(c),c=[],i)for(y=0,C=u;y<C.length;y++){for(l=(a=(w=C[y]).slice(0)).length,A=o=0;A<l;A++)-1<r.indexOf(A)||(v[A]?((d=h[A][a[A]])===p&&(d=null),c[o]=d):c[o]=a[A]===p?null:a[A],o++);e.push(c),c=[]}else for(N=0,I=t;N<I.length;N++){for(T=I[N],l=(a=S([],u[T],!0)).length,A=o=0;A<l;A++)-1<r.indexOf(A)||(v[A]?((d=h[A][a[A]])===p&&(d=null),c[o]=d):c[o]=a[A]===p?null:a[A],o++);e.push(c),c=[]}return e},s.prototype.ln=function(t,i){var n,e,r,o,a,s,u,c,u,l,f,h,v,d,p,m,b,n=this,e=n.ZVt,r=n.WVt(),o=n.getCalcItems();for(o.sort(function(t,i){return t.priority-i.priority}),a=[],s=0;s<r.length;s++)r[s]&&a.push({name:r[s].Zc,formula:r[s].D5});if(u=n.HXt,c=n.EYt,n.dispose(),n.HXt=u,n.EYt=c,n.oQt=[],n.Rti=t,n.Gti=0,n.Vti=0,n.Z$t&&n.Z$t.dispose(),n.Z$t=g,t&&i&&(u=t.map(function(t){return n.Uti(t)}),n.uut(u,i)),n.SMt(),(0,q.ht)(e)||n.vii(e),0<a.length)for(s=0;s<a.length;s++)n.addCalcField(a[s].name,a[s].formula);for(f={},h=0,v=o;h<v.length;h++)d=v[h],(l=n.getField(d.sourceName)).W5===T.PivotDataType.number&&(f[d.sourceName]=!0);0<Object.keys(f).length&&C(n,f);try{for(p=0,m=o;p<m.length;p++)b=m[p],n.dii(b.sourceName,b.calcItemName,b.formula,n.pii())}catch(t){}},s.prototype.vii=function(t){var i,n,i=this;for(n in t)h(t,n)&&i.dy(t[n])},s.prototype.mii=function(t){return this.EYt===t},s.prototype.getName=function(){return this.Zc},s.prototype.getAllFieldsNames=function(){var t,i,n,t=[],i=this.Pq;for(n in i)i.hasOwnProperty(n)&&(t[i[n].lp]=i[n].Zc);return t},s.prototype.uut=function(t,r){var i,o,a,s,o,i=this,a=M().blank,s=r.length||0;(0,q.o)(t,function(t,i){var n,e;if(t.W5===T.PivotDataType.number||t.W5===T.PivotDataType.date){for(n=t.W5===T.PivotDataType.number?function(t){return"number"==typeof t}:function(t){return t instanceof Date},e=0;(!r[e]||(0,q.ht)(r[e][i])||!n(r[e][i]))&&e<s;)e++;t.T=r[e][i],t.gd=r[e][i]}}),(0,q.o)(r,function(n,e){(0,q.o)(t,function(t,i){o=n[i],!(0,q.ht)(o)&&""!==o||(n[i]=a),o=t.Jti(o,e),(0,q.ht)(o)||(n[i]=o)}),i.oQt[e]=n}),(0,q.o)(t,function(t){t.W5!==T.PivotDataType.string&&t.W5!==T.PivotDataType.date||t.uQt()}),this.bii()},s.prototype.gii=function(t,i){var n,i,s,u,n=this,i=i.pivotCacheRecords;i&&0<i.length&&(s=i[0],u=M().blank,(0,q.o)(i,function(r,o){var a=[];(0,q.o)(t,function(t,i){var n,e,n=r[i]&&r[i].value;(0,q.ht)(n)&&(n=u),e=s[i]&&s[i].type||c(t.W5),"object"!=typeof n||(0,q.ht)(n._error)||(n=J.ErrorsMap[n._code]||J.ErrorsMap[0]),"x"===e?t.eii(n,o):"m"===e||(0,q.ht)(e)?((0,q.ht)(n)||(t.W5=T.PivotDataType.string),n=t.aQt(n,o,!0)):"n"!==e?n=t.aQt(n,o,!0):t.qti(n,o),a[i]=n}),n.oQt.push(a)}),(0,q.o)(t,function(t){t.W5===T.PivotDataType.date&&t.rii(),t.W5===T.PivotDataType.number&&(0,q.ht)(t.T)&&t.oii(),t.W5!==T.PivotDataType.string&&t.W5!==T.PivotDataType.date&&(t.W5!==T.PivotDataType.number||(0,q.ht)(t.P))||t.uQt()}))},s.prototype.wii=function(t,i){var n,i,s,u,n=this,i=i&&i.c_;i&&0<i.length&&(s=i[0],u=M().blank,(0,q.o)(i,function(r,o){var a=[];(0,q.o)(t,function(t,i){var n,n,e,n=r.c_&&r.c_[i],n=v(n&&n.n_,n&&n.v);(0,q.ht)(n)&&(n=u),e=s.c_[i]&&s.c_[i].n_||c(t.W5),"object"!=typeof n||(0,q.ht)(n._error)||(n=J.ErrorsMap[n._code]||J.ErrorsMap[0]),"x"===e?t.eii(n,o):"m"===e||(0,q.ht)(e)?((0,q.ht)(n)||(t.W5=T.PivotDataType.string),n=t.aQt(n,o,!0)):"n"!==e?n=t.aQt(n,o,!0):t.qti(n,o),a[i]=n}),n.oQt.push(a)}),(0,q.o)(t,function(t){t.W5===T.PivotDataType.date&&t.rii(),t.W5===T.PivotDataType.number&&(0,q.ht)(t.T)&&t.oii(),t.W5!==T.PivotDataType.string&&t.W5!==T.PivotDataType.date&&(t.W5!==T.PivotDataType.number||(0,q.ht)(t.P))||t.uQt()}))},s.prototype.bii=function(){var t,i,n,e,r,o,a,s,u,c,l,f,h,v,f,d,p,t=this,i=t.oQt,n=t.Q$t={},e=M().blank;if(!(0,q.ht)(i)){for(r=i.length,u=t.Pq,l=[],h=0,v=c=t.Rti;h<v.length;h++)f=v[h],(0,q.ht)(f)||(0,q.ht)(u[f.name])||((f=u[f.name]).P&&0<Object.keys(f.P).length?l[f.lp]=(0,q.ht)(f.P[e])?-1:f.P[e]:l[f.lp]=e);for(d=0;d<r;d++)if(o=i[d]){for(a=o.length,s=!0,p=0;p<a;p++)if(o[p]!==l[p]){s=!1;break}s&&(n[d]=1)}}},s.prototype.getField=function(t){return this.Pq[t]},s.prototype.Uti=function(t){var i,t,n,i=this,t=new b(t);return(0,q.ht)(t.lp)&&(t.lp=i.Gti),n=t.Zc,(0,q.ht)(i.Pq[n])&&i.Gti++,i.Pq[n]=t},s.prototype.zRt=function(t){return this.Pq[t]},s.prototype.yii=function(){var t,i,n,t=[],i=this.Pq;for(n in i)i.hasOwnProperty(n)&&t.push(i[n]);return t},s.prototype.Cii=function(t,i){var n=this.Pq[t];return i.reduce(function(t,i){return t.concat(n.k[i]||[])},[])},s.prototype.Iii=function(t){var n,t,n=this,t=t.map(function(t){var i,t,i,i=t.sourceName,t=t.items,i=n.zRt(i);return i?i.getIndexesList(t):[]});return this.Aii((0,q.amt)(t))},s.prototype.Aii=function(t){for(var i,n,e,r,i=[],n=0,e=t;n<e.length;n++)r=e[n],i.push(this.oQt[r]);return i},s.prototype.addField=function(t){var i,n,i=this;t&&!(0,q.ht)(t.Zc)&&(n=t.Zc,(0,q.ht)(i.Pq[n])?((0,q.ht)(t.lp)&&(t.lp=i.Gti),(0,q.ht)(i.Pq[n])&&i.Gti++):t.lp=i.Pq[n].lp,i.Pq[n]=t)},s.prototype.removeField=function(t){var i=this;!t||(0,q.ht)(t.Zc)||(0,q.ht)(i.Pq[t.Zc])||((0,q.ht)(t.lp)||i.Nii(t.lp),delete i.Pq[t.Zc],i.Gti--)},s.prototype.removeCalcField=function(t){var i=this,t=i.getField(t);t&&!(0,q.ht)(t.D5)&&i.removeField(t)},s.prototype.Nii=function(t){var i,n,e,r,i,n=this.Pq;for(e in n)n.hasOwnProperty(e)&&(r=n[e])&&!(0,q.ht)(r.lp)&&r.lp>t&&r.lp--},s.prototype.dispose=function(){var t,i,t=this;for(i in t.oQt=g,t.HXt=g,t.POt=g,t.Pq)t.Pq.hasOwnProperty(i)&&(t.Pq[i].dispose(),delete t.Pq[i]);t.Rti=g,t.EYt=g,t.cft=g,t.Xnn=g,t.ZVt=g,t.Z$t=g},s.prototype.Tii=function(t){for(var i,n,e,r,i=this,n=[],e=0;e<t.length;e++)n.push(i.Pq[t[e].fieldName].k[t[e].item]);return r=(0,q.amt)(n),i.Aii(r)},s.prototype.pVt=function(t){for(var i,n,e,r,o,a,s,u,i=this,n=[],e=0;e<t.length;e++)if(r=i.Pq[t[e].fieldName],(0,q.ht)(r.cii))n.push(r.k[t[e].item]);else{for(o=r.cii[t[e].item],a=!1,s=r._baseFieldName,u=0;u<t.length;u++)s===t[u].fieldName&&(0,q.Mii)(o,t[u].item)&&(a=!0);if(!a)return[]}return(0,q.amt)(n)},s.prototype.bVt=function(t){for(var i,n,e,r,i=this,n=[],e=0;e<t.length;e++)(r=i.zRt(t[e].sourceName))&&n.push(r.getIndexesList(t[e].items));return(0,q.amt)(n)},s.prototype.xii=function(t){var i;return!!this.Pq[t]},s.prototype.KXt=function(t){var i,n,i=this.Pq;for(n in i)if(i.hasOwnProperty(n)&&i[n].lp===t)return i[n]},s.prototype.Dii=function(t){this.Pq[t.Zc]=t},s.prototype.dy=function(t){var i,n,e,r,n,o,a,e,i=this;return(0,q.ht)(i.ZVt)&&(i.ZVt={}),n=i.ZVt,e=(0,J.RF)(t),r=i.getField(t.originFieldName),!(0,q.ht)(r)&&(n[t.originFieldName]=e,(n=t.textGroup)?(o=n.groupItems,a=new b({dataType:r.W5,name:n.fieldName,index:r.lp}),E(o,r.D),a.cx=[],a.A={},a.AQt={},(0,q.o)(Object.keys(o),function(t,i){a.cx.push(t),a.AQt[t]=i,a.A[i]=[],(0,q.o)(o[t],function(t){a.A[i]=(0,q.F)(a.A[i],r.k[r.P[t]])})}),a.sii(o,r.D),a.N=o,a.y1=r.Zc,a.qXt=!1,a.l=r.lp,delete a.lp,a.uQt(),i.addField(a)):r.W5!==T.PivotDataType.number||(0,q.ht)(t.numberGroup)?r.W5===T.PivotDataType.date&&z(i,r,t.dateGroups):(e=t.numberGroup,G(r,e.start,e.end,e.by)),!0)},s.prototype.zVt=function(t,i,n){var e,r,o,a,s,e=this;return!((0,q.ht)(n)||(r=n.textGroup,o=n.numberGroup,a=n.dateGroups,!(r&&r.fieldName===t||o&&n.originFieldName===t||a&&(s=e.zRt(t)).y1===i)))},s.prototype.YVt=function(t){var i,n,e,r,o,a,s,u,c,l,f,i=this,n=i.ZVt;if(!(0,q.ht)(n))for(e in n)if(h(n,e)&&(r=n[e],i.zVt(t,e,r))){delete n[e];break}if(o=i.getField(t),a=[],!(0,q.ht)(o.A))if(o.N)a.push(o.Zc),i.removeField(o);else if("number"==typeof o.T)o.uii(),o.uQt();else if(o.T instanceof Date){for(s=o,l=(u=(s=!(c=0,q.ht)(o.l)&&(0,q.ht)(o.nZt)?i.KXt(o.l):s).nZt).length;c<l;c++)f=i.getField(u[c]),i.removeField(f);delete n[s.Zc],a=a.concat(u),s.uii(),s.uQt()}return a},s.prototype.xVt=function(t){var i,t,n,t,e,r,o,i=this,t=i.getField(t),n=[];if(!(0,q.ht)(t)&&((0,q.ht)((t=t).y1)||(t=i.getField(t.y1)),!(0,q.ht)(t))&&!(0,q.ht)(t.nZt)&&0<t.nZt.length)for(n.push(t),r=0,o=(e=t.nZt).length;r<o;r++)n.push(i.getField(e[r]));return n},s.prototype.WVt=function(){var t,i,n,t=this.Pq,i=[];for(n in t)t.hasOwnProperty(n)&&!(0,q.ht)(t[n].D5)&&i.push(t[n]);return i},s.prototype.addCalcField=function(t,i){var n,t,e,r,n=this,t=new b({dataType:T.PivotDataType.number,name:t});t.D5=i,t.qXt=!1,e=n.HXt,r=n.POt,t.lii=e.parseFormulaToCalcRelatedFieldNames(i),t.iti=e.calcService.parse(r,i,0,0),n.addField(t)},s.prototype.checkFieldNameAndItems=function(t,i){var n,e,r,o,a,s,u,c,l,f,h,v,d,p,m,n=Object.keys(t),o={};if(!(0,q.ht)(i)){for(a=0,s=i;a<s.length;a++)o[u=s[a]]=!0;for(c=0,l=n;c<l.length;c++)if(!o[f=l[c]])return!1}for(h=0,v=n;h<v.length;h++){if(f=v[h],r=this.getField(f),(0,q.ht)(r))return!1;for(e=r.P,d=0,p=t[f];d<p.length;d++)if(m=p[d],(0,q.ht)(e[m]))return!1}return!0},s.prototype.setSortInfo=function(t,i){var n,t=this.getField(t);(0,q.ht)(t)||((0,q.ht)(i)?t.needSort=null:(t.needSort=i,t.uQt()))},s.prototype.addCalcItem=function(t,i,n,e){var r,o,a,r=this,o,a=r.HXt.parseFormulaToCalcRelatedFieldItemMap(n);return!!r.checkFieldNameAndItems(a,e)&&this.dii(t,i,n,r.pii())},s.prototype.dii=function(t,i,n,e){var r,o,a,t,s,u,r=this,o=r.HXt,a=r.POt,t=r.getField(t);if((0,q.ht)(n)||(s=o.calcService.parse(a,n,0,0)),t.sh[i]={calcItemFormula:n,calcExpression:s},(u=t.ty.indexOf(i))<0)return t.ty.push(i),t.addCalcItem(i,(0,q.ht)(e)?r.pii():e),!0},s.prototype.getCalcItems=function(t){for(var i,n,i,e,r,o,a,s,u,c,l,f,h,i=this,n=[],i=(0,q.ht)(t)?i.yii():[i.getField(t)],e=0,r=i;e<r.length;e++)for(a=(o=r[e]).ty,s=o.sh,u=o.WXt,c=o.M(),l=0,f=a;l<f.length;l++)h=f[l],n.push({sourceName:o.Zc,formula:s[h].calcItemFormula,calcItemName:h,priority:u[c[h]]});return n},s.prototype.updateCalcItem=function(t,i,n,e,r){var o,a,s,u,c,l,f,r,o=this,a=o.HXt,s=o.POt,u=o.getField(t);if((0,q.ht)(u))return!1;if((c=u.ty.indexOf(i))<0)return!1;if(l=!1,n!==u.sh[i].calcItemFormula){if(f=a.parseFormulaToCalcRelatedFieldItemMap(n),!o.checkFieldNameAndItems(f,r))return!1;r=a.calcService.parse(s,n,0,0),u.Eti[i]=f,u.sh[i]={calcItemFormula:n,calcExpression:r},l=!0}return l=(0,q.ht)(e)?l:o.updateCalcItemPriority(t,i,e)||l},s.prototype.updateCalcItemPriority=function(t,i,n){var e,t,r,t,o,a,s,u,c,l,f,h,v,d,p,e=this,t=e.getField(t);if((0,q.ht)(t)||t.ty.indexOf(i)<0)return!1;if(r=t.WXt[t.M()[i]],n<1?n=1:n>e.Vti&&(n=e.Vti),n===r)return!1;for(t=e.yii(),o=n<r?1:-1,a=Math.min(n,r),s=Math.max(n,r),u=0,c=t;u<c.length;u++)if((l=c[u]).hasCalcItem())for(f=l.WXt,v=0,d=h=Object.keys(f);v<d.length;v++)f[p=d[v]]===r?f[p]=n:f[p]>=a&&f[p]<=s&&(f[p]+=o);return!0},s.prototype.removeCalcItem=function(t,i){var n,e,r,t,o,a,s,u,u,s,n=this,e=[],r=n.getField(t),t=[i];if(r)for(a=t=(o=0,q.ht)(i)?S([],r.ty,!0):t;o<a.length;o++)s=a[o],(u=r.D.indexOf(s))<0||(u=r.WXt[u],r.removeCalcItem(s),e.push({formula:r.sh[s].calcItemFormula,calcItemName:s}),delete r.Eti[s],delete r.sh[s],0<=(s=r.ty.indexOf(s))&&r.ty.splice(s,1),(0,q.ht)(u))||n.Sii(u);return e},s.prototype.Sii=function(t){for(var i,n,e,r,o,a,s,u,c,l,i=this,n,e=0,r=i.yii();e<r.length;e++)if(a=(o=r[e]).WXt)for(u=0,c=s=Object.keys(a);u<c.length;u++)a[l=c[u]]>t&&a[l]--;i.Vti--},s.prototype.pii=function(){return this.Vti+=1,this.Vti},s.prototype.eti=function(t){for(var i,n,e,r,o,a,s,u,c,l,f,h,v,d,p,i=this,n=[],e={},r=[],o={},a=[],s=[],u={normalFieldsInfos:n,calcFieldsInfos:r},c=0,l=t.length;c<l;c++)f=i.getField(t[c].cacheName),(0,q.ht)(f.D5)?m(n,f,t[c].subTotalType,e):i.kii(f.Zc,a,s);for(h=0,v=a.length;h<v;h++)m(n,d=i.getField(a[h]),T.SubtotalType.sum,e);for(h=0,v=s.length;h<v;h++)m(r,p=i.getField(s[h]),T.SubtotalType.sum,o);return u},s.prototype.jii=function(t){for(var i,n,e,r,o,i=this,n=[],e=0,r=t.length;e<r;e++)o=i.getField(t[e].cacheName),(0,q.ht)(o.D5)||n.push(o);return n},s.prototype.kii=function(t,i,n){for(var e,t,r,o,a,s,u,e=this,t=e.getField(t),r=t.lii,o=0,a=r.length;o<a;o++)s=(0,J.Oii)(r[o]),u=e.getField(s),(0,q.ht)(u.D5)?i.push(s):e.kii(s,i,n);n.push(t.Zc)},s.prototype.dot=function(t){var i,n,r,t,i=this,n=i.Pq,r=[];(0,q.o)(t,function(t){var t=n[t];t&&((0,q.ht)(t.P)||0===Object.keys(t.P).length)&&(t.k={},t.P={},t.D=[],t.cC()||r.push(t))}),t=i.oQt,(0,q.o)(t,function(n,e){(0,q.o)(r,function(t){var i=t.lp;n[i]=t.aQt(n[i],e,!1)})}),(0,q.o)(r,function(t){t.uQt()})},s.prototype.Pii=function(t){var i,t,i=!1,t=L(t);return t!==T.PivotDataType.noValue&&t!==T.PivotDataType.errorValue?t:(i=t===T.PivotDataType.errorValue?!0:i)?T.PivotDataType.errorValue:T.PivotDataType.noValue},s.prototype.pJt=function(t){for(var i,n,e,i=!1,n=0;n<t.length;n++){if((e=c(t[n].type))!==T.PivotDataType.noValue&&e!==T.PivotDataType.errorValue)return e;e===T.PivotDataType.errorValue&&(i=!0)}return i?T.PivotDataType.errorValue:T.PivotDataType.noValue},s.prototype.fromJson=function(t,i,L){var n,e,r,o,a,s,u,c,l,f,h,v,d,p,m,b,g,g,w,y,b,g,C,A,N,I,T,S,x,M,E,D,k,j,O,_,F,P,n=this;if(n.cft=i,(0,q.ht)(i.name)?n.Zc=t:n.Zc=i.name,(0,q.ht)(t)||(n.FVt=+t),(0,q.ht)(i.pivotCacheId)||(n.yQt=+i.pivotCacheId),(0,q.ht)(i.recordCount)||(n.recordCount=i.recordCount),i.refreshOnLoad&&(n.fCi=!!i.refreshOnLoad),(0,q.ht)(i.sourceType)||(n.sourceType=i.sourceType,(n.EYt="",q.ht)(i.sheet)||(n.EYt=i.sheet,n.sheet=i.sheet,(0,q.ht)(i.ref))||(n.EYt=n.EYt+"!"+i.ref,n.ref=i.ref),(0,q.ht)(i.sourceName))||(n.EYt=i.sourceName,n.sourceName=i.sourceName),r=[],o=[],a=[],(e=(0,J.RF)(i.fields))&&0<e.length)for(s=0;s<e.length;s++){if(c=(u=e[s]).fieldGroup,u.lp=s,c){if(!(0,q.ht)(c.base)&&((0,q.ht)(u.entities)||0===u.entities.length)&&!(0,q.ht)(c.startDate)){(0,q.ht)(e[c.base])||(0,q.ht)(e[c.base].fieldGroup)||!(0,q.ht)(e[c.base].fieldGroup.Fii)||(e[c.base].fieldGroup.Fii=[]),e[c.base].fieldGroup.Fii.push(u);continue}if(o.push(u),!(0,q.ht)(c.discreteGroup))continue}if((0,q.ht)(u.formula)){if(l=u.entities,(f={}).name=u.name,f.index=s,l&&0<l.length)f.dataType=n.pJt(l);else if(i.Rti)for(h=0,v=i.Rti;h<v.length;h++)(d=v[h]).name===f.name&&(f.dataType=d.dataType);(p=n.Uti(f)).fromJson(u,i.pivotCacheRecords&&i.pivotCacheRecords[0]&&i.pivotCacheRecords[0][s]),r.push(p)}else a.push(u)}for(n.gii(r,i),w=0,y=m=i.calculatedItems||[];w<y.length;w++)g=(b=y[w]).pivotArea,!(0,q.ht)(g.outline)&&(b=b.formula,g=g.references[0],g=(p=i.fields[g.field]).entities[g.indexes[0]]&&p.entities[g.indexes[0]].value)&&n.addCalcItem(p.name,g,b);if(0<o.length)for(C=0,A=o;C<A.length;C++)if((c=(u=A[C]).fieldGroup)&&(N=(0,q.ht)(c.base)?u:e[c.base]))if((I={}).originFieldName=N.name,(0,q.ht)(c.groupInterval))if((0,q.ht)(c.groupBy)&&(0,q.ht)(c.Fii)){if((0,q.ht)(c.parent)){if(k=c.discreteGroup,j=c.groupItems,k&&0<k.length&&j&&0<j.length)for(I.textGroup={fieldName:u.name,groupItems:{}},O=I.textGroup.groupItems,_=0;_<k.length;_++)F=!(0,q.ht)(k[_])&&j[k[_]]&&j[k[_]].value,(0,q.ht)(F)||((0,q.ht)(O[F])&&(O[F]=[]),O[F].push(N.entities[_]&&N.entities[_].value));n.dy(I)}}else{if(T=[],(0,q.ht)(c.groupBy)||T.push({start:!0===c.autoStart?X:new Date(c.startDate),end:!0===c.autoEnd?X:new Date(c.endDate),by:tt(c.groupBy)}),(S=c.Fii)&&0<S.length)for(x=0,M=S;x<M.length;x++)D=(E=M[x]).fieldGroup,T.push({start:!0===c.autoStart?X:new Date(D.startDate),end:!0===c.autoEnd?X:new Date(D.endDate),by:tt(D.groupBy)});I.dateGroups=T,n.dy(I)}else I.numberGroup={start:!0===c.autoStart?X:c.startNum,end:!0===c.autoEnd?X:c.endNum,by:c.groupInterval},n.dy(I);if(0<a.length)for(s=0;s<a.length;s++)n.addCalcField((P=a[s]).name,P.formula);(0,q.ht)(i.overwriteList)||((0,q.ht)(n.Z$t)&&(n.Z$t=new K.OverwriteList),n.Z$t.fromJSON(i.overwriteList)),$(e,n.Pq),n.hii(),n.bii()},s.prototype.yh=function(t,i,n){var e,r,i,i,i,i,i,r,i,o,o,L,a,E,s,u,c,l,f,h,v,d,p,m,b,v,g,B,R,w,i,G,y,C,A,N,V,y,U,C,A,I,C,T,Q,W,S,x,M,D,z,k,k,k,j,M,O,_,F,P,Z,Y,H,e=this,r=(e.Xnn=t).lossless;if((0,q.ht)(t.name)?(0,q.ht)(r&&r.cacheName)?e.Zc=i:e.Zc=t.lossless.cacheName:e.Zc=t.name,(0,q.ht)(i)||(e.FVt=+i),i=(i=(i=(i=(0,q.xr)(t,"extLst"))&&(0,q.xr)(i,"ext"))&&(0,q.xr)(i,"pivotCacheDefinition"))&&i.pivotCacheId,(0,q.ht)(i)||(e.yQt=+i),(0,q.ht)(r&&r.overwriteList)||((0,q.ht)(e.Z$t)&&(e.Z$t=new K.OverwriteList),e.Z$t.fromJSON(r.overwriteList)),(0,q.ht)(t.recordCount)||(e.recordCount=+t.recordCount),t.refreshOnLoad&&(e.fCi=!!t.refreshOnLoad),i=(0,q.xr)(t,"cacheSource"),(0,q.ht)(i)||(e.sourceType=i.type,o=(i=(r="",q.xr)(i,"worksheetSource"))&&i.sheet,(0,q.ht)(o)||(e.sheet=r=o,(0,q.ht)(i.ref))||(r="=".concat((0,J.i2e)(o),"!").concat(i.ref),e.ref=i.ref),o=i&&i.name,(0,q.ht)(o)||(e.sourceName=r=o),e.EYt=r),L=(0,q.xr)(t,"cacheFields"),E=[],s=[],u=[],(a=(0,J.RF)(L.c_))&&0<a.length)for(c=0;c<a.length;c++){if(l=a[c],f=(0,q.xr)(l,"fieldGroup"),l.lp=c,h=(0,q.xr)(l,"sharedItems"),f){if(v=+f.base,d=(0,q.xr)(f,"rangePr"),p=(0,q.xr)(f,"discretePr"),!(0,q.ht)(f.base)&&((0,q.ht)(h)||h.c_&&0===h.c_.length)&&!(0,q.ht)(d&&d.startDate)){m=(0,q.xr)(a[v],"fieldGroup"),(0,q.ht)(a[v])||!(0,q.ht)(m)&&(0,q.ht)(m.Fii)&&(m.Fii=[]),m.Fii.push(l);continue}if(s.push(l),!(0,q.ht)(p))continue}if((0,q.ht)(l.formula)){if((b={}).name=l.name,b.index=c,v=h&&h.c_&&0<h.c_.length,(0,q.ht)(v)){if(t.lossless&&t.lossless.Rti)for(g=0,B=t.lossless.Rti;g<B.length;g++)(R=B[g]).name===b.name&&(b.dataType=R.dataType)}else b.dataType=e.Pii(h.c_[0]);b.name=it((0,q.xmlDecode)(b.name)),(w=e.Uti(b)).yh(l,n&&n.c_&&n.c_[0]&&n.c_[0].c_[c]),E.push(w)}else u.push(l)}for(e.wii(E,n),V=G=(i=(N=0,q.xr)(t,"calculatedItems"))&&i.c_||[];N<V.length;N++)y=V[N],C=(0,q.xr)(y,"pivotArea"),!(0,q.ht)(C.outline)&&(y=(0,q.xmlDecode)(y.formula),C=(U=(0,q.xr)(C,"references")).c_[0],A=(0,q.xr)(C,"x"),w=L.c_[+C.field],A=(C=(I=(0,q.xr)(w,"sharedItems").c_)[+A.v])&&C.v)&&e.addCalcItem(w.name,A,y);if(0<s.length)for(T=0,Q=s;T<Q.length;T++)if((f=(0,q.xr)(l=Q[T],"fieldGroup"))&&(W=(0,q.ht)(f.base)?l:a[+f.base]))if((S={}).originFieldName=W.name,d=(0,q.xr)(f,"rangePr"),(0,q.ht)(d&&d.groupInterval))if((0,q.ht)(null==d?void 0:d.groupBy)&&(0,q.ht)(f.Fii)){if((0,q.ht)(f.par)&&(j=(p=(0,q.xr)(f,"discretePr"))&&p.c_,O=(M=(0,q.xr)(f,"groupItems"))&&M.c_,!(0,q.ht)(j))){if(j&&0<j.length&&O&&0<O.length)for(S.textGroup={fieldName:l.name,groupItems:{}},_=S.textGroup.groupItems,F=0;F<j.length;F++)P=!(0,q.ht)(j[F])&&O[+j[F].v]&&O[+j[F].v].v,(0,q.ht)(P)||((0,q.ht)(_[P])&&(_[P]=[]),I=(0,q.xr)(W,"sharedItems"),_[P].push(I.c_[F]&&I.c_[F].v));e.dy(S)}}else{if(x=[],(0,q.ht)(null==d?void 0:d.groupBy)||x.push({start:"1"===d.autoStart?X:new Date(Date.parse(d.startDate)),end:"1"===d.autoEnd?X:new Date(Date.parse(d.endDate)),by:tt(d.groupBy)}),(M=f.Fii)&&0<M.length)for(D=0,z=M;D<z.length;D++)k=z[D],k=(0,q.xr)(k,"fieldGroup"),(k=(0,q.xr)(k,"rangePr"))&&x.push({start:"1"===(null==d?void 0:d.autoStart)?X:new Date(Date.parse(k.startDate)),end:"1"===(null==d?void 0:d.autoEnd)?X:new Date(Date.parse(k.endDate)),by:tt(k.groupBy)});S.dateGroups=x,e.dy(S)}else S.numberGroup={start:"1"===d.autoStart?X:parseFloat(d.startNum),end:"1"===d.autoEnd?X:parseFloat(d.endNum),by:parseFloat(d.groupInterval)},e.dy(S);if(0<u.length)for(Z=0,Y=u;Z<Y.length;Z++)e.addCalcField(it((0,q.xmlDecode)((H=Y[Z]).name)),it((0,q.xmlDecode)(H.formula)));$(a,e.Pq),e.hii(),e.bii()},s.prototype.toJson=function(t){var i,n,e,r,o,a,s,u,c,l,f,h,v,i=this,n=(0,q.ht)(i.cft)?{}:i.cft;if((0,q.ht)(i.FVt)||(n.cacheId=i.FVt),(0,q.ht)(i.yQt)?n.pivotCacheId=i.FVt:n.pivotCacheId=i.yQt,(0,q.ht)(i.Zc)||(n.name=i.Zc),i.fCi&&(n.refreshOnLoad=1),(0,q.ht)(i.recordCount)||(n.recordCount=i.oQt&&i.oQt.length),(0,q.ht)(i.EYt)||(n.EYt=i.EYt),(0,q.ht)(i.sourceType)||(n.sourceType=i.sourceType,(0,q.ht)(i.sheet)||(n.sheet=i.sheet),(0,q.ht)(i.ref)||(n.ref=i.ref),(0,q.ht)(i.sourceName))||(n.sourceName=i.sourceName),n.calcItemCount=i.Vti||0,0<i.Vti&&(n.calculatedItems=i._ii()),i.Pq&&!(0,q.isEmptyObject)(i.Pq)){for(r in e=[],t)t.hasOwnProperty(r)&&e.push(r);for(s in i.dot(e),C(i,t),o=n.fields=[],a={},i.Pq)i.Pq.hasOwnProperty(s)&&o.push(i.Pq[s].toJson(i));for(o.sort(function(t,i){return t.lp-i.lp}),u=[],c=0;c<o.length;c++)o[c].entities&&0<o[c].entities.length?u.push("x"):(0,q.ht)(o[c].type)?u.push("n"):u.push(o[c].type),(0,q.ht)(o[c].formula)||(a[c]=!0);for(l=[],f=M().blank,c=0;c<i.oQt.length;c++){for(h=[],v=0;v<i.oQt[c].length;v++)!0!==a[v]&&(i.oQt[c][v]===f?h.push({type:"n",value:i.oQt[c][v]}):h.push({type:u[v],value:i.oQt[c][v]}));l.push(h)}n.pivotCacheRecords=l,n.Rti=i.Rti}return i.Z$t&&!i.Z$t.isEmpty()&&(n.overwriteList=i.Z$t.toJSON()),n},s.prototype.Lii=function(t,i){return{n_:"pivotArea",outline:"0",c_:[{n_:"references",count:"1",c_:[{n_:"reference",field:t+"",count:"1",c_:[{n_:"x",v:i+""}]}]}]}},s.prototype.Eii=function(){for(var t,i,n,e,r,o,a,s,u,c,l,f,t=this,i=[],n,e=0,r=t.yii();e<r.length;e++)if((a=(o=r[e]).ty)&&0<a.length)for(s=0,u=a;s<u.length;s++)c=u[s],l=t.Lii(o.lp,o.P[c]),i[f=o.WXt[o.P[c]]-1]={n_:"calculatedItem",formula:(0,q.xmlEncode)(o.sh[c].calcItemFormula),c_:[l]};return i},s.prototype.wh=function(t){var i,n,e,r,o,a,s,s,u,c,l,f,h,v,d,p,p,m,b,g,w,y,i=this,n=i.oQt,e=n&&n.length||0,r=(0,q.ht)(i.Xnn)?{}:i.Xnn;if((0,q.ht)(r.pivotCacheDefinition)&&(r.pivotCacheDefinition={n_:"pivotCacheDefinition",r_:[13,14,8,16,15],"r:id":"rId1"}),o=r.pivotCacheDefinition,(0,q.ht)(i.FVt)||(r.cacheId=i.FVt+""),(0,q.ht)(i.recordCount)||(o.recordCount=e+""),(0,q.ht)(o.createdVersion)&&(o.createdVersion="7"),(0,q.ht)(o.refreshedVersion)&&(o.refreshedVersion="7"),i.fCi&&(o.refreshOnLoad="1"),o.c_=[{n_:"extLst",c_:[{n_:"ext",r_:[53,1],c_:[{n_:"pivotCacheDefinition",pivotCacheId:i.yQt+""}]}]}],a={n_:"cacheSource",type:i.sourceType},"worksheet"===i.sourceType&&(s={n_:"worksheetSource"},(0,q.ht)(i.sourceName)||(s.name=i.sourceName),(0,q.ht)(i.ref)||(s.ref=i.ref),(0,q.ht)(i.sheet)||(s.sheet=i.sheet),a.c_=[s]),o.c_.push(a),0<i.Vti&&(s=i.Eii(),o.c_.push({n_:"calculatedItems",count:s.length+"",c_:s})),i.Pq&&!(0,q.isEmptyObject)(i.Pq)){for(c in u=[],t)t.hasOwnProperty(c)&&u.push(c);for(h in i.dot(u),l=[],f={},i.Pq)i.Pq.hasOwnProperty(h)&&l.push(i.Pq[h].wh(i));for(l.sort(function(t,i){return t.lp-i.lp}),l.forEach(function(t){delete t.lp}),o.c_.push({n_:"cacheFields",count:l.length+"",c_:l}),(0,J.Pr)(o,["cacheSource","cacheFields","calculatedItems","extLst"]),v=[],d=0;d<l.length;d++)(p=(p=(0,q.xr)(l[d],"sharedItems"))&&p.c_)&&0<p.length?v.push("x"):(0,q.ht)(l[d].type)?v.push("n"):v.push(l[d].type),(0,q.ht)(l[d].formula)||(f[d]=!0);for(m=[],b=M().blank,d=0;d<e;d++){for(g=[],w=0;w<n[d].length;w++)!0!==f[w]&&(i.oQt[d][w]===b?g.push({n_:"n",v:i.oQt[d][w]}):g.push({n_:v[w],v:i.oQt[d][w]}));m.push(y={n_:"r",c_:g})}r.pivotCacheRecords={n_:"pivotCacheRecords",r_:[13,14,8,16,15],count:e,c_:m}}return o.lossless={cacheName:i.Zc},o.lossless.Rti=i.Rti,i.Z$t&&!i.Z$t.isEmpty()&&(o.lossless.overwriteList=i.Z$t.toJSON()),r},s.prototype._ii=function(){for(var t,i,n,e,r,o,a,s,u,c,l,t=this,i=[],n,e=0,r=t.yii();e<r.length;e++)if((a=(o=r[e]).ty)&&0<a.length)for(s=0,u=a;s<u.length;s++)c=u[s],(l={formula:o.sh[c].calcItemFormula,pivotArea:null}).pivotArea=t.Bii(o.lp,o.P[c]),i[o.WXt[o.P[c]]-1]=l;return i},s.prototype.Bii=function(t,i){var n={};return n.references=[{field:t,indexes:[i]}],n.outline=!0,n},s.prototype.$Vt=function(t,i){var n=this;(0,q.ht)(n.Z$t)&&(n.Z$t=new K.OverwriteList),n.Z$t.setOverwriteNode(t,i)},s.prototype.tQt=function(t){return this.Z$t&&this.Z$t.getOverwriteValue(t)},s.prototype.nQt=function(t){this.Z$t&&this.Z$t.removeOverwriteNode(t)},s.prototype.eQt=function(){return this.Z$t&&this.Z$t.getOverwriteList()},s.prototype.rQt=function(){this.Z$t&&this.Z$t.reset()},t.PivotCache=s,l.prototype.getName=function(t){var i=M().dateResource;switch(t){case T.DateGroupType.seconds:return i.Seconds;case T.DateGroupType.minutes:return i.Minutes;case T.DateGroupType.hours:return i.Hours;case T.DateGroupType.days:return i.Days;case T.DateGroupType.months:return i.Months;case T.DateGroupType.quarters:return i.Quarters;case T.DateGroupType.years:return i.Years}},l.prototype.insertIndexToIndexMap=function(t,i){var n,e,r,o,n,n=this,e=n.groupItemsKeyList,r=n.groupItemsIndexMap,o=n.groupItemsKeyIndexes,n=("number"===n.type?(0,q.getNumberGroupItemKey):(0,q.getDateGroupItemKey))(n,t);(0,q.ht)(r[n])&&(r[n]=[],e.push(n),o[n]=e.length-1),r[n]=(0,q.F)(r[n],i)},w=l,t.getPathStr=f,t.io=it},"./src/pivot-calc-engine.ts":function(t,i,n){var e,v,m,b,r,o,a,s,u,c;function l(t){return u.call(this,t)||this}function d(t,i){var n,e,r,o,a,s,u,c,l,f,h,v,d,p,n={},r=(i=i.trim()).length,a=o=e=0,s=/^('|")([\d\D]*)\1$/g;for(i=i.replace(u=/'{2,2}/g,"'");a<r;){if((o=i.indexOf("[",a))<0)return;if(c=i.slice(e,o),s.lastIndex=0,l=t[c=s.test(c)?c.slice(1,c.length-1):c],a=o+1,!(0,m.ht)(l)){for(;(0,m.ht)(n[c]);){if(f=i.indexOf("]",a),h=i.slice(o+1,f),v=l.W5,d=h,p=l.D,(0,m.ht)(h)||h.length<=0||f<0)return;s.lastIndex=0,s.test(h)&&(d=h.slice(1,h.length-1),v!==b.PivotDataType.number||isNaN(+d)||(0<=p.indexOf(d)?n[c]=d:0<=p.indexOf(+d)&&(n[c]=+d))),0<=p.indexOf(d)&&(n[c]=d),a=f+1}e=a}}return n}function f(t){var t=c.call(this,t)||this;return t.resolvers=[new v.DefaultTokenResolver(5e3)],t}function p(t,i){var n,e,r,o,a;if(14===t.type)i.push(t.value);else if(t.value instanceof v.Expression)p(t.value,i);else if(Array.isArray(t.value))for(n=0,e=t.value;n<e.length;n++)(r=e[n])instanceof v.Expression&&p(r,i);else if(Array.isArray(t.arguments))for(o=0,a=t.arguments;o<a.length;o++)(r=a[o])instanceof v.Expression&&p(r,i)}function h(t,i){var n,e,r,o,a,s,u,c,l,f,h;if(8===t.type)throw new Error;if(15===t.type)for(n={},e=t.value,o=0,a=r=Object.keys(e);o<a.length;o++)s=a[o],n.field=s,n.item=e[s],i.push(n);else if(t.value instanceof v.Expression)p(t.value,i);else if(Array.isArray(t.value))for(u=0,c=t.value;u<c.length;u++)(l=c[u])instanceof v.Expression&&p(l,i);else if(Array.isArray(t.arguments))for(f=0,h=t.arguments;f<h.length;f++)(l=h[f])instanceof v.Expression&&p(l,i)}function g(t){var i,n,e,r,o,r,i={};if(!(0,m.ht)(t))for(n=0,e=t;n<e.length;n++)o=(r=e[n]).field,r=r.item,(0,m.ht)(o)||(i[o]?i[o].push(r):i[o]=[r]);return i}function w(){this.calcService=new v.CalcService}e=this&&this.__extends||(s=function(t,i){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=t}s(t,i),t.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}),Object.defineProperty(i,"__esModule",{value:!0}),i.PivotCalcService=i.PivotCalcSource=void 0,v=n("CalcEngine"),m=n("./src/pivot-util.ts"),b=n("./src/pivot-interface.ts"),u=v.TokenResolver,e(l,u),l.prototype.setPivotCache=function(t){this.pivotCache=t},l.prototype.resolveToken=function(t,i,n,e,r){for(var o,a,s,u,c,l,f,f,h,o,a,u=this.pivotCache.Pq,c="";e<n.length&&0===(s=n[e]).uit;e++)c+=s.Awt;return 0<c.length&&(f=d(u,c),!(0,m.ht)(f))&&0<Object.keys(f).length?((l=new v.Expression(15)).value=f,{expr:l,index:e}):u[c]?((l=new v.Expression(14)).value=c,{expr:l,index:e}):(h=(f=c).length-1,u[f="'"===f.charAt(0)&&"'"===f.charAt(h)?f.substring(1,h):f]?((l=new v.Expression(14)).value=f,{expr:l,index:e}):void 0)},r=l,c=v.CalcSource,e(f,c),f.prototype.setPivotCache=function(t){this.pivotCache=t;var i=new r(6e3);i.setPivotCache(t),this.resolvers.unshift(i)},f.prototype.getResolver=function(){return this.resolvers},f.prototype.getField=function(t){var i=this.measureNode;if(!(0,m.ht)(i))return i[t]&&i[t].calc&&i[t].calc.sum},f.prototype.setContext=function(t){this.DJ=t},f.prototype.getFieldItem=function(){var t,i,n,e,r,o,a,t=this,i,n=t.expression,e=t.calcType,r=t.cacheName,o=t.pathInfo,a=t.resultIndex;return t.subtotalManager.getFieldCalcItem(arguments[0],n,o,e,r,a)},f.prototype.setCalcInfo=function(t,i,n,e,r,o){var a=this;a.calcType=t,a.subtotalManager=i,a.pathInfo=n,a.cacheName=e,a.expression=r,a.resultIndex=o},f.prototype.setMeasureNode=function(t){this.measureNode=t},i.PivotCalcSource=f,w.prototype.fii=function(t){this.calcSource=t},w.prototype.parseFormulaToCalcRelatedFieldNames=function(t){var i,n,i,i,n,t,t,e,r,o,a,i=this,n=i.calcService,i=i.calcSource,i=n.getParserContext(i);for(i.useR1C1=n.useR1C1,i.row=0,i.column=0,n=n.j3t,t=t.split(""),t=n.parseToTokens(i,t,!0),r=[],a=(e=n.eDt(i,t,!(o=0))).length;o<a;o++)p(e[o],r);return r},w.prototype.parseFormulaToCalcRelatedFieldItemMap=function(t){var i,n,i,i,n,t,t,e,r,o,a;if((0,m.ht)(t))return{};for(n=(i=this).calcService,i=i.calcSource,(i=n.getParserContext(i)).useR1C1=n.useR1C1,i.row=0,i.column=0,n=n.j3t,t=t.split(""),t=n.parseToTokens(i,t,!0),r=[],a=(e=n.eDt(i,t,!(o=0))).length;o<a;o++)h(e[o],r);return g(r)},w.prototype.getResolvers=function(){return this.calcSource.getResolver()},w.prototype.getGlobalSourceModel=function(t){return this.calcService.getGlobalSourceModel(t)},i.PivotCalcService=w},"./src/pivot-condition.ts":function(t,i,n){var v,d,s,e,r,o,a;function u(t,i,n){switch(t){case v.PivotValueFilterOperator.equalsTo:return function(t){return i===+t};case v.PivotValueFilterOperator.notEqualsTo:return function(t){return i!==+t};case v.PivotValueFilterOperator.greaterThan:return function(t){return i<+t};case v.PivotValueFilterOperator.greaterThanOrEqualsTo:return function(t){return i<=+t};case v.PivotValueFilterOperator.lessThan:return function(t){return+t<i};case v.PivotValueFilterOperator.lessThanOrEqualsTo:return function(t){return+t<=i};case v.PivotValueFilterOperator.between:return function(t){return i<=+t&&+t<=n};case v.PivotValueFilterOperator.notBetween:return function(t){return+t<i||n<+t}}}function c(t,i,n){var e,i,n;this.sn=v.PivotConditionType.value,(e=this).LVt=t,i=isNaN(+i)?NaN:+i,(0,d.ht)(n)?(e.iX=s,e.eX=i):(n=isNaN(+n)?NaN:+n,e.eX=Math.min(i,n),e.iX=Math.max(i,n)),e.evaluate=u(t,e.eX,e.iX)}function l(n){var t,e,r,i,o,a,s,u,c,l,f,h,t=this.LVt,e=this.uit,r=this.GVt;if(n){if(n.sort(function(t,i){return t.value-i.value}),i=n.length,o=void 0,a=0,s=t===v.PivotTop10FilterOperator.top,e===v.PivotTop10FilterType.count)a=r;else if(e===v.PivotTop10FilterType.sum||e===v.PivotTop10FilterType.percent){for(u=i-1,c=n[s?i-1:0].value,l=0,f=function(){var t,i;if(e===v.PivotTop10FilterType.sum)return function(){return c<r};for(t=0;t<=u;t++)l+=n[t].value;return i=r/100,function(){return c/l<i}}();f();)a++,c+=n[s?u-a:a].value;a++}return o=s?n.slice(-1*a):n.slice(0,a),h={},(0,d.o)(o,function(t){h[t.index]=!0}),h}}function f(t,i,n){this.sn=v.PivotConditionType.top10;var e=this;e.LVt=t,e.uit=i,e.GVt=n,e.evaluate=l}function h(t,i,n){switch(t){case v.PivotCaptionFilterOperator.equalsTo:return function(t){return(0,d.Rii)(i,t)};case v.PivotCaptionFilterOperator.notEqualsTo:return function(t){return!(0,d.Rii)(i,t)};case v.PivotCaptionFilterOperator.beginsWith:return function(t){return(0,d.Gii)(i,t)};case v.PivotCaptionFilterOperator.doesNotBeginWith:return function(t){return!(0,d.Gii)(i,t)};case v.PivotCaptionFilterOperator.endsWith:return function(t){return(0,d.Vii)(i,t)};case v.PivotCaptionFilterOperator.doesNotEndWith:return function(t){return!(0,d.Vii)(i,t)};case v.PivotCaptionFilterOperator.contains:return function(t){return(0,d.Uii)(i,t)};case v.PivotCaptionFilterOperator.doesNotContain:return function(t){return!(0,d.Uii)(i,t)};case v.PivotCaptionFilterOperator.greaterThan:return function(t){return 0<(t+"").localeCompare(i,"kn",{numeric:!0})};case v.PivotCaptionFilterOperator.greaterThanOrEqualsTo:return function(t){return 0<=(t+"").localeCompare(i,"kn",{numeric:!0})};case v.PivotCaptionFilterOperator.lessThan:return function(t){return(t+"").localeCompare(i,"kn",{numeric:!0})<0};case v.PivotCaptionFilterOperator.lessThanOrEqualsTo:return function(t){return(t+"").localeCompare(i,"kn",{numeric:!0})<=0};case v.PivotCaptionFilterOperator.between:return function(t){return 0<=(t+"").localeCompare(i,"kn",{numeric:!0})&&(t+"").localeCompare(n,"kn",{numeric:!0})<=0};case v.PivotCaptionFilterOperator.notBetween:return function(t){return(t+"").localeCompare(i,"kn",{numeric:!0})<0||0<(t+"").localeCompare(n,"kn",{numeric:!0})}}}function p(t,i,n){this.sn=v.PivotConditionType.caption;var e=this;this.LVt=t,e.eX=(0,d.ht)(i)?i:i+"",e.iX=(0,d.ht)(n)?n:n+"",e.evaluate=h(t,e.eX,e.iX)}function m(t,i){var n,n=(0,d.ht)(i)?new Date:new Date(i);return t?(0,d.DQt)(n).getTime():n.getTime?n.getTime():i}function b(t,i){var i,i=(0,d.ht)(i)?new Date:new Date(i);return t?(0,d.DQt)(i):i}function g(t,i,n,e){return m(e,t)>=m(e,i)&&m(e,t)<=m(e,n)}function w(t){if(t%100==0){if(t%400==0)return 1}else if(t%4==0)return 1}function y(t,i,n){for(var e,r,o,a,e=i.getFullYear(),r=n.getFullYear(),o=e;o<=r;o++)if(i<=(a=C(t,o))&&a<=n)return!0;return!1}function C(t,i){var t=new Date(t.valueOf()),n=t.getFullYear(),e=t.getMonth(),r=t.getDate();return w(n)&&1===e&&29===r&&!w(i)?t.setFullYear(i,1,28):!w(n)&&1===e&&28===r&&w(i)?t.setFullYear(i,1,29):t.setFullYear(i),t}function A(t,i,n){var t,e,r,o,a,s,e,t=new Date(t.valueOf()),e=t.getMonth(),r=t.getDate(),o=[0,2,4,6,7,9,11],a=[3,5,8,10],s=w(i)?29:28;return-1<o.indexOf(e)&&31===r?-1<a.indexOf(n)?t.setMonth(n,30):1===n?t.setMonth(n,s):t.setMonth(n):-1<a.indexOf(e)&&30===r?-1<o.indexOf(n)?t.setMonth(n,31):1===n?t.setMonth(n,s):t.setMonth(n):1===e&&r===s?-1<o.indexOf(n)?t.setMonth(n,31):-1<a.indexOf(n)?t.setMonth(n,30):t.setMonth(n):(e=new Date(i,n+1,0).getDate())<r?t.setMonth(n,e):t.setMonth(n),t}function N(t,i,n,e){var r,r;return r=A(r=new Date(t.valueOf()),i,3*n+e)}function I(t,i,n){for(var e,r,o,a,s,u,c,l,e=i.getFullYear(),r=Math.floor(i.getMonth()/3),o=n.getFullYear(),a=Math.floor(n.getMonth()/3),s=t.getMonth()%3,u=e;u<=o;u++)for(c=C(t,u),u!==o&&(a=3),l=r=u!==e?0:r;l<=a;l++)if(i<=(c=N(c,u,l,s))&&c<=n)return!0;return!1}function T(t,i,n){for(var e,r,o,a,s,u,c,e=i.getFullYear(),r=i.getMonth(),o=n.getFullYear(),a=n.getMonth(),s=e;s<=o;s++)for(u=C(t,s),s!==o&&(a=11),c=r=s!==e?0:r;c<=a;c++)if(i<=(u=A(u,s,c))&&u<=n)return!0;return!1}function S(i,n,e,r,t,o,a){var s,u;if(i<=v.PivotDateFilterOperator.notBetween)switch(i){case v.PivotDateFilterOperator.equalsTo:return function(t){return m(r,n)===m(r,t)};case v.PivotDateFilterOperator.notEqualsTo:return function(t){return m(r,n)!==m(r,t)};case v.PivotDateFilterOperator.before:return function(t){return m(r,n)>m(r,t)};case v.PivotDateFilterOperator.beforeEqualsTo:return function(t){return m(r,n)>=m(r,t)};case v.PivotDateFilterOperator.after:return function(t){return m(r,n)<m(r,t)};case v.PivotDateFilterOperator.afterEqualsTo:return function(t){return m(r,n)<=m(r,t)};case v.PivotDateFilterOperator.Between:return function(t){return g(t,n,e,r)};case v.PivotDateFilterOperator.notBetween:return function(t){return m(r,t)<m(r,n)||m(r,t)>m(r,e)}}if(8<=i&&i<=23)switch(i){case v.PivotDateFilterOperator.today:return function(t){return m(r)===m(r,t)};case v.PivotDateFilterOperator.yesterday:return function(t){return m(r)-d.PRE_DAY===m(r,t)};case v.PivotDateFilterOperator.tomorrow:return function(t){return m(r)+d.PRE_DAY===m(r,t)};case v.PivotDateFilterOperator.last7Days:return function(t){var i=m(r),t=m(r,t);return i-7*d.PRE_DAY<=t&&t<i};case v.PivotDateFilterOperator.thisMonth:return function(t){var i=new Date;return i.getFullYear()===t.getFullYear()&&i.getMonth()===t.getMonth()};case v.PivotDateFilterOperator.lastMonth:return function(t){var i=new Date;return i.setMonth(i.getMonth()-1),i.getFullYear()===t.getFullYear()&&i.getMonth()===t.getMonth()};case v.PivotDateFilterOperator.nextMonth:return function(t){var i=new Date;return i.setMonth(i.getMonth()+1),i.getFullYear()===t.getFullYear()&&i.getMonth()===t.getMonth()};case v.PivotDateFilterOperator.thisWeek:return function(t){var i=(0,d.DQt)(new Date),n=(0,d.DQt)(new Date);return i.setDate(i.getDate()-i.getDay()),n.setDate(n.getDate()-n.getDay()+6),i<=t&&t<=n};case v.PivotDateFilterOperator.lastWeek:return function(t){var i=(0,d.DQt)(new Date),n=(0,d.DQt)(new Date);return i.setDate(i.getDate()-i.getDay()-7),n.setDate(n.getDate()-n.getDay()),i<=t&&t<=n};case v.PivotDateFilterOperator.nextWeek:return function(t){var i=(0,d.DQt)(new Date),n=(0,d.DQt)(new Date);return i.setDate(i.getDate()-i.getDay()+7),n.setDate(n.getDate()-n.getDay()+14),i<=t&&t<=n};case v.PivotDateFilterOperator.nextQuarter:return function(t){var i,n,e,r,n,i=(0,d.DQt)(new Date),n=i.getMonth(),e=n%3;return i.setDate(1),i.setMonth(n-e+3),(r=(0,d.DQt)(new Date)).setMonth(n-e+6),n=2===r.getMonth()||11===r.getMonth()?31:30,r.setDate(n+1),t>=(0,d.DQt)(i)&&t<(0,d.DQt)(r)};case v.PivotDateFilterOperator.thisQuarter:return function(t){var i,n,e,r,n,i=(0,d.DQt)(new Date),n=i.getMonth(),e=n%3;return i.setDate(1),i.setMonth(n-e),(r=(0,d.DQt)(new Date)).setMonth(n-e+3),n=2===r.getMonth()||11===r.getMonth()?31:30,r.setDate(n+1),t>=(0,d.DQt)(i)&&t<=(0,d.DQt)(r)};case v.PivotDateFilterOperator.lastQuarter:return function(t){var i,n,e,r,n,i=(0,d.DQt)(new Date),n=i.getMonth(),e=n%3;return i.setDate(1),i.setMonth(n-e-3),(r=(0,d.DQt)(new Date)).setMonth(n-e),n=2===r.getMonth()||11===r.getMonth()?31:30,r.setDate(n+1),t>=(0,d.DQt)(i)&&t<(0,d.DQt)(r)};case v.PivotDateFilterOperator.nextYear:return function(t){var i;return(0,d.DQt)(new Date).getFullYear()+1===t.getFullYear()};case v.PivotDateFilterOperator.thisYear:return function(t){var i;return(0,d.DQt)(new Date).getFullYear()===t.getFullYear()};case v.PivotDateFilterOperator.lastYear:return function(t){var i;return(0,d.DQt)(new Date).getFullYear()-1===t.getFullYear()}}return i>=v.PivotDateFilterOperator.Q1&&i<=v.PivotDateFilterOperator.Q4?function(t){return i-v.PivotDateFilterOperator.Q1===Math.floor(t.getMonth()/3)}:i>=v.PivotDateFilterOperator.M1&&i<=v.PivotDateFilterOperator.M12?function(t){return i-v.PivotDateFilterOperator.M1===t.getMonth()}:i===v.PivotDateFilterOperator.yearToDate?function(t){var i=new Date,n=new Date;return i.setMonth(0,1),i.setHours(0,0,0,0),n.setHours(23,59,59),i<=t&&t<=n}:i===v.PivotDateFilterOperator.dateToDate?(s=b(r,n),u=t?b(r):b(r,e),o?a===v.PivotAdvancedDateFilterBy.year?function(t){return y(b(r,t),s,u)}:a===v.PivotAdvancedDateFilterBy.quarter?function(t){return I(b(r,t),s,u)}:a===v.PivotAdvancedDateFilterBy.month?function(t){return T(b(r,t),s,u)}:void 0:function(t){return m(r,t)>=m(r,s)&&m(r,t)<=m(r,u)}):void 0}function x(t,i,n,e,r,o,a){this.sn=v.PivotConditionType.date;var s=this;s.LVt=t,s.eX=n,s.iX=e,s.xQt=i,s.BVt=r,s.Rs=a,s.EVt=o,s.evaluate=S(t,s.eX,s.iX,i,r,o,a)}Object.defineProperty(i,"__esModule",{value:!0}),i.PivotFilterDateCondition=i.Qii=i.SQt=i.PivotFilterCaptionCondition=i.PivotFilterTop10Condition=i.PivotFilterValueCondition=void 0,v=n("./src/pivot-interface.ts"),d=n("./src/pivot-util.ts"),s=void 0,c.prototype.getConditionType=function(){return this.sn},c.prototype.toJSON=function(){var t=this,i=t.LVt,t,t=t.LVt===v.PivotValueFilterOperator.between||v.PivotValueFilterOperator.notBetween?[t.eX,t.iX]:[t.eX];return{conType:v.PivotConditionType.value,val:t,operator:i}},c.prototype.fromJSON=function(t){var i,t,n,i=t.val,t=t.operator,n=this;n.LVt=t,i instanceof Array?(n.eX=i[0],n.iX=i[1]):(n.eX=i,n.iX=s),n.evaluate=u(n.LVt,n.eX,n.iX)},i.PivotFilterValueCondition=c,f.prototype.getConditionType=function(){return this.sn},f.prototype.toJSON=function(){var t=this,i=t.LVt,n=t.GVt,t=t.uit;return{conType:v.PivotConditionType.top10,val:n,type:t,operator:i}},f.prototype.fromJSON=function(t){var i,n,t,e,i=t.val,n=t.operator,t=t.type,e=this;e.LVt=n,e.uit=t,e.GVt=i},i.PivotFilterTop10Condition=f,p.prototype.getConditionType=function(){return this.sn},p.prototype.toJSON=function(){var t=this,i=t.LVt,t=(0,d.ht)(t.iX)?[t.eX]:[t.eX,t.iX];return{conType:v.PivotConditionType.caption,val:t,operator:i}},p.prototype.fromJSON=function(t){var i,t,n,i=t.val,t=t.operator,n=this;n.LVt=t,n.eX=i[0],n.iX=i[1],n.evaluate=h(n.LVt,n.eX,n.iX)},i.PivotFilterCaptionCondition=p,i.SQt=m,i.Qii=b,x.prototype.getConditionType=function(){return this.sn},x.prototype.toJSON=function(){var t=this,i=t.LVt,n=t.xQt,e,e=(0,d.ht)(t.iX)?[t.eX]:[t.eX,t.iX];return{conType:v.PivotConditionType.date,val:e,operator:i,isWholeDay:n,isDynamicEndDate:t.BVt,isParallel:t.EVt,by:t.Rs}},x.prototype.fromJSON=function(t){var i,n,e,r,o,t,a,i=t.val,n=t.operator,e=t.isWholeDay,r=t.isDynamicEndDate,o=t.isParallel,t=t.by,a=this;a.LVt=n,a.xQt=e,a.BVt=r,a.Rs=t,a.EVt=o,i instanceof Array?(a.eX=i[0],a.iX=i[1]):(a.eX=i,a.iX=s),a.evaluate=S(a.LVt,a.eX,a.iX,e,a.BVt,a.EVt,a.Rs)},i.PivotFilterDateCondition=x},"./src/pivot-engine.ts":function(t,i,n){var o,e,u,r;function a(t,i){for(var n,e,n=i[0].length,e=0;e<i.length;e++)i[e][n]=t.getValue(e,0)}function s(){var t=this;t.cut={},t.resetDataAnalyzer(),t.Wii=1,t.zii=1e8}function c(t,i,n){for(var e,r,o,a,s,u,e={},o,a=0,s=Object.keys(i);a<s.length;a++)e[(r=i[u=s[a]]).FVt]=r;for(;e[t]&&e[t]!==n;)t++;return t}function l(t,i){return"external"!==t||!(0,u.ht)(i)}Object.defineProperty(i,"__esModule",{value:!0}),i.PivotEngine=void 0,o=n("./src/pivot-cache.ts"),e=n("./src/data-analyzer.ts"),u=n("./src/pivot-util.ts"),s.prototype.hasPivotCache=function(t){return!!this.cut[t]},s.prototype.addPivotCache=function(t){var i=this,n;return i.cut[t.getName()]=t,n=(0,u.ht)(t.FVt)?c(i.Wii,i.cut,t):c(t.FVt,i.cut,t),i.Wii=n+1,t.FVt=n,(0,u.ht)(t.yQt)?(t.yQt=i.zii,i.zii++):t.yQt>=i.zii&&(i.zii=t.yQt+1),t},s.prototype.getPivotCacheByName=function(t){return this.cut[t]},s.prototype.getPivotCacheByCacheId=function(t){var i,n,e,i,n=this.cut;for(e in n)if(n.hasOwnProperty(e)&&n[e].FVt===t)return n[e]},s.prototype.getPivotCacheByPivotCacheId=function(t){var i,n,e,i,n=this.cut;for(e in n)if(n.hasOwnProperty(e)&&n[e].yQt===t)return n[e]},s.prototype.gJt=function(t){var i,n,i=this;for(n in i.cut)if(i.cut.hasOwnProperty(n)&&i.cut[n].mii(t))return i.cut[n];return null},s.prototype.dispose=function(){var t,i,t=this;for(i in t.cut)t.cut.hasOwnProperty(i)&&t.cut[i].dispose();t.cut={},t.Zii=null},s.prototype.reset=function(){this.cut={}},s.prototype.update=function(){},s.prototype.queryItem=function(t,i,n){for(var e,r,o,a,s,s,e=this.getPivotCacheByName(t),r=!1,o=0,a=i;o<a.length;o++)if(s=a[o],(s=(s=e.getField(s.sourceName)).cC()?e.getField(s.y1):s).ty&&0<s.ty.length){r=!0;break}return this.Zii.nti(e,this.Zii.Lh(e,i,r),i,n)},s.prototype.TQt=function(t,i,n){var t=this.getPivotCacheByName(t);return this.Zii.TQt(t,this.Zii.Lh(t,i),n)},s.prototype.getCalcFields=function(t){var t=this.getPivotCacheByName(t);return t?t.WVt():[]},s.prototype.addGroup=function(t,i){var t=this.getPivotCacheByName(t);return!!t&&t.dy(i)},s.prototype.fromJson=function(t){var i,n,e,e,i=this;for(n in this.resetDataAnalyzer(),t)t.hasOwnProperty(n)&&l((e=t[n]).sourceType,e.pivotCacheRecords)&&((e=new o.PivotCache).fromJson(n,t[n],i),i.addPivotCache(e))},s.prototype.toJson=function(t,i){for(var n,e,r,o,a,s,n=this.cut,e={},r=0,o=i;r<o.length;r++)s=n[a=o[r]],(0,u.ht)(s)||(e[s.FVt]=s.toJson(t[a]));return e},s.prototype.yh=function(t,i,n){var e,r,r,e=this,r=(0,u.xr)(t,"cacheSource");l(null==r?void 0:r.type,n)&&(this.resetDataAnalyzer(),(r=new o.PivotCache).yh(t,i,n),e.addPivotCache(r))},s.prototype.wh=function(t,i){for(var n,e,r,o,a,s,n=this.cut,e={},r=0,o=i;r<o.length;r++)s=n[a=o[r]],(0,u.ht)(s)||(e[s.Zc]=s.wh(t[a]));return e},s.prototype.resetDataAnalyzer=function(){this.Zii=new e.DataAnalyzer},i.PivotEngine=s},"./src/pivot-interface.ts":function(t,i){var n,e,r,o,a,s,u,c,l,f,h,v,d,p,m,b,b,b,b,b,b,b,b,b,b,b,b,b,b,b;Object.defineProperty(i,"__esModule",{value:!0}),i.SortType=i.PivotShowDataAs=i.DateGroupType=i.DataPosition=i.PivotTop10FilterOperator=i.PivotTop10FilterType=i.PivotAdvancedDateFilterBy=i.PivotDateFilterOperator=i.PivotCaptionFilterOperator=i.PivotValueFilterOperator=i.PivotConditionType=i.PivotDataType=i.SubtotalType=i.PivotSourceFieldType=i.PivotShowDataAsBaseItemType=void 0,(b=n=i.PivotShowDataAsBaseItemType||(i.PivotShowDataAsBaseItemType={}))[b.item=0]="item",b[b.next=1]="next",b[b.previous=2]="previous",(b=e=i.PivotSourceFieldType||(i.PivotSourceFieldType={}))[b.isCalcField=0]="isCalcField",b[b.isGroupField=1]="isGroupField",(b=r=i.SubtotalType||(i.SubtotalType={}))[b.average=0]="average",b[b.count=1]="count",b[b.countNums=2]="countNums",b[b.max=3]="max",b[b.min=4]="min",b[b.product=5]="product",b[b.stdDev=6]="stdDev",b[b.stdDevp=7]="stdDevp",b[b.sum=8]="sum",b[b.varr=9]="varr",b[b.varp=10]="varp",(b=o=i.PivotDataType||(i.PivotDataType={}))[b.number=0]="number",b[b.string=1]="string",b[b.date=2]="date",b[b.boolean=3]="boolean",b[b.errorValue=4]="errorValue",b[b.noValue=5]="noValue",(b=a=i.PivotConditionType||(i.PivotConditionType={}))[b.caption=0]="caption",b[b.date=1]="date",b[b.value=2]="value",b[b.top10=3]="top10",(b=s=i.PivotValueFilterOperator||(i.PivotValueFilterOperator={}))[b.equalsTo=0]="equalsTo",b[b.notEqualsTo=1]="notEqualsTo",b[b.greaterThan=2]="greaterThan",b[b.greaterThanOrEqualsTo=3]="greaterThanOrEqualsTo",b[b.lessThan=4]="lessThan",b[b.lessThanOrEqualsTo=5]="lessThanOrEqualsTo",b[b.between=6]="between",b[b.notBetween=7]="notBetween",(b=u=i.PivotCaptionFilterOperator||(i.PivotCaptionFilterOperator={}))[b.equalsTo=0]="equalsTo",b[b.notEqualsTo=1]="notEqualsTo",b[b.beginsWith=2]="beginsWith",b[b.doesNotBeginWith=3]="doesNotBeginWith",b[b.endsWith=4]="endsWith",b[b.doesNotEndWith=5]="doesNotEndWith",b[b.contains=6]="contains",b[b.doesNotContain=7]="doesNotContain",b[b.greaterThan=8]="greaterThan",b[b.greaterThanOrEqualsTo=9]="greaterThanOrEqualsTo",b[b.lessThan=10]="lessThan",b[b.lessThanOrEqualsTo=11]="lessThanOrEqualsTo",b[b.between=12]="between",b[b.notBetween=13]="notBetween",(b=c=i.PivotDateFilterOperator||(i.PivotDateFilterOperator={}))[b.equalsTo=0]="equalsTo",b[b.notEqualsTo=1]="notEqualsTo",b[b.before=2]="before",b[b.beforeEqualsTo=3]="beforeEqualsTo",b[b.after=4]="after",b[b.afterEqualsTo=5]="afterEqualsTo",b[b.Between=6]="Between",b[b.notBetween=7]="notBetween",b[b.today=8]="today",b[b.yesterday=9]="yesterday",b[b.tomorrow=10]="tomorrow",b[b.last7Days=11]="last7Days",b[b.thisMonth=12]="thisMonth",b[b.lastMonth=13]="lastMonth",b[b.nextMonth=14]="nextMonth",b[b.thisWeek=15]="thisWeek",b[b.lastWeek=16]="lastWeek",b[b.nextWeek=17]="nextWeek",b[b.nextQuarter=18]="nextQuarter",b[b.thisQuarter=19]="thisQuarter",b[b.lastQuarter=20]="lastQuarter",b[b.nextYear=21]="nextYear",b[b.thisYear=22]="thisYear",b[b.lastYear=23]="lastYear",b[b.Q1=24]="Q1",b[b.Q2=25]="Q2",b[b.Q3=26]="Q3",b[b.Q4=27]="Q4",b[b.M1=28]="M1",b[b.M2=29]="M2",b[b.M3=30]="M3",b[b.M4=31]="M4",b[b.M5=32]="M5",b[b.M6=33]="M6",b[b.M7=34]="M7",b[b.M8=35]="M8",b[b.M9=36]="M9",b[b.M10=37]="M10",b[b.M11=38]="M11",b[b.M12=39]="M12",b[b.yearToDate=40]="yearToDate",b[b.dateToDate=41]="dateToDate",(b=l=i.PivotAdvancedDateFilterBy||(i.PivotAdvancedDateFilterBy={}))[b.month=1]="month",b[b.quarter=2]="quarter",b[b.year=3]="year",(b=f=i.PivotTop10FilterType||(i.PivotTop10FilterType={}))[b.count=0]="count",b[b.percent=1]="percent",b[b.sum=2]="sum",(b=h=i.PivotTop10FilterOperator||(i.PivotTop10FilterOperator={}))[b.top=1]="top",b[b.bottom=-1]="bottom",(b=v=i.DataPosition||(i.DataPosition={}))[b.row=0]="row",b[b.col=1]="col",b[b.none=2]="none",(b=d=i.DateGroupType||(i.DateGroupType={}))[b.seconds=0]="seconds",b[b.minutes=1]="minutes",b[b.hours=2]="hours",b[b.days=3]="days",b[b.months=4]="months",b[b.quarters=5]="quarters",b[b.years=6]="years",(b=p=i.PivotShowDataAs||(i.PivotShowDataAs={}))[b.normal=0]="normal",b[b.percentOfTotal=1]="percentOfTotal",b[b.percentOfRow=2]="percentOfRow",b[b.percentOfCol=3]="percentOfCol",b[b.percent=4]="percent",b[b.percentOfParentRow=5]="percentOfParentRow",b[b.percentOfParentCol=6]="percentOfParentCol",b[b.percentOfParent=7]="percentOfParent",b[b.difference=8]="difference",b[b.percentDiff=9]="percentDiff",b[b.runTotal=10]="runTotal",b[b.percentOfRunningTotal=11]="percentOfRunningTotal",b[b.rankAscending=12]="rankAscending",b[b.rankDescending=13]="rankDescending",b[b.index=14]="index",(b=m=i.SortType||(i.SortType={}))[b.asc=0]="asc",b[b.desc=1]="desc",b[b.custom=2]="custom"},"./src/pivot-sort.ts":function(t,l,i){var n,f,h,u,i,v,e,r,o,a,s,c,d,p;function m(t){var i,n,e,r,o,a,s,i=[],n=v().dateResource,e=n.HOUR_GROUP_ITEMS.slice(),r=n.MINUTE_GROUP_ITEMS.slice(),o=n.SECOND_GROUP_ITEMS.slice();switch(t){case f.DateGroupType.quarters:for(a=0;a<h.quartersGroupItemsKey.length;a++)i.push(n[h.quartersGroupItemsKey[a]]);break;case f.DateGroupType.months:for(a=0;a<h.monthsGroupItemsKey.length;a++)i.push(n[h.monthsGroupItemsKey[a]]);break;case f.DateGroupType.days:for(a=0;a<h.monthsGroupItemsKey.length;a++)for(s=1;s<=h.dayCountPerMonth[a];s++)i.push((0,u.Yii)(n[h.monthsGroupItemsKey[a]],s));break;case f.DateGroupType.hours:for(a=0;a<e.length;a++)i.push(e[a]);break;case f.DateGroupType.minutes:for(a=0;a<r.length;a++)i.push(r[a]);break;case f.DateGroupType.seconds:for(a=0;a<o.length;a++)i.push(o[a])}return i}Object.defineProperty(l,"__esModule",{value:!0}),l.mXt=l.Hii=l.Jii=l.qii=l.Kii=l.Xii=l.$ii=l.tni=void 0,n=i("Common"),f=i("./src/pivot-interface.ts"),h=i("./src/pivot-util.ts"),u=i("./pivot-entry.ts"),i=new n.Common.ResourceManager(u.SR),v=i.getResource.bind(i),l.tni=e=function(t,i){var n,e;return t===i?0:(n=+t,(e=+i)&&n?e<n?1:-1:(""+t).localeCompare(i+""))},l.$ii=r=function(t,i){return i<=t?1:-1},l.Xii=o=function(t,i){return t.getMonth()>=i.getMonth()?1:-1},l.Kii=a=function(t,i){return Math.floor(t.getMonth()/3)>=Math.floor(i.getMonth()/3)?1:-1},l.qii=s=function(t,i){return i<=t?1:-1},l.Jii=c=function(t,i){for(var n,e,r,o,a,s,u,c,e=v().blank,n=i===f.DateGroupType.years?(t.sort(l.tni),t):(r=m(i)).concat([]),s=0,u=!1,c=0;c<t.length;c++)t[c]&&t[c]!==e?-1<t[c].indexOf(h.LESS)?(o=t[c],s++):-1<t[c].indexOf(h.MORE)&&(a=t[c],s++):u=!0;return i===f.DateGroupType.years&&(n=n.splice(s)),o&&n.unshift(o),a&&n.push(a),u&&n.unshift(e),n},l.Hii=d=function(t){for(var i,n,e,r,o,a,a,i=[],n={},e=[],r=0,o=t.length;r<o;r++)a=void 0,-1<t[r].indexOf(h.LESS)?a=h.LESS:-1<t[r].indexOf(h.MORE)?a=h.MORE:-1<t[r].indexOf(h.NUMBER_GROUP_SEPARATOR)&&(a=h.NUMBER_GROUP_SEPARATOR),a=a?t[r].split(a)[1]:t[r],i.push(a),n[a]=r;for(i.sort(l.tni),r=0,o=i.length;r<o;r++)e.push(t[n[i[r]]]);return e},l.mXt=p=function(t,i,n){var e,r,o,a;if(i.isDate)(0,h.ht)(i.by)?t.sort(function(t,i){return new Date(t)>new Date(i)?1:-1}):t=(0,l.Jii)(t,i.by);else if(i.isNumberGroup)t=(0,l.Hii)(t);else{for(e=[],r=[],o=[],a=0;a<t.length;a++)t[a]===v().blank?o.push(t[a]):"number"==typeof t[a]?e.push(t[a]):"string"==typeof t[a]?r.push(t[a]):"object"==typeof t[a]&&r.push(t[a]._error||t[a]+"");1<e.length&&e.sort(function(t,i){return t-i}),1<r.length&&r.sort(function(t,i){return(0,u.ini)(t,i,n)}),t=e.concat(r,o)}return t}},"./src/pivot-util.ts":function(L,a,t){var n,o,i,e,t,r,s,E,B,R,G,V,U,t,u,c,l,f,h,v,d,Q,p,m;function b(){}function g(t,i,n,e,r){var i=d.jJ(i);return i?d.qT(i=n+i+e).test(t):r()}function W(t,i){return t&&i?(t.splice.apply(t,n([t.length,i.length],i,!1)),t.sort(function(t,i){return t-i}),t):t||i||[]}function z(e){var t,i,r,n,o,a;if(!e||0===e.length)return[];for(t=e[0],i=e.length,r={},w(t,function(t){r[t]=1}),n=function(t){var i={},n=!0;if(w(e[t],function(t){r[t]&&(n=!(i[t]=1))}),r=i,n)return{value:[]}},o=1;o<i;o++)if("object"==typeof(a=n(o)))return a.value;return Object.keys(r)}function Z(t,i){for(var n,e,r,n=[],e=0,r=0;r<t.length;r++)for(;e<i.length;){if(!(t[r]>i[e])){if(t[r]!==i[e])break;n.push(t[r]);break}e++}return n}function Y(t){for(var i,n,e,i=t[0],n=1,e=t.length;n<e&&0!==(i=Z(i,t[n])).length;n++);}function H(t,i){for(var n,e,r,n=!1,e=0,r=t.length;e<r;e++)i===t[e]&&(n=!0);return n}function w(t,i){for(var n,e,r,e=t.length,n=0;n<e&&!(r=i(t[n],n));n++);}function J(t){for(var i,n,i=[],n=0;n<t.length;n++)i=i.concat(t[n]);return i}function y(t){return null==t}function C(t){return"string"==typeof t}function q(t){return!y(t)&&(t=C(t)?parseFloat(t):t)==t&&isFinite(t)}function A(t){return t<10?"0"+t:t+""}function N(t){var i;try{i=t.getFullYear()+"-"+A(t.getMonth()+1)+"-"+A(t.getDate())+"T"+A(t.getHours())+":"+A(t.getMinutes())+":"+A(t.getSeconds())}catch(t){}return i}function K(t){return t.getUTCFullYear()+"/"+A(t.getUTCMonth()+1)+"/"+A(t.getUTCDate())}function I(t,i){return i.slice(0,t.length).toLowerCase()===t.toLowerCase()}function X(t,i){return g(t,i,"^","",function(){return I(t,i)})}function T(t,i){return i.slice(-t.length).toLowerCase()===t.toLowerCase()}function $(t,i){return g(t,i,"","$",function(){return T(t,i)})}function S(t,i){return""===i||0<=t.toLowerCase().indexOf(i.toLowerCase())}function tt(t,i){return g(t,i,"","",function(){return S(i,y(t)?"":t)})}function x(t,i){return t.toLowerCase()===i.toLowerCase()}function it(t,i){return g(i,t,"","",function(){return x(i,y(t)?"":t)})}function nt(t){var i,n,e;return t&&t instanceof Date?(i=t.getFullYear(),n=t.getMonth(),e=t.getDate(),new Date(i,n,e)):t}function et(t){return"string"==typeof t}function M(t){var i;return(0,a.getSR)().dateResource[a.monthsGroupItemsKey[t.getMonth()]]}function rt(t){var i;return(0,a.getSR)().dateResource.HOUR_GROUP_ITEMS[t.getHours()]}function ot(t){var i;return(0,a.getSR)().dateResource.MINUTE_GROUP_ITEMS[t.getMinutes()]}function at(t){var i;return(0,a.getSR)().dateResource.SECOND_GROUP_ITEMS[t.getSeconds()]}function st(t){var i;return(0,a.getSR)().dateResource[a.quartersGroupItemsKey[Math.floor(t.getMonth()/3)]]}function ut(){for(var t,i,n,e,t=[],i=(0,a.getSR)().dateResource,n=0,e=a.monthsGroupItemsKey.length;n<e;n++)t.push(i[a.monthsGroupItemsKey[n]]);return t}function D(t){var i,n,i,n=f.Fe(f.culture()).TimelineDateSuffix;return t+(n&&n.year||"")}function k(t,i){var n,e,n,e=f.Fe(f.culture()).TimelineDateSuffix;return e&&e.date?t+i+e.date:i+"-"+t}function ct(){for(var t,i,n,e,r,o,t=[],i=(0,a.getSR)().dateResource,n=0,e=a.monthsGroupItemsKey.length;n<e;n++)for(r=0,o=a.dayCountPerMonth[n];r<o;r++)t.push(k(i[a.monthsGroupItemsKey[n]],r+1));return t}function lt(){for(var t,i,n,e,t=[],i=(0,a.getSR)().dateResource,n=0,e=a.quartersGroupItemsKey.length;n<e;n++)t.push(i[a.quartersGroupItemsKey[n]]);return t}function ft(t){return t=t&&t[0]===t[t.length-1]&&"'"===t[0]?t.substring(1,t.length-1):t}function ht(t){var i;return"number"==typeof t?t:(i=Date.parse(t),isNaN(i)?(i=new Date(t),isNaN(i)?t:i):new Date(t))}function vt(t,i){var n,e,t,e;return y(i)||i===(0,a.getSR)().blank?(0,a.getSR)().blank:(n=t.T,e=t.Qti,t=t.Rs,i<n?a.LESS+n:e<=i?a.MORE+e:(e=n+Math.floor((i-n)/t)*t)+"-"+(e+t-1))}function dt(t,i){switch(t){case e.DateGroupType.seconds:return at(i);case e.DateGroupType.minutes:return ot(i);case e.DateGroupType.hours:return rt(i);case e.DateGroupType.days:return k(M(i),i.getDate());case e.DateGroupType.months:return M(i);case e.DateGroupType.quarters:return st(i);case e.DateGroupType.years:return D(i.getFullYear());default:return N(i)}}function j(t){var i=f.Fe(f.culture()).DateTimeFormat,n=i.shortDatePattern;return 0===t.getHours()&&0===t.getMinutes()&&0===t.getSeconds()&&0===t.getMilliseconds()||(n=i.defaultDatePattern),h.Pe(t,n)}function pt(t,i){if(y(i)||i===(0,a.getSR)().blank)return(0,a.getSR)().blank;var n=t.T,e=t.gd,t=t.Rs,r;if("string"==typeof i&&_(i))r=_(i);else{if(!Date.parse(i))return l;r=new Date(i)}return r<n?"<"+j(n):e<r?">"+j(e):dt(t,r)}function mt(t){if(t&&"object"==typeof t)for(var i in t)if(t.hasOwnProperty(i))return!1;return!0}function O(t){var i,n,e,r,i=Array.isArray(t),n="[object Object]"===Object.prototype.toString.call(t);if(i){for(e=[],r=0;r<t.length;r++)e[r]=O(t[r]);return e}if(n){for(r in e=void 0,t)y(t[r])||((e=e===l?{}:e)[r]=O(t[r]));return e}return t}function bt(i,n,t){var e,r;try{e=(r=o.Common.CultureManager.getCultureInfo()).localeCompare&&!t?r.localeCompare(i,n):i.localeCompare(n,t||"en")}catch(t){e=i.localeCompare(n)}return e}function _(t){var i,t;return!y(t)&&""!==t&&"string"==typeof t&&(t=(i=new c).parse(t))instanceof Date?t:void 0}function gt(t,i){return y(t)?t:(i=i||/(&)|(<)|(>)|(")|(')/g,wt(""+(t=typeof t===v?t.replace(i,function(t){switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&apos;"}}):t)))}function wt(t){var i,n,e,r,o;if(y(t)||""===t)return t;for(null!==t.match(u)&&(t=t.replace(i=/(_x00[0-1][0-9A-Fa-f]_)/g,function(t){return"_x005F"+t})),n=[],e=0;e<t.length;e++)r=t.charCodeAt(e),o=t[e],n.push(10===r?"_x000a_":13===r?"_x000d_":o);return n.join("")}function F(n){return function(t,i){return String.fromCharCode(parseInt(i,n))}}function yt(t,i){var n,e;return y(t)?t:!(n=typeof t===v)||-1===t.indexOf("&")?""+t:(e=/(&amp;)|(&gt;)|(&lt;)|(&quot;)|(&apos;)/g,(t=-1!==t.indexOf("&#")?t.replace(p,F(10)).replace(m,F(16)):t).replace(e,function(t){switch(t){case"&amp;":return"&";case"&gt;":return">";case"&lt;":return"<";case"&quot;":return'"';case"&apos;":return"'"}}))}function Ct(t,i){for(var n,e,r,o,a,o,n=i.split("&"),e=0,r=n.length;e<r;e++){if(a=(o=n[e].split("."))[0],o=o[1],!t)return;t=P(t,a,o)}return t}function P(t,i,n){var e,r,o,a;if(!t||!t.c_)return l;for(n=n?+n:0,r=0,o=(e=t.c_).length;r<o;r++)if((a=e[r])&&a.n_===i){if(0===n)return a;n--}}function At(t,i){var n,e,r,o,a;if(!t||!t.c_)return l;for(e=[],r=0,o=(n=t.c_).length;r<o;r++)(a=n[r])&&a.n_===i&&e.push(a);return e}function Nt(t,i){var n,e,r,o,a;if(t&&t.c_){for(n=[],e=0,r=i.length;e<r;e++)(a=At(t,o=i[e]))&&0<a.length&&(n=n.concat(a));t.c_=n}}function It(t){return i.Cmt(t.split(""),!1)?t:"'"+t.replace(/'/g,"''")+"'"}n=this&&this.__spreadArray||function(t,i,n){if(n||2===arguments.length)for(var e=0,r=i.length,o;e<r;e++)!o&&e in i||((o=o||Array.prototype.slice.call(i,0,e))[e]=i[e]);return t.concat(o||Array.prototype.slice.call(i))},Object.defineProperty(a,"__esModule",{value:!0}),a.Pr=a.xr=a.o1=a.xmlDecode=a.xmlEncode=a.parseStringToDate=a.ini=a.RF=a.k$t=a.isEmptyObject=a.getDateGroupItemKey=a.formatDateToString=a.getNumberGroupItemKey=a.nii=a.Oii=a.Zti=a.Wti=a.Yii=a.Yti=a.zti=a.isString=a.DQt=a.PRE_DAY=a.Rii=a.nni=a.Uii=a.eni=a.Vii=a.rni=a.Gii=a.oni=a.ani=a.kQt=a.jh=a.OMt=a.ht=a.sni=a.o=a.Mii=a.amt=a.F=a.uni=a.XFileConstants=a.NUMBER_GROUP_SEPARATOR=a.MORE=a.LESS=a.quartersGroupItemsKey=a.dayCountPerMonth=a.monthsGroupItemsKey=a.getSR=void 0,a.i2e=void 0,o=t("Common"),i=t("CalcEngine"),e=t("./src/pivot-interface.ts"),t=t("./pivot-entry.ts"),r=Math.min,s=Math.max,E=Math.abs,B=Math.pow,R=Math.sqrt,G=Math.floor,V=Math.ceil,U=!0,t=new o.Common.ResourceManager(t.SR,"PivotEngine"),u=/_x00[0-1][0-9A-Fa-f]_/,a.getSR=t.getResource.bind(t),c=o.Formatter&&o.Formatter.GeneralFormatter,l=void 0,a.monthsGroupItemsKey=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],a.dayCountPerMonth=[31,29,31,30,31,30,31,31,30,31,30,31],a.quartersGroupItemsKey=["Qtr1","Qtr2","Qtr3","Qtr4"],f=o.Common.CultureManager,h=o.Common.ct,a.LESS="<",a.MORE=">",a.NUMBER_GROUP_SEPARATOR="-",v="string",a.XFileConstants={cni:"http://schemas.openxmlformats.org/spreadsheetml/2006/main",ss:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",Ku:"http://schemas.openxmlformats.org/markup-compatibility/2006",ns:"xr",Ns:"http://schemas.microsoft.com/office/spreadsheetml/2014/revision"},b.qT=function(t){var i=b.kUt[t],i;return(i=i||(b.kUt[t]=new RegExp(t,"g"))).lastIndex=0,i},b.jJ=function(t,i,n){var e,r,o,a,s,u;if(b._Ut[t])return b.EUt[t];if(b.qT(e="[~?*]+").test(t)){for(r=[],o=t.split(""),s={".":!(a=void 0),"+":!0,$:!0,"^":!0,"[":!0,"]":!0,"(":!0,")":!0,"{":!0,"}":!0,"|":!0,"/":!0},u=0;u<o.length;u++)"~"===(a=o[u])&&u<o.length-1?("*"===(a=o[++u])||"?"===a?r.push("\\"):i&&r.push("~"),r.push(a)):"?"===a?r.push("."):"*"===a?(r.push("[\\s\\S]"),r.push(n?"+":"*")):(s[a]&&r.push("\\"),r.push(a));return r.join("")}return null},b.tbt=function(t,i,n){var t=b.jJ(t,i,n),t;return t=t&&"^"+t+"$"},b.D9t=function(t){return t.replace(/([\~\!\@\#\$\%\^\&\*\(\)\-\_\+\=\[\]\{\}\|\\\;\:\'\"\,\.\/\<\>\?])/,"\\$1")},b.kUt={},b._Ut={},b.EUt={},d=b,a.uni=d,a.F=W,a.amt=z,a.Mii=H,a.o=w,a.sni=J,a.ht=y,a.OMt=C,a.jh=q,a.kQt=N,a.ani=K,a.oni=I,a.Gii=X,a.rni=T,a.Vii=$,a.eni=S,a.Uii=tt,a.nni=x,a.Rii=it,a.PRE_DAY=864e5,a.DQt=nt,a.isString=et,a.zti=ut,a.Yti=D,a.Yii=k,a.Wti=ct,a.Zti=lt,a.Oii=ft,a.nii=ht,a.getNumberGroupItemKey=vt,a.formatDateToString=j,a.getDateGroupItemKey=pt,a.isEmptyObject=mt,a.k$t=Q=function(t,n){var i,e,r,o,a;if(!t)return t;for(e in i=[],t)t.hasOwnProperty(e)&&i.push(+e);for(i.sort(function(t,i){return(t-i)*n}),r={},o=0,a=i.length;o<a;o++)r[i[o]]=o+1;return r},a.RF=O,a.ini=bt,a.parseStringToDate=_,a.xmlEncode=gt,p=/&#(\d+);/g,m=/&#x([0-9A-F]+);/gi,a.xmlDecode=yt,a.o1=Ct,a.xr=P,a.Pr=Nt,a.i2e=It},"./src/pivotEngine.res.en.ts":function(t,i){Object.defineProperty(i,"__esModule",{value:!0}),i.resource=void 0,i.resource={dateResource:{Jan:"Jan",Feb:"Feb",Mar:"Mar",Apr:"Apr",May:"May",Jun:"Jun",Jul:"Jul",Aug:"Aug",Sep:"Sep",Oct:"Oct",Nov:"Nov",Dec:"Dec",Qtr1:"Qtr1",Qtr2:"Qtr2",Qtr3:"Qtr3",Qtr4:"Qtr4",Seconds:"Seconds",Minutes:"Minutes",Hours:"Hours",Days:"Days",Months:"Months",Quarters:"Quarters",Years:"Years",SECOND_GROUP_ITEMS:[":00",":01",":02",":03",":04",":05",":06",":07",":08",":09",":10",":11",":12",":13",":14",":15",":16",":17",":18",":19",":20",":21",":22",":23",":24",":25",":26",":27",":28",":29",":30",":31",":32",":33",":34",":35",":36",":37",":38",":39",":40",":41",":42",":43",":44",":45",":46",":47",":48",":49",":50",":51",":52",":53",":54",":55",":56",":57",":58",":59"],MINUTE_GROUP_ITEMS:[":00",":01",":02",":03",":04",":05",":06",":07",":08",":09",":10",":11",":12",":13",":14",":15",":16",":17",":18",":19",":20",":21",":22",":23",":24",":25",":26",":27",":28",":29",":30",":31",":32",":33",":34",":35",":36",":37",":38",":39",":40",":41",":42",":43",":44",":45",":46",":47",":48",":49",":50",":51",":52",":53",":54",":55",":56",":57",":58",":59"],HOUR_GROUP_ITEMS:["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"]},Exp_NoItemParseError:"An item name cannot be found. Check that you've typed the name correctly and the item is present in the PivotTable report.",Exp_UnsupportedCalcItemType:"References, names, and arrays are not supported in PivotTable formulas.",blank:"(blank)"}},CalcEngine:function(t){t.exports=o("@spreadjs/js-calc")},Common:function(t){t.exports=o("@spreadjs/js-sheets-common")}},e={},t=r("./pivot-entry.ts"),(a={}).Pivot=t}(),e=a||{},"object"==typeof t.exports?t.exports=e.Pivot:void 0!==(i=function(){return e.Pivot}.apply(i,n=[]))&&(t.exports=i)},Pivot:function(t){"use strict";t.exports=e.Pivot},"@spreadjs/js-sheets-common":function(t){"use strict";t.exports=e.Spread},"@spreadjs/js-calc":function(t){"use strict";t.exports=e.Spread.CalcEngine},Core:function(t){"use strict";t.exports=e.Spread.Sheets},SheetsCalc:function(t){"use strict";t.exports=e.Spread.Sheets.CalcEngine},CellTypes:function(t){"use strict";t.exports=e.Spread.Sheets.CellTypes},ConditionalFormatting:function(t){"use strict";t.exports=e.Spread.Sheets.ConditionalFormatting},FormulaTextBox:function(t){"use strict";t.exports=e.Spread.Sheets.FormulaTextBox},Shapes:function(t){"use strict";t.exports=e.Spread.Sheets.Shapes},Slicers:function(t){"use strict";t.exports=e.Spread.Sheets.Slicers},Tables:function(t){"use strict";t.exports=e.Spread.Sheets.Tables}},o={},t=n("./dist/plugins/pivot/pivot-all-entry.js"),((e=void 0===e?{}:e).Spread=e.Spread||{}).Pivot=t});