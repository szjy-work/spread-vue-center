/*!
 * 
 * SpreadJS Library 17.0.10
 *
 * Copyright(c) GrapeCity Software inc.  All rights reserved.
 *
 * Licensed under the SpreadJS Commercial License.
 * info.xa@grapecity.com
 * https://www.grapecity.com.cn/developer/spreadjs
 *
 */
!function(t){"object"==typeof module&&"object"==typeof module.exports?module.exports=t(require("@grapecity-software/spread-sheets")):"function"==typeof define&&define.amd?define(["@grapecity-software/spread-sheets"],t):"object"==typeof exports?exports.Spread=t(require("@grapecity-software/spread-sheets")):t(GC)}(function(r){function i(t){var n,n,n=o[t];return void 0!==n||(n=o[t]={exports:{}},e[t].call(n.exports,n,n.exports,i)),n.exports}var e,o,t;e={"./dist/plugins/report/base/sheet-tab-base.js":function(t,n){"use strict";var i;function r(){}Object.defineProperty(n,"__esModule",{value:!0}),n.SheetTabBase=void 0,r.prototype.name=function(t){var n=this.Mf;return n.name.apply(n,arguments),n.name()},r.prototype.getParent=function(){return this.Mf&&this.Mf.getParent()},r.prototype.visible=function(t){var n=this.Mf;return n.visible.apply(n,arguments)},r.prototype.R2e=function(){return this.Mf.options.sheetTabColor},r.prototype.hg=function(t){this.Mf.hg(t)},r.prototype.L0=function(t,n){var i;this.Mf.L0(t,n),t&&(this.E3(),this.UMi)&&this.UMi.detach()},r.prototype.Zg=function(t){this.Mf.Zg(t)},r.prototype.pM=function(t){this.Mf.pM(t)},r.prototype.b2=function(t,n){return this.Mf&&this.Mf.b2(t,n)},r.prototype.ow=function(){this.Mf.ow()},r.prototype.aw=function(){this.Mf.aw()},r.prototype.tw=function(){this.Mf.tw()},r.prototype.Wb=function(t,n){this.Mf.Wb(t,n)},r.prototype.Kb=function(t){this.Mf.Kb(t)},r.prototype.Fb=function(t,n){this.Mf.Fb(t,n)},r.prototype.onHorizontalDockScroll=function(t,n){this.Mf.onHorizontalDockScroll(t,n)},r.prototype.Gb=function(t){this.Mf.Gb(t)},r.prototype.WC=function(t,n,i){this.Mf.WC(t,n,i)},r.prototype.$C=function(t){this.Mf.$C(t)},r.prototype.QC=function(t,n,i){this.Mf.QC(t,n,i)},r.prototype.Cg=function(){this.Mf.Cg()},r.prototype.suspendPaint=function(){this.Mf.suspendPaint()},r.prototype.resumePaint=function(){var t=this.Mf.getDataSource();this.Mf.resumePaint()},r.prototype.isPaintSuspended=function(){return this.Mf.isPaintSuspended()},r.prototype.v3=function(t){var n,i,r,e,n=this.rM;if(n)for(i=0,r=n;i<r.length;i++)e=r[i],t.bind(e.type,e.data,e.fn)},r.prototype.bind=function(t,n,i){this.rM||(this.rM=[]),this.Mf.bind(t,n,i),this.rM.push({type:t,data:n,fn:i})},r.prototype.unbind=function(n,i){this.Mf.unbind(n,i),this.rM&&(this.rM=this.rM.filter(function(t){return t.type!==n&&t.fn!==i}))},r.prototype.unbindAll=function(){this.rM=[],this.Mf.unbindAll()},r.prototype.D3=function(t,n,i){this.rM||(this.rM=[]),this.Mf.D3(t,n,i),this.rM.push({type:t,data:n,fn:i})},r.prototype._3=function(n,i){this.Mf._3(n,i),this.rM&&(this.rM=this.rM.filter(function(t){return t.type!==n&&t.fn!==i}))},r.prototype.E3=function(){this.rM=[],this.Mf.E3()},r.prototype.parameter=function(t){return 0!==arguments.length&&(this.ghe=t),this.ghe},r.prototype.suspendEvent=function(){this.Mf.suspendEvent()},r.prototype.resumeEvent=function(){this.Mf.resumeEvent()},r.prototype.isEventSuspended=function(){return this.Mf.isEventSuspended()},r.prototype.bC=function(){this.Mf.bC()},r.prototype.ki=function(t,n,i){this.Mf.ki(t,n,i)},r.prototype.isEditing=function(){return this.Mf.isEditing()},r.prototype.ol=function(t,n,i,r){return this.Mf.ol(t,n,i,r)},r.prototype.currentTheme=function(t){var n=this.Mf;return n.currentTheme.apply(n,arguments)},r.prototype.FM=function(){this.Mf.FM()},r.prototype.uw=function(){return this.Mf.uw()},r.prototype.ot=function(){return this.Mf.ot()},r.prototype.hitTest=function(t,n,i,r){return this.Mf.hitTest(t,n,i,r)},r.prototype.toJSON=function(t){},r.prototype.fromJSON=function(t,n,i,r,e){},n.SheetTabBase=r},"./dist/plugins/report/calc-model/calc-model.js":function(t,n,i){"use strict";var a,r,h,e,o,u;function s(t,n,i,r){this.hCi=!1;var e=this;e.vCi=n,e.dCi=i,e.POt=r,e.pCi(n,t),e.c5()}Object.defineProperty(n,"__esModule",{value:!0}),n.CalcModel=void 0,a=i("CalcEngine"),r=i("./dist/plugins/report/helpers/smart-cache.js"),h=i("./dist/plugins/report/utils/utils.js"),e=i("./dist/plugins/report/calc-model/helpers/hierarchical-cell-indexing-helper.js"),o=i("SheetsCalc"),s.prototype.pCi=function(t,n){var i=this,r;i.POt.setReportContext(t,i,new e.HierarchicalCellIndexingHelper(i,t,n))},s.prototype.wCi=function(){return this.POt.hierarchicalCellIndexingHelper},s.prototype.gCi=function(){this.c5(),this.hCi=!0},s.prototype.MCi=function(){this.hCi=!1},s.prototype.jCi=function(t){var n,t,n=this,t=(0,o.formulaToExpression)(n.POt.Mf.reportSheet.templateSheet,t);return this.ICi(n.POt.Mf.reportSheet,t),(0,o.expressionToFormula)(n.POt.Mf,t)},s.prototype.ICi=function(t,n){var i,r,e;if(8===n.type)this.xbe(t,n);else{if(n.arguments)for(i=0,r=n.arguments;i<r.length;i++)e=r[i],this.ICi(t,e);n.value&&this.ICi(t,n.value),n.value2&&this.ICi(t,n.value2)}},s.prototype.xbe=function(t,n){var i,r,e,o,t,i=t.parameter();if(i){for(o in e=n.value+"",i)i.hasOwnProperty(o)&&o.toUpperCase()===e.toUpperCase()&&(r=i[o]);void 0!==r&&("string"==(t=typeof r)?n.type=3:"boolean"==t?n.type=4:"number"==t?n.type=2:r instanceof Date&&(r=r.toString(),n.type=3),n.value=r)}},s.prototype.CCi=function(t){var n,i,r,e,o,u,s,c,f,n=this,i=(0,h.bCi)(t);if(!(0,h.ht)(i)){if(i=n.jCi(i),r=t.row,e=t.col,n.mCi.get(r,e)||n.yCi.get(r,e))return n.NCi.get(r,e);if((u=n.DCi)[r]){if(u[r][e])return a.Errors.Value}else u[r]=[];return i.startsWith("{")&&i.endsWith("}")?o=t.value:(u[r][e]=!0,s=n.dCi,f=(c=n.POt).getBaseRowCol(),c.setContext({row:r,col:e}),o=s.evaluate(c,i,0,0),u[r][e]=!1,this.POt.hierarchicalCellIndexingHelper.resetOffsetContent(),c.setContext(f)),n.NCi.set(r,e,o),n.yCi.set(r,e,!0),t.group.defaultFormula&&(t.group.defaultFormula=void 0,t.group.value=o,t.value=o),o}},s.prototype.OCi=function(t,n,i){var r,e,o,r=this,e=r.dCi,o=r.POt;return o.setContext({row:t,col:n}),i=r.jCi(i),e.evaluate(o,i,0,0)},s.prototype.Sl=function(t,n){return this.NCi.get(t,n)},s.prototype.ACi=function(t,n,i){this.mCi.set(t,n,!0),this.NCi.set(t,n,i),this.POt.hierarchicalCellIndexingHelper.resetRankCache(),this.reCalcCellsFrom(t,n)},s.prototype.TCi=function(t,n,i){var r,e,o;this.hCi&&(e=(r=this).ECi,o={row:n,col:i},t.forEach(function(t){var n=t.row,t=t.col;(0,h.ht)(e[n])&&(e[n]=[]),(0,h.ht)(e[n][t])?e[n][t]=[o]:e[n][t].push(o)}))},s.prototype.SCi=function(t,i){var r;this.hCi&&(r=this.ECi,t.forEach(function(t){var n=t.row,t=t.col;(0,h.ht)(r[n])&&(r[n]=[]),(0,h.ht)(r[n][t])?r[n][t]=[i]:r[n][t].push(i)}))},s.prototype.eG=function(){var t=this;t.NCi=h.KEYWORD_UNDEFINED,t.dCi=h.KEYWORD_UNDEFINED,t.POt.destroy(),t.POt=h.KEYWORD_UNDEFINED,t.yCi=h.KEYWORD_UNDEFINED,t.ECi=h.KEYWORD_UNDEFINED,t.mCi=h.KEYWORD_UNDEFINED,t.DCi=h.KEYWORD_UNDEFINED},s.prototype.c5=function(){var t=this;t.NCi=new r.SmartCache,t.yCi=new r.SmartCache,t.mCi=new r.SmartCache,t.POt.hierarchicalCellIndexingHelper.reset(),t.ECi=[],t.DCi=[]},s.prototype.fillCellsDependsOnCurrentCell=function(t,n,i,r){var e,o,u,s,e=this,o=e.ECi,u=o[t]&&o[t][n];(r=r||{})[t+"-"+n]=!0,u&&(s=function(t){var n=t.row,t=t.col;(0,h.ht)(o[n])||(0,h.ht)(o[n][t])||r[n+"-"+t]?i.push({row:n,col:t}):e.fillCellsDependsOnCurrentCell(n,t,i,r)},u.forEach(function(t){Array.isArray(t)?t.forEach(function(t){s(t)}):s(t)}))},s.prototype.reCalcCellsFrom=function(t,n){var i,r,i=this,r=[];i.yCi.reset(),i.fillCellsDependsOnCurrentCell(t,n,r),r.forEach(function(t){var t=i.vCi.getCell(t.row,t.col);i.CCi(t)})},n.CalcModel=s},"./dist/plugins/report/calc-model/calc-source.js":function(t,n,i){"use strict";var r,e,b,O,S,o,m,y,R,u,s,c;function f(t,n,i){var n=c.call(this,t,n,i)||this;return n.Mf=t,n}function L(t,n,i){var r,e,o,u;if(t.arguments&&t.arguments.some(function(t){return t===n||8===t.type&&i.getCustomName(t.value)===n})||t.value===n||t.value2===n)return t.functionName;if(t.arguments)for(r=0,e=t.arguments;r<e.length;r++)if(u=L(o=e[r],n,i))return u;return t.value&&(u=L(t.value,n,i))||t.value2&&(u=L(t.value2,n,i))?u:void 0}r=this&&this.__extends||(s=function(t,n){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),e=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||((o=o||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.ReportCalcSource=void 0,b=i("CalcEngine"),O=i("./dist/plugins/report/utils/utils.js"),S=i("Core"),o=i("SheetsCalc"),m=i("./dist/plugins/report/data-model/helpers/merge-range-utils.js"),R=e(["ROW","ROWS","COLUMN","COLUMNS","INDEX","SUMIF","SUMIFS","SCATTERSPARKLINE","BOXPLOTSPARKLINE","MONTHSPARKLINE","YEARSPARKLINE","HISTOGRAMSPARKLINE","RANGEBLOCKSPARKLINE"],y=["R.INDEX","R.RANK","R.R","R.A","R.V","R.PROPORTION","R.CUMULATIVE","R.YOY","R.MOM"],!0),c=o.SheetSource,r(f,c),f.prototype.setReportContext=function(t,n,i){this._Ci=t,this.xCi=n,this.hierarchicalCellIndexingHelper=i},f.prototype.getResolver=function(){return this.resolvers},f.prototype.evaluateReference=function(t,n,i){return this.btr(t,n,i)},f.prototype.btr=function(t,n,i,r){var e,o,u,s,c,f,a,h,l,v,d,p,w,I,M,g,C,o,I,i,e,o,N,E,j,A,T,D;if(void 0===r&&(r=!1),o=(e=this).DJ,u=e._Ci,s=e.xCi,c=isNaN(n.row)?0:n.row,f=isNaN(n.column)?0:n.column,d=t.getRange&&t.getRange(c,f),h=(0===c&&0===f||!t.rowRelative&&!t.columnRelative?(a=d.row,d):(a=(p=u.getCell(c,f)).cellNode.templateCell.row,p.cellNode.templateCell)).col,l=d.rowCount,v=d.colCount,w=t.source||n.source,I=n.WK,g=o?(M=o.row,o.col):(M=n.row,n.column),o=I&&t instanceof b.ReferenceExpression?L(I,t,n.source)||I.functionName:"",R.includes(o)){if(i||n.arrayFormulaMode)return I=void 0,t.endSource&&(I=n.getSheetRangeReference({source:t.source,endSource:t.endSource,row:d.row,col:d.col,rowCount:d.rowCount,colCount:d.colCount})),!((I=n.getReference(w,d))instanceof b.CalcReference)||(C=e._4i(I,M,g),this.Otr(C),y.includes(o))?I:C.length?(i=!(0,m.kOi)(C[0]),n.getReference(w,(0,m.GOi)(C,i)[0])):n.getReference(w,new S.Range(0,0,0,0));if(1<l||1<v){if(e=c>=d.row&&c<d.row+l,o=f>=d.col&&f<d.col+v,e&&o)a=c,h=f;else{if(!e&&!o)return b.Errors.Value;if(e&&1===v)a=c;else{if(!o||1!==l)return b.Errors.Value;h=f}}n.WK&&n.WK.ensureSingle&&(t.$9t=!0)}else if(-1===d.row&&-1===l){if(1!==v)return b.Errors.Value;a=c}else if(-1===d.col&&-1===v){if(1!==l)return b.Errors.Value;h=f}return a===M&&h===g?null:((C=u.getCells(a,h,M,g))&&C.length&&this.Otr(C),r?void 0:w.getValue(a,h))}if(d){for(N=[],E=0;E<l;E++)for(j=0;j<v;j++)if(C=u.getCells(a+E,h+j,M,g))for(this.Otr(C),A=0,T=C;A<T.length;A++)p=T[A],D=(0,O.bCi)(p)?s.CCi(p):p.value,r||(Array.isArray(D)?D.forEach(function(t){N.push(t)}):N.push(D));return r?void 0:new b.TwoDimensionalCalcArray([N])}return b.Errors.Reference},f.prototype.getSheet=function(){return this.Mf},f.prototype.getBaseRowCol=function(){var t=this.DJ;if(t)return{row:t.row,col:t.col}},f.prototype.getValue=function(t,n){var i,r,i,i=this._Ci,r=this.xCi,i=i.getCell(t,n);if(i)return(0,O.bCi)(i)?r.CCi(i):i.value},f.prototype.getCustomFunction=function(t){return this.Mf?this.Mf.Jbt(t):null},f.prototype.op=function(){return this.getCalcService()},f.prototype.setContext=function(t){this.DJ=t},f.prototype.destroy=function(){this.xCi=O.KEYWORD_UNDEFINED,this.DJ=O.KEYWORD_UNDEFINED,this.resolvers=O.KEYWORD_UNDEFINED,this._Ci=O.KEYWORD_UNDEFINED},f.prototype.updateBranchPrecedents=function(t,n,i){var r,e,o,u,r=this;if(1===t.type)r.btr(t,n,i,!0);else{if(t.arguments)for(e=0,o=t.arguments;e<o.length;e++)1===(u=o[e]).type?r.btr(u,n,i,!0):r.updateBranchPrecedents(u,n,i);t.value&&r.updateBranchPrecedents(t.value,n,i),t.value2&&r.updateBranchPrecedents(t.value2,n,i)}},f.prototype.Otr=function(t){var n,i,r,e,o,i;this.DJ&&(r=(i=(n=this).DJ).row,e=i.col,o=i.formula,i=i.triggerUpdatePrecedents,n.xCi.TCi(t,r,e),i)&&S.Worksheet.et(n.getSheet(),"updatePrecedents",{row:r,col:e,cells:t,formula:o})},f.prototype._4i=function(t,n,i){for(var r,e,o,u,s,c,f,a,r=t.getRow(),e=t.getColumn(),o=r+t.getRowCount()-1,u=e+t.getColumnCount()-1,s=this.Mf.reportSheet.templateSheet,c=this._Ci,f=[];r<=o;r++){for(;e<=u;e++)(a=s.getSpan(r,e))&&(a.row!==r||a.col!==e)||c.getCells(r,e,n,i).forEach(function(t){f.push(t)});e=t.getColumn()}return f},n.ReportCalcSource=f},"./dist/plugins/report/calc-model/helpers/hierarchical-cell-indexing-helper.js":function(t,n,i){"use strict";var S,m,i,y,h,r,i;function R(){return S.Functions.CALC_PRECISION||14}function e(t,n,i){this.zCi={},this._Ci=n,this.LCi=i,this.xCi=t,this.PCi={},this.ntr={}}Object.defineProperty(n,"__esModule",{value:!0}),n.HierarchicalCellIndexingHelper=void 0,S=i("CalcEngine"),m=i("./dist/plugins/report/utils/utils.js"),i=i("Common"),y=i.Common.st.E8,(i=h=h||{})[i.noJuxtaposition=0]="noJuxtaposition",i[i.nonSkippingNumber=1]="nonSkippingNumber",i[i.skipNumber=2]="skipNumber",e.prototype.getYearOverYear=function(t,n,i,r){for(var e,o,u,s,c,n,f,a,h,l,v,d,p,w,I,h,f,M,g,C,N,E,j,e,A,T,D,b,O,h,f,s,M,e=this,o=e._Ci,u=e.xCi,s=e.ntr,c=n.getRow(),n=n.getColumn(),f=e.LCi.reportSheet.getTemplate(),a=o.getCells(c,n,t.row,t.col)[0],h=i||r,l=o.getCells(h.getRow(),h.getColumn(),a.row,a.col)[0],v=e.BCi({row:c,col:n},{row:i.getRow(),col:i.getColumn()},r&&{row:r.getRow(),col:r.getColumn()},{row:a.row,col:a.col}),d=-1,w=0,I=v.length;w<I;w++)if((p=v[w]).row===a.row&&p.col===a.col){d=w;break}if(d<0)return S.Errors.Reference;for(h=l.cellNode.templateCell,f=f.GCi(h.row,h.col),s[M=this.itr(t,{row:c,col:n},i&&{row:i.getRow(),col:i.getColumn()},r&&{row:r.getRow(),col:r.getColumn()})]||(s[M]=e.BCi({row:h.row,col:h.col},f.upParent,f.leftParent,{row:l.row,col:l.col})),C=-1,E=0,j=(g=s[M]).length;E<j;E++){if((N=g[E]).row===l.row&&N.col===l.col){N=g[E-1],C=E-1;break}if(N.row>l.row&&N.col>l.col)break}if(C<0)return 0;if(e=o.getCells(c,n,N.row,N.col),i&&r){for(A=[],T=o.getCells(r.getRow(),r.getColumn(),a.row,a.col)[0],D=0,b=e;D<b.length;D++)O=b[D],(0,m.kCi)(O.group,T.group)&&A.push(O);e=A}return(h=e[d])&&(u.TCi([h],t.row,t.col),void 0!==h.value&&u.hCi||(h.value=(0,m.bCi)(h)?u.CCi(h):h.value||null)),f=+a.value,s=h&&+h.value,isNaN(f)&&(f=0),isNaN(s)&&(s=0),M="number"==typeof(M=(0,m.calculationValue)(f,s,1))?y(M,R()):M},e.prototype.getMonthOverMonth=function(t,n,i,r){var e,o,u,s,c,n,f,o,a,h,l,v,d,e,c,n,e=this,o=e._Ci,u=e.xCi,s=e.ntr,c=n.getRow(),n=n.getColumn(),f=o.getCells(c,n,t.row,t.col)[0],o=this.itr(t,{row:c,col:n},i&&{row:i.getRow(),col:i.getColumn()},r&&{row:r.getRow(),col:r.getColumn()});for(s[o]||(s[o]=e.BCi({row:c,col:n},i&&{row:i.getRow(),col:i.getColumn()},r&&{row:r.getRow(),col:r.getColumn()},{row:f.row,col:f.col})),l=-1,v=0,d=(a=s[o]).length;v<d;v++){if((h=a[v]).row===f.row&&h.col===f.col){l=v-1;break}if(h.row>f.row&&h.col>f.col)break}return(h=(0,m.ht)(l)?null:a[l])&&(u.TCi([h],t.row,t.col),void 0!==h.value&&u.hCi||(h.value=(0,m.bCi)(h)?u.CCi(h):h.value||null)),e=+f.value,c=h&&+h.value,isNaN(e)&&(e=0),isNaN(c)&&(c=0),l<0?0:"number"==typeof(n=(0,m.calculationValue)(e,c,1))?y(n,R()):n},e.prototype.itr=function(t,n,i,r){var e,o,n,i,i,e,o=this._Ci,n="".concat(n.row,"_").concat(n.col,"_");return i&&(n=(i=o.getCells(i.row,i.col,t.row,t.col)[0])?"".concat(n).concat(i.row,"_").concat(i.col,"_"):n),n=r?(i=o.getCells(r.row,r.col,t.row,t.col)[0])?"".concat(n).concat(i.row,"_").concat(i.col,"_"):n:n},e.prototype.getCumulative=function(t,n,i,r){var e,o,u,s,c,n,f,o,a,h,l,v,d,p,w,I,e=this,o=e._Ci,u=e.xCi,s=e.ntr,c=n.getRow(),n=n.getColumn(),f=o.getCells(c,n,t.row,t.col)[0],o=this.itr(t,{row:c,col:n},i&&{row:i.getRow(),col:i.getColumn()},r&&{row:r.getRow(),col:r.getColumn()});for(s[o]||(s[o]=e.BCi({row:c,col:n},i&&{row:i.getRow(),col:i.getColumn()},r&&{row:r.getRow(),col:r.getColumn()},t)),l=-1,d=[],w=p=v=0,I=(a=s[o]).length;w<I;w++){if((h=a[w]).row===f.row&&h.col===f.col){l=w-1;break}if(h.row>f.row&&h.col>f.col)break;void 0!==h.value&&u.hCi||(h.value=(0,m.bCi)(h)?u.CCi(h):h.value||null),p=+h.value,isNaN(p)&&(p=0),d.push(h),v+=p}return(h=(0,m.ht)(l)?null:a[l])&&u.TCi(d,t.row,t.col),p=+f.value,isNaN(p)&&(p=0),(0,m.calculationValue)(p,h&&v,0)},e.prototype.getProportion=function(t,n,i,r){var e,o,u,s,c,n,o,f,t,c,a,h,l,e=this,o=e._Ci,u=e.xCi,s=e.ntr,c=n.getRow(),n=n.getColumn(),o=o.getCells(c,n,t.row,t.col)[0],f=o&&+o.value;for(isNaN(f)&&(f=0),s[t=this.itr(t,{row:c,col:n},i&&{row:i.getRow(),col:i.getColumn()},r&&{row:r.getRow(),col:r.getColumn()})]||(s[t]=e.BCi({row:c,col:n},i&&{row:i.getRow(),col:i.getColumn()},r&&{row:r.getRow(),col:r.getColumn()},{row:o.row,col:o.col})),a=0,h=c=s[t];a<h.length;a++)void 0===(l=h[a]).value&&(l.value=(0,m.bCi)(l)?u.CCi(l):l.value||null);return e.RCi(f,c)},e.prototype.BCi=function(t,n,i,r){var e,o,u,s,c,f,a,h,l,s,n,e,o=this._Ci,u=[];if(n&&i){for(s=o.getCells(n.row,n.col,r.row,r.col)[0],c=o.getCells(i.row,i.col,r.row,r.col)[0],a=0,h=f=o.getCells(t.row,t.col,s.row,s.col);a<h.length;a++)l=h[a],(0,m.kCi)(l.group,c.group)&&u.push(l);(0,m.FOi)(u,"V"===s.cellNode.templateCell.expansionDirection)}else n||i?(n=o.getCells((s=n||i).row,s.col,r.row,r.col)[0],u=o.getCells(t.row,t.col,n.row,n.col),(0,m.FOi)(u,"V"===n.cellNode.templateCell.expansionDirection)):(u=o.getCells(t.row,t.col),(0,m.FOi)(u,!0));return u},e.prototype.getIndex=function(t,n,i){var r,e,o,u,s,o,c,f,a,r=this,e=this,o=e._Ci,u=e.xCi,s=o.getCells(n.getRow(),n.getColumn(),t.row,t.col)[0],o=i?{row:i.getRow(),col:i.getColumn()}:null;return u.TCi([s],t.row,t.col),void 0!==s.value&&u.hCi||(s.value=(0,m.bCi)(s)?u.CCi(s):s.value||null),c=o?"-".concat(o.row,"-").concat(o.col):"",void 0===(f=this.zCi["".concat(s.row,"-").concat(s.col,"-").concat(c)])&&(a=e.ZCi(t,{row:n.getRow(),col:n.getColumn()},o)).forEach(function(t,n){r.zCi["".concat(t.row,"-").concat(t.col,"-").concat(c)]=n+1,t===s&&(f=n+1)}),f},e.prototype.getRank=function(t,n,i,r,e){var o,u,s,c,i,n,i,f,a,a,a,f,n,a;return void 0===e&&(e=1),s=(u=(o=this)._Ci).getCells(n.getRow(),n.getColumn(),t.row,t.col)[0],c=o.VCi(t,n,i),i=i instanceof S.CalcReference?{row:i.getRow(),col:i.getColumn()}:i,i=(n=o.ZCi(t,{row:n.getRow(),col:n.getColumn()},i)).length,(f=o.PCi[c])?(a=o._Ci.getCell(t.row,t.col).cellNode.templateCell,a="".concat(c,"_").concat(a.row,"_").concat(a.col),o.PCi[a]||(o.PCi[a]=f,o.UCi(n,t))):(a=[].concat(n),o.HCi(c,a,t),o.UCi(a,t)),(0,m.ht)(s.value)?null:(f=o.PCi[c])&&f[s.row]&&f[s.row][s.col]?(n=f[s.row][s.col],a=r?i-n.index+1:n.index,e===h.noJuxtaposition?a-=r?n.afterEmptyCellCount:n.beforeEmptyCellCount:e===h.skipNumber?a-=r?n.currentAfterEmptyCellCount:n.currentBeforeEmptyCellCount:r||(a=a+n.currentAfterEmptyCellCount-n.sameValueCount+n.currentAfterEmptyCellCount),a):void 0},e.prototype.coordinateExecute=function(t,n,i,r){var e,o,u,s,c,f,a,i,r,a,i,h,l,v,d,p,w,I,M,g,s,C,N,E,j,A,a,i,h,e=this,o=e._Ci,u=e.WCi,s=e.LCi.reportSheet.getTemplate(),c=e.xCi,f=e._Ci;if(e.resetOffsetContent(),i||r)return(a=o.getCells(n.getRow(),n.getColumn(),t.row,t.col)[0])?(i=e.BCi({row:n.getRow(),col:n.getColumn()},i&&{row:i.getRow(),col:i.getColumn()},r&&{row:r.getRow(),col:r.getColumn()},{row:a.row,col:a.col}),e.QCi(i,t)):S.Errors.Null;if(!u||!u.length)return e.QCi(o.getCells(n.getRow(),n.getColumn()),t);for(r=u[0].parent,a=o.getCells(r.row,r.col,t.row,t.col)[0],(i=s.GCi(a.cellNode.templateCell.row,a.cellNode.templateCell.col)).leftParent&&i.upParent?h=(v="H"===a.cellNode.templateCell.expansionDirection)?i.upParent:i.leftParent:(i.leftParent||i.upParent)&&(h=i.leftParent||i.upParent),h&&(l=o.getCells(h.row,h.col,t.row,t.col)[0]),d=[],p=[],w=0,I=u.length;w<I&&(M=u[w],!l||e.FCi(M.parent,{row:l.cellNode.templateCell.row,col:l.cellNode.templateCell.col})||(d.push(l),l=null),l=e.getCell(t,l,M));w++);if(0<d.length&&l){for(d.push(l),s=d[0],C=d[1],E=0,j=N=f.getCells(n.getRow(),n.getColumn(),s.row,s.col);E<j.length;E++)A=j[E],(0,m.kCi)(A.group,C.group)&&p.push(A);g=e.YCi(p,{row:n.getRow(),col:n.getColumn()},d,t)}else l&&(a=o.getCell(t.row,t.col),i=e.FCi({row:a.cellNode.templateCell.row,col:a.cellNode.templateCell.col},r),g=e.getCell(t,l,{parent:{row:n.getRow(),col:n.getColumn()},offset:0,isAbsolute:!1},!i));return g?g instanceof Array?e.QCi(g,t):(c.TCi([g],t.row,t.col),void 0!==(h=e.LCi.getValue(g.row,g.col))&&c.hCi?h:(0,m.bCi)(g)?c.CCi(g):g.value||null):null},e.prototype.getCell=function(t,n,i,r){var e,o,u,s,i,c,f,a,e,h,l,v,e=this,o=e._Ci,u=i.parent,s=i.isAbsolute,i=i.offset,c=n?{row:n.cellNode.templateCell.row,col:n.cellNode.templateCell.col}:null,f=e.ZCi(t,u,c),a=o.getCells(u.row,u.col,t.row,t.col)[0],e=o.getCells(u.row,u.col,n&&n.row,n&&n.col);if(!a||r)return e;for(h=void 0,l=0,v=f.length;l<v;l++)if(f[l]===a){h=l;break}if(s){if(!i)return null;h=0<i?i-1:e.length+i}else h+=i;return e[h]},e.prototype.QCi=function(t,n){for(var i,r,e,o,u,s,i=this.xCi,r=[],o=0,u=t;o<u.length;o++)s=u[o],void 0!==(e=this.LCi.getValue(s.row,s.col))&&i.hCi||(e=(0,m.bCi)(s)?i.CCi(s):s.value||null),Array.isArray(e)?e.forEach(function(t){r.push(t)}):r.push(e);return i.TCi(t,n.row,n.col),new S.TwoDimensionalCalcArray([r])},e.prototype.YCi=function(t,n,i,r){var e,o,u,s,i,e,r,c,f,a,e=this,o=e._Ci,u=o.getCell(r.row,r.col),s=i[0],i=i[1];if(!e.FCi({row:u.cellNode.templateCell.row,col:u.cellNode.templateCell.col},s)&&!e.FCi({row:u.cellNode.templateCell.row,col:u.cellNode.templateCell.col},i))return t;for(e=o.getCells(n.row,n.col,r.row,r.col)[0],r=o.getCells(s.cellNode.templateCell.row,s.cellNode.templateCell.col,e.row,e.col)[0],c=o.getCells(i.cellNode.templateCell.row,i.cellNode.templateCell.col,e.row,e.col)[0],f=o.getCells(n.row,n.col,r.row,r.col),a=0;a<f.length;a++)if((0,m.kCi)(u.group,c.group))return t[a]},e.prototype.FCi=function(t,n){var i,r,e,i=this,r,e=i.LCi.reportSheet.getTemplate().GCi(t.row,t.col);return e.leftParent?e.leftParent.row===n.row&&e.leftParent.col===n.col||i.FCi(t,e.leftParent):!!e.upParent&&(e.upParent.row===n.row&&e.upParent.col===n.col||i.FCi(t,e.upParent))},e.prototype.coordinateOffset=function(t,n,i){var r,e,r=this;r.WCi=r.WCi||[],(e=r.WCi).push({parent:{row:t.getRow(),col:t.getColumn()},offset:n,isAbsolute:i})},e.prototype.reset=function(){this.JCi(),this.resetRankCache(),this.resetOffsetContent(),this.ntr={}},e.prototype.resetRankCache=function(){this.PCi={}},e.prototype.resetOffsetContent=function(){this.WCi=void 0},e.prototype.JCi=function(){this.zCi={}},e.prototype.HCi=function(t,n,i){for(var r,e,o,u,s,c,f,a,h,l,v,d,p,w,I,r=this,e=r.PCi,o=r.xCi,u=e[t]=[],c=0,f=n;c<f.length;c++)a=f[c],o.TCi([a],i.row,i.col),a.value=(0,m.bCi)(a)?o.CCi(a):a.value||null;for((n=n.filter(function(t){return!(0,m.ht)(t.value)})).sort(function(t,n){return t.value>n.value?1:-1}),l=n.length,p=d=v=h=0;v<l;v++)u[(s=n[v]).row]||(u[s.row]=[]),v&&s.value===n[v-1].value?(d++,p++,h++):p=h=0,u[s.row][s.col]={index:v+1,sameValueCount:h,beforeEmptyCellCount:d,currentBeforeEmptyCellCount:p};for(v=l-1,I=w=0;-1<v;v--)s=n[v],v<l-1&&s.value===n[v+1].value?(w++,I++,h++):I=h=0,u[s.row][s.col].afterEmptyCellCount=w,u[s.row][s.col].currentAfterEmptyCellCount=I,u[s.row][s.col].sameValueCount+=h},e.prototype.UCi=function(t,n){var i,n,n,i=this,n=i._Ci.getCell(n.row,n.col),n=i._Ci.getCells(n.cellNode.templateCell.row,n.cellNode.templateCell.col).map(function(t){return{row:t.row,col:t.col}});i.xCi.SCi(t,n)},e.prototype.VCi=function(t,n,i){var r,e,t,o,e,r,e=this._Ci,t=e.getCells(n.getRow(),n.getColumn(),t.row,t.col)[0],o="";return i instanceof S.CalcReference&&(e=e.getCells(i.getRow(),i.getColumn(),t.row,t.col)[0],o=m.CONNECTOR+e.row+m.CONNECTOR+e.col),n.getRow()+m.CONNECTOR+n.getColumn()+o},e.prototype.ZCi=function(t,n,i){var r,e,o,u,i,r,e=this._Ci,o=e.getCells(n.row,n.col,t.row,t.col)[0],u=[];return u=i?(i=e.getCells(i.row,i.col,t.row,t.col)[0],e.getCells(o.cellNode.templateCell.row,o.cellNode.templateCell.col,i.row,i.col)):e.getCells(n.row,n.col)},e.prototype.RCi=function(t,n){for(var i,r,e,o,u,n,i=0,e=0,o=n;e<o.length;e++)r=+(u=o[e]).value,isNaN(r)&&(i+=0),i+=r;return n="number"==typeof(n=(0,m.calculationValue)(t,i,1))?y(n,R()):n},n.HierarchicalCellIndexingHelper=e},"./dist/plugins/report/calc-model/supported-functions.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.reportSupportFunctionNames=void 0,n.reportSupportFunctionNames=["SUM","EOMONTH","ISBLANK","NORMINV","COUNT","ISOWEEKNUM","ISERR","PEARSON","AVERAGE","NETWORKDAYS","ISERROR","PERCENTILE.EXC","CHAR","NETWORKDAYS.INTL","ISEVEN","PERCENTILE.INC","DATE","TIMEVALUE","ISFORMULA","PERCENTRANK.EXC","MAX","WEEKNUM","ISLOGICAL","PERCENTRANK.INC","MIN","WORKDAY","ISNA","PERMUT","TIME","WORKDAY.INTL","ISNONTEXT","PERMUTATIONA","ABS","YEARFRAC","ISNUMBER","PHI","CEILING","BESSELI","ISODD","POISSON.DIST","COMBIN","BESSELJ","ISTEXT","PROB","EVEN","BESSELK","N","QUARTILE.EXC","EXP","BESSELY","NA","QUARTILE.INC","FACT","BIN2DEC","SHEET","RANK.AVG","FLOOR","BIN2HEX","SHEETS","RANK.EQ","INT","BIN2OCT","FALSE","RSQ","LN","BITAND","IFERROR","SKEW","LOG","BITLSHIFT","IFNA","SKEW.P","LOG10","BITOR","IFS","SLOPE","MOD","BITRSHIFT","NOT","SMALL","PI","BITXOR","TRUE","STANDARDIZE","POWER","COMPLEX","XOR","STDEV.P","PRODUCT","CONVERT","ADDRESS","STDEV.S","RAND","DEC2BIN","COLUMN","STDEVA","RANDBETWEEN","DEC2HEX","COLUMNS","STDEVPA","ROUND","DEC2OCT","FORMULATEXT","STEYX","ROUNDDOWN","DELTA","HYPERLINK","T.DIST","ROUNDUP","ERF","ROWS","T.DIST.2T","SIGN","ERF.PRECISE","ACOT","T.DIST.RT","ODD","ERFC","ACOTH","T.INV","SQRT","ERFC.PRECISE","ARABIC","T.INV.2T","SUMSQ","GESTEP","BASE","T.TEST","TRUNC","HEX2BIN","CEILING.MATH","TRIMMEAN","SIN","HEX2DEC","CEILING.PRECISE","VAR.P","COS","HEX2OCT","COMBINA","VAR.S","TAN","IMABS","COT","VARA","SINH","IMAGINARY","COTH","VARPA","COSH","IMARGUMENT","CSC","WEIBULL.DIST","TANH","IMCONJUGATE","CSCH","Z.TEST","ASIN","IMCOS","DECIMAL","ASC","ACOS","IMCOSH","FACTDOUBLE","BAHTTEXT","ATAN","IMCOT","FLOOR.MATH","CLEAN","ATAN2","IMCSC","FLOOR.PRECISE","CONCAT","ASINH","IMCSCH","GCD","DBCS","ACOSH","IMDIV","ISO.CEILING","DOLLAR","ATANH","IMEXP","LCM","FINDB","DEGREES","IMLN","MROUND","FIXED","RADIANS","IMLOG10","MULTINOMIAL","JIS","CODE","IMLOG2","QUOTIENT","LEFTB","CONCATENATE","IMPOWER","ROMAN","LENB","EXACT","IMPRODUCT","SEC","MIDB","FIND","IMREAL","SECH","REPLACEB","LEFT","IMSEC","SERIESSUM","REPT","LEN","IMSECH","SQRTPI","RIGHTB","LOWER","IMSIN","SUMIF","SEARCH","MID","IMSINH","SUMIFS","SEARCHB","PROPER","IMSQRT","SUMPRODUCT","T","REPLACE","IMSUB","SUMX2MY2","TEXT","RIGHT","IMSUM","SUMX2PY2","TEXTJOIN","SUBSTITUTE","IMTAN","SUMXMY2","UNICHAR","TRIM","OCT2BIN","AVEDEV","UNICODE","UPPER","OCT2DEC","AVERAGEA","ENCODEURL","DATEDIF","OCT2HEX","AVERAGEIF","WEBSERVICE","DAY","ACCRINT","AVERAGEIFS","EURO","DAYS360","ACCRINTM","BETA.DIST","EUROCONVERT","HOUR","AMORDEGRC","BETA.INV","ISOMITTED","MINUTE","AMORLINC","BINOM.DIST","LAMBDA","MONTH","COUPDAYBS","BINOM.DIST.RANGE","OBJECT","NOW","COUPDAYS","BINOM.INV","PROPERTY","SECOND","COUPDAYSNC","CHISQ.DIST","REFRESH","TODAY","COUPNCD","CHISQ.DIST.RT","REDUCE","WEEKDAY","COUPNUM","CHISQ.INV","SCAN","YEAR","COUPPCD","CHISQ.INV.RT","CHITEST","AND","CUMIPMT","CHISQ.TEST","MEDIAN","IF","CUMPRINC","CONFIDENCE.NORM","RANGEBLOCKSPARKLINE","OR","DB","CONFIDENCE.T","RANK","SWITCH","DDB","COUNTA","HBARSPARKLINE","ROW","DISC","COUNTBLANK","VBARSPARKLINE","VALUE","DOLLARDE","COUNTIF","VARISPARKLINE","CORREL","DOLLARFR","COUNTIFS","PIESPARKLINE","BETADIST","DURATION","COVARIANCE.P","AREASPARKLINE","BETAINV","EFFECT","COVARIANCE.S","SCATTERSPARKLINE","BINOMDIST","FV","DEVSQ","LINESPARKLINE","CHIDIST","FVSCHEDULE","EXPON.DIST","COLUMNSPARKLINE","CONFIDENCE","INTRATE","F.DIST","WINLOSSSPARKLINE","COVAR","IPMT","F.DIST.RT","BULLETSPARKLINE","CRITBINOM","IRR","F.INV","SPREADSPARKLINE","EXPONDIST","ISPMT","F.INV.RT","STACKEDSPARKLINE","FDIST","MDURATION","F.TEST","BOXPLOTSPARKLINE","FTEST","MIRR","FINV","CASCADESPARKLINE","GAMMADIST","NOMINAL","FISHER","PARETOSPARKLINE","GAMMAINV","NPER","FISHERINV","MONTHSPARKLINE","HYPGEOMDIST","NPV","FORECAST","YEARSPARKLINE","MODE","ODDFPRICE","GAMMA","GAUGEKPISPARKLINE","NEGBINOMDIST","ODDFYIELD","GAMMA.DIST","HISTOGRAMSPARKLINE","NORM.INV","ODDLPRICE","GAMMA.INV","STDEV","NORMDIST","ODDLYIELD","GAMMALN","BC_QRCODE","NORMSDIST","PDURATION","GAMMALN.PRECISE","BC_EAN13","NORMSINV","PMT","GAUSS","BC_EAN8","PERCENTILE","PPMT","GEOMEAN","BC_CODABAR","PERCENTRANK","PRICE","GROWTH","BC_CODE39","POISSON","PRICEDISC","HARMEAN","BC_CODE93","QUARTILE","PRICEMAT","HYPGEOM.DIST","BC_CODE128","STDEVP","PV","INTERCEPT","BC_GS1_128","TDIST","RATE","KURT","BC_CODE49","TINV","RECEIVED","LARGE","BC_PDF417","TTEST","RRI","LOGNORM.DIST","BC_DATAMATRIX","VAR","SLN","LOGNORM.INV","LET","VARP","SYD","MAXA","IMAGE","WEIBULL","TBILLEQ","MAXIFS","TEXTBEFORE","ZTEST","TBILLPRICE","MINA","TEXTAFTER","CHIINV","TBILLYIELD","MINIFS","TEXTSPLIT","CHIDIST","VDB","MODE.MULT","GC.REGEXEXTRACT","LOGINV","XIRR","MODE.SNGL","GC.REGEXMATCH","LOGNORMDIST","XNPV","NEGBINOM.DIST","GC.REGEXREPLACE","DATEPART","YIELD","NORM.DIST","SJS.UUID","DATEVALUE","YIELDDISC","NORM.S.DIST","SJS.ENDWITH","DAYS","YIELDMAT","NORM.S.INV","SJS.STARTWITH","EDATE","ERROR.TYPE","SJS.REGEXEXTRACT","SJS.REGEXMATCH","SJS.REGEXREPLACE","R.R","R.A","R.V","R.INDEX","R.RANK","R.CURRENTPAGE","R.PAGESCOUNT","R.PROPORTION","R.CUMULATIVE","R.MOM","R.YOY"]},"./dist/plugins/report/commands/add-record.js":function(t,n,i){"use strict";var r,e,u,s,i,o,c,f,a;function h(t,n){return a.call(this,t,n)||this}function l(t){var n="reportSheetAddRecord";e.Commands[n]={canUndo:!1,execute:function(t,n,i){return o(t,c,n,i)}},t.register(n,e.Commands[n])}r=this&&this.__extends||(f=function(t,n){return(f=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}f(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.registerAddRecordCommand=void 0,e=i("Core"),u=i("./dist/plugins/report/events/index.js"),s=i("./dist/plugins/report/worksheet/report-worksheet.js"),i=e.Commands.ActionBase,o=e.Commands.zA,r(h,a=i),h.prototype.execute=function(){var t,n,i,r,n,e,o;this.Mf&&this.Mf instanceof s.ReportWorksheet&&this.tT&&(t=this.Mf,n=this.tT,i=n.activeRow,r=n.activeCol,n=(0,u.KCi)(i,r,function(){t.reportSheet.addRecordAt(i,r)}),e=n.name,o=n.event,setTimeout(function(){t.ki(e,o),o.canceled||o.addRecordSingleUseAction()}))},c=h,n.registerAddRecordCommand=l},"./dist/plugins/report/commands/delete-record.js":function(t,n,i){"use strict";var r,e,u,s,i,o,c,f,a;function h(t,n){return a.call(this,t,n)||this}function l(t){var n="reportSheetDeleteRecord";e.Commands[n]={canUndo:!1,execute:function(t,n,i){return o(t,c,n,i)}},t.register(n,e.Commands[n])}r=this&&this.__extends||(f=function(t,n){return(f=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}f(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.registerDeleteRecordCommand=void 0,e=i("Core"),u=i("./dist/plugins/report/events/index.js"),s=i("./dist/plugins/report/worksheet/report-worksheet.js"),i=e.Commands.ActionBase,o=e.Commands.zA,r(h,a=i),h.prototype.execute=function(){var t,n,i,r,n,e,o;this.Mf&&this.Mf instanceof s.ReportWorksheet&&this.tT&&(t=this.Mf,n=this.tT,i=n.activeRow,r=n.activeCol,n=(0,u.XCi)(i,r,function(){t.reportSheet.deleteRecordAt(i,r)}),e=n.name,o=n.event,setTimeout(function(){t.ki(e,o),o.canceled||o.deleteRecordSingleUseAction()}))},c=h,n.registerDeleteRecordCommand=l},"./dist/plugins/report/commands/index.js":function(t,n,i){"use strict";var r,e,o,u,s,c;function f(t){(0,r.registerAddRecordCommand)(t),(0,e.registerDeleteRecordCommand)(t),(0,s.registerResetRecordCommand)(t),(0,c.registerSubmitCommand)(t),(0,u.registerCollapseCommand)(t),(0,o.registerRegenerateReportCommand)(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.registerCommands=void 0,r=i("./dist/plugins/report/commands/add-record.js"),e=i("./dist/plugins/report/commands/delete-record.js"),o=i("./dist/plugins/report/commands/regenerate-report.js"),u=i("./dist/plugins/report/commands/report-collapse.js"),s=i("./dist/plugins/report/commands/reset-current-cell.js"),c=i("./dist/plugins/report/commands/submit.js"),n.registerCommands=f},"./dist/plugins/report/commands/regenerate-report.js":function(t,n,i){"use strict";var r,e,o,i,u,s,c,f;function a(t,n){return f.call(this,t,n)||this}function h(t){var n="reportSheetRegenerateReport";e.Commands[n]={canUndo:!1,execute:function(t,n,i){return u(t,s,n,i)}},t.register(n,e.Commands[n])}r=this&&this.__extends||(c=function(t,n){return(c=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}c(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.registerRegenerateReportCommand=void 0,e=i("Core"),o=i("./dist/plugins/report/worksheet/report-worksheet.js"),i=e.Commands.ActionBase,u=e.Commands.zA,r(a,f=i),a.prototype.execute=function(){var t;this.Mf&&this.Mf instanceof o.ReportWorksheet&&this.tT&&this.Mf.reportSheet.regenerateReport()},s=a,n.registerRegenerateReportCommand=h},"./dist/plugins/report/commands/report-collapse.js":function(t,n,i){"use strict";var r,e,i,o,u,s,c;function f(t,n){return c.call(this,t,n)||this}function a(t){var n="ReportCollapseButtonToggle";e.Commands[n]={canUndo:!1,execute:function(t,n,i){return o(t,u,n,i)}},t.register(n,e.Commands[n])}r=this&&this.__extends||(s=function(t,n){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}s(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.registerCollapseCommand=void 0,e=i("Core"),i=e.Commands.ActionBase,o=e.Commands.zA,r(f,c=i),f.prototype.execute=function(){var t,n,i,t,r,n,t=this,n=t.tT,i=!1;return t.canExecute()&&(t=t.Mf,r=n.row,n=n.col,t.$Ci(r,n)),i=!0},u=f,n.registerCollapseCommand=a},"./dist/plugins/report/commands/reset-current-cell.js":function(t,n,i){"use strict";var r,e,o,u,i,s,c,f,a;function h(t,n){return a.call(this,t,n)||this}function l(t){var n="reportSheetResetCellValue";e.Commands[n]={canUndo:!1,execute:function(t,n,i){return s(t,c,n,i)}},t.register(n,e.Commands[n])}r=this&&this.__extends||(f=function(t,n){return(f=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}f(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.registerResetRecordCommand=void 0,e=i("Core"),o=i("./dist/plugins/report/events/index.js"),u=i("./dist/plugins/report/worksheet/report-worksheet.js"),i=e.Commands.ActionBase,s=e.Commands.zA,r(h,a=i),h.prototype.execute=function(){var f,t,n,i,r;this.Mf&&this.Mf instanceof u.ReportWorksheet&&this.tT&&(f=this.Mf,t=this.tT.selections,n=(0,o.qCi)(t,function(){Array.isArray(t)&&(f.reportSheet.suspendPaint(),t.forEach(function(t){for(var n,i,r,e,o,u,s,c,n=t.row,i=t.col,r,e,o=n+t.rowCount-1,u=i+t.colCount-1,s=n;s<=o;s++)for(c=i;c<=u;c++)f.reportSheet.resetCellValue(s,c)}),f.reportSheet.resumePaint())}),i=n.name,r=n.event,setTimeout(function(){f.ki(i,r),r.canceled||r.resetCellValueSingleUseAction()}))},c=h,n.registerResetRecordCommand=l},"./dist/plugins/report/commands/submit.js":function(t,n,i){"use strict";var r,e,o,i,u,s,c,f;function a(t,n){return f.call(this,t,n)||this}function h(t){var n="reportSheetSubmit";e.Commands[n]={canUndo:!1,execute:function(t,n,i){return u(t,s,n,i)}},t.register(n,e.Commands[n])}r=this&&this.__extends||(c=function(t,n){return(c=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}c(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.registerSubmitCommand=void 0,e=i("Core"),o=i("./dist/plugins/report/worksheet/report-worksheet.js"),i=e.Commands.ActionBase,u=e.Commands.zA,r(a,f=i),a.prototype.execute=function(){var t;this.Mf&&this.Mf instanceof o.ReportWorksheet&&this.tT&&this.Mf.reportSheet.submit()},s=a,n.registerSubmitCommand=h},"./dist/plugins/report/convertors/report-json-convertor.js":function(t,n,i){"use strict";var a,l,c,r,v,e;function o(t){this.oOi=!1,this.cOi=t,this.workSheetConvertor=new r.WorkSheetConvertor(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.ReportJSONConvertor=void 0,a=i("Core"),l=i("./dist/plugins/report/print/print-sheet.js"),c=i("./dist/plugins/report/utils/utils.js"),r=i("./dist/plugins/report/convertors/worksheet-convertor.js"),v=i("Print"),o.prototype.Np=function(t){var n,i,r,e,o,u,s,c,f,a,u,s,n,h,u,n=this,i=n.cOi,r=n.workSheetConvertor,e={},o=i.options.dirtyStyle,u=(t=t||{}).gp,s="PaginatedPreview"===i.renderMode(),c="Preview"===i.renderMode(),f=t.convertReportSheetToWorksheet;if(u){if(s){if(i.options.printAllPages)return this.oOi?(this.fOi?this.hOi():this.fOi=n.aOi(t,i.name()),this.fOi):n.aOi(t,i.name());u=i.templateSheet.printInfo(),s=new v.PrintInfo,n=i.Mf.Pie,s.fromJSON(u.toJSON()),s.fitPagesTall(1),s.fitPagesWide(1),s.sheet(i.Mf),i.Mf.Pie=s,a=i.Mf.toJSON(t),i.Mf.Pie=n}if(c)return(u=(h=r.lOi(t)).printInfo())&&(u.showRowHeader(1),u.showColumnHeader(1)),new l.PrintSheet(h).toJSON(t)}return a=f?(c?h=r.lOi(t):i.Mf).toJSON(t):a||i.templateSheet.toJSON(t),e.template=a,e.reportName=t.newWorkSheetName||i.name(),e.name=t.newWorkSheetName||i.name(),e.sheetType=i._gi,e.renderMode=i.options.renderMode,e.printAllPages=i.options.printAllPages,o&&(e.dirtyStyle=o.toJSON()),e.parameter=i.ghe,e.parameterUI=i.vOi,e},o.prototype.wh=function(t,n,i){var r,e,o,u,s,c,f,r,r=this,e=r.cOi,o=r.workSheetConvertor,s=e.options.dirtyStyle,c=n.styleManager;return i&&i.gp&&"PaginatedPreview"===e.renderMode()&&e.options.printAllPages?r.aOi(i,e.name()):(i&&(i.gp||i.fileType===a.OpenSaveFileType.excel)?((u=("Design"!==e.options.renderMode&&"Preview"===e.options.renderMode?f=o.lOi(i):e.Mf).wh(t,n,i)).lossless||(u.lossless={}),u.lossless.reportLossless={}):(e.templateSheet!==e.Mf&&e.templateSheet.b2(e.b2(),!1),(u=e.templateSheet.wh(t,n,i)).lossless||(u.lossless={}),u.lossless.reportLossless={reportName:e.name()}),u.lossless.sheetType=e._gi,(r=u.lossless.reportLossless).renderMode=e.options.renderMode,r.printAllPages=e.options.printAllPages,s&&(r.dirtyStyle=c.getStyleIndex(s,3,e.name())),r.parameter=e.ghe,r.parameterUI=e.vOi,u)},o.prototype.Zme=function(t,n,i,r,e){var o,u=this.cOi,s;u.options.renderMode=t.renderMode,u.dOi(t.template,null,(null==r?void 0:r.gp)||(null==r?void 0:r.sb)),t.dirtyStyle&&(s=new a.Style).fromJSON(t.dirtyStyle,i&&i.noSchema,null),(0,c.ht)(t.reportName)||(u.name(t.reportName),u.templateSheet.name(t.reportName)),u.options.dirtyStyle=s,u.options.printAllPages=t.printAllPages,u.ghe=t.parameter,u.vOi=t.parameterUI,(0,c.pOi)(u.templateSheet),"Design"!==u.renderMode()&&(r&&(r.gp||r.sb)?u.regenerateReport():u.fetchAllTablesAsync().then(function(){u.getParent()&&u.regenerateReport()}))},o.prototype.yh=function(t,n,i){var r,e,o,u,t,s,r,e=this.cOi,o=t.lossless&&t.lossless.reportLossless;o&&(u=a.util.o1(t,"sheetViews&sheetView"),e.options.renderMode=o.renderMode,e.dOi(t,{sjsCommonInfo:n,openOptions:i}),e.b2(!(!u||"1"!==u.tabSelected)),t=n.styleManager,(0,c.ht)(o.reportName)||(e.name(o.reportName),e.templateSheet.name(o.reportName)),o.dirtyStyle&&(e.options.dirtyStyle=t.getStyle(o.dirtyStyle)),e.options.printAllPages=o.printAllPages,e.ghe=o.parameter,e.vOi=o.parameterUI,s=a.Util.wo(i,e.getParent().v2))&&e.fetchAllTablesAsync().then(function(){e.getParent()&&e.regenerateReport()})},o.prototype.hOi=function(){for(var t,n,i,r,e,o,u,s,c,t,n=this.cOi,i=this.fOi,r=n.printInfo(),e=r.pageRange(),o=0,u=i;o<u.length;o++)(c=(s=u[o]).sheet.printInfo).pageRange=e,c.pageHeaderFooter=r.pageHeaderFooter()},o.prototype.wOi=function(t){return this.oOi=!!t,t||(this.fOi=void 0),this.oOi},o.prototype.aOi=function(i,r){var e=this.cOi;return e.reportWorksheet.paginationHelper.Gf().gOi().filter(function(t,n){return 0===e.printPageIndexArray.length||-1!==e.printPageIndexArray.indexOf(n)}).map(function(t,n){return new l.PrintSheet(t,r,n,e.E0i).toJSON(i)})},n.ReportJSONConvertor=o},"./dist/plugins/report/convertors/worksheet-convertor.js":function(t,n,i){"use strict";var o,r;function e(t){this.MOi=t}Object.defineProperty(n,"__esModule",{value:!0}),n.WorkSheetConvertor=void 0,o=i("Core"),e.prototype.lOi=function(t){var n,i,r,e,n,i,r=this.MOi.Mf,e=new o.Worksheet;return e.parent=r.parent,r.parent.suspendPaint(),e.suspendPaint(),e.suspendEvent(),e.suspendDirty(),e.fromJSON(r.toJSON(t)),e.resumeDirty(),e.resumeEvent(),e.resumePaint(),r.parent.resumePaint(),e},n.WorkSheetConvertor=e},"./dist/plugins/report/data-model/helpers/cell-collapse-helper.js":function(t,n,i){"use strict";var C,r,N,e;function o(t){var n=this;n._Ci=t,n.jOi=new r.SmartCache,n.IOi={},n.COi={}}Object.defineProperty(n,"__esModule",{value:!0}),n.CellCollapseHelper=void 0,C=i("./dist/plugins/report/utils/utils.js"),r=i("./dist/plugins/report/helpers/smart-cache.js"),N=i("Core"),o.prototype.bOi=function(t,n,i){var r,e,o,u,s,u,r=this,e=r.jOi,o=i.cellNode,u=o.templateCell,s=u.expansionDirection;u.showCollapseButton&&"No"!==s&&o.children&&0<o.children.length&&i.row===t&&i.col===n&&(u=r.mOi(i),"H"===s?(void 0===u||u>=i.col+i.colCount||u<i.col)&&(u=i.col):(void 0===u||u>=i.row+i.rowCount||u<i.row)&&(u=i.row),e.set(t,n,{index:u,type:"E"}))},o.prototype.$Ci=function(t,n){var i,r,r,i=this,r=i.jOi;r&&((r=r.get(t,n))&&"E"===r.type?(r.type="C",i.yOi(t,n,1)):r&&"C"===r.type&&(r.type="E",i.yOi(t,n,-1)))},o.prototype.NOi=function(t,n){return!!(n?this.IOi:this.COi)[t]},o.prototype.DOi=function(t,n){var t=this.jOi.get(t,n);return t&&t.type},o.prototype.Ctr=function(t,n){var i,r,t,n,i,n,i=this,r,t=i._Ci.getCell(t,n);return t?(i=(n=i.getCellTreeRange(t.group)).rowCount,n=n.colCount,"H"===t.cellNode.templateCell.expansionDirection?n:i):1},o.prototype.yOi=function(t,n,i){var r,e,o,u,s,u,c,f,a,h,c,s,r=this,e=r.IOi,o=r.COi,u=r._Ci,s=r.jOi,u=u.getCell(t,n);u&&(f=(c=r.getCellTreeRange(u.group)).row,a=c.col,h=c.rowCount,c=c.colCount,s=s.get(t,n).index,"H"===u.cellNode.templateCell.expansionDirection?r.OOi(o,s,a,c,i):r.OOi(e,s,f,h,i))},o.prototype.OOi=function(t,n,i,r,e){var o;if(0<t[n])for(o=0;o<r;o++)if(!t[i+o]){n=i+o;break}for(o=0;o<r;o++)this.AOi(t,i+o),i+o!==n&&(t[i+o]+=e,t[i+o]<0)&&(t[i+o]=0)},o.prototype.getCellTreeRange=function(t){var n,i,r,e,o,t,i,u,s,c,f,a,h,l,v,d,p,w,I,M,g,n=this,i=n.jOi,e=t.dataCell,o=t.childrenArray,t=t.crossChildren,i=i.get(e.row,e.col),u=i&&i.range;if(u)return new N.Range(u.row,u.col,u.rowCount,u.colCount);if(o.length||t.length){for(s=0,c=o;s<c.length;s++)for(a=0,h=f=c[s];a<h.length;a++)l=h[a],r=(0,C.TOi)(r,n.getCellTreeRange(l));for(v=0,d=t;v<d.length;v++)if(p=d[v])for(w=0,I=p;w<I.length;w++)for(M=0,g=f=I[w];M<g.length;M++)l=g[M],r=(0,C.TOi)(r,n.getCellTreeRange(l))}else r=new N.Range(e.row,e.col,e.rowCount,e.colCount);return r=(0,C.TOi)(r,new N.Range(e.row,e.col,e.rowCount,e.colCount)),i&&(i.range=new N.Range(r.row,r.col,r.rowCount,r.colCount)),r},o.prototype.AOi=function(t,n){t[n]===C.KEYWORD_UNDEFINED&&(t[n]=0)},o.prototype.mOi=function(t){var n,n,i,n=this,i=n.EOi(t),n=i?n.SOi(t,i):"V"===t.cellNode.templateCell.expansionDirection?t.row:t.col;return n},o.prototype.SOi=function(t,n){var i,r,e,t,n,i=t.group,r="V"===t.cellNode.templateCell.expansionDirection,e=n.leftParent&&n.upParent,t=t.cellNode.children.indexOf(n),n=e?i.crossChildren[t]&&i.crossChildren[t][0]&&i.crossChildren[t][0][0].dataCell:i.childrenArray[t]&&i.childrenArray[t][0].dataCell;return n?r?n.row:n.col:void 0},o.prototype.EOi=function(t){var n,i,r,e,o;if(t.cellNode.children&&0<t.cellNode.children.length){for(n=0,i=t.cellNode.children;n<i.length;n++)if((r=i[n]).templateCell.dataSetting&&"Summary"===r.templateCell.dataSetting.type)return r;for(e=0,o=t.cellNode.children;e<o.length;e++)if((r=o[e]).templateCell.formula)return r}},o.prototype.destroy=function(){var t=this;t.jOi=C.KEYWORD_UNDEFINED,t.COi=C.KEYWORD_UNDEFINED,t.IOi=C.KEYWORD_UNDEFINED,t._Ci=C.KEYWORD_UNDEFINED},o.prototype.reset=function(){var t=this;t.jOi=new r.SmartCache,t.COi={},t.IOi={}},n.CellCollapseHelper=o},"./dist/plugins/report/data-model/helpers/cell-status-helper.js":function(t,n,i){"use strict";var a,h,l,r;function e(t,n,i){this._Oi=t,this.Mf=n,this._Ci=i}Object.defineProperty(n,"__esModule",{value:!0}),n.CellStatesHelper=void 0,a=i("Core"),h=i("./dist/plugins/report/utils/utils.js"),l=i("./dist/plugins/report/data-model/helpers/merge-range-utils.js"),e.prototype.xOi=function(){try{var t=this,n=t.Mf;n.cellStates.clear(new a.Range(0,0,n.getRowCount(),n.getColumnCount()),a.SheetArea.viewport),n.cellStates.fromJSON(t._Oi.toJSON()),t.zOi()}catch(t){}},e.prototype.zOi=function(){for(var t,n,i,r,e,o,u,s,c,f,t=this,n=t._Ci,i,r=t.Mf.cellStates,e,s=0,c=r.all();s<c.length;s++)f=c[s],u||f.state!==a.CellStatesType.dirty||(u=!0),r.remove(f.range,f.state),o=(0,h.JS)(n.getReportRange(),f.range),(0,h.ht)(o)||t.LOi(f,t.POi(o));u||t.BOi()},e.prototype.POi=function(t){for(var n,i,r,e,o,u,s,c,f,a,n,n=this,i=n._Ci,r=n._Oi.Mf,e=[],o=[],u=t.row,s=t.col,c=u+t.rowCount-1,f=s+t.colCount-1;u<=c;u++){for(;s<=f;s++)(a=r.getSpan(u,s))&&(a.row!==u||a.col!==s)||i.getAllCells(u,s).forEach(function(t){o.push(t)});s=t.col}return n=!(0,l.kOi)(o[0]),(0,h.FOi)(o,n),(0,l.GOi)(o,n).forEach(function(t){e.push(t)}),e},e.prototype.LOi=function(t,n){for(var i,r,e,o,u,s,i,r,e=this.Mf.cellStates,o=0,u=n;o<u.length;o++)s=u[o],e.add(s,t.state,t.style)},e.prototype.BOi=function(){var t=this,n=t.Mf,i=n.cellStates;t.Mf.reportSheet.options.dirtyStyle&&i.add(n.ROi(),a.CellStatesType.dirty,t.Mf.reportSheet.options.dirtyStyle)},n.CellStatesHelper=e},"./dist/plugins/report/data-model/helpers/chart-series-color-helper.js":function(t,s){"use strict";var n;function f(){}Object.defineProperty(s,"__esModule",{value:!0}),s.ChartColorHelper=s.chartColors=void 0,s.chartColors={"accent 1":["accent 1","accent 2","accent 3","accent 4","accent 5","accent 6"],"accent 1 0":["accent 1","accent 2","accent 3","accent 4","accent 5","accent 6"],"accent 1&1":["accent 1","accent 3","accent 5","accent 1 -40","accent 3 -40","accent 5 -40"],"accent 1 0&1":["accent 1","accent 3","accent 5","accent 1 -40","accent 3 -40","accent 5 -40"],"accent 2":["accent 2","accent 4","accent 6","accent 2 -40","accent 4 -40","accent 6 -40"],"accent 2 0":["accent 2","accent 4","accent 6","accent 2 -40","accent 4 -40","accent 6 -40"],"accent 6":["accent 6","accent 5","accent 4","accent 6 -40","accent 5 -40","accent 4 -40"],"accent 6 0":["accent 6","accent 5","accent 4","accent 6 -40","accent 5 -40","accent 4 -40"],"text 1 11.5":["text 1 11.5","text 1 45","text 1 25","text 1 1.5","text 1 70","text 1 40"],"accent 1 -50":{startColor:"accent 1 -50",stopColor:"accent 1 50"},"accent 2 -50":{startColor:"accent 2 -50",stopColor:"accent 2 50"},"accent 3 -50":{startColor:"accent 3 -50",stopColor:"accent 3 50"},"accent 4 -50":{startColor:"accent 4 -50",stopColor:"accent 4 50"},"accent 5 -50":{startColor:"accent 5 -50",stopColor:"accent 5 50"},"accent 6 -50":{startColor:"accent 6 -50",stopColor:"accent 6 50"},"accent 1 50":{startColor:"accent 1 50",stopColor:"accent 1 -50"},"accent 2 50":{startColor:"accent 2 50",stopColor:"accent 2 -50"},"accent 3 50":{startColor:"accent 3 50",stopColor:"accent 3 -50"},"accent 4 50":{startColor:"accent 4 50",stopColor:"accent 4 -50"},"accent 5 50":{startColor:"accent 5 50",stopColor:"accent 5 -50"},"accent 6 50":{startColor:"accent 6 50",stopColor:"accent 6 -50"}},f.getChartColors=function(t,n,i){var r,e,o,u;if(1!==(null==i?void 0:i.index)||"accent 1"!==t&&"accent 1 0"!==t||(t+="&1"),(r=s.chartColors[t])instanceof Array){for(e=r.length,o=[],u=0;u<n;u++)o.push(r[u%e]);return o}if(r instanceof Object)return f.ZOi(r.startColor,r.stopColor,n)},f.ZOi=function(t,n,i){var r,e,o,u,s,c,r=[],e=parseFloat(f.VOi(t).toString()),o,u=(parseFloat(f.VOi(n).toString())-e)/(i-1),s=0;for(r.push(t),c=1;c<i-1;c++)r.push(f.UOi(t,s=e+u*c));return r.push(n),r},f.VOi=function(t){return t.split(" ")[2]||0},f.UOi=function(t,n){var t=t.split(" ");return t[2]=n,t.join(" ")},s.ChartColorHelper=f},"./dist/plugins/report/data-model/helpers/conditional-format-helper.js":function(t,n,i){"use strict";var w,I,r;function e(t,n,i){this.mJ=t,this.Mf=n,this._Ci=i}Object.defineProperty(n,"__esModule",{value:!0}),n.ConditionalFormatHelper=void 0,w=i("./dist/plugins/report/data-model/helpers/merge-range-utils.js"),I=i("./dist/plugins/report/utils/utils.js"),e.prototype.HOi=function(){try{var t=this;t.Mf.conditionalFormats.fromJSON(t.mJ.toJSON(),t.Mf),t.WOi()}catch(t){}},e.prototype.WOi=function(){for(var t,n,i,r,e,o,u,t=this,n,i=t.Mf.conditionalFormats,r,e=0,o=i.getRules();e<o.length;e++)u=o[e],t.QOi(u);i.nJ=!1},e.prototype.QOi=function(t){for(var n,i,r,e,o,u,s,c,f,a,h,l,v,d,p,n=this,i=t.ranges(),r=n._Ci,c=[],a=n.mJ.eJ,h=0,l=i;h<l.length;h++){for(e=(v=l[h]).row,o=v.col,u=e+v.rowCount-1,s=o+v.colCount-1,f=[];e<=u;e++){for(;o<=s;o++)(d=a.getSpan(e,o))&&(d.row!==e||d.col!==o)||r.getAllCells(e,o).forEach(function(t){f.push(t)});o=v.col}p=!(0,w.kOi)(f[0]),(0,I.FOi)(f,p),(0,w.GOi)(f,p).forEach(function(t){c.push(t)})}t.ranges(c)},n.ConditionalFormatHelper=e},"./dist/plugins/report/data-model/helpers/floating-object-helper.js":function(t,n,i){"use strict";var o,a,r;function e(t,n,i){this.YOi=t,this._Ci=n,this.LCi=i,this.JOi={}}function h(t,n){n.width(t.width),n.height(t.height),n.x(t.x),n.y(t.y),n.allowMove(!1),n.allowResize(!1),n.allowRotate(!1),n.isSelected(!1),n.isLocked(!0)}function u(t,n,i,r){var i,i,e;return 1!==i||null!=(i=null==(i=null==r?void 0:r.shapeData)?void 0:i.pic)&&i.cameraTool||((e=new o.PictureShape(t,n.name())).fromJSON(r),e.tnV()),e}function s(t){for(var n,i,r,e,n,i=0,r=t.shapes.all().filter(function(t){return 1===t.ttV});i<r.length;i++)e=r[i],t.shapes.VP(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.FloatingObjectHelper=void 0,o=i("Shapes"),a=i("./dist/plugins/report/utils/utils.js"),e.prototype.KOi=function(){try{this.XOi()}catch(t){}},e.prototype.XOi=function(){var c,t,n,t,f,n,i,a,r,e,o,c=this,t=this,n=t.YOi,t=t.LCi,f=n.$Oi(),n=n.lfi();for(s(t),i=function(n){var t,i,r,e,o,u,s,t=!1;f&&(i=n.startRow(),r=n.startColumn(),e=f.titleRow,o=f.endRow,u=f.titleCol,s=f.endCol,t=e&&i>=e.start&&i<=e.end||o&&i>=o.start&&i<=o.end||u&&r>=u.start&&r<=u.end||s&&r>=s.start&&r<=s.end),t?a._Ci.getAllCells(n.startRow(),n.startColumn()).forEach(function(t){c.qOi(n,t)}):a.qOi(n)},a=this,r=0,e=n;r<e.length;r++)i(o=e[r])},e.prototype.qOi=function(t,n){var i,r,r,i=this.LCi,r=JSON.parse(JSON.stringify(t.toJSON())),r=u(i,t,r.shapeType,r);r&&(i.shapes.ZP(r),this.r4i(t.x(),t.y(),t.height(),t.width(),r,n))},e.prototype.r4i=function(t,n,i,r,e,o){var u,s,c,f,t,n,u=this,s=u.LCi,c=u._Ci,f=u.YOi,t={x:t,y:n,width:r,height:i,cell:o},n=(0,a.getFloatObjPosition)(t,f,c,s);(0,a.updateSheetRange)(n.x+n.width,n.y+n.height,s),h(n,e),u.JOi[e.name()]=t},e.prototype.zrt=function(){var t,n,t,i,t,r,e,o,u,n=this,t=n.LCi,i=n.JOi,t=null==(t=t.shapes)?void 0:t.all();if(t)for(r=0,e=t;r<e.length;r++)(u=i[(o=e[r]).name()])&&n.r4i(u.x,u.y,u.height,u.width,o,u.cell)},n.FloatingObjectHelper=e},"./dist/plugins/report/data-model/helpers/merge-range-utils.js":function(t,n,i){"use strict";var d,v;function r(t){var t=t&&t.cellNode&&t.cellNode.templateCell;return t&&"V"===t.expansionDirection}function e(t,n){var i,r,e,o,u,s,c,f,a,h,l,v,i={};if(!((0,d.ht)(t)||t.length<1)){if(r=t.length,o=(e=t[0]).row,u=e.col,s=e.rowCount,f=u+(c=e.colCount),a=o+s,n){for(h=1;h<r;h++)if(o===(e=t[h]).row&&e.col===f)c+=e.colCount,f+=e.colCount,s=Math.max(s,e.rowCount);else{for(l=0;l<s;l++)i[o+l+d.CONNECTOR+u+d.CONNECTOR+c]={row:o,col:u,rowCount:1,colCount:c};s=0,s=Math.max(s,e.rowCount),o=e.row,f=(u=e.col)+(c=e.colCount)}i[o+d.CONNECTOR+u+d.CONNECTOR+c]={row:o,col:u,rowCount:s,colCount:c}}else{for(h=1;h<r;h++)if(u===(e=t[h]).col&&e.row===a)s+=e.rowCount,a+=e.rowCount,c=Math.max(c,e.colCount);else{for(v=0;v<c;v++)i[u+v+d.CONNECTOR+o+d.CONNECTOR+s]={row:o,col:u,rowCount:s,colCount:1};c=0,c=Math.max(c,e.colCount),o=e.row,u=e.col,a=o+(s=e.rowCount)}i[u+d.CONNECTOR+o+d.CONNECTOR+s]={row:o,col:u,rowCount:s,colCount:c}}return i}}function o(t,n){return u(e(t,n),n)||[]}function u(t,n){var i,r,e,o,u,s,c,f,a,h,l;if(!(0,d.ht)(t)){if(r=(i=Object.keys(t)).length,n)for(f=0;f<r;f++)(s=t[e=i[f]])&&(c=t[u=+(o=e.split(d.CONNECTOR))[0]+1+d.CONNECTOR+o[1]+d.CONNECTOR+o[2]])&&(c.row=s.row,c.rowCount=s.rowCount+c.rowCount,t[e]=void 0);else for(f=0;f<r;f++)(s=t[e=i[f]])&&(c=t[u=+(o=e.split(d.CONNECTOR))[0]+1+d.CONNECTOR+o[1]+d.CONNECTOR+o[2]])&&(c.col=s.col,c.colCount=s.colCount+c.colCount,t[e]=void 0);for(l in a=[],t)t[l]&&(h=t[l],a.push(new v.Range(h.row,h.col,h.rowCount,h.colCount)));return a}}Object.defineProperty(n,"__esModule",{value:!0}),n.TOi=n.GOi=n.o4i=n.kOi=void 0,d=i("./dist/plugins/report/utils/utils.js"),v=i("Core"),n.kOi=r,n.o4i=e,n.GOi=o,n.TOi=u},"./dist/plugins/report/data-model/helpers/report-chart-helper.js":function(t,n,i){"use strict";var l,C,I,N,E,r;function e(t,n,i){this.YOi=t,this._Ci=n,this.LCi=i,this.u4i=[],this.s4i={},this.c4i={},this.f4i={},this.h4i={}}Object.defineProperty(n,"__esModule",{value:!0}),n.ReportChartHelper=void 0,l=i("CalcEngine"),C=i("Core"),I=i("./dist/plugins/report/utils/utils.js"),N=i("./dist/plugins/report/data-model/helpers/chart-series-color-helper.js"),E=Array.isArray,e.prototype.a4i=function(t,n,i){var n,r;t.row===n&&t.col===i&&this.LCi.charts&&(r=(n=t.cellNode.templateCell)&&n.chartName)&&this.u4i.push(t)},e.prototype.l4i=function(){var t,n,i,r,e,o,u;if(this.LCi.suspendPaint(),this.LCi.suspendCalcService(),t=this.LCi.charts,this.f4i={},this.h4i={},t){for(i=0,r=n=t.all();i<r.length;i++)e=r[i],t.remove(e.name());for(this.v4i(),this.d4i(),o=0,u=n=t.all();o<u.length;o++)(e=u[o]).isLocked(!0),e.allowMove(!1),e.allowResize(!1),e.isSelected(!1)}this.u4i=[],this.LCi.resumeCalcService(),this.LCi.resumePaint()},e.prototype.p4i=function(t,n){var i,r,e,o,u,s,c,f,a,s,h,l,i=this,r=i.s4i;if(r[t+"_"+n])for(o=0,u=e=r[t+"_"+n];o<u.length;o++){for(c=(s=u[o]).chart,f=s.series,a=s.row,s=s.col,h=c.series().get(),l=void 0,Array.isArray(h)?l=h.length:h&&(l=1);0<l;)c.series().remove(0),l--;i.w4i(c,a,s,f,!0)}},e.prototype.r4i=function(t,n){var i,r,e,o,t,i=this,r=i.YOi,e=i._Ci,o=i.LCi,t=(0,I.getFloatObjPosition)(t,r,e,o);(0,I.updateSheetRange)(t.x+t.width,t.y+t.height,o),i.g4i(t,n)},e.prototype.zrt=function(){var t,n,t,i,r,t,e,o,u,s,s,n=this,t=n.LCi,i=n.f4i,r=n.h4i,t=null==(t=t.charts)?void 0:t.all();if(t)for(e=0,o=t;e<o.length;e++)(s=i[(u=o[e]).name()])?n.r4i(s,u):(s=r[u.name()])&&n.g4i((0,I.getFloatObjRect)(s.row,s.col,n.LCi),u)},e.prototype.d4i=function(){for(var t,n,i,r,e,o,u,s,c,t=this,n=t.YOi,i=t.c4i,r,e=0,o=n.M4i();e<o.length;e++)if(u=o[e],(0,I.ht)(i[u.name()]))try{s=t.j4i(u.name(),null,null,!0),(0,I.ht)(s)||(c={x:u.x(),y:u.y(),width:u.width(),height:u.height()},t.r4i(c,s),t.f4i[s.name()]=c)}catch(t){}},e.prototype.v4i=function(){for(var t,n,i,r,e,o,u,s,t=this,n=t.u4i,i=t.c4i,r=0,e=n;r<e.length;r++){i[(u=(o=e[r]).cellNode.templateCell).chartName]=!0;try{s=t.j4i(u.chartName,o.row,o.col),(0,I.ht)(s)||(t.g4i((0,I.getFloatObjRect)(o.row,o.col,t.LCi),s),t.h4i[s.name()]={row:o.row,col:o.col})}catch(t){}}},e.prototype.j4i=function(t,n,i,r){var e,o,e,u,t,s,o=this,e=o.LCi,u,t=o.YOi.I4i(t);if(t)return s=t.clone(e),e.charts.ZP(s),o.w4i(s,n,i,null,null,null==(e=t.colorAndStyle)?void 0:e.color),s},e.prototype.w4i=function(t,n,i,r,e,o){var u,s,c,f,a,r,h,l,n,i,v,d,p,w,I,M,g,u=this,s=t.series(),f=t.ignoreHidden();if(r?c=r:(t.ignoreHidden(!1),c=s.get(),E(c)||(c=[c])),a=u.C4i(c,n,i,t,e),0<(r=Object.keys(a)).length){if(!e)for(l=c.length;0<l;)s.remove(0),l--;for(n=this.isPieOrDoughnutChart(t.chartType()),i=this.isSunburstOrTreeMapChart(t.chartType()),v=void 0,d=function(t){a[t]=u.b4i(a[t]),h={},C.GC$.extend(h,c[t]);var i=N.ChartColorHelper.getChartColors(h.backColor,a[t].length,o);v=v||i,a[t].forEach(function(t,n){C.GC$.extend(h,t),h.backColor=i&&i[n]||h.backColor,h.dataPoints=void 0,s.add(h)})},p=0,w=r;p<w.length;p++)d(I=w[p]);if(i||n)for(M=(h=s.AllSers[0]).dataPoints(),v=N.ChartColorHelper.getChartColors(v[0],M.Count,o),g=0;g<M.Count;g++)h.Points.GetPoint(g).setDataPointProperties({backColor:v[+g]})}t.ignoreHidden(f)},e.prototype.isSunburstOrTreeMapChart=function(t){return 57===t||58===t},e.prototype.isPieOrDoughnutChart=function(t){return 10===t||3===t},e.prototype.b4i=function(t){var n,i,r,e,o,u,s,c,n=this,i=t[0],r=t.slice(1),e={};return i.values.forEach(function(t,n){e[t.xValue]=n}),o=function(t,n){return(0,I.ht)(e[t.xValue])||(0,I.ht)(e[n.xValue])?(0,I.ht)(e[t.xValue])?1:-1:e[t.xValue]-e[n.xValue]},r.forEach(function(t){return t.values.sort(o)}),u=[],s=[],c=[],t.forEach(function(t){t.values.forEach(function(t){s.push(t.xValue),c.push(t.yValue)});var t=n.m4i({name:t.name,xValues:s,yValues:c});t&&u.push(t),s=[],c=[]}),u},e.prototype.C4i=function(t,r,e,n,i){var o,u,s,c,f,a,h,l,v,d,p,o=this,u,s=o.LCi.reportSheet.templateSheet,c=o._Ci,f={},d=[],p=[];return t.forEach(function(t,n){var i,i,i,i=c.getCell(r,e)&&c.getCell(r,e).cellNode.templateCell,i=i&&s.GCi(i.row,i.col);i&&(i.leftParent||i.upParent)&&(a=i.leftParent||i.upParent),h=o.y4i(t.name,r,e,a),l=o.N4i(t.xValues,h&&h.nameCells,r,e),v=o.D4i(t.yValues,l),0<(i=o.O4i(h,l,v,d)).length&&(f[n]=i)}),C.GC$.extend(p,t),i||o.A4i(d,n,p,r,e),f},e.prototype.O4i=function(n,r,e,o){var u,s,c,f,a,h,l,t,u=this,s=u.LCi,c=[],a=[];return n&&n.nameCells?((0,I.pushArrayTo)(n.nameCells,o),n.nameCells.forEach(function(t,i){f=n.isStatic?n.name:s.getValue(t.row,t.col);var t=r&&r[i]&&r[i].xValueCells;t?((0,I.pushArrayTo)(t,o),t.forEach(function(t,n){h=s.getValue(t.row,t.col);var t=e&&e[i]&&e[i][n];t&&((0,I.pushArrayTo)(t,o),l=u.T4i(t)),a.push({xValue:h,yValue:l})})):(e[0][0]&&0<e[0][0].length&&(l=e[0][0].map(function(t){return t.value})),a.push({yValue:l||[]})),c.push({name:null!=f?f:'={"'+f+'"}',values:a}),a=[]})):n&&n.name&&((t=r&&r[0].xValueCells)?((0,I.pushArrayTo)(t,o),t.forEach(function(t,n){h=s.getValue(t.row,t.col);var t=e&&e[0]&&e[0][n];t&&((0,I.pushArrayTo)(t,o),l=u.T4i(t)),a.push({xValue:h,yValue:l})})):(e[0][0]&&0<e[0][0].length&&(l=e[0][0].map(function(t){return t.value})),a.push({yValue:l||[]})),c.push({name:n.name,values:a})),c},e.prototype.m4i=function(t){var n,i,t,i,r,n=t.name,i=t.xValues,t=t.yValues,i=i.join('","');return""!==i&&(i='={"'+i+'"}'),{name:n=(0,I.ht)(n)||"="===n[0]?n:'={"'+n+'"}',xValues:i,yValues:r="={"+(r=t.join())+"}"}},e.prototype.T4i=function(t,n){for(var i,r,e,o,u,s,o,i,r=this.LCi,e=0,u=0,s=t;u<s.length;u++)o=s[u],o=+r.getValue(o.row,o.col),isNaN(o)||(e+=o);return e},e.prototype.y4i=function(t,n,i,r){var e,o,u,s,o,c,f,a,e=this,o=e.LCi;try{s=o.Lp.parse(o.Uw(),t,0,0)}catch(t){}return s instanceof l.ReferenceExpression?(o=s.row,c=s.column,f=s.endRow,a=s.endColumn,{name:t,nameCells:u=e.E4i(new C.Range(o,c,f?f-o+1:1,a?a-c+1:1),n,i)}):s&&8===s.type&&r?{name:t,nameCells:u=e.E4i(new C.Range(r.row,r.col,1,1),n,i),isStatic:!0}:{name:t,isStatic:!0}},e.prototype.N4i=function(t,n,r,e){var o,i,u,s,c,f,a,h,o=this,i=o.LCi;if(!(0,I.ht)(t)){try{u=i.Lp.parse(i.Uw(),t,0,0)}catch(t){}return s={},u instanceof l.ReferenceExpression?(c=u.row,f=u.column,a=u.endRow,h=u.endColumn,n?n.forEach(function(t,n){var i=o.S4i(c,f,t,{row:r,col:e});s[n]={xValueCells:o.E4i(new C.Range(c,f,a?a-c+1:1,h?h-f+1:1),i&&i.row,i&&i.col),nameCell:t}}):s[0]={xValueCells:o.E4i(new C.Range(c,f,a?a-c+1:1,h?h-f+1:1))},s):void 0}},e.prototype.S4i=function(t,n,i,r){var e,i,o,u,o,e,e,r,i,r,i,o=this,u=o._Ci,o=o.LCi.reportSheet.getTemplate(),e=null==(e=u.getCell(t,n))?void 0:e.cellNode.templateCell,e={row:e.row,col:e.col};return(0,I.FCi)(o,e,{row:i.cellNode.templateCell.row,col:i.cellNode.templateCell.col})?i:(0,I.ht)(r.row)||(0,I.ht)(r.col)?void 0:(r=null==(i=u.getCell(r.row,r.col))?void 0:i.cellNode.templateCell,r=(i=o.GCi(r.row,r.col)).leftParent,i=i.upParent,r&&(0,I.FCi)(o,e,r)?u.getCells(r.row,r.col,t,n)[0]:i&&(0,I.FCi)(o,e,i)?u.getCells(i.row,i.col,t,n)[0]:void 0)},e.prototype.D4i=function(t,n){var e,i,r,o,u,s,c,f,a,e=this,i=e.LCi;try{r=i.Lp.parse(i.Uw(),t,0,0)}catch(t){}if(o={},r instanceof l.ReferenceExpression)return u=r.row,s=r.column,c=r.endRow,f=r.endColumn,n?(a=Object.keys(n)).forEach(function(t,i){var r=n[t],t=r.xValueCells;o[i]={},t.forEach(function(t,n){o[i][n]=e._4i(new C.Range(u,s,c?c-u+1:1,f?f-s+1:1),r.nameCell,t)})}):(o[0]={},o[0][0]=e.E4i(new C.Range(u,s,c?c-u+1:1,f?f-s+1:1))),o},e.prototype._4i=function(t,n,i){var r,e,o,u,s,c,f,a,h,l,v,d,p,w,r=this,e=r.LCi.reportSheet.getTemplate(),o=[],u=r._Ci;if(n&&i&&!(0,I.FCi)(e,i,n)){for(s=t.row,c=t.col,h=s+(f=t.rowCount),l=c+(a=t.colCount);s<h;s++){for(;c<l;c++)for(d=0,p=v=u.getCells(s,c,i.row,i.col);d<p.length;d++)w=p[d],(0,I.kCi)(w.group,n.group)&&o.push(w);c=t.col}return o}return r.E4i(t,i.row,i.col)},e.prototype.E4i=function(t,n,i){for(var r,e,o,u,s,c,f,a,h,r,e=this._Ci,o=[],u=t.row,s=t.col,c,f,a=u+t.rowCount,h=s+t.colCount;u<a;u++){for(;s<h;s++)(0,I.pushArrayTo)(e.getCells(u,s,n,i),o);s=t.col}return o},e.prototype.g4i=function(t,n){t&&n&&(n.width(t.width),n.height(t.height),n.x(t.x),n.y(t.y))},e.prototype.A4i=function(t,n,i,r,e){for(var o,u,s,c,f,a,s,o,u=this.s4i,c={chart:n,series:i,row:r,col:e},f=0,a=t;f<a.length;f++)u[s=(s=a[f]).row+"_"+s.col]||(u[s]=[]),u[s].push(c)},n.ReportChartHelper=e},"./dist/plugins/report/data-model/helpers/validation-helper.js":function(t,n,i){"use strict";var g,C,N,E,r;function e(t,n,i,r){this.b8=t,this.Mf=n,this._Ci=i,this.LCi=r}Object.defineProperty(n,"__esModule",{value:!0}),n.ValidationHelper=void 0,g=i("Core"),C=i("./dist/plugins/report/data-model/helpers/merge-range-utils.js"),N=i("./dist/plugins/report/utils/utils.js"),E=i("./dist/plugins/report/helpers/smart-cache.js"),e.prototype.copyValidation=function(){try{var t=this,n=t.Mf;n.b8.fromJSON(t.b8.toJSON(),null,n),t.updateValidation(),n.b8.C8()}catch(t){}},e.prototype.updateValidation=function(){for(var t,n,i,r,e,o,u,s,t=this,n,i,r=t.Mf.b8.YB,e,o=0,u=Object.keys(r);o<u.length;o++)s=u[o],t.updateValidatorRange(r[s])},e.prototype.updateValidatorRange=function(t){for(var n,i,r,e,o,u,s,c,f,a,h,l,v,d,p,w,I,M,n=this,i=t.smt(),r=n._Ci,e=n.b8.eJ,o=new E.SmartCache,u=new g.Range(0,0,e.getRowCount(),e.getColumnCount()),h=[],d=0,p=i;d<p.length;d++)if(v=(w=p[d]).getIntersect(u,e.getRowCount(),e.getColumnCount())){for(s=v.row,c=v.col,f=s+v.rowCount-1,a=c+v.colCount-1,l=[];s<=f;s++){for(;c<=a;c++)I=void 0,o.get(s,c)||(I=e.getSpan(s,c),n.J4i(I,s,c,o),r.getAllCells(s,c).forEach(function(t){l.push(t)}));c=v.col}M=!(0,C.kOi)(l[0]),(0,N.FOi)(l,M),(0,N.pushArrayTo)((0,C.GOi)(l,!(0,C.kOi)(l[0])),h)}t._S=h},e.prototype.J4i=function(t,n,i,r){if(t)for(var e=t.row,o=e+t.rowCount-1,u=t.col,s=u+t.colCount-1;e<=o;e++){for(;u<=s;u++)r.set(e,u,!0);u=t.col}else r.set(n,i,!0)},e.prototype.getInvalidCells=function(){var t,n,i,r,e,o,u,s,c,f,a,t=this,n,i=t.Mf.b8.p6t(),e=[];if(i&&0<i.length)for(o=0,u=i;o<u.length;o++)if((r=(s=u[o]).smt())&&0<r.length)for(c=0,f=r;c<f.length;c++)a=f[c],t.x4i(a,s,e);return e},e.prototype.x4i=function(t,n,i){for(var r,e,o,u,s,c,f,a,h,r=this,e=r.Mf,o=t.row,u=t.col,s,c,f=o+t.rowCount,a=u+t.colCount,h=r.LCi;o<f;o++){for(;u<a;u++)n.isValid(e,o,u,h.z4i(o,u))||i.push([o,u]);u=t.col}},n.ValidationHelper=e},"./dist/plugins/report/data-model/report-data-model.js":function(t,n,i){"use strict";var e,c,p,f,a,h,r;function o(t,n,i,r,e,o,u){var s=this;s.LCi=t,s._Ci=n,s.YOi=i,s.xCi=r,s.L4i=e,s.P4i=o,s.B4i=u,s.G4i=t.shapes?new h.FloatingObjectHelper(i,n,t):null,s.k4i=t.charts?new f.ReportChartHelper(i,n,t):null,s.R4i=new a.CellCollapseHelper(n)}e=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||((o=o||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.ReportDataModel=void 0,c=i("Core"),p=i("./dist/plugins/report/utils/utils.js"),f=i("./dist/plugins/report/data-model/helpers/report-chart-helper.js"),a=i("./dist/plugins/report/data-model/helpers/cell-collapse-helper.js"),h=i("./dist/plugins/report/data-model/helpers/floating-object-helper.js"),o.prototype.Z4i=function(){var t,n,i,r,e,o,u,s,c,f,a,a,t=this;for(t.V4i(),t.W4i(),r=(i=(n=t._Ci).getReportRange()).row,e=i.col,o=i.rowEnd,u=i.colEnd,t.xCi.gCi(),s=r;s<=o;s++)for(c=e;c<=u;c++)f=n.getCell(s,c),a=t.U4i(f,s,c),t.H4i(a,s,c,!0),f&&f.row===s&&f.col===c&&(0,p.bCi)(f)&&(a=t.xCi.CCi(f),f.value=a,f.group.value=a);return t.xCi.MCi(),{rowHeightCache:this.xl,colWidthCache:this.Nl,rowToTemplateRowCache:this.Q4i,colToTemplateColCache:this.F4i}},o.prototype.Y4i=function(){var t,n,i,t,r,e,o,u,s,c,f,a,h,l,v,d,n=this;for(n.V4i(),n.W4i(),r=(t=(i=n._Ci).getReportRange()).row,e=t.col,o=t.rowEnd,s=(u=t.colEnd)-e+1,c=n.k4i,f=this.R4i,n.xCi.gCi(),a=r;a<=o;a++)for(h=e;h<=u;h++)l=i.getCell(a,h),v=n.U4i(l,a,h),n.H4i(v,a,h),l&&(f.bOi(a,h,l),l.row===a&&l.col===h&&(0,p.bCi)(l)&&(d=n.xCi.CCi(l),l.value=d,l.group.value=d),n.J4i(l,a,h),n.K4i(v,a,h,s),null!=c)&&c.a4i(l,a,h);n.xCi.MCi(),n.L4i.HOi(),n.P4i.xOi(),n.B4i.copyValidation(),null!=(t=n.G4i)&&t.KOi(),null!=c&&c.l4i(),n.X4i()},o.prototype.$4i=function(t,n,i){var r,e,o,r,u,r=this,e=r.xCi,o=r._Ci,r=r.k4i,u=o.getCell(t,n);u&&u.row===t&&u.col===n&&(o.updateCellValue(t,n,i),e.ACi(t,n,i),r)&&r.p4i(t,n)},o.prototype.q4i=function(t,n){var t=this._Ci.addRecord(t,n);return t.success&&this.Y4i(),t},o.prototype.tEi=function(t,n){var t=this._Ci.deleteRecord(t,n);return t.success&&this.Y4i(),t},o.prototype.nEi=function(){return this._Ci.getDataCollectionResults()},o.prototype.Mtr=function(t,n){this._Ci.resetCellsStateToNormal(t,n)},o.prototype.u=function(){return this._Ci.isDirty()},o.prototype.rEi=function(t,n){return this._Ci.getCell(t,n)},o.prototype.eEi=function(){return this.Z5||new c.Range(0,0,0,0)},o.prototype.F5t=function(t){var n=this;return n.R4i.NOi(t,!1)?0:n.Nl[t]},o.prototype.L5t=function(t){var n=this;return n.R4i.NOi(t,!0)?0:n.xl[t]},o.prototype.D7=function(t,n){var t=this.oEi[t];return t&&t[n]},o.prototype.ZF=function(n){return n?this.uEi.filter(function(t){return t.intersect(n.row,n.col,n.rowCount,n.colCount)}):e([],this.uEi,!0)},o.prototype.ML=function(t,n){var i,t,t,i=this,t=i.sEi[t];return t?(t=t[n])&&i.YOi.ML(t.row,t.col):null},o.prototype.Sl=function(t,n){var i,r,i,i=this,r=i._Ci.getCell(t,n);return r&&r.row===t&&r.col===n?(i=(0,p.bCi)(r)?i.xCi.Sl(t,n):r.value,Array.isArray(i)?e([],i,!0):i):null},o.prototype.cEi=function(){return this.B4i.getInvalidCells()},o.prototype.fEi=function(){var t;null!=(t=this.G4i)&&t.zrt(),this.k4i.zrt()},o.prototype.CCi=function(t,n,i){return this.xCi.OCi(t,n,i)},o.prototype.$Ci=function(t,n){this.R4i.$Ci(t,n),this.fEi()},o.prototype.hEi=function(t,n){return"C"===this.R4i.DOi(t,n)},o.prototype.Ctr=function(t,n){return this.R4i.Ctr(t,n)},o.prototype.eG=function(){this.oEi=p.KEYWORD_UNDEFINED,this.uEi=p.KEYWORD_UNDEFINED,this._Ci=p.KEYWORD_UNDEFINED,this.YOi=p.KEYWORD_UNDEFINED,this.xl=p.KEYWORD_UNDEFINED,this.aEi=p.KEYWORD_UNDEFINED,this.Nl=p.KEYWORD_UNDEFINED,this.lEi=p.KEYWORD_UNDEFINED,this.sEi=p.KEYWORD_UNDEFINED,this.Z5=p.KEYWORD_UNDEFINED,this.xCi.eG(),this.R4i.destroy()},o.prototype.c5=function(){this.V4i()},o.prototype.V4i=function(){var t,n,i,r,e,o,n,t=this,n=t._Ci;t.oEi=[],t.uEi=[],o=e=r=i=0,n&&(i=(n=n.getReportRange()).row,r=n.col,e=n.rowEnd-i+1,o=n.colEnd-r+1),t.Q4i=new Array(e),t.F4i=new Array(o),t.xl=new Array(e),t.aEi=new Array(e),t.Nl=new Array(o),t.lEi=new Array(o),t.sEi=new Array(e),t.Z5=new c.Range(i,r,e,o),t.xCi.c5(),t.R4i.reset()},o.prototype.J4i=function(t,n,i){(1<t.rowCount||1<t.colCount)&&t.row===n&&t.col===i&&this.vEi(t.row,t.col,t.rowCount,t.colCount)},o.prototype.vEi=function(t,n,i,r){for(var e,o,u,s,e=new c.Range(t,n,i,r),o=0;o<e.rowCount;o++)for(u=e.row+o,s=0;s<e.colCount;s++)this.oEi[u]||(this.oEi[u]=[]),this.oEi[u][e.col+s]=e;this.uEi.push(e)},o.prototype.U4i=function(t,n,i){var r,e,r,o,u,s,c,n,f,i,t,a,h,o,f;return t?(e=(r=t.overwrittenCellNode||t.cellNode).leftParent||r.upParent,o=(r=r.templateCell).row===r.rowEnd,u=r.col===r.colEnd,s=t.rowCount===r.rowEnd-r.row+1,c=t.colCount===r.colEnd-r.col+1,n=n-t.row,f=r.rowEnd-r.row+1,i=i-t.col,t=r.colEnd-r.col+1,a=o?r.row:r.row+n%f,h=u?r.col:r.col+i%t,o=o&&s?r.dataColumn?7:6:s?r.dataColumn?5:e?4:3:r.dataColumn?2:f<=n?-1:1,f=u&&c?r.dataColumn?7:6:c?r.dataColumn?5:e?4:3:r.dataColumn?2:t<=i?-1:1,{rowSetterPriority:o=(r.paginateBeforeRow||r.paginateAfterRow)&&s?100:o,colSetterPriority:f=(r.paginateBeforeColumn||r.paginateAfterColumn)&&c?100:f,templateCellRow:a,templateCellCol:h}):{rowSetterPriority:0,colSetterPriority:0,templateCellRow:void 0,templateCellCol:void 0}},o.prototype.H4i=function(t,n,i,r){void 0===r&&(r=!1);var e=t.rowSetterPriority,o=t.colSetterPriority,u=t.templateCellRow,t=t.templateCellCol;0<=e&&(void 0===this.xl[n]||e>this.aEi[n])&&(this.xl[n]=this.YOi.L5t(u),this.aEi[n]=e,r)&&void 0!==u&&(this.Q4i[n]=u),0<=o&&(void 0===this.Nl[i]||o>this.lEi[i])&&(this.Nl[i]=this.YOi.F5t(t),this.lEi[i]=o,r)&&void 0!==t&&(this.F4i[i]=t)},o.prototype.K4i=function(t,n,i,r){this.sEi[n]||(this.sEi[n]=new Array(r)),this.sEi[n][i]={row:t.templateCellRow,col:t.templateCellCol}},o.prototype.W4i=function(){var t,n,t,t=this,n=t.LCi,t=t.eEi();t&&(n.setRowCount(t.row+t.rowCount),n.setColumnCount(t.col+t.colCount))},o.prototype.X4i=function(){var t,n,i,r,e,o,u,s,c,f,a,h,t=this.LCi,n=this.YOi;if(t.shapes){for(i={},e=0,o=r=t.shapes.all();e<o.length;e++)u=o[e],s=n.dEi(u.name()),!(0,p.ht)(s)&&0<=s&&(i[s]=u);for(f=0,a=c=Object.keys(i);f<a.length;f++)h=a[f],t.shapes.zIndex(i[h].name(),+h)}},n.ReportDataModel=o},"./dist/plugins/report/data-model/template-info.js":function(t,n,i){"use strict";var r,e;function o(t){this.pEi(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.TemplateInfo=void 0,r=i("Core"),o.prototype.pEi=function(t){this.wEi=t},o.prototype.ML=function(t,n){var i,t,i=this.wEi,t=this.wEi.getActualStyle(t,n,r.SheetArea.viewport,!0);return t&&(0,r.composeParentStyle)(t,t,i,!1,10,!0),t},o.prototype.F5t=function(t){return+this.wEi.getColumnWidth(t)},o.prototype.L5t=function(t){return+this.wEi.getRowHeight(t)},o.prototype.gEi=function(){return this.wEi.conditionalFormats},o.prototype.getCellStates=function(){return this.wEi.cellStates},o.prototype.getValidations=function(){return this.wEi.b8},o.prototype.lfi=function(){return this.wEi.shapes.all()},o.prototype.M4i=function(){return this.wEi.charts.all()},o.prototype.I4i=function(t){return this.wEi.charts.get(t)},o.prototype.D7=function(t,n){return this.wEi.getSpan(t,n)},o.prototype.MEi=function(){return this.wEi.getRowCount()},o.prototype.jEi=function(){return this.wEi.getColumnCount()},o.prototype.e2t=function(){return this.wEi.getCustomNames()},o.prototype.IEi=function(t){return this.wEi.getCustomName(t)},o.prototype.dEi=function(t){return this.wEi.shapes.zIndex(t)},o.prototype.$Oi=function(){return this.wEi.getPaginationSetting()},n.TemplateInfo=o},"./dist/plugins/report/definition-comments/index.js":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),i("./dist/plugins/report/definition-comments/template-sheet/index.js"),i("./dist/plugins/report/definition-comments/report-sheet.js")},"./dist/plugins/report/definition-comments/report-sheet.js":function(){},"./dist/plugins/report/definition-comments/template-sheet/data-entry-setting.js":function(){},"./dist/plugins/report/definition-comments/template-sheet/index.js":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),i("./dist/plugins/report/definition-comments/template-sheet/template-cell.js"),i("./dist/plugins/report/definition-comments/template-sheet/data-entry-setting.js"),i("./dist/plugins/report/definition-comments/template-sheet/pagination-setting.js"),i("./dist/plugins/report/definition-comments/template-sheet/layout-setting.js"),i("./dist/plugins/report/definition-comments/template-sheet/others.js")},"./dist/plugins/report/definition-comments/template-sheet/layout-setting.js":function(){},"./dist/plugins/report/definition-comments/template-sheet/others.js":function(){},"./dist/plugins/report/definition-comments/template-sheet/pagination-setting.js":function(){},"./dist/plugins/report/definition-comments/template-sheet/template-cell.js":function(){},"./dist/plugins/report/events/add-record.js":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.KCi=void 0;var r=i("./dist/plugins/report/events/helpers/utils.js");function e(t,n,i){return{name:"ReportSheetAddRecord",event:{activeRow:t,activeCol:n,canceled:!1,addRecordSingleUseAction:(0,r.CEi)(i)}}}n.KCi=e},"./dist/plugins/report/events/delete-record.js":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.XCi=void 0;var r=i("./dist/plugins/report/events/helpers/utils.js");function e(t,n,i){return{name:"ReportSheetDeleteRecord",event:{activeRow:t,activeCol:n,canceled:!1,deleteRecordSingleUseAction:(0,r.CEi)(i)}}}n.XCi=e},"./dist/plugins/report/events/helpers/utils.js":function(t,n){"use strict";function i(t){var n=!1;return function(){n||(n=!0,t())}}Object.defineProperty(n,"__esModule",{value:!0}),n.CEi=void 0,n.CEi=i},"./dist/plugins/report/events/index.js":function(t,n,i){"use strict";var r,e,r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&("get"in e?n.__esModule:!e.writable&&!e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i("./dist/plugins/report/events/add-record.js"),n),e(i("./dist/plugins/report/events/delete-record.js"),n),e(i("./dist/plugins/report/events/reset-current-cell.js"),n)},"./dist/plugins/report/events/reset-current-cell.js":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.qCi=void 0;var r=i("./dist/plugins/report/events/helpers/utils.js");function e(t,n){return{name:"ReportSheetResetCellValue",selections:t,event:{canceled:!1,resetCellValueSingleUseAction:(0,r.CEi)(n)}}}n.qCi=e},"./dist/plugins/report/helpers/break-line-helper.js":function(t,n,i){"use strict";var v,r;function e(t){this.Mf=t,this.bEi={},this.mEi={}}Object.defineProperty(n,"__esModule",{value:!0}),n.BreakLineHelper=void 0,v=i("Core"),e.prototype.yEi=function(){var t,n,i,r,e,o,t=this,n=t.Mf,i=n.getRowCount(),r=n.getColumnCount();for(this.bEi={},this.mEi={},e=0;e<i;e++)for(o=0;o<r;o++)t.NEi(e,o,n.getTemplateCell(e,o),{})},e.prototype.NEi=function(t,n,i,r,e){var o,u,s,c,f,a,h,l,o=this,u=o.Mf,s=o.bEi,c=o.mEi,a=u.getSpan(t,n),h=1,l=1;a&&a.row===t&&a.col===n&&(h=a.rowCount,l=a.colCount),r=r||u.getTemplateCell(t,n),o.DEi(t,n,h,l),null==i||!i.paginateAfterRow||null!=r&&r.paginateAfterRow&&!e||(s[t+h]+=1,f=!0),null==i||!i.paginateAfterColumn||null!=r&&r.paginateAfterColumn&&!e||(c[n+l]+=1,f=!0),null==r||!r.paginateAfterRow||null!=i&&i.paginateAfterRow&&!e||(--s[t+h],f=!0),null==r||!r.paginateAfterColumn||null!=i&&i.paginateAfterColumn&&!e||(--c[n+l],f=!0),null==i||!i.paginateBeforeRow||null!=r&&r.paginateBeforeRow&&!e||(s[t]+=1,f=!0),null==i||!i.paginateBeforeColumn||null!=r&&r.paginateBeforeColumn&&!e||(c[n]+=1,f=!0),null==r||!r.paginateBeforeRow||null!=i&&i.paginateBeforeRow&&!e||(--s[t],f=!0),null==r||!r.paginateBeforeColumn||null!=i&&i.paginateBeforeColumn&&!e||(--c[n],f=!0),f&&u.ki(v.Events.ReportPaginationSettingChanged)},e.prototype.OEi=function(t,n){return!!(n?this.bEi:this.mEi)[t]},e.prototype.DEi=function(t,n,i,r){var e=this,o=e.bEi,e=e.mEi;(!o[t]||o[t]<0)&&(o[t]=0),(!o[t+i]||o[t+i]<0)&&(o[t+i]=0),(!e[n]||e[n]<0)&&(e[n]=0),(!e[n+r]||e[n+r]<0)&&(e[n+r]=0)},e.prototype.eG=function(){this.Mf=void 0,this.bEi=void 0,this.mEi=void 0},n.BreakLineHelper=e},"./dist/plugins/report/helpers/cell-node-info-helper.js":function(t,n,i){"use strict";var r,e,o;function u(t){this.wEi=t}Object.defineProperty(n,"__esModule",{value:!0}),n.CellNodeInfoHelper=void 0,r=i("Report"),e=i("./dist/plugins/report/template/template-resolver.js"),u.prototype.AEi=function(){var t,n,i,t=this,n=this.wEi,i=new e.ReportTemplateResolver(n);t.TEi=new r.ParentChildTreeGenerator(i).process(!0).cellNodeCache,t.EEi(n.getActiveRowIndex(),n.getActiveColumnIndex())},u.prototype.EEi=function(t,n){var i,r,r,i=this,r=i.TEi;i.SEi(),r&&(r=r.get(t,n))&&!r.templateCell.isEmpty&&(r.upParent&&(i._Ei=r.upParent.templateCell.row,i.xEi=r.upParent.templateCell.col),r.leftParent)&&(i.zEi=r.leftParent.templateCell.row,i.LEi=r.leftParent.templateCell.col)},u.prototype.PEi=function(){return{leftParent:{row:this.zEi,col:this.LEi},upParent:{row:this._Ei,col:this.xEi}}},u.prototype.SEi=function(){var t=this;t._Ei=void 0,t.xEi=void 0,t.zEi=void 0,t.LEi=void 0},u.prototype.BEi=function(t){this.GEi=t},u.prototype.GCi=function(t,n){var i,t,i={upParent:null,leftParent:null};if(this.GEi){if(!(t=this.GEi.get(t,n))||t.templateCell.isEmpty)return i;t.upParent&&(i.upParent={row:t.upParent.templateCell.row,col:t.upParent.templateCell.col}),t.leftParent&&(i.leftParent={row:t.leftParent.templateCell.row,col:t.leftParent.templateCell.col})}return i},u.prototype.eG=function(){this.SEi(),this.wEi=void 0},n.CellNodeInfoHelper=u},"./dist/plugins/report/helpers/cell-reference-helper.js":function(t,n,i){"use strict";var a,r,e,h,o;function u(t){var f=this;this.kEi="GCTemplateSheetBuiltInCustomName",this.REi=new e.SmartCache,this.ZEi=[],this.VEi={},this.UEi=/^([A-Z]+)([0-9]+)$/,this.HEi=/\$/g,this.WEi=function(t,n,i){var r,n,e,o,n,u,s,c,r=f.Ywt(t.obj[t.key]),n=(0,h.QEi)(n),e=n.row,o=n.col,n=(0,h.QEi)(i),u=n.row,s=n.col,c=!1;return r.forEachNodes(function(t){t.type===a.ExpressionType.reference&&t.row===e&&t.column===o&&(t.row=u,t.column=s,c=!0)}),c?f.FEi(r):t[t.key]},this.Ywt=function(t){return f.Mf.Lp.parse(f.Mf.qgt,t,0,0)},this.FEi=function(t){return f.Mf.Lp.unparse(f.Mf.qgt,t,0,0)},this.Mf=t}Object.defineProperty(n,"__esModule",{value:!0}),n.CellReferenceHelper=void 0,a=i("CalcEngine"),r=i("SheetsCalc"),e=i("./dist/plugins/report/helpers/smart-cache.js"),h=i("./dist/plugins/report/utils/utils.js"),u.prototype.YEi=function(){this.Mf.suspendPaint(),this.Mf.suspendCalcService(),this.dl(),this.JEi(),this.KEi(this.Mf.getDataEntrySetting()),this.Mf.resumeCalcService(),this.Mf.resumePaint()},u.prototype.dl=function(){var n,t,n=this,t;this.Mf.getCustomNames().forEach(function(t){t.getName().startsWith(n.kEi)&&n.Mf.removeCustomName(t.getName())}),this.VEi={},this.REi=new e.SmartCache,this.ZEi=[]},u.prototype.XEi=function(t){var n=this;t.names&&(t.names=t.names.filter(function(t){return!t.name.startsWith(n.kEi)}))},u.prototype.$Ei=function(t){var n,i,n=this;null!=(i=null==t?void 0:t.lossless)&&i.definedNames&&(t.lossless.definedNames=t.lossless.definedNames.filter(function(t){return!t.name.startsWith(n.kEi)}))},u.prototype.qEi=function(t,n,i){this.Mf.suspendPaint(),this.Mf.suspendCalcService();var r=this.REi.get(t,n);r&&(this.rSi(r),this.REi.set(t,n,[])),this.eSi(t,n,i),this.Mf.resumeCalcService(),this.Mf.resumePaint()},u.prototype.KEi=function(t){var n=this;this.Mf.suspendPaint(),this.Mf.suspendCalcService(),this.rSi(this.ZEi),this.ZEi=[],t&&t.forEach(function(t){t.fields.forEach(function(t){var t;(0,h.oSi)(t.formula)&&(t=n.uSi((0,h.sSi)(t.formula),t,"formula"),n.ZEi.push(t))})}),this.Mf.resumeCalcService(),this.Mf.resumePaint()},u.prototype._6=function(t){var r=this;t.forEach(function(t){var n,i,t,n,n=t.nameInfo,i=t.oldExpr,t=t.newExpr,n=r.VEi[n.getName()];n&&(t.type===a.ExpressionType.error?"vertical"!==n.key&&"horizontal"!==n.key||(n.obj[n.key]="None"):n.cSi?n.obj[n.key]=n.cSi(n,r.fSi(i).replace(r.HEi,""),r.fSi(t).replace(r.HEi,"")):n.obj[n.key]=r.fSi(t).replace(r.HEi,""))}),this.Mf.AEi()},u.prototype.eG=function(){this.REi=void 0,this.ZEi=void 0,this.VEi=void 0,this.Mf=void 0},u.prototype.JEi=function(){for(var t,n,i,r,e,o,t=this.Mf,n=t.getRowCount(),i=t.getColumnCount(),r=0;r<=n;r++)for(e=0;e<=i;e++)(o=t.getTemplateCell(r,e))&&this.eSi(r,e,o)},u.prototype.eSi=function(t,n,i){i&&(this.hSi(t,n,i),this.aSi(t,n,i),this.lSi(t,n,i),this.vSi(t,n,i))},u.prototype.hSi=function(t,n,i){var r,e,r;i.context&&(e=(r=i.context).horizontal,r=r.vertical,this.oSi(r)&&this.dSi(r,i.context,"vertical",t,n),this.oSi(e))&&this.dSi(e,i.context,"horizontal",t,n)},u.prototype.aSi=function(c,f,t){var a,h,a=this,h=function(t){var n,i,r,e,o,u,s,n=t.cell;if(a.oSi(n)&&a.dSi(n,t,"cell",c,f),t.and)for(i=0,r=t.and;i<r.length;i++)e=r[i],h(e);if(t.or)for(o=0,u=t.or;o<u.length;o++)s=u[o],h(s)};t.filter&&t.filter.condition&&h(t.filter.condition)},u.prototype.lSi=function(i,r,t){var e=this;"Group"===t.type&&t.bins&&t.bins.forEach(function(n){e.pSi(n.groupBy).forEach(function(t){e.dSi(t,n,"groupBy",i,r,e.WEi)})})},u.prototype.vSi=function(n,i,r){var e=this;r.defaultValue&&this.pSi(r.defaultValue).forEach(function(t){e.dSi(t,r,"defaultValue",n,i,e.WEi)})},u.prototype.dSi=function(t,n,i,r,e,o){var t,n,t=this.uSi(t,n,i,o),n=this.REi.get(r,e);n||this.REi.set(r,e,n=[]),n.push(t)},u.prototype.uSi=function(t,n,i,r){var e,t,t,e=this.wSi(),t=this.gSi(t);return this.Mf.addCustomName(e,t,0,0),this.VEi[(t={name:e,obj:n,key:i,cSi:r}).name]=t},u.prototype.pSi=function(t){var t,n;return t?(t=this.Ywt(t),n=[],t.forEachNodes(function(t){var t;t.type===a.ExpressionType.reference&&(t=(0,h.MSi)(t.row,t.column),-1===n.indexOf(t))&&n.push(t)}),n):[]},u.prototype.wSi=function(){return"".concat(this.kEi).concat(Math.random().toString().substring(2)).concat((new Date).getTime())},u.prototype.oSi=function(t){return this.UEi.test((t||"").toUpperCase())},u.prototype.gSi=function(t){var t=this.UEi.exec(t);return t?"$"+t[1]+"$"+t[2]:null},u.prototype.fSi=function(t){var t=(0,r.expressionToFormula)(this.Mf,t);return t.substring(t.indexOf("!")+1)},u.prototype.rSi=function(t){var n=this;t.forEach(function(t){n.Mf.removeCustomName(t.name),n.VEi[t.name]=void 0})},n.CellReferenceHelper=u},"./dist/plugins/report/helpers/data-entry-helper.js":function(t,n,i){"use strict";var E,j,A,i,T,D,r;function e(t){this.MOi=t}Object.defineProperty(n,"__esModule",{value:!0}),n.DataEntryHelper=void 0,E=i("Common"),j=i("Core"),A=i("./dist/plugins/report/utils/utils.js"),i=i("./dist/plugins/report/resources/index.js"),T=j.GC$,D=i.rm.getResource.bind(i.rm),e.prototype.$4i=function(t,n,i){var r,e;"Preview"!==this.MOi.options.renderMode||(e=(r=this.MOi).reportWorksheet.reportDataModel,(0,A.ht)(e))||(e.$4i(t,n,i),r.repaint())},e.prototype.jSi=function(t,n){var i,r,e,o;"Preview"!==this.MOi.options.renderMode||(e=(r=this.MOi).reportWorksheet.reportDataModel,(0,A.ht)(e))||"updated"===(null==(i=null==(o=e.rEi(t,n))?void 0:o.group)?void 0:i.state)&&(e.$4i(t,n,o.group.oldValue),r.repaint())},e.prototype.q4i=function(t,n){var i,r,e,e,o,e,o,e,t,i=this.MOi;"Preview"===i.options.renderMode&&i.reportWorksheet.isExpandable(t,n)&&(e=(r=i.reportWorksheet).reportDataModel,(0,A.ht)(e)||(i.suspendPaint(),o=(e=e.q4i(t,n)).success,e=e.nextActiveCell,o&&e&&(e=(o=this.acr(e,t,n)).nextActiveRow,t=o.nextActiveCol,r.setActiveCell(e,t),r.showCell(e,t,j.VerticalPosition.nearest,j.HorizontalPosition.nearest)),i.resumePaint()))},e.prototype.tEi=function(t,n){var i,r,r,t,n,i=this.MOi;"Preview"===i.options.renderMode&&i.reportWorksheet.isExpandable(t,n)&&(r=i.reportWorksheet.reportDataModel,(0,A.ht)(r)||(i.suspendPaint(),t=(r=r.tEi(t,n)).success,n=r.nextActiveCell,t&&n&&(i.Mf.setActiveCell(n.row,n.col),i.Mf.showCell(n.row,n.col,j.VerticalPosition.nearest,j.HorizontalPosition.nearest)),i.resumePaint()))},e.prototype.ISi=function(){return this.CSi},e.prototype.bSi=function(t,n){this.mSi=t,this.CSi=n},e.prototype.ySi=function(){var i,r,t,a,n,e,o,u,s,c,f,h,l,v,d,p,w,I,M,g,C,N,r=new Promise(function(t){i=t}),t=this.MOi,a=t.getParent(),n=function(t,n){return i({success:!0,error:t,invalidCells:n}),r};try{if("Preview"!==this.MOi.options.renderMode)return n("Is_Not_Preview_Mode");if(!(e=t.reportWorksheet.reportDataModel))return n("ReportService_Is_Empty");if(T[T.sd]({jS:a},1),o=e.cEi(),u=e.nEi(),this.mSi&&"function"==typeof this.mSi)return s=t.getTemplate().getDataEntrySetting(),c=u.map(function(t,n){return{records:t.records,deleteRecords:t.deletedRecords,rule:s[n]}}),this.mSi(c,o);if(0<o.length)return t.reportWorksheet.jT(j.InvalidOperationType.reportSheet,E.Common.zf.I5(D().ContainsInvalidCells,[o.map(function(t){return t.join("-")}).toString()])),n("Contains_Invalid_Cells",[o.map(function(t){return t.join("-")}).toString()]);h=f=0,l=!1,v=[],d=[],p=[],w=[],I=[],M=[],g=function(){l&&0===f&&0===h&&(e.Mtr(p,w),t.repaint(),i({success:0===v.length&&0===d.length,updateFailedRecords:v,deleteFailedRecords:d}))},C=function(){f--,g()},N=function(){h--,g()},u.forEach(function(t){var n,r,i,e,o,u,t,s,c,f;"Smart"===t.dataCollectionSetting.type&&(n=t.dataCollectionSetting,0!==(r=n.fields.filter(function(t){return t.isPrimary})).length)&&(i=t,e=a.dataManager().tables[n.tableName])&&(o=e._dataSource.LEt.batch,u=e.getDataSync(),t=i.records.map(function(i){return(0,A.NSi)(u,function(n){return r.every(function(t){return n[t.dbColumnName]===i.entity[t.dbColumnName]})})}),s=!1,c=function(t,n){h++,e.saveItem(t,function(){p.push(i.records[n]),N()},function(){v.push(i.records[n]),N()})},t.forEach(function(t,n){-1!==t&&(e.updateItem(t,i.records[n].entity),o||c(t,n),s=!0)}),f=u.length,t.forEach(function(t,n){-1===t&&(e.insertItem(f,i.records[n].entity),o||c(f,n),f++,s=!0)}),i.deletedRecords.forEach(function(i){var t=(0,A.NSi)(e.getDataSync(),function(n){return r.every(function(t){return n[t.dbColumnName]===i.entity[t.dbColumnName]})});-1!==t&&(o?e.remove(t,1):(h++,e.remove(t,1,function(){w.push(i),N()},function(){d.push(i),N()})),s=!0)}),o)&&s&&!I.includes(e)&&(I.push(e),M.push(i))}),I.forEach(function(t,n){f++,t.submitChanges().then(function(t){t?(M[n].records.forEach(function(t){p.push(t)}),M[n].deletedRecords.forEach(function(t){w.push(t)})):(M[n].records.forEach(function(t){v.push(t)}),M[n].deletedRecords.forEach(function(t){d.push(t)})),C()})}),l=!0,g()}catch(t){i({success:!1,error:t})}return r},e.prototype.acr=function(t,n,i){var r,e,o,u,s,c,f,a,h,u,e=this.MOi,o=e.reportWorksheet,u=o.reportDataModel,s=t.row,c=t.col;if(0===u.L5t(s)||0===u.F5t(c)){for(f=o.Q3i(n,i),a=t.cellNode,h=e.templateSheet;a&&"List"===(null==(r=a.templateCell.dataSetting)?void 0:r.type)&&1===a.children.length;)if(a=a.children[0],0<+h.getRowHeight(a.templateCell.row)&&0<+h.getColumnWidth(a.templateCell.col)){f=a;break}(u=e.getCells(f.templateCell.row,f.templateCell.col,s,c)[0])&&(s=u.row,c=u.col)}return{nextActiveRow:s,nextActiveCol:c}},n.DataEntryHelper=e},"./dist/plugins/report/helpers/pagination-helper.js":function(t,n,i){"use strict";var I,M,g,C,h,l,v,r;function e(t,n){this.LCi=t;var t=(this._Ci=n).getPaginationInfo();this.DSi=t?t.pages:[],this.OSi=new M.PrintInfo,this.ASi=this.OSi.toJSON()}Object.defineProperty(n,"__esModule",{value:!0}),n.PaginationHelper=void 0,I=i("Core"),M=i("Print"),g=i("./dist/plugins/report/utils/utils.js"),C=i("./dist/plugins/report/overrides/sheet-override.js"),h=i("ConditionalFormatting"),l=Math.min,v=Math.max,e.prototype.TSi=function(t){return null!=t&&(t=parseInt(t,10)||0)!==this.ESi&&0<=t&&this.DSi.length>t&&(this.ESi=t,this.SSi(),this._Si(t)),{currentPage:this.xSi,currentPageIndex:this.ESi,range:this.DSi[this.ESi]}},e.prototype.zSi=function(){return this.DSi.length},e.prototype.gOi=function(t,n,i){var r,e,o,u,s,c,f,a,a,r=this,e=r.LCi.getParent(),o=r.LCi.name(),u=[],s=r.zSi();for(r.SSi(),c=0;c<s;c++)r.ESi=c,f="".concat(o,"-").concat(c+1),t&&(a=t(c),(0,g.ht)(a)||(f=a.toString())),e&&(f=this.LSi(f,e)),a=this._Si(c,f,i),n&&n(a),u.push(a);return u},e.prototype.Gf=function(){return new e(this.LCi,this._Ci)},e.prototype.PSi=function(t,n){for(var i,r,e,o,i=this.DSi,r=0,e=i.length;r<e;r++)if((o=i[r]).row<=t&&o.rowEnd>=t&&o.col<=n&&o.colEnd>=n)return r},e.prototype.LSi=function(t,n){for(;n.Gm(t);)t="".concat(t,"(2)");return t},e.prototype._Si=function(t,n,i){var r,e,n,n,o,n,u,s,c,f,t,n,a,h,l,v,d,p,w,r=this,e=new I.Worksheet(n||r.LCi.name());if(e.parent=r.LCi.parent,r.fSt(e),n=r.OSi,i?(n=new M.PrintInfo).fromJSON(r.ASi):(0,C.BSi)(e,r.LCi.reportSheet),n.sheet(e),e.printInfo(n),(n=e.printInfo()).fitPagesTall(1),n.fitPagesWide(1),this.xSi=e,(0,g.GSi)(r.LCi.reportSheet.templateSheet,e),e.options.isProtected=!0,e.options.disableContextMenu=!0,e.options.gridline.showHorizontalGridline=!1,e.options.gridline.showVerticalGridline=!1,o=r.LCi,u=(n=r.DSi[t]).row,s=n.col,c=n.rowEnd,f=n.colEnd,t=Math.max(c-u+1,0),n=Math.max(f-s+1,0),e.setRowCount(t),e.setColumnCount(n),0!==t&&0!==n&&(o.vT(u,s,0,0,t,n,I.CopyToOptions.all&~I.CopyToOptions.formula&~I.CopyToOptions.conditionalFormat,!1,!1,e,{ignoreValidator:!0}),a=this.kSi(u,s)))for(h=a.row,l=a.col,v=h+a.rowCount-1,d=l+a.colCount-1;h<=v;h++){for(;l<=d;l++)e.setStyle(h-u,l-s,o.getActualStyle(h,l));l=a.col}for(p=u;p<=c;p++)e.setRowHeight(p-u,o.getRowHeight(p));for(w=s;w<=f;w++)e.setColumnWidth(w-s,o.getColumnWidth(w));return r.xOi(u,s),r.RSi(u,s),r.ZSi(u,s),r.VSi(u,s),r.lSt(e),i||(0,C.USi)(e,r.LCi.reportSheet),e},e.prototype.kSi=function(t,n){var i,r,i,t,n,i=this,r=i.xSi,i=i.LCi,t=new I.Range(t,n,r.getRowCount(),r.getColumnCount()),n=i.getUsedRange(I.UsedRangeType.conditionFormat);if(n)return-1!==n.row&&-1!==n.rowCount||(n.row=0,n.rowCount=i.getRowCount()),-1!==n.col&&-1!==n.colCount||(n.col=0,n.colCount=i.getColumnCount()),t.getIntersect(n,r.getRowCount(),r.getColumnCount())},e.prototype.xOi=function(t,n){var i,i,r,i,e,i,o,u,s,c,f,f,i=this,r=i.xSi,i=i.LCi,e=new I.Range(t,n,r.getRowCount(),r.getColumnCount()),i=null==(i=i.cellStates)?void 0:i.all();if(null!=i&&i.length)for(o=[I.CellStatesType.hover,I.CellStatesType.selected,I.CellStatesType.active],u=0,s=i;u<s.length;u++)f=(c=s[u]).range,0<=o.indexOf(c.state)&&(f=f.getIntersect(e,r.getRowCount(),r.getColumnCount()))&&(f.row=f.row-t,f.col=f.col-n,r.cellStates.add(f,c.state,c.style))},e.prototype.RSi=function(s,c){var t,t,f,t,a,n,i,r,e,o,u,t=this,f=t.xSi,t=null==(t=t.LCi.conditionalFormats)?void 0:t.getRules(),a=new I.Range(s,c,f.getRowCount(),f.getColumnCount()),n=function(t){for(var n,i,r,e,o,u,n,i=[],r=0,e=t.ranges();r<e.length;r++)(u=(o=e[r]).getIntersect(a,f.getRowCount(),f.getColumnCount()))&&(u.row=u.row-s,u.col=u.col-c,i.push(u));return i};if(null!=t&&t.length)for(i=0,r=t;i<r.length;i++)(e=r[i])instanceof h.StateRule?(o=n(e)).length&&(e.ruleType()===h.RuleType.rowStateRule?f.conditionalFormats.addRowStateRule(e.state(),e.style(),o):e.ruleType()===h.RuleType.columnStateRule&&f.conditionalFormats.addColumnStateRule(e.state(),e.style(),o)):e instanceof h.DataBarRule?(o=n(e)).length&&((u=f.conditionalFormats.addDataBarRule(e.minType(),e.minValue(),e.maxType(),e.maxValue(),e.color(),o)).showBarOnly(e.showBarOnly()),u.gradient(e.gradient()),u.borderColor(e.borderColor()),u.showBorder(e.showBorder()),u.dataBarDirection(e.dataBarDirection())):e instanceof h.IconSetRule&&(o=n(e)).length&&((u=f.conditionalFormats.addIconSetRule(e.iconSetType(),o)).showIconOnly(e.showIconOnly()),u.reverseIconOrder(e.reverseIconOrder()))},e.prototype.ZSi=function(t,n){var i,r,e,o,u,i,s,c,f,a,h,l,v,d,p,w,a,r=this,e=r.xSi,o=null==(i=r.LCi.b8)?void 0:i.YB;if(o&&(e.b8.fromJSON(r.LCi.b8.toJSON(),null,e),e.b8.d5(),u=new I.Range(t,n,e.getRowCount(),e.getColumnCount()),(i=Object.keys(o)).length))for(s=0,c=i;s<c.length;s++){for(l=[],v=0,d=h=(a=o[f=c[s]]).smt();v<d.length;v++)(w=(p=d[v]).getIntersect(u,e.getRowCount(),e.getColumnCount()))&&(w.row=w.row-t,w.col=w.col-n,l.push(w));l.length&&((a=a.clone(e))._S=l,a.g6t(l),e.b8.w6t(a))}},e.prototype.VSi=function(t,n){var i,r,e,r,o,u,s,c,f,a,h,l,v,d,v,d,i=this,r=i.LCi,e=i.xSi;if(r.shapes)for(r=r.shapes.all(),o=e.getRowCount()+t,u=e.getColumnCount()+n,s=new I.Range(t,n,o-t,u-n),c=0,f=r;c<f.length;c++)h=(a=f[c]).startRow(),l=a.startColumn(),v=a.endRow(),d=a.endColumn(),s.intersect(h,l,v-h+1,d-l+1)&&s.intersect(h,l,1,1)&&(v=a.Gf(e),e.shapes.ZP(v),d=i.HSi(a,t,n,o-1,u-1),v.width(d.width),v.height(d.height),v.x(d.x),v.y(d.y))},e.prototype.HSi=function(t,n,i,r,e){var o,u,s,t,n,i,c,f,a,h,o=t.x(),u=t.y(),s=t.width()+o,t=t.height()+u,n=(0,g.WSi)(this.LCi,n,i),i=(0,g.WSi)(this.LCi,r,e),c,f,a,h;return{x:v(o-n.x,0),y:v(u-n.y,0),width:l(i.x+i.width,s)-o,height:l(i.y+i.height,t)-u}},e.prototype.SSi=function(){this.ASi=this.LCi.reportSheet.printInfo().toJSON(),this.OSi.fromJSON(this.ASi),this.OSi.showRowHeader(1),this.OSi.showColumnHeader(1)},e.prototype.fSt=function(t){t.suspendPaint(),t.suspendEvent(),t.suspendDirty()},e.prototype.lSt=function(t){t.resumeDirty(),t.resumeEvent(),t.resumePaint()},n.PaginationHelper=e},"./dist/plugins/report/helpers/parameter-helper.js":function(t,e,n){"use strict";var i,r,c,f,o,a,h,l,u,v,s;function d(t,n){var i=n.host,r=n.initParametersUI,n=n.onChange;this.MOi=t,this.Ti=i,this.QSi=r,this.FSi=n,this.YSi=this.JSi(),this.ltr=Object.assign({},t.parameter())}Object.defineProperty(e,"__esModule",{value:!0}),e.ParameterHelper=e.PARAMETER_PANEL_WORKBOOK=void 0,i=n("Core"),r=n("Common"),c=n("Bindings"),f=n("CellTypes"),o=i.GC$,a=r.Common.lt.ht,h=".parameterPanelEvent",l=".parameterPanelChangedEvent",u=null,v=void 0,e.PARAMETER_PANEL_WORKBOOK="workbook",d.prototype.KSi=function(){var t=this,n=t.YSi;t.XSi(n),t.$Si(n)},d.prototype.L0=function(t,n){var i=this,r=i.YSi;t&&(i.qSi(),i.t3i(),r.destroy(),delete i.YSi,o(i.Ti).data(e.PARAMETER_PANEL_WORKBOOK,u))},d.prototype.JSi=function(){var t,n,n,t=this,n=t.Ti,n=o(n).data(e.PARAMETER_PANEL_WORKBOOK);return n||(n=new i.Workbook(t.Ti,{sheetCount:1}),o(t.Ti).data(e.PARAMETER_PANEL_WORKBOOK,n)),n.options.allowDynamicArray=!0,n},d.prototype.XSi=function(t){var n,i,r,r,n=this;t.suspendPaint(),t.suspendEvent(),i=t.getActiveSheet(),(r=this.MOi.vOi)&&i.fromJSON(r),n.QSi(i),r=i.toJSON({}),t.options.highlightInvalidData&&(r.highlightInvalidData=!0),this.MOi.vOi=r,n.n3i(i),t.resumeEvent(),t.resumePaint()},d.prototype.n3i=function(t){var n,i,i,r,e,o,u,s,n,i=this.MOi.parameter(),i=new c.CellBindingSource(i);for(t.setDataSource(i),r=t.getRowCount(),e=t.getColumnCount(),o=0;o<r;o++)for(u=0;u<e;u++)((s=t.getCell(o,u)).bindingPath()||s.cellType())&&s.locked(!1)},d.prototype.$Si=function(t){var n,i,n,i=this,n=t.getActiveSheet();t.suspendPaint(),t.suspendEvent(),i.i3i(t),i.r3i(n),i.e3i(t),t.setDataManager(null==(n=this.MOi.getParent())?void 0:n.dataManager()),t.resumeEvent(),t.resumePaint()},d.prototype.i3i=function(t){t.options.allowContextMenu=!1,t.options.allowUserZoom=!1,t.options.showVerticalScrollbar=!1,t.options.showHorizontalScrollbar=!1,t.options.tabStripVisible=!1,t.options.allSheetsListVisible=i.AllSheetsListVisibility.hide,t.options.allowUserDragDrop=!1},d.prototype.r3i=function(t){t.options.colHeaderVisible=!1,t.options.rowHeaderVisible=!1,t.setRowCount(100),t.setColumnCount(100),t.options.gridline.showHorizontalGridline=!1,t.options.gridline.showVerticalGridline=!1,t.selectionPolicy(i.SelectionPolicy.single),t.protect()},d.prototype.e3i=function(t){var u,s,r,c,u=this,s=u.MOi,r=t.getActiveSheet();u.qSi(),u.t3i(),r.bind(i.Events.TopRowChanged+h,function(t,n){r.showRow(0,i.VerticalPosition.top),n.newTopRow=0}),r.bind(i.Events.LeftColumnChanged+h,function(t,n){r.showColumn(0,i.HorizontalPosition.left),n.newLeftCol=0}),r.bind(i.Events.EditStarting+h,function(t,n){var i,r,e,o,u,i=n.sheet,r=n.row,e=n.col,o,u;i.getCell(r,e).cellType()instanceof f.CheckBox&&(n.cancel=!0)}),u.Ti.addEventListener("contextmenu",u.o3i),i.Worksheet.ch("parameterPanel",{priority:1800,needPaintSelection:function(t){var n,i,n;this===r&&(n=this.getActiveRowIndex(),i=this.getActiveColumnIndex(),(n=this.getCell(n,i)).bindingPath()||n.cellType()||(t.nps=!1))}}),c=function(t,n,i,r,e,o){var n,i,n,t,i,n=t.getCell(n,i),i=n.tag(),n=n.bindingPath(),t=t.getDataSource().getSource();!a(n)&&a(e)&&(t[n]=e=""),s.parameter(t),i={tag:a(i)?n:i,oldValue:o?u.ltr[n]:r,newValue:e},u.FSi(s,i),i.newValue!==e&&t&&n&&(t[n]=i.newValue,s.parameter(t)),u.ltr=Object.assign({},s.parameter())},r.bind(i.Events.ValueChanged+l,function(t,n){var i=n.sheet,r=n.row,e=n.col,o=n.newValue,n=n.oldValue;i&&c(i,r,e,n,o)}),r.bind(i.Events.RangeChanged+l,function(t,n){var i=n.sheet,n=n.changedCells;i&&null!=n&&n.length&&n.forEach(function(t){var n=t.row,t=t.col;void 0!==n&&void 0!==t&&c(i,n,t,void 0,i.getValue(n,t),!0)})}),t.bind(i.Events.ButtonClicked+l,function(t,n){var i,r,n,i,r,n,i=n.sheet,r=n.row,n=n.col;!i||(r=(i=i.getCell(r,n)).cellButtons())&&r.length||(n={tag:i.tag(),oldValue:v,newValue:v},u.FSi(s,n))})},d.prototype.qSi=function(){var t,n,i,t,n=this.YSi,i=n.getActiveSheet();n&&n.unbind(l),i&&i.unbind(l)},d.prototype.t3i=function(){var t,n,t=this,n=t.YSi.getActiveSheet();n&&n.unbind(h),t.Ti.removeEventListener("contextmenu",t.o3i)},d.prototype.o3i=function(t){t.preventDefault()},e.ParameterHelper=d},"./dist/plugins/report/helpers/smart-cache.js":function(t,n){"use strict";var i;function r(){this.cE=[]}Object.defineProperty(n,"__esModule",{value:!0}),n.SmartCache=void 0,r.prototype.get=function(t,n){if(this.cE[t])return this.cE[t][n]},r.prototype.set=function(t,n,i){this.cE[t]||(this.cE[t]=[]),this.cE[t][n]=i},r.prototype.getCache=function(){return this.cE},r.prototype.reset=function(){this.cE=[]},n.SmartCache=r},"./dist/plugins/report/helpers/template-alias-helper.js":function(t,n,i){"use strict";var a,c,s,r;function e(t){this.u3i=new s.SmartCache,this.template=t}Object.defineProperty(n,"__esModule",{value:!0}),n.AliasHelper=void 0,a=i("Core"),c=i("./dist/plugins/report/utils/utils.js"),s=i("./dist/plugins/report/helpers/smart-cache.js"),e.prototype.s3i=function(t,n,i){var r,e,o,u,s,o,r,e=this.template,o=this.c3i(t,n,i),u=o.oldAlias,s=o.newAlias,o=o.oldColumnInfo;if(u!==s){if(s){e.getCustomName(s)&&(s=this.f3i(s));try{this.template.addCustomName(s,(0,c.h3i)(t,n),0,0),this.u3i.set(t,n,s),i.alias=s,this.a3i(u,s)}catch(t){if(o===i.binding)return void(i.alias=u);i.alias=s=null}}u&&(s||this.u3i.set(t,n,null),this.template.removeCustomName(u))}},e.prototype.a3i=function(t,n){var i,r,e,o,u,s,c,f,i,r=this.template;if(t&&n&&(e=r.getUsedRange(a.UsedRangeType.formula)))for(u=e.row+e.rowCount-1,s=e.col+e.colCount-1,c=e.row;c<=u;c++)for(f=e.col;f<=s;f++)(o=r.bMt(c,f))&&this.l3i(o,t,n)},e.prototype.l3i=function(t,n,i){var r,e,o;if(8===t.type&&t.value.toLocaleUpperCase()===n.toLocaleUpperCase()&&(t.value=i),t.arguments)for(r=0,e=t.arguments;r<e.length;r++)o=e[r],this.l3i(o,n,i);t.value&&this.l3i(t.value,n,i),t.value2&&this.l3i(t.value2,n,i)},e.prototype.v3i=function(){var t,n,i,r,e,t,o,u,n=this,i=n.template;for(n.etr(),n.u3i=new s.SmartCache,r=i.getRowCount()-1,e=i.getColumnCount()-1,o=0;o<=r;o++)for(u=0;u<=e;u++)(t=null==(t=i.getTemplateCell(o,u))?void 0:t.alias)&&(n.u3i.set(o,u,t),n.template.addCustomName(t,(0,c.h3i)(o,u),0,0))},e.prototype.etr=function(){for(var t,n,i,r,e,o,t=this,n=t.d3i(),i,r=0,e=Object.keys(n);r<e.length;r++)o=e[r],t.template.removeCustomName(o)},e.prototype.XEi=function(t){var n;t.names&&(n=this.d3i(),t.names=t.names.filter(function(t){return!n[t.name]}))},e.prototype.$Ei=function(t){var n,i;null!=(n=null==t?void 0:t.lossless)&&n.definedNames&&(i=this.d3i(),t.lossless.definedNames=t.lossless.definedNames.filter(function(t){return!i[t.name]}))},e.prototype.d3i=function(){var n={},t;return this.u3i.getCache().forEach(function(t){t&&t.forEach(function(t){t&&(n[t]=!0)})}),n},e.prototype.c3i=function(t,n,i){var i,r,e,r=this,e={oldAlias:r.u3i.get(t,n),newAlias:null,oldColumnInfo:null};return i&&(e.newAlias=i.alias),e.oldColumnInfo=null==(i=r.template.getTemplateCell(t,n))?void 0:i.binding,e},e.prototype.f3i=function(t,n){var i=this,r=(n=void 0===n?0:n)?t+"_"+n:t;return this.template.getCustomName(r)?i.f3i(t,++n):r},n.AliasHelper=e},"./dist/plugins/report/helpers/template-tooltip-helper.js":function(t,n,i){"use strict";var r,e,o,f,a,h,u;function s(t){this.dV=t}Object.defineProperty(n,"__esModule",{value:!0}),n.TemplateTooltipHelper=void 0,r=i("Common"),e=i("Core"),o=i("./dist/plugins/report/resources/index.js"),f=i("./dist/plugins/report/template/utils.js"),a=o.rm.getResource.bind(o.rm),h=r.Common.zf,s.prototype.p3i=function(t,n){var i,r,e,o,u,s,r,c,i=this.dV,r=i.getTemplateCell(t,n),e=[];if(r){switch(o=(0,f.w3i)(r),u="",r.type){case"List":u=a().listCellType;break;case"Group":u=a().groupCellType;break;case"Summary":u=a().summaryCellType}if("Summary"===r.type){switch(s="",r.aggregate){case"Sum":s=a().summarySumTip;break;case"Avg":s=a().summaryAvgTip;break;case"Max":s=a().summaryMaxTip;break;case"Min":s=a().summaryMinTip;break;case"Count":s=a().summaryCountTip;break;case"None":s=a().summaryNoneTip}u+=s}"Chart"!==r.type&&"Static"!==r.type&&e.push(a().toolTipCellType+u),o&&(o.tableName&&e.push(a().toolTipTableName+o.tableName),o.columnName)&&e.push(a().toolTipColumnName+o.columnName)}if((r=i.getFormula(t,n))&&e.push(a().toolTipFormula+r),0<e.length){for(c=0;c<e.length;c++)e[c]=h.j0(e[c]);return e.join("\r\n")}},n.TemplateTooltipHelper=s,e.GC$.extend(e.Workbook.prototype,{rpwm:function(t,n,i){return i?[a().wmk1,0]:-1===t?i?[a().wmk1,0]:[a().wmk2,1]:void 0}}),e.GC$.extend(e.Worksheet.prototype,{rpwm:function(t,n,i){return i?[a().wmk1,0]:-1===t?i?[a().wmk1,0]:[a().wmk2,1]:void 0}})},"./dist/plugins/report/index.js":function(t,n,i){"use strict";var r,e,o;Object.defineProperty(n,"__esModule",{value:!0}),n.SR=n.TemplateSheet=n.ReportSheet=void 0,r=i("./dist/plugins/report/report-sheet.js"),Object.defineProperty(n,"ReportSheet",{enumerable:!0,get:function(){return r.ReportSheet}}),e=i("./dist/plugins/report/worksheet/template-sheet.js"),Object.defineProperty(n,"TemplateSheet",{enumerable:!0,get:function(){return e.TemplateSheet}}),o=i("./dist/plugins/report/resources/report.ns.js"),Object.defineProperty(n,"SR",{enumerable:!0,get:function(){return o.SR}}),i("./dist/plugins/report/definition-comments/index.js")},"./dist/plugins/report/overrides/feature-register.js":function(t,n,i){"use strict";var l,r,e,c,o,v,f,d,p,w,u,I,M,g;function C(t){var n,n;return t&&(n=t.getParent())&&(n=n.getSheetTab(t.name()))instanceof o.ReportSheet?n:null}function s(){function a(t){t instanceof d.TemplateSheet&&t.enqueueBuildExpansionInfoCacheMessage()}function h(t,n){t instanceof d.TemplateSheet&&n.sheetArea===l.SheetArea.viewport&&t.buildBreadLineCache()}function u(t,n,i,r){var t,e,o,u,o,s,c,f,f,t,t,f,t=t,e=t.options,o=t.Ut,u=o.getRowCount(r),o=o.getColumnCount(r);return 1===r?((f=t.H3)&&f._dataSource&&(f=t.Ut.q_(!1,3,i),t=e.colHeaderAutoTextIndex,f)&&(0<=t&&n===t||-1===t&&n===u-1)&&(c=f.displayName||f.name),(0,v.ht)(c)&&n===(s=(s=e.colHeaderAutoTextIndex)<0||u<=s?u-1:s)&&(2===(t=e.colHeaderAutoText)?c=l.util.Vf(i+1):1===t&&(c=i+1))):2===r&&(0,v.ht)(c)&&i===(s=(s=e.rowHeaderAutoTextIndex)<0||o<=s?o-1:s)&&(2===(f=e.rowHeaderAutoText)?c=l.util.Vf(n+1):1===f&&(c=n+1)),c}function s(t,n,i,r,e){var o,u,t,s,c,f,o,o=t.getPaginationSetting(),u=t.getRowCount(r),t=t.getColumnCount(r);return o&&(s=o.titleRow,c=o.endRow,f=o.titleCol,o=o.endCol,1===r&&(f||o)&&n===u-1?f&&f.start<=i&&f.end>=i?e+="(HR)":o&&o.start<=i&&o.end>=i&&(e+="(FR)"):2===r&&(s||c)&&i===t-1&&(s&&s.start<=n&&s.end>=n?e+="(H)":c&&c.start<=n&&c.end>=n&&(e+="(F)"))),e}l.Workbook.ch("reportSheet",{adlc:function(t){var n,i,r,e,o,t,u,s,c,f,n=t.flg,i=t.checkRs,r=t.m,e=t.d,o=t.nl,t=t.fn,u,s=["tSheet","epor"],c=this.rpwm||this.parent&&this.parent.rpwm;n&&-1===n.indexOf("r".toUpperCase()+s[1]+s[0])?(i.wm=i.wm||[],(f=c&&c(r,e,!0))&&i.wm.push(f),i.nwm=!0,i.state||(i.state=[]),i.state.push(["rpe",0]),i.dis||(i.dis=[]),i.dis.push("7265706f72745368656574"),this.parent&&t&&t(this,i.dis,"ad")):-1===r&&(i.wm=i.wm||[],(f=c&&c(r,e,!1))&&i.wm.push(f),i.nwm=!0)},init:function(){(0,r.registerCommands)(this.commandManager())},createSheetTab:function(t){var n=this.ls,i,r=["e","p"];n&&0===n["r"+r[1]+r[0]]&&(n.hl||!n.b)||t.type!==l.SheetType.reportSheet||(t.name||(t.name=(0,v.g3i)(this.mp)),t.sheetTab=new o.ReportSheet(t.name))},createSheet:function(t){var n=this.ls,i,r=["e","p"];n&&0===n["r"+r[1]+r[0]]&&(n.hl||!n.b)||t.type!==l.WorksheetType.reportTemplateSheet||(t.sheet=new d.TemplateSheet(t.name))},getAdditionalWorksheetToSJSFormat:function(t){for(var n,i,r,e,o,n,i=0,r=this.mp;i<r.length;i++)(e=r[i])._gi===l.SheetType.reportSheet&&(o=void 0,o=t.fileType===l.OpenSaveFileType.excel?e.getSheet():e.templateSheet)&&t.sheets.push(o)},getAdditionalSheet:function(t){for(var n,i,r,e,e,n,i=0,r=this.mp;i<r.length;i++)(e=r[i])._gi===l.SheetType.reportSheet&&(e=e.templateSheet)&&t.sheets.push(e)},onCultureChanged:function(){g()}}),l.Workbook.ch("printSheet",{init:function(){(0,r.registerCommands)(this.commandManager())},createSheetTab:function(t){var n=this.ls,i,r=["e","p"];n&&0===n["r"+r[1]+r[0]]&&(n.hl||!n.b)||t.type!==l.SheetType.printSheet||(t.sheetTab=new e.PrintSheet)}}),l.Y8.ch("reportSheet",{isValid:function(t){return this.Mf.isReportWorkSheet},getValue:function(t){var n,i,r,e;this.Mf.isReportWorkSheet&&(n=t.row,i=t.col,r=t.sheetArea,e=this.Mf,r===l.SheetArea.viewport)&&(t.value=e.z4i(n,i),t.isValueGet=!0)},setValue:function(t){var n,i,r,e,o,n=this.Mf;n.isReportWorkSheet&&n.allowEditing&&(i=t.row,r=t.col,e=t.sheetArea,o=t.value,e===l.SheetArea.viewport)&&(n.reportSheet.updateCellValue(i,r,l.util.V0(o)),t.isValueSet=!0)},clear:function(t){var n,i,r,e,t,o,u,s,n=t.row,i=t.col,r=t.rowCount,e=t.colCount,t=t.sheetArea,o=this.Mf;if(t===l.SheetArea.viewport&&o instanceof f.ReportWorksheet)for(u=n;u<n+r;u++)for(s=i;s<i+e;s++)o.reportSheet.updateCellValue(u,s,null)},getStyle:function(t){var n,i,r,n,e,n,o,o,n,o,n,o,u,s;this.Mf.isReportWorkSheet&&(i=t.row,r=t.col,n=t.sheetArea,e=this.Mf,n===l.SheetArea.viewport)&&((n=e.M3i(i,r))&&(null!=(o=n.cellButtons)&&o.length&&(n.cellButtons=o.filter(function(t){return"ReportCollapseButtonToggle"!==t.command&&"ReportCollapseButtonToggle-empty"!==t.command})),(o=new l.Style).h5(n),t.style=o),t.style&&"PaginatedPreview"===e.reportSheet.renderMode()?(t.style.cellButtons=void 0,t.style.dropDowns=void 0,t.style.cellType=void 0):"Preview"===e.reportSheet.renderMode()&&e.reportDataModel&&(n=e.reportDataModel.rEi(i,r),o=e.reportSheet.templateSheet,o=(n=null==(n=null==n?void 0:n.cellNode)?void 0:n.templateCell)&&o.getTemplateCell(n.row,n.col))&&(u=e.hEi(i,r),o.showCollapseButton)&&"No"!==n.expansionDirection&&(t.style||(t.style=new l.Style),1<(s=e.Ctr(i,r))?(0,v.j3i)(t.style,u):(0,v.Ntr)(t.style)),t.isStyleGet=!0)},getSpans:function(t){var n,i,r,e,o,u,s,c,u;this.Mf.isReportWorkSheet&&(n=t.row,i=t.col,r=t.rowCount,e=t.colCount,o=t.isAll,u=t.sheetArea,s=t.spans,c=this.Mf,u===l.SheetArea.viewport)&&(u=void 0,o?u=c.I3i():!(0,v.ht)(n)&&(0,v.ht)(r)?u=[c.C3i(n,i)]:(0,v.ht)(n)||(0,v.ht)(r)||(u=c.I3i(new l.Range(n,i,r,e))),!(0,v.ht)(u)&&0<u.length&&(0,v.pushArrayTo)(u,s),t.isSpansGet=!0)},getSize:function(t){var n,i,r,e;this.Mf.isReportWorkSheet&&(n=t.isRow,i=t.index,r=t.sheetArea,e=this.Mf,r===l.SheetArea.viewport?(t.size=n?e.b3i(i):e.m3i(i),t.isSizeGet=!0):r!==l.SheetArea.colHeader||n?r===l.SheetArea.rowHeader&&n&&(t.size=e.b3i(i),t.isSizeGet=!0):(t.size=e.m3i(i),t.isSizeGet=!0))},getHyperlink:function(t){var n=t.row,i=t.col,r=t.sheetArea,e=this.Mf;r===l.SheetArea.viewport&&e instanceof f.ReportWorksheet&&(t.hyperlink=e.y3i(n,i),t.isLinkGet=!0)},getLastNonNullRowOrCol:function(t){var n=t.sheetArea,i=t.isRow,r=this.Mf;n===l.SheetArea.viewport&&r instanceof f.ReportWorksheet&&(t.index=i?r.N3i():r.D3i(),t.isIndexGet=!0)}}),l.Worksheet.ch("reportSheet",{init:function(){var t=this;t instanceof f.ReportWorksheet&&t.initReportCalcSource()},paint:function(){var t,n,t=this;this instanceof f.ReportWorksheet&&"Preview"===this.reportSheet.renderMode()&&(n=t.Uw()).setContext()},applyEditingSetFormula:function(t){var n;t.sheetArea===l.SheetArea.viewport&&this instanceof f.ReportWorksheet&&"Design"!==this.reportSheet.renderMode()&&(t.isAllow=!1)},fromJsonAfterSJSFormula:function(){var n,t,t,i,n=this,t=this.parent;n instanceof d.TemplateSheet&&t&&(t=t.mp)&&(i=t.filter(function(t){return 3===t._gi&&t.getTemplate()===n})[0])&&i.fetchAllTablesAsync().then(function(){i.refresh()})},getActualToSJSFormatSheet:function(t){var n=C(t.sheet);n&&(t.sheet=n.templateSheet)},preProcessKeyDown:function(t){var n,i,i,n,i,n,n=this,i=C(n);i&&"Design"!==i.renderMode()&&(i=t.e,i=(n=n.Qy()).getShortcutKey(i.keyCode,i.ctrlKey,i.shiftKey,i.altKey,i.metaKey),n=n.getCommands(i),t.r=null==n?void 0:n.some(function(t){return"undo"===t.Zc||"redo"===t.Zc}))},getCellActualLockedInfo:function(t){var n,n,i,r,e,n=t.sheetArea;if(n===l.SheetArea.viewport&&this instanceof f.ReportWorksheet&&"Preview"===this.reportSheet.renderMode()&&(n=this.reportSheet.getStyle(t.row,t.col))&&n.cellButtons)for(i=0,r=n.cellButtons;i<r.length;i++)if("ReportCollapseButtonToggle"===(e=r[i]).command)return void(t.isLocked=!1)},getStatusBarSheetSource:function(t){this.isReportWorkSheet&&(t.sheetSource=new I.SheetSource(this))}}),l.Worksheet.ch("templateSheet",{paintCell:function(t){var n,i,r,e,o,t,t,e,n,n,e,n,i=this,r=t.ctx,e=t.sheetArea,o=t.cell,t=t.isPrinting;i instanceof d.TemplateSheet&&!t&&e===l.SheetArea.viewport&&(t=null,n=(e=i.getTemplateCell(o.row,o.col))?(0,w.O3i)(e):"No",e&&"Summary"!==e.type&&("H"===n?t|=c.TemplateCellPaintType.horizontalParent:"V"===n&&(t|=c.TemplateCellPaintType.verticalParent)),e&&e.filter&&e.filter.condition&&(t|=c.TemplateCellPaintType.filter),!(n=e&&e.pin)||"Row"!==n&&"Column"!==n&&"Both"!==n||(t|=c.TemplateCellPaintType.staticPin),null!=(n=null==(e=i.getPaginationSetting())?void 0:e.rowPagination)&&n.paginationDataCell&&(n=(0,v.QEi)(e.rowPagination.paginationDataCell))&&n.col===o.col&&n.row===o.row&&(t|=c.TemplateCellPaintType.paginationIcon),t)&&(0,c.A3i)(r,new l.Rect(o.x,o.y,o.width,o.height),t,i.templateOptions,i)},paintAdornment:function(t){var r,e,t,n,i,o,u,o,r=this,e=t.ctx,t=t.clipRect;r instanceof d.TemplateSheet&&(n=r.PEi(),i=[],(o=void 0,v.ht)(n.leftParent.row)||(i[0]=r.getCellRect(n.leftParent.row,n.leftParent.col),o=!0),(0,v.ht)(n.upParent.row)||(i[1]=r.getCellRect(n.upParent.row,n.upParent.col),o=!0),u=function(t,n,i){t&&(e.save(),e.rect(t.x,t.y,t.width,t.height),e.clip(),(0,c.T3i)(e,n,r.templateOptions,t.x,t.y,i),e.restore())},o)&&(u((o=(0,v.E3i)(r,n,t))[0],i[0],!0),u(o[1],i[1],!1))},sheetHighlightInvalid:function(t){var n,i=t.sheetArea;this instanceof d.TemplateSheet&&i===l.SheetArea.viewport&&(t.isNeedHighlightInvalid=!1)},adjustCustomNameOnMove:function(t){var n;this instanceof d.TemplateSheet&&(t.needAdjustCustomNameOnMove=!1)},getAllFunctions:function(t){var n,i,r,e,i,o,u,s,n=this,i=n.getParent(),r=i&&i.Amt,e=n.Amt;if(n.isReportTemplateSheet){if(t.funcs=t.funcs.filter(function(t){return!t.isFunc||r&&r[t.name.toUpperCase()]||e&&e[t.name.toUpperCase()]||t.isFunc&&-1<M.reportSupportFunctionNames.indexOf(t.name)}),i=n.getCustomNames())for(o=0,u=i;o<u.length;o++)s=u[o],t.funcs.push({name:s.getName(),description:s.getComment(),isFunc:!1});t.isFuncGet=!0}},onLayoutChanged:function(t){var n=this;!n.isReportTemplateSheet||"deleteRows"!==t.changeType&&"deleteColumns"!==t.changeType||n.updateAllAliasInfo()}}),l.Y8.ch("templateSheet",{isValid:function(){return this.Mf.isReportTemplateSheet},undoBindingPath:function(t){var n,i,r,t,n=this.Mf,i=t.row,r=t.col,t=t.value;n.isReportTemplateSheet&&n.setTemplateCell(i,r,t)},clear:function(t){var n,i,r,e,o,u,s,c,f,n=this.Mf,i=t.row,r=t.col,e,o,u=i+t.rowCount-1,s=r+t.colCount-1;if(n.isReportTemplateSheet)for(c=i;c<=u;c++)for(f=r;f<=s;f++)n.S3i(c,f,void 0);a(this.Mf),h(this.Mf,t)},getValue:function(t){var n,i,r,e,o,e,n=t.row,i=t.col,r=t.sheetArea,e=t.valueType,o=this.Mf;r!==l.SheetArea.colHeader&&r!==l.SheetArea.rowHeader||!o.isReportTemplateSheet||(e=this.W_(r).getValue(n,i,e),(0,v.ht)(e)&&(e=u(o,n,i,r)),(0,v.ht)(e)&&(e=""),t.value=s(o,n,i,r,e),t.isValueGet=!0)}}),p.ConditionalFormats.ch("templateSheet",{onRuleAdded:function(){a(this)},onRuleRemoved:function(){a(this)},onRuleUpdated:function(){a(this)}}),l.CellTypes.Base.ch("templateSheet",{beforePaintDecoration:function(t){var n,t,i,r,e,n,r,o,n=t.context,t=t.style,i=n.sheet,r=n.sheetArea,e=n.row,n=n.col;i.isReportTemplateSheet&&r===l.SheetArea.viewport&&t&&(r=i.getTemplateCell(e,n),o=(0,v.getTemplateIcon)(i,r,t))&&((0,v.rtr)(e,n,i,r,t)&&(t.textIndent=t.textIndent||1),t.decoration?t.decoration.icons||(t.decoration.icons=[]):t.decoration={icons:[]},t.decoration.icons=t.decoration.icons.filter(function(t){return!t.isReport}),t.decoration.icons.push(o))},beforePaintCellContent:function(t){var n,t,i,r,e,n,r,i,n=t.context,t=t.style,i=n.sheet,r=n.sheetArea,e=n.row,n=n.col;i.isReportTemplateSheet&&r===l.SheetArea.viewport&&t&&(r=i.getTemplateCell(e,n),null!=(i=t.cellButtons)&&i.length&&(t.cellButtons=i.filter(function(t){return"ReportCollapseButtonToggle"!==t.command})),r)&&r.showCollapseButton&&"None"!==r.spillDirection&&(0,v.j3i)(t,!1)}}),p.Condition.ch("reportSheet",{initConditionExpression:function(t){var n,i,r,t,n,i=t.expr,r=t.baseRow,t=t.baseCol;this.isReportWorkSheet&&(0,v.wtr)(i,r,t)}})}Object.defineProperty(n,"__esModule",{value:!0}),n.registerFeatures=void 0,l=i("Core"),r=i("./dist/plugins/report/commands/index.js"),e=i("./dist/plugins/report/print/print-sheet.js"),c=i("./dist/plugins/report/render/paint-template-cell.js"),o=i("./dist/plugins/report/report-sheet.js"),v=i("./dist/plugins/report/utils/utils.js"),f=i("./dist/plugins/report/worksheet/report-worksheet.js"),d=i("./dist/plugins/report/worksheet/template-sheet.js"),p=i("ConditionalFormatting"),w=i("./dist/plugins/report/template/utils.js"),u=i("./dist/plugins/report/resources/index.js"),I=i("SheetsCalc"),M=i("./dist/plugins/report/calc-model/supported-functions.js"),g=u.rm.getResource.bind(u.rm),n.registerFeatures=s},"./dist/plugins/report/overrides/sheet-override.js":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ser=n.USi=n.BSi=void 0;var c=i("Core");function r(t,n){t.TF=function(){return n},t.hP=function(){return!t.parent||t.parent.getActiveSheetTab()===n}}function e(t,n){t.printInfo=function(){return n.printInfo.apply(n,arguments)}}function o(t){var s=t.isEditingValueChanged;t.isEditingValueChanged=function(t,n,i){var r,e,o,u,r,r=i.sheet,e=i.row,o=i.col,u=i.sheetArea||c.SheetArea.viewport,r=r&&r.getValue(e,o,u,c.ValueType.richText);return(!r||"SparklineExValue"!==r.typeName)&&s(t,n,i)}}n.BSi=r,n.USi=e,n.ser=o},"./dist/plugins/report/print/print-sheet.js":function(t,n,i){"use strict";var r,u,i,e,o,s;function c(t,n,i,r){var e,o,e=s.call(this)||this,o=e;return o._gi=u.SheetType.printSheet,o.Mf=t||new u.Worksheet("s".concat(Math.random().toString().substring(1).replace(".","")).concat((new Date).getTime())),e._3i(),e.reportSheetName=n,e.reportPageIndex=i,e.E0i=r,e}r=this&&this.__extends||(o=function(t,n){return(o=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}o(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.PrintSheet=void 0,u=i("Core"),i=i("./dist/plugins/report/base/sheet-tab-base.js"),s=i.SheetTabBase,r(c,s),c.prototype.toJSON=function(t){return{sheet:this.Mf.toJSON(t),sheetType:this._gi,reportSheetName:this.reportSheetName,reportPageIndex:this.reportPageIndex,order:this.E0i,name:this.Mf.name()}},c.prototype.fromJSON=function(t,n,i,r,e){this.reportSheetName=t.reportSheetName,this.reportPageIndex=t.reportPageIndex,this.E0i=t.order,t.sheet&&(this.Mf.fromJSON(t.sheet),this._3i())},c.prototype._3i=function(){this.Mf.isReportPrintWorkSheet=!0},n.PrintSheet=c},"./dist/plugins/report/render/paint-template-cell.js":function(t,n){"use strict";var a,u,o,e,s,c,f,i;function r(t,n,i,r,e){var o=n.x,u=n.y,s=n.width,c=n.height;s<=0||c<=0||(t.save(),t.rect(o,u,s,c),t.clip(),l(t,o,u,i,r.expansionDirectionArrowColor),v(t,o,u,i,r.expansionDirectionArrowColor),j(t,n,i,e),E(t,n,i,e),N(t,n,i,e),t.restore())}function h(t,n,i,r,e,o){var i,u,s,c,f;t.save(),i=i.parentArrowColor||"rgba(21,101,192,0.8)",o?(u=n.x,s=n.y,c=n.width,f=n.height,c&&f&&(t.rect(u-2,s-2,c+3,f+3),M(t,u,s,c,f,i,r))):(u=n.x,s=n.y,c=n.width,f=n.height,c&&f&&(t.rect(u-2,s-2,c+3,f+3),t.clip(),I(t,u,s,c,f,i,e))),t.restore()}function l(t,n,i,r,e){r&o.horizontalParent&&(p(t,n,i,e),w(t,n+1,i+3,n+9,i+3,e))}function v(t,n,i,r,e){r&o.verticalParent&&(d(t,n,i,e),w(t,n+3,i+1,n+3,i+9,e))}function d(t,n,i,r){t.beginPath(),t.fillStyle=r||"#FFEA37",t.fillRect(n,i,7,11),t.closePath()}function p(t,n,i,r){t.beginPath(),t.fillStyle=r||"#FFEA37",t.fillRect(n,i,11,7),t.closePath()}function w(t,n,i,r,e,o){var u,s,c,f,u=4,s,c,f=Math.atan2(e-i,r-n);t.beginPath(),t.strokeStyle=o||a,t.moveTo(n,i),t.lineTo(r,e),t.lineTo(r-4*Math.cos(f-Math.PI/6),e-4*Math.sin(f-Math.PI/6)),t.moveTo(r,e),t.lineTo(r-4*Math.cos(f+Math.PI/6),e-4*Math.sin(f+Math.PI/6)),t.stroke(),t.closePath()}function I(t,n,i,r,e,o,u){t.beginPath(),t.lineWidth=2,t.strokeStyle=o,t.rect(n-1,i-1,r+1,e+1),t.stroke(),t.closePath(),t.restore(),t.save(),t.fillStyle=o,6+u<i?(t.clearRect(n-2,i-10,r+3,10),t.fillRect(n-2,i-10,r+3,10),C(t,n-2,i-9,r+3,"white")):(t.clearRect(n-2,i,r+3,10),t.fillRect(n-2,i,r+3,10),C(t,n-2,i,r+3,"white"))}function M(t,n,i,r,e,o,u){t.beginPath(),t.lineWidth=2,t.strokeStyle=o,t.rect(n-1,i-1,r+1,e+1),t.stroke(),t.closePath(),t.fillStyle=o,6+u<n?(t.clearRect(n-10,i-2,10,e+3),t.beginPath(),t.fillRect(n-10,i-2,10,e+3),g(t,n-9,i-2,e+3,"white")):(t.clearRect(n,i-2,10,e+3),t.fillRect(n,i-2,10,e+3),g(t,n,i-2,e+3,"white"))}function g(t,n,i,r,e){var o;t.beginPath(),i=Math.floor(i+r/2)-6,t.fillStyle=e||u,t.moveTo(n+3,i-2),t.lineTo(n+3,i+10),t.lineTo(n+1,i+10),t.lineTo(n+4,i+18),t.lineTo(n+7,i+10),t.lineTo(n+5,i+10),t.lineTo(n+5,i-2),t.fill()}function C(t,n,i,r,e){var o;t.beginPath(),n=Math.floor(n+r/2)-6,t.fillStyle=e||u,t.moveTo(n-2,i+3),t.lineTo(n+10,i+3),t.lineTo(n+10,i+1),t.lineTo(n+18,i+4),t.lineTo(n+10,i+7),t.lineTo(n+10,i+5),t.lineTo(n-2,i+5),t.fill(),t.closePath()}function N(t,n,i,r){i&o.paginationIcon&&(t.beginPath(),t.fillStyle="#4FC3F7",t.fillRect(n.x,n.y+n.height-7,6,6))}function E(t,n,i,r){i&o.staticPin&&(t.beginPath(),t.moveTo(n.x,n.y),t.lineTo(n.x+8,n.y),t.lineTo(n.x+8,n.y+10),t.lineTo(n.x,n.y+10),t.fillStyle="white",t.fill(),t.closePath(),f?t.drawImage(f,n.x+1,n.y+1):((f=new Image).src=s,f.onload=function(){r.repaint()}))}function j(t,n,i,r){i&o.filter&&(t.beginPath(),t.moveTo(n.x+n.width-9,n.y),t.lineTo(n.x+n.width,n.y),t.lineTo(n.x+n.width,n.y+9),t.lineTo(n.x+n.width-9,n.y+9),t.fillStyle="white",t.fill(),t.closePath(),c?t.drawImage(c,n.x+n.width-8,n.y+1):((c=new Image).src=e,c.onload=function(){r.repaint()}))}Object.defineProperty(n,"__esModule",{value:!0}),n.T3i=n.A3i=n.TemplateCellPaintType=void 0,a="rgb(94, 94, 94)",u="rgb(34, 115, 71)",(i=o=n.TemplateCellPaintType||(n.TemplateCellPaintType={}))[i.horizontalParent=1]="horizontalParent",i[i.verticalParent=2]="verticalParent",i[i.filter=4]="filter",i[i.staticPin=8]="staticPin",i[i.paginationIcon=16]="paginationIcon",e="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iN3B4IiBoZWlnaHQ9IjdweCIgdmlld0JveD0iMCAwIDUgNSIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDx0aXRsZT5maWx0ZXI8L3RpdGxlPgogICAgPGcgaWQ9ImZpbHRlciIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTMuMTI0ODk2NjksMi40OTk2NTI4MyBMMy4xMjQ4OTY2OSw0LjY4ODIzNzc0IEMzLjEzNzM5NDYzLDQuNzcxNTU5NTEgMy4xMDYxNDk3OSw0Ljg2MDQzNjA1IDMuMDM0Mjg2NjcsNC45MTg3NjEyOCBDMi45MTI0MzE4Miw1LjAyNzA3OTU3IDIuNzE1NTg5MzYsNS4wMjcwNzk1NyAyLjU5MzczNDUsNC45MTg3NjEyOCBMMS45NjU3MTMzMyw0LjM2MDUwNTQ5IEMxLjg5Mzg1MDIxLDQuMjk2NjI1NDcgMS44NjI2MDUzNyw0LjIxMDUyNjMyIDEuODc1MTAzMzEsNC4xMjk5ODE5NSBMMS44NzUxMDMzMSwyLjQ5OTY1MjgzIEwxLjg2NTcyOTg2LDIuNDk5NjUyODMgTDAuMDY2MDI3MzgyLDAuNDQ5OTM3NTA5IEMtMC4wNDAyMDUwNTU4LDAuMzMwNTA5NjUxIC0wLjAxNTIwOTE4OCwwLjE1NTUzMzk1NCAwLjExOTE0MzYwMSwwLjA2MTEwMjYyNDYgQzAuMTc4NTA4Nzg3LDAuMDIyMjE5MTM2MiAwLjI0NDEyMjkzOSwwIDAuMzEyODYxNTc2LDAgTDAuMzEyODYxNTc2LDAgTDQuNjg3MTM4NDIsMCBMNC42ODcxMzg0MiwwIEM0Ljc1NTg3NzA2LDAgNC44MjE0OTEyMSwwLjAyMjIxOTEzNjIgNC44ODA4NTY0LDAuMDYxMTAyNjI0NiBDNS4wMTUyMDkxOSwwLjE1NTUzMzk1NCA1LjA0MDIwNTA2LDAuMzMwNTA5NjUxIDQuOTMzOTcyNjIsMC40NDk5Mzc1MDkgTDMuMTM0MjcwMTQsMi40OTk2NTI4MyBMMy4xMjQ4OTY2OSwyLjQ5OTY1MjgzIFoiIGlkPSLot6/lvoQiIGZpbGw9InJnYigyMSwxMDEsMTkyKSIgZmlsbC1ydWxlPSJub256ZXJvIj48L3BhdGg+CiAgICA8L2c+Cjwvc3ZnPg==",s="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iNXB4IiBoZWlnaHQ9IjlweCIgdmlld0JveD0iMCAwIDQgNyIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDx0aXRsZT5waW4yPC90aXRsZT4KICAgIDxnIGlkPSJwaW4yIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMS41MTI3ODg5LDQuNjE5MjM3NzIgTDIuNDgxOTc3OTQsNC42Mzg5ODA2OSBMMi40ODQ1NTYzLDUuOTU0NDg1NzUgQzIuNDg1ODc3OSw2LjA4NDA4MzI3IDIuNDU5NzU0MSw2LjIxMjQ4NTY0IDIuNDA3NzczNTYsNi4zMzE4ODQzNCBMMi4xNTI1NjU2NSw2LjkwMzM3OTE3IEMyLjEyNjQ4MTY4LDYuOTYyMTEyNzQgMi4wNjY0MTYyMyw3LjAwMDEyMDE1IDEuOTk5ODcwMjQsNyBDMS45MzMzMjQyNSw2Ljk5OTg3OTI4IDEuODczMTA5MzksNi45NjE2NTQyIDEuODQ2Nzk0OTksNi45MDI4MjU3OSBMMS41OTM4Nzg1Miw2LjMxNjgwNDM0IEMxLjU0MTU2NTI0LDYuMTk3MTc3MTMgMS41MTQ5NDM1Miw2LjA2ODcwNjMgMS41MTU2MTU4Niw1LjkzOTEyNTE2IEwxLjUxMjc4ODksNC42MTkyMzc3MiBaIE0wLjcyNTY1OTk4NywwLjE0ODA2OTkyMiBDMC43ODY2MjEzNjUsMC4wNTU0Mzg4NDk5IDAuODkyOTA4MjgxLC0wLjAwMDQ2NzM0NjgyNCAxLjAwNzE1OTc4LDAgTDIuOTgzMzg4NjYsMC4wMDM1Nzk0NjQ4NSBDMy4xMDE3Nzg0OCwtMC4wMDA5NzA2MzAxMDkgMy4yMTQwMTY5OSwwLjA1NTIzMjgzNTYgMy4yNzgxODM4MSwwLjE1MTE5ODIxNiBDMy4zNDIzNTA2MiwwLjI0NzE2MzU5NyAzLjM0ODc5NTgxLDAuMzY4NDU4ODQ2IDMuMjk1MTEyMTQsMC40Njk3ODA5NCBMMy4wNzcwODg3OCwwLjkxMDM0NjUzIEMzLjAxNDkzMTYsMS4wMzUyMzQyNSAyLjk5NzIwODA3LDEuMTc2NTc2OTYgMy4wMjYwMzUzMSwxLjMxMjQ2ODg0IEwzLjI4MDE2NTkyLDIuNTE3OTU4NSBDMy4zMTc3MzgzMywyLjcwNzM3MTg0IDMuNDE0MDgyNSwyLjg4MTQzOTQ4IDMuNTU2MTk0NTksMy4wMTc5OTc2NCBMMy45MDcyNjY3NywzLjM1NTM0OTQ1IEMzLjk3MDI5OTU1LDMuNDE1MTc2NDkgNC4wMDYwNDA4NiwzLjQ5NjU2OTc0IDQuMDA2NTkzMiwzLjU4MTU0NDM1IEw0LjAwNDU2MTA2LDMuNzY5MjcxNjIgQzQuMDA0Mzg3NjUsMy45NDUwOTMwNCAzLjg1NjQ2NjQyLDQuMDg3MjMzMzEgMy42NzM0OTQyLDQuMDg3Mzk5OTUgTDAuMzQ5MzczODEsNC4wNzkwNzc3OCBDMC4xNjYzOTk2NDQsNC4wNzgyNDg4NiAwLjAxNzkyMDE3NjcsMy45MzU1NzIxNyAwLjAxNzA1NzU0NzcsMy43NTk3NDg4OCBMMC4wMDczMTYxNjM2MiwzLjU2NTMxMjEgQzAuMDA3NTM1NDExNTYsMy40ODAzMzg4OCAwLjA0Mjk1NzkxMTcsMy4zOTkwNzQ0MiAwLjEwNTc1NjYyNSwzLjMzOTQ3NTExIEwwLjQ1NTUwODg4MiwzLjAwMzM5MTYzIEMwLjU5Njk0ODE5OCwyLjg2NzM4MTk3IDAuNjkyNDMzMzMyLDIuNjkzNTE3MDYgMC43Mjk1NzkzODIsMi41MDQzNDgwNCBMMC45Nzg3NDY3NjYsMS4yOTk5OTk4NyBDMS4wMDcyODEwNywxLjE2Mzk4MTE3IDAuOTg4NzYzNzk5LDEuMDIyODAzNSAwLjkyNjM1NjE4MiwwLjg5NzQ1OTcxNyBMMC43MDY4NDQ3MzksMC40NTYzMzI5MTcgQzAuNjU3NTk0NDY3LDAuMzU3MDkyOTkzIDAuNjY0Njk4NjEsMC4yNDA3MDA5OTQgMC43MjU2NTk5ODcsMC4xNDgwNjk5MjIgWiIgaWQ9IuW9oueKtiIgZmlsbD0icmdiKDIxLDEwMSwxOTIpIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+",n.A3i=r,n.T3i=h},"./dist/plugins/report/report-all-entry.js":function(t,n,i){(r=r||{}).Report=i("./node_modules_local/@spreadjs/js-report/dist/gc.report.js"),r.Spread=r.Spread||{},r.Spread.Report=i("./dist/plugins/report/index.js"),t.exports=r.Spread.Report},"./dist/plugins/report/report-sheet.js":function(t,n,i){"use strict";var r,e,o,u,s,c,f,a,h,l,v,d,p,w,I,M,g,C,N,E,j,A;function T(t){var n,i,t,n=A.call(this)||this;return n.x3i="Preview",n.Itr=!1,n.canClone=!0,(i=n)._gi=u.SheetType.reportSheet,i.z3i=new a.DataEntryHelper(i),i.L3i=new v.ReportJSONConvertor(i),i.options={renderMode:i.x3i,printAllPages:!0,dirtyStyle:(0,s.P3i)()},t=t||(0,s.B3i)(),i.templateSheet=new d.TemplateSheet(t),(0,c.BSi)(i.templateSheet,i),i.reportWorksheet=i.G3i(t),i.Mf=i.reportWorksheet,i.printPageIndexArray=[],i.ghe={},i.regenerateReport(),n}r=this&&this.__extends||(j=function(t,n){return(j=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}j(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),e=this&&this.__awaiter||function(t,u,i,s){function c(n){return n instanceof i?n:new i(function(t){t(n)})}return new(i=i||Promise)(function(n,i){function r(t){try{o(s.next(t))}catch(t){i(t)}}function e(t){try{o(s.throw(t))}catch(t){i(t)}}function o(t){t.done?n(t.value):c(t.value).then(r,e)}o((s=s.apply(t,u||[])).next())})},o=this&&this.__generator||function(t,i){var r={label:0,sent:function(){if(1&u[0])throw u[1];return u[1]},trys:[],ops:[]},e,o,u,s,s={next:n(0),throw:n(1),return:n(2)};return"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function n(n){return function(t){return c([n,t])}}function c(n){if(e)throw new TypeError("Generator is already executing.");for(;r=s&&n[s=0]?0:r;)try{if(e=1,o&&(u=2&n[0]?o.return:n[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,n[1])).done)return u;switch(o=0,(n=u?[2&n[0],u.value]:n)[0]){case 0:case 1:u=n;break;case 4:return r.label++,{value:n[1],done:!1};case 5:r.label++,o=n[1],n=[0];continue;case 7:n=r.ops.pop(),r.trys.pop();continue;default:if(!(u=0<(u=r.trys).length&&u[u.length-1])&&(6===n[0]||2===n[0])){r=0;continue}if(3===n[0]&&(!u||n[1]>u[0]&&n[1]<u[3]))r.label=n[1];else if(6===n[0]&&r.label<u[1])r.label=u[1],u=n;else{if(!(u&&r.label<u[2])){u[2]&&r.ops.pop(),r.trys.pop();continue}r.label=u[2],r.ops.push(n)}}n=i.call(t,r)}catch(t){n=[6,t],o=0}finally{e=u=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}},Object.defineProperty(n,"__esModule",{value:!0}),n.ReportSheet=void 0,u=i("Core"),s=i("./dist/plugins/report/utils/utils.js"),c=i("./dist/plugins/report/overrides/sheet-override.js"),f=i("./dist/plugins/report/worksheet/report-worksheet.js"),a=i("./dist/plugins/report/helpers/data-entry-helper.js"),h=i("./dist/plugins/report/overrides/feature-register.js"),l=i("./dist/plugins/report/base/sheet-tab-base.js"),v=i("./dist/plugins/report/convertors/report-json-convertor.js"),d=i("./dist/plugins/report/worksheet/template-sheet.js"),p=i("./dist/plugins/report/helpers/parameter-helper.js"),w=i("./dist/plugins/report/resources/index.js"),I=i("./dist/plugins/report/worksheet/utils.js"),M=u.GC$,g=w.rm.getResource.bind(w.rm),C=u.util.Z0,N=u.util.V0,(0,h.registerFeatures)(),A=l.SheetTabBase,r(T,A),T.prototype.pM=function(t){A.prototype.pM.call(this,t),this.templateSheet&&this.templateSheet!==this.Mf&&(this.templateSheet.parent=t)},T.prototype.adrs=function(){var t,n,t=this.name(),n=this.getParent();n&&(n.suspendPaint(),n.suspendEvent(),n.g3(n.getSheetTabIndex(t),2),n.setActiveSheetIndex(0),n.resumeEvent(),n.resumePaint())},T.prototype.G3i=function(t){var n,t,n=this,t=new f.ReportWorksheet(t,n);return t.parent=n.getParent(),(0,c.BSi)(t,n),t},T.prototype.renderMode=function(t){var n;return(t=this.k3i(t))&&t!==this.options.renderMode&&(n=this.options.renderMode,"Design"===(this.options.renderMode=t)?(this.R3i(this.templateSheet),(0,s.pOi)(this.templateSheet),this.Itr&&(this.Itr=!1,this.fetchAllTablesAsync(!0))):this.regenerateReport(),this.ki(u.Events.ReportSheetModeChanged,{oldMode:n,newMode:t})),this.options.renderMode},T.prototype.k3i=function(n){var t,i;return n&&((i=(t=["Preview","PaginatedPreview","Design"]).find(function(t){return t.toUpperCase()===n.toUpperCase()}))||this.options.renderMode)},T.prototype.R3i=function(t,n){var i,r;t.name(this.name()),(i=this.getParent())&&this.Mf!==t&&(M[M.sd]({jS:i},1),t.parent=i,t.suspendPaint(),r=this.b2(),null!=n&&n.destroy(),this.Mf.L0(!1),this.Mf=t,this.Mf===this.templateSheet?this.Z3i||(i.v3(this.Mf),this.Z3i=!0):i.v3(this.Mf),i.getActiveSheetTab()===this?(i.c3=void 0,i.jb=-1,i.setActiveSheetTab(this.name())):this.Mf.isSelected(r),t.resumePaint())},T.prototype.ttr=function(t){var n=this.reportWorksheet;return this.reportWorksheet=t,n&&((0,I.H3i)(n,this.getParent()),n.bC()),n},T.prototype.getPagesCount=function(){return"PaginatedPreview"===this.options.renderMode?this.reportWorksheet.getPagesCount():1},T.prototype.currentPage=function(t){var n,i,t,r,t,n,e;return"PaginatedPreview"===this.options.renderMode&&this.reportWorksheet?(n=this.reportWorksheet.currentPage(),i=this.reportWorksheet.currentPage(),r=(t=this.reportWorksheet.currentPage(t)).currentPageIndex,t=t.currentPage,n.currentPage!==t&&(this.R3i(t),n=this.getParent())&&n.ki(u.Events.ReportPaginationPageChanged,e={oldPageIndex:i,currentPageIndex:r}),r):0},T.prototype.generatePageSheets=function(t,n){var i,r,e,o,u,n;return"PaginatedPreview"!==this.options.renderMode?[]:(i=this.getParent(),r=i.getSheetPosition(this.name()),e=i.getSheetCount(),t&&i&&i.suspendPaint(),o=t?function(t){var n=t.name();i.addSheet(e++,t),i.changeSheetPosition(n,++r),void 0===u&&(u=n)}:null,n=this.reportWorksheet.paginationHelper.Gf().gOi(n,o,!0),(0,s.V3i)(n),t&&i&&(void 0!==u&&i.setActiveSheet(u),i.resumePaint()),n)},T.prototype.printPageIndexes=function(t){return t&&(this.printPageIndexArray=t),this.printPageIndexArray},T.prototype.printInfo=function(t){var n=this.templateSheet,i;return n.printInfo&&(i=n.printInfo.apply(n,arguments)),arguments.length?this:i},T.prototype.updateCellValue=function(t,n,i){this.z3i.$4i(t,n,i)},T.prototype.addRecordAt=function(t,n){this.z3i.q4i(t,n)},T.prototype.deleteRecordAt=function(t,n){this.z3i.tEi(t,n)},T.prototype.resetCellValue=function(t,n){this.z3i.jSi(t,n)},T.prototype.submit=function(){return e(this,void 0,void 0,function(){var n;return o(this,function(t){switch(t.label){case 0:return[4,this.z3i.ySi()];case 1:return n=t.sent(),this.Itr=!n.success,[2,n]}})})},T.prototype.isDirty=function(){return this.reportWorksheet.reportDataModel.u()},T.prototype.isExpandable=function(t,n){if("Preview"===this.options.renderMode)return this.reportWorksheet.isExpandable(t,n)},T.prototype.setSubmitHandler=function(t,n){this.z3i.bSi(t,n=void 0===n?!1:n)},T.prototype.fetchAllTablesAsync=function(t){return void 0===t&&(t=!1),this.templateSheet.fetchAllTablesAsync(this.getParent(),t)},T.prototype.loadTemplate=function(t){var n,t;t&&((n=this).dOi(t),n.regenerateReport(),t=n.getParent())&&t.undoManager().clear()},T.prototype.dOi=function(t,n,i){var n,r,t;t&&((r=new d.TemplateSheet(this.name())).parent=this.Mf.parent,r.vf=0,t.keepUnknownFormulas=!0,n?r.yh(t,n.sjsCommonInfo,n.openOptions,!0):r.fromJSON(t),t.type===u.WorksheetType.reportTemplateSheet||(null==(n=t.lossless)?void 0:n.type)===u.WorksheetType.reportTemplateSheet||i||(0,s.U3i)(r),r.name(this.name()),this.Z3i=!1,t=this.templateSheet,(0,I.H3i)(t,this.getParent()),"Design"===this.options.renderMode?(this.templateSheet=r,this.R3i(r,t)):this.templateSheet=r,this.reportWorksheet.templateInfo.pEi(r),(0,c.BSi)(r,this))},T.prototype.getTemplate=function(){return this.templateSheet},T.prototype.regenerateReport=function(){var t,n,i,r,e,t=this,n=t.options.renderMode;"Design"===n?(t.templateSheet.AEi(),t.repaint()):(t.printPageIndexArray=[],i=t.G3i(t.name()),t._Ci=i.regenerateReportData(r="PaginatedPreview"===n),t._Ci&&(e=t.ttr(i),"Preview"===n?t.R3i(i,e):r&&t.R3i(i.currentPage(0).currentPage,e)))},T.prototype.refresh=function(){"Design"===this.renderMode()?(this.templateSheet.AEi(),this.repaint()):this.regenerateReport()},T.prototype.repaint=function(){var t,n,t,n=this.Mf;n&&n.hP()&&n.repaint()},T.prototype.getRange=function(){var t=this;return t.W3i()?t.reportWorksheet.ROi():new u.Range(0,0,t.Mf.getRowCount(),t.Mf.getColumnCount())},T.prototype.getValue=function(t,n){return this.Mf.getValue(t,n)},T.prototype.getTemplateCell=function(t,n){var i,t,i;return"Design"===this.renderMode()?this.templateSheet.getTemplateCell(t,n):(t=this.reportWorksheet.Q3i(t,n))?this.templateSheet.getTemplateCell(t.templateCell.row,t.templateCell.col):null},T.prototype.getCells=function(t,n,i,r){var e=this;return e.W3i()&&e._Ci?e._Ci.getCells(t,n,i,r).map(function(t){return{value:t.value,row:t.row,col:t.col,rowCount:t.rowCount,colCount:t.colCount}}):[]},T.prototype.getStyle=function(t,n){return this.Mf.getStyle(t,n)},T.prototype.getActualStyle=function(t,n){return this.Mf.getActualStyle(t,n)},T.prototype.getSpan=function(t,n){return this.Mf.getSpan(t,n)},T.prototype.getColumnWidth=function(t){return+this.Mf.getColumnWidth(t)},T.prototype.getRowHeight=function(t){return+this.Mf.getRowHeight(t)},T.prototype.parameter=function(t){var n,i,r,e,o,u,s,n=this;if(0===arguments.length){for(e in r={},i=n.ghe)i.hasOwnProperty(e)&&(r[e]=N(i[e]));return r}if(t){for(e in o={},u={},t)if(t.hasOwnProperty(e)){if(o[e]=C(t[e]),u[s=e.toUpperCase()])throw new Error(g().Exp_InvalidParameterName);u[s]=!0}n.ghe=o}},T.prototype.setParametersUI=function(t,n,i){var r=this;(t="string"==typeof t?document.getElementById(t):t)&&(r.F3i&&r.F3i.Ti!==t&&r.F3i.L0(!0),r.F3i=new p.ParameterHelper(r,{host:t,initParametersUI:n,onChange:i}),r.F3i.KSi())},T.prototype.W3i=function(){return"Preview"===this.options.renderMode},T.prototype.toggleCollapseState=function(t,n){this.W3i()&&this.reportWorksheet.$Ci(t,n)},T.prototype.getCollapseState=function(t,n){if(this.W3i())return this.reportWorksheet.hEi(t,n)},T.prototype.getCellsLength=function(t,n){var i;return null==(i=this._Ci)?void 0:i.getCells(t,n).length},T.prototype.R2e=function(){return this.templateSheet.options.sheetTabColor},T.prototype.getSheet=function(){return this.Mf},T.prototype.Y3i=function(){var t;return null==(t=this.Mf.options)?void 0:t.isProtected},T.prototype.togglePaginatedPreviewCache=function(t){return this.L3i.wOi(t)},T.prototype.internalIsDirtyCell=function(t,n){return this.reportWorksheet.isDirtyCell(t,n)},T.prototype.internalParameterUI=function(t){if(0===arguments.length)return this.vOi;this.vOi=t},T.prototype.toWorksheet=function(){return this.L3i.workSheetConvertor.lOi()},T.prototype.toJSON=function(t){return this.L3i.Np(t)},T.prototype.wh=function(t,n,i){return this.L3i.wh(t,n,i)},T.prototype.fromJSON=function(t,n,i,r,e){this.L3i.Zme(t,n,i,r,e)},T.prototype.yh=function(t,n,i){this.L3i.yh(t,n,i)},T.prototype.L0=function(t,n){var i;t&&((0,I.H3i)((i=this).reportWorksheet,i.getParent()),(0,I.H3i)(i.templateSheet,i.getParent()),i.reportWorksheet.bC(),i.templateSheet.bC(),i.reportWorksheet.destroy(),i.templateSheet.destroy(),i.F3i&&i.F3i.L0(t,n),i.F3i=void 0,i.L3i=void 0,i._Ci=void 0,i.templateSheet=void 0,i.reportWorksheet=void 0,i.printPageIndexArray=void 0,i.vOi=void 0),A.prototype.L0.call(this,t,n)},n.ReportSheet=T},"./dist/plugins/report/resources/index.js":function(t,n,i){"use strict";var r,i;Object.defineProperty(n,"__esModule",{value:!0}),n.rm=void 0,r=i("Common"),i=i("./dist/plugins/report/resources/report.ns.js"),n.rm=new r.Common.ResourceManager(i.SR,"ReportSheet")},"./dist/plugins/report/resources/lr.gcn.js":function(t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.wmk2=n.wmk1=void 0,n.wmk1=["6288","a568"],n.wmk2=["6288","a568"]},"./dist/plugins/report/resources/report.ns.js":function(t,n,i){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SR=void 0;var i=i("./dist/plugins/report/resources/res.en.js");n.SR={en:i}},"./dist/plugins/report/resources/res.en.js":function(t,n,i){"use strict";var r,e;for(e in Object.defineProperty(n,"__esModule",{value:!0}),n.Exp_InvalidParameterName=n.configDataSetting=n.summaryNoneTip=n.summaryCountTip=n.summaryMinTip=n.summaryMaxTip=n.summaryAvgTip=n.summarySumTip=n.summaryCellType=n.groupCellType=n.listCellType=n.toolTipCellType=n.toolTipFormula=n.toolTipColumnName=n.toolTipTableName=n.ContainsInvalidCells=void 0,n.ContainsInvalidCells="Report sheet contains invalid cells({0}), please check.",n.toolTipTableName="Table: ",n.toolTipColumnName="Column: ",n.toolTipFormula="Formula: ",n.toolTipCellType="Type: ",n.listCellType="List",n.groupCellType="Group",n.summaryCellType="Summary",n.summarySumTip="(Sum)",n.summaryAvgTip="(Avg)",n.summaryMaxTip="(Max)",n.summaryMinTip="(Min)",n.summaryCountTip="(Count)",n.summaryNoneTip="(None)",n.configDataSetting="Please config data setting.",n.Exp_InvalidParameterName="invalid parameter name",r=i("./dist/plugins/report/resources/lr.gcn.js"))r.hasOwnProperty(e)&&(n[e]=r[e])},"./dist/plugins/report/template/template-overwrite.js":function(t,n){"use strict";function i(t){t.getText=function(t,n){var i,r,n,e,o,e,o,i=n.row,r=n.col,n=n.sheet,e=n.getTemplateCell(i,r);if(!s(e)&&"object"==typeof e){if("Chart"===e.type&&e.chartName)return"["+e.chartName+"]";if(!s(o=n.getCellAlias(i,r)))return u(e,o)}return s(e=n.getFormula(i,r))?s(t)&&!s(o=n.getValue(i,r))?o:t:e}}function u(t,n){return s(n)?null:"Summary"===t.type?(t.aggregate||"Sum")+"("+n+")":n}function s(t){return null==t}Object.defineProperty(n,"__esModule",{value:!0}),n.J3i=void 0,n.J3i=i},"./dist/plugins/report/template/template-resolver.js":function(t,n,i){"use strict";var r,e,v,s,o,u;function c(t,n){var i,n,t,r,e,n,i=this;i.Mf=t,i.LCi=n,i.K3i=new o.SmartCache,i.X3i=new o.SmartCache,(0,v.ht)(t)||((n=(0,s.$3i)(t))?(i.q3i(n),i.t_i(n),t=n.row,r=n.col,e=n.rowCount,n=n.colCount,i.n_i={row:0,col:0,rowEnd:t+e-1,colEnd:r+n-1}):i.n_i={row:0,col:0,rowEnd:0,colEnd:0})}r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.ReportTemplateResolver=void 0,e=i("CalcEngine"),v=i("./dist/plugins/report/utils/utils.js"),s=i("./dist/plugins/report/template/utils.js"),o=i("./dist/plugins/report/helpers/smart-cache.js"),c.prototype.getTemplatePaginationSetting=function(){return this.i_i(this.Mf.getPaginationSetting(),this.Mf.printInfo())},c.prototype.getRowHeight=function(t){return+this.Mf.getRowHeight(t)},c.prototype.getColumnWidth=function(t){return+this.Mf.getColumnWidth(t)},c.prototype.evaluateFormula=function(t,n,i){return this.LCi?this.LCi.reportDataModel.CCi(t,n,i):i},c.prototype.getCellNamesInFormula=function(t){var t,n,t=this.Mf.Lp.parse(this.Mf.qgt,t,0,0),n=[];return t.forEachNodes(function(t){var t;t.type===e.ExpressionType.reference&&(t=(0,v.MSi)(t.row,t.column),-1===n.indexOf(t))&&n.push(t)}),n},c.prototype.getTemplateRange=function(){return this.n_i},c.prototype.getTemplateCell=function(t,n){var i,r,e,o,u,i=this,r=i.Mf,e=r.getTemplateCell(t,n),o=(0,s.r_i)(e||{}),u=r.getSpan(t,n);return o.newRecordDefaultValueGenerator=i.e_i(e),o.dataColumn||(o.formula=r.getFormula(t,n)),o.value=o.dataColumn||o.formula?void 0:r.getValue(t,n),o.isEmpty=!(e||null!==o.value||o.dataColumn||o.formula||r.getStyle(t,n)||r.getStyle(-1,n)||r.getStyle(t,-1)||u||o.chartName||void 0!==i.K3i.get(t,n)||void 0!==i.X3i.get(t,n)||i.o_i(t,n)||i.u_i(t,n)),o.isColWidthChanged=+r.getColumnWidth(n)!=+r.defaults.colWidth,o.isRowHeightChanged=+r.getRowHeight(t)!=+r.defaults.rowHeight,!o.isEmpty||o.isColWidthChanged||o.isRowHeightChanged?(o.row=t,o.col=n,(0,v.ht)(u)?(o.rowEnd=t,o.colEnd=n):(o.rowEnd=u.row+u.rowCount-1,o.colEnd=u.col+u.colCount-1),o):null},c.prototype.getTemplateDataCollectionSetting=function(){var i,t,n,i=this,t=this.Mf&&this.Mf.getDataEntrySetting();if(t)return n={dataCollections:t.map(function(t){var n,n;return{type:"Smart",tableName:t.tableName,ignoreContainsEmptyValueRecord:t.skipRecordWithEmptyValue,ignoreNonUpdatedCell:!t.includeUnmodified,allowEmptyKey:null==(n=null==(n=i.LCi)?void 0:n.reportSheet)?void 0:n.z3i.ISi(),fields:t.fields.map(function(t){return(0,v.oSi)(t.formula)?{type:"Cell",cellName:t.formula,dbColumnName:t.dbColumnName,isPrimary:t.isPrimary}:r({type:"Formula"},t)})}})}},c.prototype.getTemplateSplitSetting=function(){return this.s_i(this.Mf.getLayoutSetting())},c.prototype.e_i=function(t){if(t&&void 0!==t.defaultValue)return function(){return{formula:t.defaultValue}}},c.prototype.o_i=function(t,n){var i,r,i=this.Mf.getDataEntrySetting();return!!i&&(r=(0,v.MSi)(t,n),i.some(function(t){return t.fields.some(function(t){return(0,v.oSi)(t.formula)&&(0,v.sSi)(t.formula)===r})}))},c.prototype.u_i=function(t,n){for(var i,r,e,o,u,i,r,e=0,o=this.Mf.cellStates.all();e<o.length;e++)if((u=o[e]).range.intersect(t,n,1,1))return!0},c.prototype.q3i=function(t){for(var n,i,r,e,o,u,s,n,c,f,a,h,l,h,i=this,r=i.Mf,e={},o=0;o<t.rowCount;o++)for(u=0;u<t.colCount;u++)(s=r.getTemplateCell(o,u))&&"Chart"===s.type&&!(0,v.ht)(s.chartName)&&(e[s.chartName]=!0);if(n=null==(n=r.charts)?void 0:n.all())for(c=0,f=n;c<f.length;c++)e[(a=f[c]).name()]||(h=a.position(),l=(0,v.c_i)(h.x,h.y,r),h=(0,v.c_i)(h.x+a.width(),h.y+a.height(),r),i.K3i.set(l.row,l.col,!0),i.K3i.set(h.row,h.col,!0),t.rowCount=Math.max(t.row+t.rowCount-1,h.row)-t.row+1,t.colCount=Math.max(t.col+t.colCount-1,h.col)-t.col+1)},c.prototype.t_i=function(t){var n,i,r,n,e,o,u,s,c,f,u,a,s,i=this,r=i.Mf,n=null==(n=r.shapes)?void 0:n.all();if(n)for(e=0,o=n;e<o.length;e++)1===(u=o[e]).ttV&&(s=u.x(),c=u.y(),f=u.width(),u=u.height(),a=(0,v.c_i)(s,c,r),s=(0,v.c_i)(s+f,c+u,r),i.X3i.set(a.row,a.col,!0),i.X3i.set(s.row,s.col,!0),t.rowCount=Math.max(t.row+t.rowCount-1,s.row)-t.row+1,t.colCount=Math.max(t.col+t.colCount-1,s.col)-t.col+1)},c.prototype.i_i=function(t,n){var i,r,e,o,i,i=(0,s.f_i)((t=t||{}).titleRow),r=(0,s.f_i)(t.titleCol),e=(0,s.f_i)(t.endRow),o=(0,s.f_i)(t.endCol),i={titleRows:i,endRows:e=i&&e&&e[0]<i[i.length-1]?void 0:e,titleCols:r,endCols:o=r&&o&&o[0]<r[r.length-1]?void 0:o,rowPagination:t.rowPagination,paginationOrder:"OverThenDown"===t.paginationOrder?"ColumnFirst":"RowFirst"};return t.rowPagination||(i.pagePixelSize=(0,s.h_i)(n)),i.rowPagination&&(!i.rowPagination.rowCountPerPage||i.rowPagination.rowCountPerPage<0)&&(i.rowPagination.rowCountPerPage=10),i},c.prototype.s_i=function(t){return t?"RowLayout"===t.type?{type:"RowSplit",dataRange:this.ftr(t.dataRange),rowCount:t.rowCount,repeatRows:t.repeatRows}:"ColumnLayout"===t.type?{type:"ColumnSplit",dataRange:this.ftr(t.dataRange),columnCount:t.columnCount,repeatCols:t.repeatCols}:null:null},c.prototype.ftr=function(t){var n,i,n,r,e,r;return!t||2!==(n=t.split(":").map(function(t){return t.trim()}).filter(function(t){return t})).length?"":(i=n[0],n=n[1],r=/^\d+$/,e=this.getTemplateRange(),r.test(i)&&r.test(n)?"".concat((0,v.MSi)(+i-1,e.col),":").concat((0,v.MSi)(+n-1,e.colEnd)):(r=/^[a-zA-Z]+$/).test(i)&&r.test(n)?"".concat(i).concat(e.row+1,":").concat(n).concat(e.rowEnd+1):t)},n.ReportTemplateResolver=c},"./dist/plugins/report/template/utils.js":function(t,n,i){"use strict";var a,h,o,u,l,r;function e(t){var n,n,i,r,i=t.autoExpand,r=t.pin;return{row:void 0,col:void 0,rowEnd:void 0,colEnd:void 0,value:void 0,formula:void 0,isEmpty:void 0,isRowHeightChanged:void 0,isColWidthChanged:void 0,newRecordDefaultValueGenerator:void 0,leftParent:(null==(n=null==t?void 0:t.context)?void 0:n.vertical)||"Default",upParent:(null==(n=null==t?void 0:t.context)?void 0:n.horizontal)||"Default",expansionDirection:s(t),dataColumn:c(t),dataSetting:f(t),overwriteWhenExpand:"List"===t.type&&"Overwrite"===t.spillMode,lineBreakOption:t.lineBreakOption,filter:t.filter||{},sorts:t.sortOptions,chartName:t.chartName,hExpansible:!i||"Both"===i||"Horizontal"===i,vExpansible:!i||"Both"===i||"Vertical"===i,clearRowOffset:"Both"===r||"Row"===r,clearColOffset:"Both"===r||"Column"===r,paginateBeforeRow:!!t.paginateBeforeRow,paginateAfterRow:!!t.paginateAfterRow,paginateBeforeColumn:!!t.paginateBeforeColumn,paginateAfterColumn:!!t.paginateAfterColumn,repeatContentWhenPaging:void 0===t.repeatContentWhenPaging||!!t.repeatContentWhenPaging,canBreakWhenPaging:void 0===t.canBreakWhenPaging||!!t.canBreakWhenPaging,showCollapseButton:!!t.showCollapseButton}}function s(t){var n,t,t=t;return"SUMMARY"===(null==(n=t.type)?void 0:n.toUpperCase())?"No":r[(t.spillDirection||(t.binding?"VERTICAL":"NONE")).toUpperCase()]}function c(t){var t,t,n,t=t;return!t.binding||1===(n=(t=t.binding.trim()).split("[")).length?null:{tableName:n[0],columnName:t.substring(n[0].length+1,t.length-1)}}function f(t){var n;return t.binding?"List"===t.type?{type:"List"}:"Group"===t.type?{type:"Group",bins:t.bins,formula:t.formula}:{type:"Summary",aggregation:t.aggregate}:null}function v(t){var n,n;return C(t,n=(n=d(t)).union(I(t)).union(M(t)).union(g(t)))}function d(t){var n,i,r,i,e,e,n=t.getUsedRange(o)||new a.Range(0,0,0,0);return-1===n.rowCount||-1===n.colCount?(r=(i=t.getUsedRange(u)||new a.Range(0,0,0,0)).row+i.rowCount-1,i=i.col+i.colCount-1,(e=t.getUsedRange(a.UsedRangeType.rowStyle))&&(r=Math.max(r,e.row+e.rowCount-1)),r=Math.max(r,p(t)),(e=t.getUsedRange(a.UsedRangeType.colStyle))&&(i=Math.max(i,e.col+e.colCount-1)),i=Math.max(i,w(t)),new a.Range(n.row,n.col,r-n.row+1,i-n.col+1)):n}function p(t){var n,n,n,i,r,e,n,o,n=null==(n=t.rowOutlines)?void 0:n.getUsedRange(a.UsedRangeType.axis),n=null==n?void 0:n.maxRow,i=0;if((0,h.ht)(n)||(i=Math.max(i,n)),r=t.Ut.rowInfos[3].infos,0<(n=(e=Object.keys(r)).length))for(o=n-1;0<=o;o--)if(!(0,h.ht)(r[e[o]])){i=Math.max(i,+e[o]);break}return i}function w(t){var n,n,n,i,r,e,n,o,n=null==(n=t.columnOutlines)?void 0:n.getUsedRange(a.UsedRangeType.axis),n=null==n?void 0:n.maxCol,i=0;if(n&&(i=Math.max(i,n)),r=t.Ut.colInfos[3].infos,0<(n=(e=Object.keys(r)).length))for(o=n-1;0<=o;o--)if(!(0,h.ht)(r[e[o]])){i=Math.max(i,+e[o]);break}return i}function I(t){var n,i,t,r,e,o,u,s,c,c,f,c,n=0,i=0,t=t.getDataEntrySetting();if(!(0,h.ht)(t))for(r=0,e=t;r<e.length;r++)for(u=0,s=(o=e[r]).fields;u<s.length;u++)c=s[u],(0,h.oSi)(c.formula)&&(f=(c=(0,h.QEi)(c.formula)).row,c=c.col,n=l(n,f+1),i=l(i,c+1));return new a.Range(0,0,n,i)}function M(t){for(var t,n,i,r,e,t=t.cellStates.all(),n=new a.Range(0,0,0,0),i=0,r=t;i<r.length;i++)e=r[i],n=n.union(e.range);return-1!==n.row&&-1!==n.rowCount||(n.row=0,n.rowCount=0),-1!==n.col&&-1!==n.colCount||(n.col=0,n.colCount=0),n}function g(t){var t,t,n,i,r,e,o,u,s,e,t=null==(t=t.shapes)?void 0:t.all(),n=new a.Range(0,0,0,0);if(t)for(i=0,r=t;i<r.length;i++)1===(e=r[i]).ttV&&(o=e.startRow(),u=e.startColumn(),s=e.endRow(),e=e.endColumn(),n=n.union(new a.Range(o,u,s-o+1,e-u+1)));return n}function C(t,n){for(var i,r,e,o,u,s,c,f,i=t.getRowCount()-1,r=t.getColumnCount()-1,e=n.row+n.rowCount-1,o=n.col+n.colCount-1;e<=i;i--){for(c=r;0<=c;c--)if(s=t.getTemplateCell(i,c),!(0,h.ht)(s)){u=i,n.rowCount=u-n.row+1,o=Math.max(o,c);break}if(!(0,h.ht)(u))break}for(u=u||t.getRowCount()-1;o<=r;r--)for(f=u;0<=f;f--)if(s=t.getTemplateCell(f,r),!(0,h.ht)(s))return n.colCount=r-n.col+1,n;return n}function N(t){var n,i,r;if(t){for(n=[],i=t.start,r=t.end;i<=r;i++)n.push(i);return n}}function E(t){var n,i,r,e,r,o,t,u,t,n=.96,i=2,r=t.paperSize(),e=n*r.width(),r=n*r.height(),o=t.orientation(),t=t.margin(),u=((t.left||0)+(t.right||0))*n,t=((t.top||0)+(t.bottom||0))*n;return 2===o?{width:r-u,height:e-t}:{width:e-u,height:r-t}}Object.defineProperty(n,"__esModule",{value:!0}),n.h_i=n.f_i=n.a_i=n.$3i=n.l_i=n.w3i=n.O3i=n.r_i=void 0,a=i("Core"),h=i("./dist/plugins/report/utils/utils.js"),o=a.UsedRangeType.style+a.UsedRangeType.rowStyle+a.UsedRangeType.colStyle+a.UsedRangeType.data+a.UsedRangeType.formula+a.UsedRangeType.span+a.UsedRangeType.sparkLine+a.UsedRangeType.comment+a.UsedRangeType.dataValidation+a.UsedRangeType.conditionFormat+a.UsedRangeType.axis,u=a.UsedRangeType.style+a.UsedRangeType.data+a.UsedRangeType.formula+a.UsedRangeType.span+a.UsedRangeType.sparkLine+a.UsedRangeType.comment+a.UsedRangeType.dataValidation+a.UsedRangeType.conditionFormat,l=Math.max,n.r_i=e,r={HORIZONTAL:"H",VERTICAL:"V",NONE:"No"},n.O3i=s,n.w3i=c,n.l_i=f,n.$3i=v,n.a_i=C,n.f_i=N,n.h_i=E},"./dist/plugins/report/utils/utils.js":function(_,l,t){"use strict";var i,u,r,n,s,e,c,o,f,a,h,v,d,p,w,I,M,g,C,N,B,E;function G(t){return t&&(t.cellNode.templateCell.formula||t.group.defaultFormula)}function j(){var t=o+f;return f++,t}function z(t){for(var n=j(),i=0;i<t.length;)t[i].name()===n?(n=j(),i=0):i++;return n}function k(t){for(var n,i,r,e,n=-1,i=1,r="A".charCodeAt(0)-1,e=t.length-1;0<=e;e--)n+=(t.charCodeAt(e)-r)*i,i*=26;return n}function A(t){return(t=(t=t||"").startsWith("=")?t.substring(1):t).trim().toUpperCase()}function U(t){return E.test(A(t))}function T(t){var t=E.exec(A(t));return t?{row:parseInt(t[2],10)-1,col:k(t[1])}:null}function D(t,n){for(var i,r,e,i="",r="A".charCodeAt(0),e=n+1;0<e;e=parseInt((e-1)/26+"",10))i=String.fromCharCode(r+(e-1)%26)+i;return i+(t+1)}function Z(t,n){for(var i,r,e,i="",r="A".charCodeAt(0),e=n+1;0<e;e=parseInt((e-1)/26+"",10))i=String.fromCharCode(r+(e-1)%26)+i;return"$"+i+"$"+(t+1)}function V(t,n){for(var i=0,r=t.length;i<r;i++)if(n(t[i],i,t))return i;return-1}function H(t,n){var i;if(n)return i=new u.Range(n.row,n.col,n.rowCount,n.colCount),(n.row<0||n.rowCount<0)&&(i.row=0,i.rowCount=t.rowEnd+1),(n.col<0||n.colCount<0)&&(i.col=0,i.colCount=t.colEnd+1),i}function W(n,t,i){var r=0,e=0,o=0,u=0,e=b(t,function(t){return n.getRowHeight(t)}),r,o,u;return{x:b(i,function(t){return n.getColumnWidth(t)}),y:e,height:+n.getRowHeight(t),width:+n.getColumnWidth(i)}}function b(t,n){for(var i,r,i=0,r=0;r<t;r++)i+=+n(r);return i}function F(t,n,i){for(var r=0,e=0,o=0,u=0,s=0,c=0,f=0,a=0;o<=t&&!(t<o+(f=+i.F5t(e)));)o+=f,e+=1;for(s=f-(t-o);u<=n&&!(n<u+(a=+i.L5t(r)));)u+=a,r+=1;return{row:r,col:e,offsetX:s,offsetY:c=a-(n-u)}}function Q(t,n,i){for(var r,e,o,u,s,c,f,a,h,l,r=0,e=0,o=0,u=0,s=0,c=0,f=i.getColumnCount(),a=i.getRowCount();o<=t&&((h=i.getColumnWidth(e))||!(f<=e)||(h=i.defaults.colWidth))&&!(t<o+(s=+h));)o+=s,e+=1;for(;u<=n&&((l=i.getRowHeight(r))||!(a<=r)||(l=i.defaults.rowHeight||0))&&!(n<u+(c=+l));)u+=c,r+=1;return{row:r,col:e}}function Y(){var t=new u.Style;return t.decoration={cornerFold:{size:6,position:u.CornerPosition.leftTop,color:"#FF3D00"}},t}function J(t){if(t){var n=t.titleRow,i=t.endRow,r=t.titleCol,t=t.endCol;if(!(O(n)&&O(i)&&O(r)&&O(t)))return!1;if(!tt(n,i)||!tt(r,t))return!1}return!0}function K(t,n){try{if(t){var i=(0,r.formulaToRange)(n,t.dataRange);if(!i)return!1;if(t.dataRange=(0,r.rangeToFormula)(i,0,0,15),"RowLayout"===t.type){if(!(0<t.rowCount))return!1;if(t.repeatRows&&!O(t.repeatRows))return!1}if("ColumnLayout"===t.type){if(!(0<t.columnCount))return!1;if(t.repeatCols&&!O(t.repeatCols))return!1}}return!0}catch(t){return!1}}function X(t,n){return t.cellButtons=t.cellButtons||[],t.cellButtons.unshift({position:u.ButtonPosition.leftOfText,command:"ReportCollapseButtonToggle",imageType:u.ButtonImageType.custom,visibility:u.ButtonVisibility.always,useButtonStyle:!1,enabled:!0,buttonBackColor:"transparent",hoverBackColor:"transparent",imageSrc:n?l.collapseImg:l.expandImg,v_i:!0,imageSize:{width:16,height:16}}),t}function $(t){return t.cellButtons=t.cellButtons||[],t.cellButtons.unshift({position:u.ButtonPosition.leftOfText,command:"ReportCollapseButtonToggle-empty",imageType:u.ButtonImageType.custom,visibility:u.ButtonVisibility.always,useButtonStyle:!1,enabled:!0,buttonBackColor:"transparent",hoverBackColor:"transparent",imageSrc:l.emptyCollapse,v_i:!0,imageSize:{width:16,height:16}}),t}function q(t,n){var i,r;return t&&n?(i=g(t.row+t.rowCount-1,n.row+n.rowCount-1),r=g(t.col+t.colCount-1,n.col+n.colCount-1),t.row=M(t.row,n.row),t.col=M(t.col,n.col),t.rowCount=i-t.row+1,t.colCount=r-t.col+1):!t&&n&&(t=new u.Range(n.row,n.col,n.rowCount,n.colCount)),t}function O(t){return!t||!((0,l.ht)(t.start)||(0,l.ht)(t.end)||t.start>t.end||t.start<0||t.end<0)}function tt(t,n){return!(t&&n&&t.end>=n.start)}function nt(t,n){n.defaults.rowHeight=t.defaults.rowHeight,n.defaults.colWidth=t.defaults.colWidth,n.options.allowCellOverflow=t.options.allowCellOverflow,n.options.showFormulas=!1,n.options.sheetTabColor=t.options.sheetTabColor,n.options.frozenlineColor=t.options.frozenlineColor,n.options.clipBoardOptions=u.ClipboardPasteOptions.values,n.options.gridline={},n.options.rowHeaderVisible=!1,n.options.colHeaderVisible=!1,n.options.rowHeaderAutoText=t.options.rowHeaderAutoText,n.options.colHeaderAutoText=t.options.colHeaderAutoText,n.options.rowHeaderAutoTextIndex=t.options.rowHeaderAutoTextIndex,n.options.colHeaderAutoTextIndex=t.options.colHeaderAutoTextIndex,n.options.isProtected=t.options.isProtected,n.options.protectionOptions=i({},t.options.protectionOptions),n.options.selectionBackColor=t.options.selectionBackColor,n.options.selectionBorderColor=t.options.selectionBorderColor,n.options.sheetAreaOffset=t.options.sheetAreaOffset,n.options.reversalTrailingResizeOrder=t.options.reversalTrailingResizeOrder,n.options.keepUnknownFormulas=t.options.keepUnknownFormulas,n.options.disableContextMenu=t.options.disableContextMenu,n.options.frozenlineColor=t.options.frozenlineColor,n.frozenRowCount(t.frozenRowCount()),n.frozenColumnCount(t.frozenColumnCount()),n.frozenTrailingRowCount(t.frozenTrailingRowCount()),n.frozenTrailingColumnCount(t.frozenTrailingColumnCount()),n.currentTheme(t.currentTheme()),n.zoom(t.zoom())}function it(t){var n,c,n=t&&t.filter;return n&&n.condition&&(c=function(t){var n,i,r,e,o,u,s,n=t.value;if((0,l.ht)(n)||"object"!=typeof n||(t.value=C(n)),t.and)for(i=0,r=t.and;i<r.length;i++)e=r[i],c(e);if(t.or)for(o=0,u=t.or;o<u.length;o++)s=u[o],c(s)})(n.condition),t}function rt(t){var n,i,c,n=t&&t.filter;return n&&n.condition&&(i=(0,u.RF)(n.condition),(c=function(t){var n,i,r,e,o,u,s,n=t.value;if((0,l.ht)(n)||"string"!=typeof n||(t.value=N(n)),t.and)for(i=0,r=t.and;i<r.length;i++)e=r[i],c(e);if(t.or)for(o=0,u=t.or;o<u.length;o++)s=u[o],c(s)})(i),n.condition=i),t}function et(t,n,i){var r,e,o,u,s,c,f,a,h,t,r=[],e=t.Dn,o=1,u=1,s=t.frozenRowCount(),c=t.frozenColumnCount(),f=t.frozenTrailingRowCount(),a=t.frozenTrailingColumnCount(),h=t.getRowCount(),t=t.getColumnCount();return(0,l.ht)(n.leftParent.row)||(n.leftParent.row<s?o--:n.leftParent.row>=h-f&&o++,n.leftParent.col<c?u--:n.leftParent.col>=t-a&&u++,r[0]=e.uO(o,u),u=o=1),(0,l.ht)(n.upParent.row)||(n.upParent.row<s?o--:n.upParent.row>=h-f&&o++,n.upParent.col<c?u--:n.upParent.col>=t-a&&u++,r[1]=e.uO(o,u)),r}function ot(t,n){var i=t.titleRow,r=t.endRow;i&&(t.titleRow=S(i,n)),r&&(t.endRow=S(r,n)),ft(t,n)}function ut(t,n){var i=t.titleCol,r=t.endCol;i&&(t.titleCol=S(i,n)),r&&(t.endCol=S(r,n)),ft(t,n)}function st(t,n){"RowLayout"===t.type&&t.repeatRows&&(t.repeatRows=S(t.repeatRows,n)),at(t,n)}function ct(t,n){"ColumnLayout"===t.type&&t.repeatCols&&(t.repeatCols=S(t.repeatCols,n)),at(t,n)}function ft(t,n){var i,i,i=t.rowPagination;i&&i.paginationDataCell&&((i=lt(i.paginationDataCell,n))?t.rowPagination.paginationDataCell=i:t.rowPagination=void 0)}function at(t,n){var i;t.dataRange&&((i=t.dataRange.trim().toUpperCase().split(":").map(function(t){return lt(t,n)})).some(function(t){return!t})&&(t.dataRange=void 0),t.dataRange=i.join(":"))}function S(t,n){var n,i,r,n,e,t,n=ht(n),i=n.active,r=n.type,n=n.count,e=m(t.start,i,n,r);if(!(e<0||(t=m(t.end,i,n,r))<0))return{start:e,end:t}}function ht(t){var n,i,r,n,i,r;return{active:t.propertyName.includes("Rows")?t.row:t.col,type:t.propertyName.includes("add")&&!t.isUndo||t.propertyName.includes("delete")&&t.isUndo?"Add":"Delete",count:t.isUndo?t.oldValue:t.count}}function m(t,n,i,r){return n<=t?"Add"===r?t+i:t<n+i?-1:t-i:t}function lt(t,n){var t,i,r,e,i,o,n,t=T(t);if(t&&(r=(i=ht(n)).active,e=i.count,i=i.type,o=n.propertyName.includes("Rows")?m(t.row,r,e,i):t.row,n=n.propertyName.includes("Columns")?m(t.col,r,e,i):t.col,!(o<0||n<0)))return D(o,n)}function vt(t){pt(t,3),dt(t),wt(t),It(t),Mt(t)}function dt(t){var n,i,r;if(t.RB&&(n=t.RB.cE))for(i in n)n.hasOwnProperty(i)&&(r=n[i],t.removeSparkline(r.row,r.column))}function pt(n,i){var t;n.tables&&n.tables.all().forEach(function(t){n.tables.remove(t,i)})}function wt(n){var t;n.pivotTables&&n.pivotTables.all().forEach(function(t){n.pivotTables.remove(t.name())})}function It(t){var n,i,r,e;if(t.charts)for(i=0,r=n=t.charts.all();i<r.length;i++)e=r[i],t.charts.remove(e.name())}function Mt(t){var n,i,r,e,o;if(t.shapes)for(r=0,e=i=(n=t.shapes).all();r<e.length;r++)(o=e[r]).ttV!==c.CT_ShapeType.CT_Picture&&o.ttV!==c.CT_ShapeType.CT_Chart&&n.remove(o.name())}function gt(t){var n;t.charts&&t.charts.all().forEach(function(t){t.Fnn(!0)})}function Ct(t,n,i){var r,i,t;if(n)return r={src:"",position:u.IconPosition.leftOfText,width:12,height:12,v_i:!0,isReport:!0},t="string"==typeof(i=null==i?void 0:i.backColor)&&Nt(u.I.m(t,i)),"Group"===n.type?r.src=t?p:h:"List"===n.type?r.src=t?w:v:"Summary"===n.type?r.src=t?I:d:r=void 0,r}function Nt(t){var n=!1;return n=t&&a.rp(a._(t))<127.5?!0:n}function Et(t,n){n?t.sort(function(t,n){return t.row!==n.row?t.row-n.row:t.col-n.col}):t.sort(function(t,n){return t.col!==n.col?t.col-n.col:t.row-n.row})}function jt(t,n,i,r){var e,o,u,s,c,f,a,h,c,n,l,v,t,i,l,e=t.x,o=t.y,u=t.width,s=t.height,c=F(e,o,n),f=c.row,a=c.col,h=c.offsetX,c=c.offsetY,n=At(n,f,a),l=!1,v=!1;return n&&(l=a-n.col>=n.colCount/2,v=f-n.row>=n.rowCount/2),t=t.cell||i.getCells(f,a).sort(function(t,n){return t.row>=n.row&&t.col>=n.col?1:-1})[0],i=r.getSpan(t.row,t.col),l&&i?a=i.col+i.colCount-(n.colCount+n.col-a):t&&(a=Math.max(t.col,a)),v&&i?f=i.row+i.rowCount-(n.rowCount+n.row-f):t&&(f=Math.max(t.row,f)),(l=Tt(f,a,r)).x+=+r.getColumnWidth(a),l.y+=+r.getRowHeight(f),{x:e=l.x-h,y:o=l.y-c,width:u,height:s,cell:t}}function At(t,n,i){var n,i,n=t.D7(n,i);if(n)return i=new u.Range(n.row,n.col,n.rowCount,n.colCount),-1!==n.row&&-1!==n.rowCount||(i.row=0,i.rowCount=t.MEi()),-1!==n.col&&-1!==n.colCount||(i.col=0,i.colCount=t.jEi()),i}function Tt(t,n,i){var r,e,e,r=y(0,0,t,n,i),e=i.getSpan(t,n),e=e?y(e.row,e.col,e.rowCount,e.colCount,i):y(t,n,1,1,i);return{x:r.width,y:r.height,width:e.width,height:e.height}}function y(t,n,i,r,e){for(var o,u,s,c,o=t+i,u=n+r,s=0,c=0;t<o;t++)s+=+e.getRowHeight(t);for(;n<u;n++)c+=+e.getColumnWidth(n);return{width:c,height:s}}function Dt(t,n,i){var t,n,r,t=Q(t,n,i),n=i.getRowCount(),r=i.getColumnCount();t.row+1>n&&i.setRowCount(t.row+1),t.col+1>r&&i.setColumnCount(t.col+1)}function bt(t,n,i,r,e){var r,o,e,o,e,o=r?(0,s.O3i)(r):"No";if(e.hAlign===u.HorizontalAlign.left||e.hAlign===u.HorizontalAlign.general||(0,l.ht)(e.hAlign)){if(r&&"Summary"!==r.type&&"Static"!==r.type&&("H"===o||"V"===o))return!0;if((e=r&&r.pin)&&("Row"===e||"Column"===e||"Both"===e))return!0;if(null!=(r=null==(o=i.getPaginationSetting())?void 0:o.rowPagination)&&r.paginationDataCell&&(e=T(o.rowPagination.paginationDataCell))&&e.col===n&&e.row===t)return!0}return!1}function Ot(t,n,i){if((0,l.ht)(t)&&(0,l.ht)(n))return null;if((0,l.ht)(t))t=0;else if((0,l.ht)(n)&&1!==i)return t;if(t instanceof e.CalcError)return t;if(n instanceof e.CalcError)return n;switch(i){case 0:return t+n;case 1:return 0===n||(0,l.ht)(n)?e.Errors.DivideByZero:t/n}}function R(t,n){var i=!1;return t.upParent===n||t.leftParent===n||(!(i=t.upParent&&(t.upParent.upParent||t.upParent.leftParent)?R(t.upParent,n):i)&&t.leftParent&&(t.leftParent.upParent||t.leftParent.leftParent)?R(t.leftParent,n):i)}function L(t,n,i){var n=t.GCi(n.row,n.col);return n.leftParent?n.leftParent.row===i.row&&n.leftParent.col===i.col||L(t,n.leftParent,i):!!n.upParent&&(n.upParent.row===i.row&&n.upParent.col===i.col||L(t,n.upParent,i))}function St(t){var n,i,r;if(t&&t.length)for(n=0,i=t;n<i.length;n++)(r=i[n]).options.disableContextMenu=!1,mt(r),yt(r)}function mt(t){for(var t,n,i,r,e,n,i=0,r=null==(t=t.charts)?void 0:t.all();i<r.length;i++)(e=r[i]).isLocked(!1),e.allowMove(!0),e.allowResize(!0),e.isSelected(!0)}function yt(t){for(var t,n,i,r,e,n,i=0,r=null==(t=t.shapes)?void 0:t.all();i<r.length;i++)1===(e=r[i]).ttV&&(e.isLocked(!1),e.allowMove(!0),e.allowResize(!0),e.allowRotate(!0),e.isSelected(!0))}function P(t,n,i){var r,e,o;if(t&&1===t.type)x(t,n,i);else{if(t.arguments)for(r=0,e=t.arguments;r<e.length;r++)P(o=e[r],n,i);t.value&&(1===t.value.type?x:P)(t.value,n,i),t.value2&&(1===t.value2.type?x:P)(t.value2,n,i)}}function x(t,n,i){t.columnRelative&&(t.columnRelative=!1,t.column+=i),t.rowRelative&&(t.rowRelative=!1,t.row+=n)}function Rt(t,n){for(var i=0,r=t.length;i<r;i++)n.push(t[i])}i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(l,"__esModule",{value:!0}),l.pushArrayTo=l.wtr=l.V3i=l.FCi=l.kCi=l.calculationValue=l.rtr=l.updateSheetRange=l.getFloatObjRect=l.getFloatObjPosition=l.FOi=l.getTemplateIcon=l.pOi=l.U3i=l.d_i=l.p_i=l.w_i=l.g_i=l.E3i=l.M_i=l.j_i=l.GSi=l.TOi=l.Ntr=l.j3i=l.I_i=l.C_i=l.P3i=l.c_i=l.b_i=l.WSi=l.JS=l.NSi=l.h3i=l.MSi=l.QEi=l.oSi=l.sSi=l.g3i=l.B3i=l.ht=l.bCi=l.emptyCollapse=l.collapseImg=l.expandImg=l.LINKER=l.CONNECTOR=l.KEYWORD_UNDEFINED=void 0,u=t("Core"),r=t("SheetsCalc"),n=t("Common"),s=t("./dist/plugins/report/template/utils.js"),e=t("CalcEngine"),c=t("Shapes"),l.KEYWORD_UNDEFINED=void 0,o="ReportSheet",f=1,a=n.Common.ft,l.CONNECTOR="_",l.LINKER="&",l.expandImg="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+bWludXMxNjwvdGl0bGU+CiAgICA8ZyBpZD0ibWludXMxNiIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Iue8lue7hOWkh+S7vS0yIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzLjAwMDAwMCwgMy4wMDAwMDApIj4KICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgZmlsbD0iI0ZGRkZGRiIgeD0iMCIgeT0iMCIgd2lkdGg9IjExIiBoZWlnaHQ9IjExIj48L3JlY3Q+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDAgTDExLDAgTDExLDExIEwwLDExIEwwLDAgWiBNMSwxIEwxLDEwIEwxMCwxMCBMMTAsMSBMMSwxIFoiIGlkPSLnn6nlvaIiIGZpbGw9IiNBQkFCQUIiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPgogICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjNjY2NjY2IiB4PSIzIiB5PSI1IiB3aWR0aD0iNSIgaGVpZ2h0PSIxIj48L3JlY3Q+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=",l.collapseImg="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+cGx1czE2PC90aXRsZT4KICAgIDxnIGlkPSJwbHVzMTYiIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxnIGlkPSLnvJbnu4TlpIfku70tMyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMy4wMDAwMDAsIDMuMDAwMDAwKSI+CiAgICAgICAgICAgIDxyZWN0IGlkPSLnn6nlvaIiIGZpbGw9IiNGRkZGRkYiIHg9IjAiIHk9IjAiIHdpZHRoPSIxMSIgaGVpZ2h0PSIxMSI+PC9yZWN0PgogICAgICAgICAgICA8cGF0aCBkPSJNMCwwIEwxMSwwIEwxMSwxMSBMMCwxMSBMMCwwIFogTTEsMSBMMSwxMCBMMTAsMTAgTDEwLDEgTDEsMSBaIiBpZD0i55+p5b2iIiBmaWxsPSIjQUJBQkFCIiBmaWxsLXJ1bGU9Im5vbnplcm8iPjwvcGF0aD4KICAgICAgICAgICAgPHBhdGggZD0iTTYsMyBMNiw1IEw4LDUgTDgsNiBMNS45OTksNiBMNiw4IEw1LDggTDQuOTk5LDYgTDMsNiBMMyw1IEw1LDUgTDUsMyBMNiwzIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiM2NjY2NjYiPjwvcGF0aD4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==",l.emptyCollapse="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTZweCIgaGVpZ2h0PSIxNnB4IiB2aWV3Qm94PSIwIDAgMTYgMTYiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+bWludXMxNjwvdGl0bGU+CiAgICA8ZyBpZD0ibWludXMxNiIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPGcgaWQ9Iue8lue7hOWkh+S7vS0yIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzLjAwMDAwMCwgMy4wMDAwMDApIj4KICAgICAgICAgICAgPHJlY3QgaWQ9IuefqeW9oiIgeD0iMCIgeT0iMCIgd2lkdGg9IjExIiBoZWlnaHQ9IjExIj48L3JlY3Q+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0wLDAgTDExLDAgTDExLDExIEwwLDExIEwwLDAgWiBNMSwxIEwxLDEwIEwxMCwxMCBMMTAsMSBMMSwxIFoiIGlkPSLnn6nlvaIiIGZpbGwtcnVsZT0ibm9uemVybyI+PC9wYXRoPgogICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiB4PSIzIiB5PSI1IiB3aWR0aD0iNSIgaGVpZ2h0PSIxIj48L3JlY3Q+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=",h="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+Z3JvdXA8L3RpdGxlPgogICAgPGcgaWQ9Imdyb3VwIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMCw2IEwwLDEgTDMsMSBMMyw2IEwwLDYgWiBNMiwyIEwxLDIgTDEsNSBMMiw1IEwyLDIgWiBNMiwxMSBMMiw4IEwxLDggTDEsMTEgTDIsMTEgWiBNMCwxMiBMMCw3IEwzLDcgTDMsMTIgTDAsMTIgWiBNNCwyIEwxMiwyIEwxMiwzIEw0LDMgTDQsMiBaIE00LDQgTDEyLDQgTDEyLDUgTDQsNSBMNCw0IFogTTQsOCBMMTIsOCBMMTIsOSBMNCw5IEw0LDggWiBNNCwxMCBMMTIsMTAgTDEyLDExIEw0LDExIEw0LDEwIFoiIGlkPSLlvaLnirYiIGZpbGw9IiMyQjcwNDkiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+",v="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+bGlzdDwvdGl0bGU+CiAgICA8ZyBpZD0ibGlzdCIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTAsMSBMMiwxIEwyLDIgTDAsMiBaIE0wLDQgTDIsNCBMMiw1IEwwLDUgWiBNMCw3IEwyLDcgTDIsOCBMMCw4IFogTTAsMTAgTDIsMTAgTDIsMTEgTDAsMTEgWiBNMywxIEwxMiwxIEwxMiwyIEwzLDIgWiBNMyw0IEwxMiw0IEwxMiw1IEwzLDUgWiBNMyw3IEwxMiw3IEwxMiw4IEwzLDggWiBNMywxMCBMMTIsMTAgTDEyLDExIEwzLDExIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiMyQjcwNDkiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+",d="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c3VtbWFyeTwvdGl0bGU+CiAgICA8ZyBpZD0ic3VtbWFyeSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gaWQ9Iui3r+W+hCIgZmlsbD0iIzJCNzA0OSIgZmlsbC1ydWxlPSJub256ZXJvIiBwb2ludHM9IjEwIDIgMi43MjEyNSAyIDcuNTgxMjUgNiAyLjcyMTI1IDEwIDEwIDEwIDEwIDExIDEgMTEgMSAxMCA1LjkyODU3MTQzIDYgMSAyIDEgMSAxMCAxIj48L3BvbHlnb24+CiAgICA8L2c+Cjwvc3ZnPg==",p="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+Z3JvdXAgd2hpdGU8L3RpdGxlPgogICAgPGcgaWQ9Imdyb3VwLXdoaXRlIiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8cGF0aCBkPSJNMCw2IEwwLDEgTDMsMSBMMyw2IEwwLDYgWiBNMiwyIEwxLDIgTDEsNSBMMiw1IEwyLDIgWiBNMiwxMSBMMiw4IEwxLDggTDEsMTEgTDIsMTEgWiBNMCwxMiBMMCw3IEwzLDcgTDMsMTIgTDAsMTIgWiBNNCwyIEwxMiwyIEwxMiwzIEw0LDMgTDQsMiBaIE00LDQgTDEyLDQgTDEyLDUgTDQsNSBMNCw0IFogTTQsOCBMMTIsOCBMMTIsOSBMNCw5IEw0LDggWiBNNCwxMCBMMTIsMTAgTDEyLDExIEw0LDExIEw0LDEwIFoiIGlkPSLlvaLnirYiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+",w="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+bGlzdCB3aGl0ZTwvdGl0bGU+CiAgICA8ZyBpZD0ibGlzdC13aGl0ZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBhdGggZD0iTTAsMSBMMiwxIEwyLDIgTDAsMiBaIE0wLDQgTDIsNCBMMiw1IEwwLDUgWiBNMCw3IEwyLDcgTDIsOCBMMCw4IFogTTAsMTAgTDIsMTAgTDIsMTEgTDAsMTEgWiBNMywxIEwxMiwxIEwxMiwyIEwzLDIgWiBNMyw0IEwxMiw0IEwxMiw1IEwzLDUgWiBNMyw3IEwxMiw3IEwxMiw4IEwzLDggWiBNMywxMCBMMTIsMTAgTDEyLDExIEwzLDExIFoiIGlkPSLlvaLnirbnu5PlkIgiIGZpbGw9IiNGRkZGRkYiPjwvcGF0aD4KICAgIDwvZz4KPC9zdmc+",I="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTJweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTIgMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8dGl0bGU+c3VtbWFyeSB3aGl0ZTwvdGl0bGU+CiAgICA8ZyBpZD0ic3VtbWFyeS13aGl0ZSIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+CiAgICAgICAgPHBvbHlnb24gaWQ9Iui3r+W+hCIgZmlsbD0iI0ZGRkZGRiIgZmlsbC1ydWxlPSJub256ZXJvIiBwb2ludHM9IjEwIDIgMi43MjEyNSAyIDcuNTgxMjUgNiAyLjcyMTI1IDEwIDEwIDEwIDEwIDExIDEgMTEgMSAxMCA1LjkyODU3MTQzIDYgMSAyIDEgMSAxMCAxIj48L3BvbHlnb24+CiAgICA8L2c+Cjwvc3ZnPg==",M=Math.min,g=Math.max,C=u.util.Z0,N=u.util.V0,l.bCi=G,l.ht=B=function(t){return null==t},l.B3i=j,l.g3i=z,E=/^([A-Z]+)([0-9]+)$/,l.sSi=A,l.oSi=U,l.QEi=T,l.MSi=D,l.h3i=Z,l.NSi=V,l.JS=H,l.WSi=W,l.b_i=F,l.c_i=Q,l.P3i=Y,l.C_i=J,l.I_i=K,l.j3i=X,l.Ntr=$,l.TOi=q,l.GSi=nt,l.j_i=it,l.M_i=rt,l.E3i=et,l.g_i=ot,l.w_i=ut,l.p_i=st,l.d_i=ct,l.U3i=vt,l.pOi=gt,l.getTemplateIcon=Ct,l.FOi=Et,l.getFloatObjPosition=jt,l.getFloatObjRect=Tt,l.updateSheetRange=Dt,l.rtr=bt,l.calculationValue=Ot,l.kCi=R,l.FCi=L,l.V3i=St,l.wtr=P,l.pushArrayTo=Rt},"./dist/plugins/report/worksheet/report-worksheet.js":function(t,n,i){"use strict";var r,l,c,f,e,o,u,a,s,h,v,d,p,w,I,M,g,C,N,E,j,A,T;function D(t,n){var e,t,e=T.call(this,t)||this;return e.isReportWorkSheet=!0,e.shapeIsProtected=function(){return!0},e.getParent=function(){var t,t;return e.parent||(null==(t=null==(t=e.reportSheet)?void 0:t.Mf)?void 0:t.parent)},e.resetCalc=function(){e.initReportCalcSource(),e.eMt=!0},e.y3i=function(t,n){var i,r,i,r,t,i=e,r=i.reportDataModel,i=i.reportSheet.templateSheet;if(!(0,v.ht)(r)&&i.getHyperlink&&(r=r.rEi(t,n)))return t=r.cellNode.templateCell,i.getHyperlink(t.row,t.col,l.SheetArea.viewport)},e.toJSON=function(t){var n,t,n=e;return n.allowEditing=!1,n.suspendPaint(),n.suspendEvent(),n.suspendCalcService(),n.m_i(),n.y_i(),n.N_i(),t=T.prototype.toJSON.call(e,t),n.otr(t),e.allowEditing=!0,n.resumeCalcService(),n.resumeEvent(),n.resumePaint(),t},(t=e).reportSheet=n,t.allowEditing=!0,t.templateInfo=new s.TemplateInfo(n.templateSheet),t.init(),(0,g.ser)(t.$f()),e}r=this&&this.__extends||(A=function(t,n){return(A=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}A(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.ReportWorksheet=void 0,l=i("Core"),c=i("Report"),f=i("./dist/plugins/report/calc-model/calc-model.js"),e=i("./dist/plugins/report/data-model/helpers/cell-status-helper.js"),o=i("./dist/plugins/report/data-model/helpers/conditional-format-helper.js"),u=i("./dist/plugins/report/data-model/helpers/validation-helper.js"),a=i("./dist/plugins/report/data-model/report-data-model.js"),s=i("./dist/plugins/report/data-model/template-info.js"),h=i("./dist/plugins/report/template/template-resolver.js"),v=i("./dist/plugins/report/utils/utils.js"),d=i("./dist/plugins/report/helpers/pagination-helper.js"),p=i("SheetsCalc"),w=i("./dist/plugins/report/calc-model/calc-source.js"),I=i("ConditionalFormatting"),M=i("./dist/plugins/report/worksheet/utils.js"),g=i("./dist/plugins/report/overrides/sheet-override.js"),C=l.GC$,N=l.util.Z0,E=l.util.g0,T=l.Worksheet,r(D,T),D.prototype.initReportCalcSource=function(){var t,n,t=this;t.Amt={},t.hyt={},n=t.getParent(),t.iMt?t.iMt.clearAll():t.T3=new w.ReportCalcSource(t,l.SheetArea.colHeader,n&&n.getCalcService()),t.rMt?t.rMt.clearAll():t.A3=new w.ReportCalcSource(t,l.SheetArea.rowHeader,n&&n.getCalcService()),t.oMt?t.oMt.clearAll():t.qgt=new w.ReportCalcSource(t,l.SheetArea.viewport,n&&n.getCalcService())},D.prototype.getPagesCount=function(){return this.paginationHelper?this.paginationHelper.zSi():1},D.prototype.currentPage=function(t){return this.paginationHelper?this.paginationHelper.TSi(t):{currentPage:this,currentPageIndex:0,range:{row:0,col:0,rowEnd:this.getRowCount(),colEnd:this.getColumnCount()}}},D.prototype.getPageIndexByCell=function(t,n){return this.paginationHelper?this.paginationHelper.PSi(t,n):0},D.prototype.ignoreShowFunctions=function(){return!0},D.prototype.getHierarchicalCellIndexingHelper=function(){return this.reportDataModel.xCi.wCi()},D.prototype.regenerateReportData=function(t){var i,n,r,n,e,o,u,s,n,i=this,n=i.reportSheet.templateSheet,r=i.getParent();if(C[C.sd]({jS:r},1),r&&r.dataManager()&&n&&!n.xT)return i.suspendPaint(),i.defaults.colWidth=n.defaults.colWidth,i.defaults.rowHeight=n.defaults.rowHeight,n=new h.ReportTemplateResolver(n,this),e=i.reportSheet.parameter(),o=new c.ReportEngine(n,r.dataManager()),u=!1,n=o.generateReport(s=t?{enablePagination:!0,beforePageSizePaginate:function(t){var n;return i.reportSheet.templateSheet.BEi(o.getTreeGenerateResult().cellNodeCache),u=!0,new a.ReportDataModel(i,t,i.templateInfo,new f.CalcModel(i,t,i.getParent().getCalcService(),i.Uw(l.SheetArea.viewport)),null,null,null).Z4i()},parameter:e}:{enablePagination:!1,parameter:e}),u||i.reportSheet.templateSheet.BEi(o.getTreeGenerateResult().cellNodeCache),i.paginationHelper=t?new d.PaginationHelper(i,n):null,i.O_i(n),t&&i.currentPage(0),i.resumePaint(),n},D.prototype.isExpandable=function(t,n){var i,i,i=null==(i=this.reportDataModel)?void 0:i.rEi(t,n);return!(!i||"No"===i.cellNode.templateCell.expansionDirection)},D.prototype.isDirtyCell=function(t,n){var i,r,r,i,r=this.reportDataModel;if(!(0,v.ht)(r)&&(r=r.rEi(t,n))&&"updated"===r.group.state)return!0},D.prototype.z4i=function(t,n){var i,r=this.reportDataModel;if(!(0,v.ht)(r))return r.Sl(t,n)},D.prototype.M3i=function(t,n){var i,r=this.reportDataModel;if(!(0,v.ht)(r))return r.ML(t,n)},D.prototype.I3i=function(t){var n,i=this.reportDataModel;if(!(0,v.ht)(i))return i.ZF(t)},D.prototype.C3i=function(t,n){var i,r=this.reportDataModel;if(!(0,v.ht)(r))return r.D7(t,n)},D.prototype.m3i=function(t){var n,i=this.reportDataModel;if(!(0,v.ht)(i))return i.F5t(t)},D.prototype.b3i=function(t){var n,i=this.reportDataModel;if(!(0,v.ht)(i))return i.L5t(t)},D.prototype.N3i=function(){var t,n,n,t,n=this.reportDataModel,n=null==n?void 0:n.eEi();return(null==n?void 0:n.rowCount)||0},D.prototype.D3i=function(){var t,n,n,t,n=this.reportDataModel,n=null==n?void 0:n.eEi();return(null==n?void 0:n.colCount)||0},D.prototype.ROi=function(){var t,n=this.reportDataModel;return(null==n?void 0:n.eEi())||new l.Range(0,0,0,0)},D.prototype.A_i=function(t,n){var i,r,r,i,r=this.reportDataModel;if(!(0,v.ht)(r)&&(r=r.rEi(t,n))&&"updated"===r.group.state)return!0},D.prototype.$Ci=function(t,n){var i,r,e,o,r,e,i=this,r=i.reportDataModel;(0,v.ht)(r)||(e=r.hEi(t,n),r.$Ci(t,n),o=r.hEi(t,n),r=r.rEi(t,n),e===o||o||((e=i.C3i(t,n))?(0,M.showCellInViewport)(e.row,e.col,i,r):(0,M.showCellInViewport)(t,n,i,r)),i.invalidateLayout(),i.gP(),i.repaint())},D.prototype.hEi=function(t,n){var i,r=this.reportDataModel;if(!(0,v.ht)(r))return r.hEi(t,n)},D.prototype.Ctr=function(t,n){var i,r;return this.reportDataModel.Ctr(t,n)},D.prototype.Q3i=function(t,n){var t,i,r,e,i=t,r=n;return this.paginationHelper&&(i=(e=this.paginationHelper.TSi().range).row+t,r=e.col+n),null==(t=this.reportDataModel.rEi(i,r))?void 0:t.cellNode},D.prototype.destroy=function(){T.prototype.destroy.call(this),this.reportDataModel=null,this.paginationHelper=null,this.templateInfo=null,this.reportSheet=null},D.prototype.init=function(){var t,n,n,t=this;t.suspendDirty(),t.setRowCount(0),t.setColumnCount(0),t.GSi(),t.options.gridline.showVerticalGridline=!1,t.options.gridline.showHorizontalGridline=!1,t.JT=!1,t.UB=!1,t.hA=l.ClipboardPasteOptions.values,t.lF=l.CopyToOptions.value,(n=null==(n=t.reportSheet.getParent())?void 0:n.Lp)&&(t.Lp.useR1C1=n.useR1C1,t.Lp.allowDynamicArray=n.allowDynamicArray,t.Lp.iterativeCalculation=n.iterativeCalculation,t.Lp.iterativeCalculationMaximumIterations=n.iterativeCalculationMaximumIterations,t.Lp.iterativeCalculationMaximumChange=n.iterativeCalculationMaximumChange,t.Lp.calcOnDemand=n.calcOnDemand,t.Lp.dynamicReferences=n.dynamicReferences),t.T_i()},D.prototype.T_i=function(){var t,n,i,r,e,o,u,s,t=this,n,i=t.templateInfo.e2t();if(i&&i.length)for(r=0,e=i;r<e.length;r++)u=(o=e[r]).getName(),0<(s=(0,p.expressionToFormula)(t.reportSheet.templateSheet,o.getExpression())).indexOf("!")&&(s=s.slice(s.indexOf("!")+1)),t.addCustomName(u,s,o.getRow(),o.getColumn())},D.prototype.GSi=function(){var t,n,i,t=this,n=t.reportSheet.templateSheet;n&&((0,v.GSi)(n,t),t.Amt=n.Amt,(i=n.printInfo()).sheet(t),t.printInfo(i),t.setDefaultStyle(n.getDefaultStyle()))},D.prototype.O_i=function(t){var n,i,r,n=this,i=n.getParent(),r=n.templateInfo;n.reportDataModel=new a.ReportDataModel(n,t,r,new f.CalcModel(n,t,i&&i.getCalcService(),n.Uw(l.SheetArea.viewport)),new o.ConditionalFormatHelper(r.gEi(),n,t),new e.CellStatesHelper(r.getCellStates(),n,t),new u.ValidationHelper(r.getValidations(),n,t,n)),n.reportDataModel.Y4i()},D.prototype.m_i=function(){for(var t,n,i,r,e,o,u,s,c,f,a,h,t=this,n=t.ROi(),i=n.row,r=n.col,e,o,u=i+n.rowCount,s=r+n.colCount,h=t.Ut.sheetModels[3];i<u;i++){for(;r<s;r++)c=t.z4i(i,r),f=t.getActualStyle(i,r),a=t.y3i(i,r),(0,v.ht)(c)||(c=N(c),c=E(c),h.setValue(i,r,c,null,null)),(0,v.ht)(f)||t.setStyle(i,r,f,l.SheetArea.viewport),(0,v.ht)(a)||t.setHyperlink(i,r,a,l.SheetArea.viewport);r=n.col}},D.prototype.otr=function(t){var n,n,n=null==(n=null==t?void 0:t.conditionalFormats)?void 0:n.rules;null!=n&&n.length&&(t.conditionalFormats.rules=n.filter(function(t){return t.ruleType!==I.RuleType.formulaRule}))},D.prototype.y_i=function(){var t,n,n,i,r,e,t=this,n=t.ROi(),n=t.I3i(n);if(n)for(i=0,r=n;i<r.length;i++)e=r[i],t.addSpan(e.row,e.col,e.rowCount,e.colCount,l.SheetArea.viewport)},D.prototype.N_i=function(){for(var t,n,i,r,e,o,t=this,n=t.ROi(),i,r,e=n.rowCount-1,o=n.colCount-1;-1<e;)t.setRowHeight(e,t.b3i(e)),e--;for(;-1<o;)t.setColumnWidth(o,t.m3i(o)),o--},n.ReportWorksheet=D},"./dist/plugins/report/worksheet/template-sheet.js":function(t,n,i){"use strict";var r,u,e,o,a,s,h,c,f,l,v,d,p,w,I,M;function g(t){var p,t,p=M.call(this,t)||this;return p.isReportTemplateSheet=!0,p.S_i=0,p.__i=!0,p.canClone=!0,p.getBindingPath=function(t,n,i){return M.prototype.getBindingPath.call(p,t,n,i)},p.enqueueBuildExpansionInfoCacheMessage=function(){var t=p;t.S_i&&window.clearTimeout(t.S_i),t.S_i=window.setTimeout(function(){t.xT||(t.AEi(),t.repaint(),t.S_i=0)})},p.getRowPageBreak=function(t){return p.x_i.OEi(t,!0)},p.getColumnPageBreak=function(t){return p.x_i.OEi(t,!1)},p.z_i=function(t,n){3===n.sheetArea&&-1!==["addRows","deleteRows"].indexOf(n.propertyName)&&(p.updateAllAliasInfo(),p.P_i&&(0,a.g_i)(p.P_i,n),p.B_i)&&(0,a.p_i)(p.B_i,n)},p.G_i=function(t,n){3===n.sheetArea&&-1!==["addColumns","deleteColumns"].indexOf(n.propertyName)&&(p.L_i.v3i(),p.P_i&&(0,a.w_i)(p.P_i,n),p.B_i)&&(0,a.d_i)(p.B_i,n)},p.k_i=function(t,n){var i=n.sheet,n=n.floatingObject;i===p&&p.R_i(n)},p.Z_i=function(t,n){var i=n.sheet,n=n.shape;i===p&&p.R_i(n)},p.V_i=function(t,n){var i=n.sheet,r=n.floatingObject,e=n.propertyName,n=n.oldValue;i===p&&p.U_i(r,e,n)},p.H_i=function(t,n){var i=n.sheet,r=n.shape,e=n.propertyName,n=n.oldValue;i===p&&p.U_i(r,e,n)},p.W_i=function(t,n){var i,r,e,o,n,u,s,c,f,a,h,l,v,d,i=n.sheet,r=n.type,e=n.range,o=n.isAdd,n=n.isClear;if("span"===r&&i===p)if(o)for(u=e.row,s=e.col,a=u+(c=e.rowCount),h=s+(f=e.colCount),l=u;l<a;l++)for(v=s;v<h;v++)!(d=p.getBindingPath(l,v))||l===u&&v===s?l===u&&v===s&&p.x_i.NEi(u,s,d,null,!0):(d.paginateBeforeRow=!1,d.paginateAfterRow=!1,d.paginateBeforeColumn=!1,d.paginateAfterColumn=!1,p.x_i.NEi(u,s,d),p.setBindingPath(l,v,d));else n&&p.x_i.yEi()},p.YEi=function(){p.AEi(),p.Q_i.YEi(),p.x_i.yEi(),p.L_i.v3i()},p.$t=function(t,n,i,r){if(i===u.SheetArea.viewport||(0,a.ht)(i)){var e,o=void 0;if(p.getTemplateCell(t,n))return(o=p.$f()).getText(null,{sheet:p,row:t,col:n})}return p.getValue(t,n,i,r)},p.o2e=function(t,n,i,r,e){var o,i,r,e,t,o=p,i=o.getActualStyle(t,n,i,r,e),r=o.getTemplateCell(t,n),e=(0,a.getTemplateIcon)(o,r,i);return e&&((0,a.rtr)(t,n,o,r,i)&&(i.textIndent=i.textIndent||1),i.decoration?i.decoration.icons||(i.decoration.icons=[]):i.decoration={icons:[]},i.decoration.icons=i.decoration.icons.filter(function(t){return!t.isReport}),i.decoration.icons.push(e)),null!=(t=i.cellButtons)&&t.length&&(i.cellButtons=t.filter(function(t){return"ReportCollapseButtonToggle"!==t.command})),r&&r.showCollapseButton&&"None"!==r.spillDirection&&(0,a.j3i)(i,!1),i},p.toJSON=function(t){var t=M.prototype.toJSON.call(p,t);return(0,d.F_i)(t),p.Y_i(t,!0),t.templateSetting={paginationSetting:p.P_i,layoutSetting:p.B_i,dataEntrySetting:p.J_i,templateOptions:p.templateOptions},t.type=u.WorksheetType.reportTemplateSheet,t},p.wh=function(t,n,i){var t=M.prototype.wh.call(p,t,n,i);return t&&((0,d.K_i)(t),p.Y_i(t,!1),t.lossless||(t.lossless={}),t.lossless.templateLossless={paginationSetting:p.P_i,layoutSetting:p.B_i,dataEntrySetting:p.J_i,templateOptions:p.templateOptions},t.lossless.type=u.WorksheetType.reportTemplateSheet),t},p.fromJSON=function(t,n,i,r,e){(0,d.X_i)(t);try{M.prototype.fromJSON.call(p,t,n,i,r,e)}catch(t){}var n=t.templateSetting;n&&(p.P_i=n.paginationSetting,p.B_i=n.layoutSetting,p.J_i=n.dataEntrySetting,p.templateOptions=n.templateOptions||{}),p.YEi()},p.yh=function(t,n,i,r){var n,i;(0,d.$_i)(t);try{M.prototype.yh.call(p,t,n,i,r)}catch(t){}(i=null==(n=null==t?void 0:t.lossless)?void 0:n.templateLossless)&&(p.P_i=i.paginationSetting,p.B_i=i.layoutSetting,p.J_i=i.dataEntrySetting,p.templateOptions=i.templateOptions||{}),p.YEi()},p.destroy=function(){var t,t,t;M.prototype.destroy.call(p),null!=(t=p.x_i)&&t.eG(),null!=(t=p.q_i)&&t.eG(),null!=(t=p.Q_i)&&t.eG(),p.J_i=void 0,p.P_i=void 0,p.q_i=void 0,p.Q_i=void 0,p.x_i=void 0,p.txi=void 0,p.L_i=void 0,p.templateOptions=void 0},(t=p).ctr=!0,t.q_i=new e.CellNodeInfoHelper(t),t.Q_i=new s.CellReferenceHelper(t),t.options.showFormulas=!0,t.x_i=new c.BreakLineHelper(t),t.txi=new f.TemplateTooltipHelper(t),t.L_i=new v.AliasHelper(t),t.templateOptions={},t.getCalcService().allowDynamicArray=!0,t.ixi(),t.bindEvents(),p}r=this&&this.__extends||(I=function(t,n){return(I=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}I(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.TemplateSheet=void 0,u=i("Core"),e=i("./dist/plugins/report/helpers/cell-node-info-helper.js"),o=i("./dist/plugins/report/template/template-overwrite.js"),a=i("./dist/plugins/report/utils/utils.js"),s=i("./dist/plugins/report/helpers/cell-reference-helper.js"),h=i("./dist/plugins/report/template/utils.js"),c=i("./dist/plugins/report/helpers/break-line-helper.js"),f=i("./dist/plugins/report/helpers/template-tooltip-helper.js"),l=i("Chart"),v=i("./dist/plugins/report/helpers/template-alias-helper.js"),d=i("./dist/plugins/report/worksheet/utils.js"),p=".template-sheet",M=u.Worksheet,r(g,M),g.prototype.getTemplateCell=function(t,n){return this.getBindingPath(t,n)},g.prototype.setTemplateCell=function(t,n,i){this.S3i(t,n,i),this.setBindingPath(t,n,i)},g.prototype.getDataEntrySetting=function(){return this.J_i},g.prototype.setDataEntrySetting=function(t){this.Q_i.KEi(t),this.J_i=t},g.prototype.getPaginationSetting=function(){return this.P_i},g.prototype.setPaginationSetting=function(t){(0,a.C_i)(t)&&(this.P_i=t)},g.prototype.getLayoutSetting=function(){return this.B_i},g.prototype.setLayoutSetting=function(t){(0,a.I_i)(t,this)&&(this.B_i=t)},g.prototype.S3i=function(t,n,i){this.Q_i.qEi(t,n,i),this.NEi(t,n,i),this.s3i(t,n,i)},g.prototype.s3i=function(t,n,i){this.L_i.s3i(t,n,i)},g.prototype.getCellAlias=function(t,n){var t,n,t,i,t=this.getTemplateCell(t,n);if(t)return!(n=t.alias)&&t.binding&&(i=(t=t.binding.trim()).split("["),n=t.substring(i[0].length+1,t.length-1)),n},g.prototype.getAllCellAlias=function(){return this.L_i.d3i()},g.prototype.getActualText=function(t,n){return this.$f().getText(t,n)},g.prototype.showToolTip=function(t){return 0<arguments.length&&(this.__i=!!t),!!this.__i},g.prototype.getCellTipContent=function(t,n){return this.txi.p3i(t,n)},g.prototype.AEi=function(){this.q_i.AEi()},g.prototype.PEi=function(){return this.q_i.PEi()},g.prototype.GCi=function(t,n){return this.q_i.GCi(t,n)},g.prototype.BEi=function(t){this.q_i.BEi(t)},g.prototype.bindEvents=function(){var i=this;i.bind(u.Events.ActiveCellChanged+p,function(t,n){i.q_i.EEi(n.row,n.col),i.repaint()}),[u.Events.CellChanged,u.Events.WorksheetDataChanged,u.Events.RowChanged,u.Events.ColumnChanged,u.Events.RowHeightChanged,u.Events.ColumnWidthChanged,u.Events.DragFillBlockCompleted,u.Events.DragMerged,u.Events.PasteEnd,u.Events.ClipboardPasted,u.Events.ValueChanged,u.Events.RangeChanged,u.Events.ShapeChanged,u.Events.ShapeRemoved,u.Events.FloatingObjectChanged,u.Events.FloatingObjectRemoved].forEach(function(t){i.bind("".concat(t).concat(p),i.enqueueBuildExpansionInfoCacheMessage)}),i.bind("".concat(u.Events.RowChanged).concat(p,"-ns"),i.z_i),i.bind("".concat(u.Events.ColumnChanged).concat(p,"-ns"),i.G_i),i.bind("".concat(u.Events.FloatingObjectRemoved).concat(p,"-ns"),i.k_i),i.bind("".concat(u.Events.FloatingObjectChanged).concat(p,"-ns"),i.V_i),i.bind("".concat(u.Events.ShapeRemoved).concat(p,"-ns"),i.Z_i),i.bind("".concat(u.Events.ShapeChanged).concat(p,"-ns"),i.H_i),i.bind("".concat(u.Events.WorksheetDataChanged).concat(p,"-ns"),i.W_i)},g.prototype.buildBreadLineCache=function(){this.x_i.yEi();var t=this.getParent();t&&(t.needUpdatePrintCache=!0,this.ki(u.Events.ReportPaginationSettingChanged))},g.prototype.updateAllAliasInfo=function(){this.L_i.v3i()},g.prototype.NEi=function(t,n,i){var r,e=this.getSpan(t,n);e&&(e.row!==t||e.col!==n)&&i?(i.paginateAfterColumn=!1,i.paginateAfterRow=!1,i.paginateBeforeColumn=!1,i.paginateBeforeRow=!1):this.x_i.NEi(t,n,i)},g.prototype.ixi=function(){var t,t,t=this.$f();(0,o.J3i)(t),this.charts&&((t=this.charts).tIe?t.paintBlankChart=d.rxi:t.paintBlankChart=d.exi)},g.prototype.R_i=function(t){var n,i,r,e,o,u;if(l.Chart&&t&&t instanceof l.Chart)for(n=t.name(),i=this.getRowCount(),r=this.getColumnCount(),e=0;e<i;e++)for(o=0;o<r;o++)(u=this.getBindingPath(e,o))&&u.chartName===n&&(u.chartName=null,this.setBindingPath(e,o,u))},g.prototype.U_i=function(t,n,i){var r,e,o,u,s,c;if(l.Chart&&t&&t instanceof l.Chart&&"name"===n)for(r=t.name(),e=this.getRowCount(),o=this.getColumnCount(),u=0;u<e;u++)for(s=0;s<o;s++)(c=this.getBindingPath(u,s))&&c.chartName===i&&(c.chartName=r,this.setBindingPath(u,s,c))},g.prototype.Y_i=function(t,n){n?(this.Q_i.XEi(t),this.L_i.XEi(t)):(this.Q_i.$Ei(t),this.L_i.$Ei(t))},g.prototype.KI=function(t,n,i,r,e,o,u,s,c,f){var a,h,l,v,d,a,t;for(this.suspendPaint(),l=(h=t)+i-1;h<=l;h++)for(d=(v=n)+r-1;v<=d;v++)(a=null==(a=this.getStyle(h,v))?void 0:a.clone())&&a._autoFormatter&&(delete a._autoFormatter,a.toJSON()||this.setStyle(h,v,void 0));return t=M.prototype.KI.call(this,t,n,i,r,e,o,u,s,c,f),this.resumePaint(),t},g.prototype.internalUpdateSettingsToReferNewTable=function(t,n){var t=t.toUpperCase();(0,d.Etr)(this,t,n),(0,d.jtr)(this,t,n)},g.prototype.internalUpdateSettingsToReferNewColumn=function(t,n,i){var t=t.toUpperCase(),n=n.toUpperCase();(0,d.Atr)(this,t,n,i),(0,d.Ttr)(this,t,n,i)},g.prototype.onCustomNameFormulaChanged=function(t){this.Q_i._6(t)},g.prototype.fetchAllTablesAsync=function(t,n){var i,r,e,o;return void 0===n&&(n=!1),i=this.D_i(),r=t.dataManager(),e=Object.keys(r.tables),o=function(n){return r.tables[e.find(function(t){return t.toUpperCase()===n})]},Promise.all(i.map(function(t){var t=o(t);return t?t.fetch(n).catch(function(){}):Promise.resolve()}))},g.prototype.D_i=function(){var t,n,i,r,e,o,u,s,c,f,f,t={},n=(0,h.$3i)(this);if(n)for(i=n.row,r=n.col,u=i+(e=n.rowCount),s=r+(o=n.colCount);i<u;i++){for(;r<s;r++)c=this.getTemplateCell(i,r),(0,a.ht)(c)||"string"==typeof c||((f=(0,h.w3i)(c))&&!(0,a.ht)(f.tableName)&&(t[f.tableName.toUpperCase()]=!0),f=c.filter&&c.filter.condition,this.E_i(f,t));r=n.col}return Object.keys(t)},g.prototype.E_i=function(t,n){var i,r,e,o,u,s;if(t){if(t.dataColumn&&(n[t.dataColumn.tableName.toUpperCase()]=!0),t.and)for(i=0,r=t.and;i<r.length;i++)e=r[i],this.E_i(e,n);if(t.or)for(o=0,u=t.or;o<u.length;o++)s=u[o],this.E_i(s,n)}},g.prototype.getText=function(t,n,i){var r,e,e,o,r=this,e=r.getTemplateCell(t,n);return(0,a.ht)(i)&&(i=3),e?r.$t(t,n,i):(e=r.t0(t,n,i),(0,a.ht)(e)?(o=r.getValue(t,n,i),r.vL(t,n,o,i,!0)):e)},g.prototype.isActualProtected=function(){return!1},g.prototype.getActualUsedRange=function(){var t=this,n=t.Ut,i=n.getLastNonNullCol(3,!0),n=n.getLastNonNullRow(3,!0),n=(0,a.ht)(n)?0:n+1,i=(0,a.ht)(i)?0:i+1;return(0,h.a_i)(t,new u.Range(0,0,n,i))},n.TemplateSheet=g},"./dist/plugins/report/worksheet/utils.js":function(t,n,i){"use strict";var e,h,r,s,c,f,o,u;function a(t){var n,i,r,e,o,u,n=t&&t.data&&t.data.dataTable;if(n)for(i in n)if(n.hasOwnProperty(i))for(e in r=n[i])r.hasOwnProperty(e)&&(u=(o=r[e])&&o.bindingPath)&&"object"==typeof u&&(o.bindingPath=(0,s.j_i)((0,h.RF)(u)))}function l(t){var n,i,r,e,o,u,n=t&&t.data&&t.data.dataTable;if(n)for(i in n)if(n.hasOwnProperty(i))for(e in r=n[i])r.hasOwnProperty(e)&&(u=(o=r[e])&&o.bindingPath)&&"object"==typeof u&&(o.bindingPath=(0,s.M_i)(u))}function v(t){var n,t,i,r,e,o,u,n,t=null==t?void 0:t.c_;if(null!=t&&t.length&&(i=t.filter(function(t){return"sheetData"===t.n_})[0]))for(r in i)if(i.hasOwnProperty(r)&&"object"==typeof i[r])for(o in e=i[r])e.hasOwnProperty(o)&&"object"==typeof e[o]&&(n=null==(n=null==(u=e[o])?void 0:u.lossless)?void 0:n.bindingPath)&&"object"==typeof n&&(u.lossless.bindingPath=(0,s.j_i)((0,h.RF)(n)))}function d(t){var n,t,i,r,e,o,u,n,t=null==t?void 0:t.c_;if(null!=t&&t.length&&(i=t.filter(function(t){return"sheetData"===t.n_})[0]))for(r in i)if(i.hasOwnProperty(r)&&"object"==typeof i[r])for(o in e=i[r])e.hasOwnProperty(o)&&"object"==typeof e[o]&&(n=null==(n=null==(u=e[o])?void 0:u.lossless)?void 0:n.bindingPath)&&"object"==typeof n&&(u.lossless.bindingPath=(0,s.M_i)(n))}function p(t,n){var i=document.createElement("div");i.style.display="flex",i.style.justifyContent="center",i.style.alignItems="center",i.style.border="1px solid #BDBDBD",i.style.backgroundColor="white",i.style.color="#424242",i.style.height="100%",i.style.fontSize="14px",i.style.fontStyle="italic",i.textContent=o().configDataSetting,n.appendChild(i)}function w(t,n,i,r){n.save(),n.beginPath(),n.rect(0,0,i,r),n.fillStyle="#FFFFFF",n.fill(),n.beginPath(),n.rect(0,0,i,r),n.strokeStyle="#BDBDBD",n.lineWidth=1,n.stroke(),n.font="italic 14px sans-serif",n.fillStyle="#424242",n.textAlign="center",n.textBaseline="middle",n.fillText(o().configDataSetting,i/2,r/2,i),n.restore()}function I(t,n,i){var r,e,o,u,s,r=t.Ut.W_(h.SheetArea.viewport).dataTable;if(r)for(e in r)if(r.hasOwnProperty(e))for(u in o=r[e])o.hasOwnProperty(u)&&(s=o[u])&&s.bindingPath&&N(s.bindingPath,n,i)}function M(t,n,i){var t=t.getDataEntrySetting();null!=t&&t.length&&t.forEach(function(t){t.tableName.toUpperCase()===n&&(t.tableName=i)})}function g(t,n,i,r){var e,o,u,s,c,e=t.Ut.W_(h.SheetArea.viewport).dataTable;if(e)for(o in e)if(e.hasOwnProperty(o))for(s in u=e[o])u.hasOwnProperty(s)&&(c=u[s])&&c.bindingPath&&E(t,c.bindingPath,n,i,r)}function C(t,n,i,r){var t=t.getDataEntrySetting();null!=t&&t.length&&t.forEach(function(t){t.tableName.toUpperCase()===n&&t.fields.forEach(function(t){t.dbColumnName.toUpperCase()===i&&(t.dbColumnName=r)})})}function N(t,n,i){var t;t&&"object"==typeof t&&["List","Group","Summary"].includes(t.type)&&((t=t).binding&&t.binding.toUpperCase().startsWith(n+"[")&&(t.binding="".concat(i).concat(t.binding.substring(n.length))),t.filter)&&t.filter.condition&&O(t.filter.condition,n,i)}function E(r,t,n,e,o){var i,i,t,u;t&&"object"==typeof t&&["List","Group","Summary"].includes(t.type)&&((t=t).binding&&t.binding.toUpperCase().startsWith(n+"[")?(t.binding.toUpperCase()==="".concat(n,"[").concat(e,"]")&&(t.binding=t.binding.replace(/\[.*\]/g,"[".concat(o,"]"))),t.filter&&t.filter.condition&&(u=D(r,t.filter.condition,n,e,o),t.filter.condition=u),null!=(i=t.sortOptions)&&i.length&&t.sortOptions.forEach(function(t){var n=!1,i;t.asc?(n=!0,i=t.asc):t.desc&&(i=t.desc),i=j(r,i,e,o),n?t.asc=i:t.desc=i}),t.formula&&(t.formula=A(r,t.formula,e,o)),null!=(i=t.bins)&&i.length&&t.bins.forEach(function(t){t.groupBy=A(r,t.groupBy,e,o)})):t.filter&&t.filter.condition&&(u=D(r,t.filter.condition,n,e,o,!0),t.filter.condition=u))}function j(t,n,i,r){if((n=n.trim()).startsWith("=")){var e=n.substring(1);if(!u.test(e))return A(t,n,i,r)}else if(n.toUpperCase()===i)return r}function A(t,n,i,r){var e,o,u,e=T(t,n),o=new RegExp("\\[@?".concat(i,"\\]"),"i"),u=new RegExp("".concat(i),"i");return e.forEachNodes(function(t){t.type===c.ExpressionType.name&&t.value.match(o)&&(t.value=t.value.replace(u,r))}),(n.startsWith("=")?"=":"")+(0,f.expressionToFormula)(t,e)}function T(t,n){return t.Lp.parse(t.qgt,n,0,0)}function D(i,r,e,o,u,s){var t=b(i,r,e,o,u,s);return r.and&&r.and.forEach(function(t,n){var t=D(i,t,e,o,u,s);r.and[n]=t}),r.or&&r.or.forEach(function(t,n){var t=D(i,t,e,o,u,s);r.or[n]=t}),t}function b(t,n,i,r,e,o){var i,u,u,u=n&&n.dataColumn;return u&&u.tableName.toUpperCase()===i&&u.columnName.toUpperCase()===r&&(n.dataColumn.columnName=e),o||("string"==typeof n?n=A(t,n,r,e):(null==(i=null==n?void 0:n.column)?void 0:i.toUpperCase())===r&&(n.column=e),(u=n)&&"string"==typeof u.formula&&(u.formula=A(t,u.formula,r,e))),n}function O(t,n,i){S(t,n,i),t.and&&t.and.forEach(function(t){O(t,n,i)}),t.or&&t.or.forEach(function(t){O(t,n,i)})}function S(t,n,i){var r;t&&(null==(r=t.dataColumn)?void 0:r.tableName.toUpperCase())===n&&(t.dataColumn.tableName=i)}function m(t,n){var i,r,i=null==n?void 0:n.Lp;i&&(r=e(e([],y(t),!0),[t.Uw(),t.T3,t.A3],!1)).forEach(function(t){t&&i.removeSource(t)})}function y(t){var n={calcSources:[]};return h.Worksheet.et(t,"getRelatedCalcSources",n),n.calcSources}function R(t,n,i,r){var e,o,u,s,c,f,a,e=i.getViewportTopRow(1),o=i.getViewportBottomRow(1),u=i.getViewportLeftColumn(1),s=i.getViewportRightColumn(1);!r||(n<u||s<n)&&(t<e||o<t)||("H"===r.cellNode.templateCell.expansionDirection?(n<u||s<n)&&(f=i.ly,i.showColumn(n,h.HorizontalPosition.left),i.scroll(0-f,0)):(t<e||o<t)&&(f=i.my,i.showRow(t,h.VerticalPosition.top),i.scroll(0,0-f)))}e=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r=0,e=n.length,o;r<e;r++)!o&&r in n||((o=o||Array.prototype.slice.call(n,0,r))[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.showCellInViewport=n.H3i=n.Ttr=n.Atr=n.jtr=n.Etr=n.exi=n.rxi=n.$_i=n.K_i=n.X_i=n.F_i=void 0,h=i("Core"),r=i("./dist/plugins/report/resources/index.js"),s=i("./dist/plugins/report/utils/utils.js"),c=i("CalcEngine"),f=i("SheetsCalc"),n.F_i=a,n.X_i=l,n.K_i=v,n.$_i=d,o=r.rm.getResource.bind(r.rm),n.rxi=p,n.exi=w,n.Etr=I,n.jtr=M,n.Atr=g,n.Ttr=C,u=/^([A-Z]+)(\d+)$/,n.H3i=m,n.showCellInViewport=R},"./node_modules_local/@spreadjs/js-report/dist/gc.report.js":function(t,n){var i,n,o,r;!function(){"use strict";var r,e,t,r={8346:function(t,n){var i,r;function e(t,n,i,r){this.reset(t,n,i,r)}i=this&&this.__assign||function(){return(i=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.SmartCache=void 0,e.prototype.get=function(t,n){var t=t-this.Dyt;if(this.cE[t])return this.cE[t][n-this._yt]},e.prototype.set=function(t,n,i){var r=t-this.Dyt;this.cE[r]||(0<this.Tx?this.cE[r]=new Array(this.Tx):this.cE[r]=[]),t>this.Z5.rowEnd&&(this.Z5.rowEnd=t),n>this.Z5.colEnd&&(this.Z5.colEnd=n),this.cE[r][n-this._yt]=i},e.prototype.getRange=function(){return i({},this.Z5)},e.prototype.reset=function(t,n,i,r){this.cE=0<i?new Array(i-t+1):[],this.Tx=r-n,this.Dyt=t,this._yt=n,this.Z5={row:t,col:n,rowEnd:i,colEnd:r}},n.SmartCache=e},7789:function(t,n){var e,i;function r(t){for(var n=-1,i=1,r="A".charCodeAt(0)-1,e=t.length-1;0<=e;e--)n+=(t.charCodeAt(e)-r)*i,i*=26;return n}function o(t,n,i){var r=e(e([],i=void 0===i?[]:i,!0),[t],!1);0<t.children.length?t.children.forEach(function(t){return o(t,n,r)}):n.push(r)}e=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r,e=0,o=n.length;e<o;e++)!r&&e in n||((r=r||Array.prototype.slice.call(n,0,e))[e]=n[e]);return t.concat(r||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.uxi=n.phe=n.QEi=void 0,n.QEi=function(t){t=(t||"").replace("=","").trim().toUpperCase();var t=i.exec(t);return t?{row:parseInt(t[2],10)-1,col:r(t[1])}:null},i=/^([A-Z]+)([0-9]+)$/,n.phe=function(t){var n=[];return o(t,n),n},n.uxi=function n(t,i){i(t)||t.children.forEach(function(t){return n(t,i)})}},3607:function(t,n,i){var r,e,o,u,r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&!("get"in e?!n.__esModule:e.writable||e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),n.ParentChildTreeGenerator=n.ReportEngine=void 0,o=i(6401),Object.defineProperty(n,"ReportEngine",{enumerable:!0,get:function(){return o.ReportEngine}}),u=i(9034),Object.defineProperty(n,"ParentChildTreeGenerator",{enumerable:!0,get:function(){return u.ParentChildTreeGenerator}}),e(i(1129),n),e(i(6546),n),e(i(7770),n),e(i(9876),n),e(i(4869),n),e(i(6807),n)},7770:function(t,n){Object.defineProperty(n,"__esModule",{value:!0})},4869:function(t,n){Object.defineProperty(n,"__esModule",{value:!0})},6807:function(t,n){Object.defineProperty(n,"__esModule",{value:!0})},9876:function(t,n){Object.defineProperty(n,"__esModule",{value:!0})},1129:function(t,n){Object.defineProperty(n,"__esModule",{value:!0})},6546:function(t,n){Object.defineProperty(n,"__esModule",{value:!0})},9089:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.CellNodeFinder=void 0;var e=i(8346),o=i(7789),u=i(391),r;function s(t,n){void 0===n&&(n=null),this.sxi=t,this.cxi=n,this.n_i=null!==this.cxi?this.cxi.getTemplateRange():this.sxi.getRange();var t=this.n_i,n=t.row,i=t.col,r=t.rowEnd,t=t.colEnd;this.fxi=new e.SmartCache(n,i,r,t)}s.prototype.hxi=function(t){var n,i,r,e,n;if((0,u.axi)(t.templateCell.leftParent)){if((n=this.fxi.get(t.templateCell.row,t.templateCell.col))&&void 0!==n.leftParent)return n.leftParent;for(i=[],r=t.templateCell.col-1;r>=this.n_i.col;r--)if(e=this.lxi(t.templateCell.row,r)){if((0,u.vxi)(e.templateCell.leftParent)&&(r=-1),this.dxi(e))return this.pxi(i,e,"left"),e;(0,u.axi)(e.templateCell.leftParent)&&(0,u.e5t)(e)&&e.templateCell.col===r&&i.push({row:t.templateCell.row,col:r})}this.pxi(i,null,"left")}else if(!(0,u.vxi)(t.templateCell.leftParent)&&(n=(0,o.QEi)(t.templateCell.leftParent))&&(e=this.lxi(n.row,n.col,this.wxi(n.row,n.col)))&&e!==t)return e;return null},s.prototype.gxi=function(t){var n,i,r,e,n;if((0,u.axi)(t.templateCell.upParent)){if((n=this.fxi.get(t.templateCell.row,t.templateCell.col))&&void 0!==n.upParent)return n.upParent;for(i=[],r=t.templateCell.row-1;r>=this.n_i.row;r--)if(e=this.lxi(r,t.templateCell.col)){if((0,u.vxi)(e.templateCell.upParent)&&(r=-1),this.Mxi(e))return this.pxi(i,e,"up"),e;(0,u.axi)(e.templateCell.upParent)&&(0,u.e5t)(e)&&e.templateCell.row===r&&i.push({row:r,col:t.templateCell.col})}this.pxi(i,null,"up")}else if(!(0,u.vxi)(t.templateCell.upParent)&&(n=(0,o.QEi)(t.templateCell.upParent))&&(e=this.lxi(n.row,n.col,this.wxi(n.row,n.col)))&&e!==t)return e;return null},s.prototype.lxi=function(t,n,i){var r=this.sxi.get(t,n);return r||(r=this.jxi(t,n,i),this.Ixi(r)),r},s.prototype.Ixi=function(t){var n,i,r,e;if(t)for(n=t.templateCell.rowEnd,i=t.templateCell.colEnd,r=t.templateCell.row;r<=n;r++)for(e=t.templateCell.col;e<=i;e++)this.sxi.set(r,e,t)},s.prototype.jxi=function(t,n,i){var r=this.cxi.getTemplateCell(t,n);if(!r){if(!i)return null;r={row:t,col:n,rowEnd:t,colEnd:n,value:void 0,formula:void 0,isEmpty:!0,isRowHeightChanged:!1,isColWidthChanged:!1,leftParent:"Default",upParent:"Default",expansionDirection:"No",filter:null,hExpansible:!0,vExpansible:!0}}return{templateCell:r,treeRange:{row:r.row,col:r.col,rowEnd:r.rowEnd,colEnd:r.colEnd},children:[],leftParent:null,upParent:null,data:{groups:[]},indexOfLeftParentChildren:-1,indexOfUpParentChildren:-1}},s.prototype.dxi=function(t){var t=t.templateCell;return"V"===t.expansionDirection&&(t.dataColumn||t.formula)&&(!t.dataSetting||"Summary"!==t.dataSetting.type)},s.prototype.Mxi=function(t){var t=t.templateCell;return"H"===t.expansionDirection&&(t.dataColumn||t.formula)&&(!t.dataSetting||"Summary"!==t.dataSetting.type)},s.prototype.wxi=function(t,n){return t>=this.n_i.row&&t<=this.n_i.rowEnd&&n>=this.n_i.col&&n<=this.n_i.colEnd},s.prototype.pxi=function(t,r,e){var o=this;t.forEach(function(t){var n=t.row,t=t.col,i=o.fxi.get(n,t);i||o.fxi.set(n,t,i={}),"left"===e?i.leftParent=r:i.upParent=r})},n.CellNodeFinder=s},9034:function(t,n,i){var e,o,a,u,h,r;function s(t){this.cxi=t}e=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r,e=0,o=n.length;e<o;e++)!r&&e in n||((r=r||Array.prototype.slice.call(n,0,e))[e]=n[e]);return t.concat(r||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.ParentChildTreeGenerator=void 0,o=i(8346),a=i(7789),u=i(9089),h=i(391),s.prototype.process=function(t){var n,i,r,e,o,u,o;if(void 0===t&&(t=!1),performance.now(),!this.cxi)return null;if(this.n_i=this.cxi.getTemplateRange(),!this.n_i)return null;for(this.V4i(),this.Cxi(),n=this.bxi(),i=this.n_i.rowEnd;i>=this.n_i.row;i--)for(r=this.n_i.colEnd;r>=this.n_i.col;r--)(e=this.mxi.lxi(i,r))&&e.templateCell.row===i&&e.templateCell.col===r&&(this.yxi(n,e),this.Nxi(e),(0,h.e5t)(e))&&(u=(o=this.Oji(e)).leftParent,o=o.upParent,(u||o)&&this.Dxi(u,o,e)?(this.Oxi(u,n),this.Oxi(o,n),u&&o&&n.crossCells.unshift(e)):this.Axi(n,e));return this.Txi(n),t||(0,h.Exi)(n),this.Sxi(n),this._xi(n),this.xxi(),performance.now(),n},s.prototype.V4i=function(){var t=this.n_i,n=t.row,i=t.col,r=t.rowEnd,t=t.colEnd;this.sxi=new o.SmartCache(n,i,r,t),this.zxi=new o.SmartCache(n,i,r,t),this.mxi=new u.CellNodeFinder(this.sxi,this.cxi),this.Lxi=[],this.Pxi=[],this.Bxi=[],this.Gxi=[]},s.prototype.bxi=function(){return{verticalExpansionTrees:[],horizontalExpansionTrees:[],crossCells:[],cellNodeCache:this.sxi,templateResolver:this.cxi,colOffsetClearCache:this.Lxi,rowOffsetClearCache:this.Pxi,paginateBeforeRowCache:{},paginateAfterRowCache:{},paginateBeforeColumnCache:{},paginateAfterColumnCache:{},canNotBreakCells:[]}},s.prototype.Cxi=function(){for(var t,n,i,r,e,r,t=this.n_i.row;t<=this.n_i.rowEnd;t++)for(n=this.n_i.col;n<=this.n_i.colEnd;n++)(i=this.mxi.lxi(t,n))&&i.templateCell.row===t&&i.templateCell.col===n&&(0,h.e5t)(i)&&((0,h.kxi)(i.templateCell.leftParent)||(0,h.kxi)(i.templateCell.upParent))&&(e=(r=this.Oji(i)).leftParent,r=r.upParent,e||r)&&this.Dxi(e,r,i)},s.prototype.Oji=function(t){var n=this.mxi.hxi(t),i=this.mxi.gxi(t);return n&&i&&n===i&&((0,h.axi)(t.templateCell.upParent)?i=null:n=null),{leftParent:n,upParent:i}},s.prototype.Axi=function(t,n){"V"===n.templateCell.expansionDirection?t.verticalExpansionTrees.unshift(this.Rxi(n)):"H"===n.templateCell.expansionDirection?t.horizontalExpansionTrees.unshift(this.Rxi(n)):n.templateCell.dataColumn&&t.verticalExpansionTrees.unshift(this.Rxi(n))},s.prototype.Txi=function(t){var f=this;t.verticalExpansionTrees.forEach(function(t){var t,n,i,r,e,n,o,i,u,s,c,t=t.root,n=t.treeRange,i=n.row,r=n.col,e=n.rowEnd,n=n.colEnd;for(f.zxi.reset(i,r,e,n),i=(o=(0,a.phe)(t).sort(function(t,n){return n.length-t.length}))[0].length,u=[],s=function(n){o.forEach(function(t){t[n]&&!u.includes(t[n])&&f.Zxi(t[n])})},c=i-2;0<=c;c--)s(c)}),t.horizontalExpansionTrees.forEach(function(t){var t,n,i,r,e,n,o,i,u,s,c,t=t.root,n=t.treeRange,i=n.row,r=n.col,e=n.rowEnd,n=n.colEnd;for(f.zxi.reset(i,r,e,n),i=(o=(0,a.phe)(t).sort(function(t,n){return n.length-t.length}))[0].length,u=[],s=function(n){o.forEach(function(t){t[n]&&!u.includes(t[n])&&f.Vxi(t[n])})},c=i-2;0<=c;c--)s(c)}),t.verticalExpansionTrees=t.verticalExpansionTrees.filter(function(t){return!t.root.leftParent&&!t.root.upParent}),t.horizontalExpansionTrees=t.horizontalExpansionTrees.filter(function(t){return!t.root.leftParent&&!t.root.upParent})},s.prototype.Zxi=function(t){for(var n,i,r,e,o,u,s,c,f,n=t.treeRange,i=n.row,r=n.col,e=n.rowEnd,o=n.colEnd,u=!1,s=i;s<=e;s++)for(c=r;c<=o;c++)!(f=this.mxi.lxi(s,c))||f===t||this.zxi.get(f.templateCell.row,f.templateCell.col)||f.templateCell.row<i||f.templateCell.col<r||f.templateCell.isEmpty&&this.Uxi(f)||(0,h.vxi)(f.templateCell.leftParent)||!f||f.leftParent||f.upParent||(this.Dxi(t,null,f)?u=!0:this.zxi.set(f.templateCell.row,f.templateCell.col,!0));u&&this.Zxi(t)},s.prototype.Vxi=function(t){for(var n,i,r,e,o,u,s,c,f,n=t.treeRange,i=n.row,r=n.col,e=n.rowEnd,o=n.colEnd,u=!1,s=i;s<=e;s++)for(c=r;c<=o;c++)!(f=this.mxi.lxi(s,c))||f===t||this.zxi.get(f.templateCell.row,f.templateCell.col)||f.templateCell.row<i||f.templateCell.col<r||f.templateCell.isEmpty&&this.Uxi(f)||(0,h.vxi)(f.templateCell.upParent)||!f||f.upParent||f.leftParent||(this.Dxi(null,t,f)?u=!0:this.zxi.set(f.templateCell.row,f.templateCell.col,!0));u&&this.Vxi(t)},s.prototype.Uxi=function(t){var n,i,r,e,o,n,u,s,c,n,f,a,h,l,v,n=this.n_i,i=n.row,r=n.col,e=n.rowEnd,o=n.colEnd,n=t.templateCell,u=n.row,s=n.col,c=n.isRowHeightChanged,n=n.isColWidthChanged;if(!c&&!n)return!0;if(f=this.Gxi[u],a=this.Bxi[s],c&&!f)for(h=r;h<=o;h++)if((v=this.sxi.get(u,h))&&v!==t&&!v.templateCell.isEmpty){f=!0;break}if(n&&!a)for(l=i;l<=e;l++)if((v=this.sxi.get(l,s))&&v!==t&&!v.templateCell.isEmpty){a=!0;break}return c&&!n?f:(n&&!c||!(!c||!n)&&f)&&a},s.prototype.Sxi=function(t){var t=e(e([],t.verticalExpansionTrees,!0),t.horizontalExpansionTrees,!0),r=function(i){i.children.sort(h.Hxi),i.children.forEach(function(t,n){t.leftParent===i?t.indexOfLeftParentChildren=n:t.indexOfUpParentChildren=n,r(t)})};t.forEach(function(t){return r(t.root)})},s.prototype.Wxi=function(t){var t=t.templateCell,n=t.row,t=t.col;this.Gxi[n]||(this.Gxi[n]=!0),this.Bxi[t]||(this.Bxi[t]=!0)},s.prototype._xi=function(t){var n=t.crossCells;e(e([],t.verticalExpansionTrees,!0),t.horizontalExpansionTrees,!0).forEach(function(t){t.pathArray=(0,a.phe)(t.root),t.crossCells=n.filter(function(n){return t.pathArray.find(function(t){return t.find(function(t){return t===n})})})})},s.prototype.Rxi=function(t){return this.Wxi(t),{root:t,pattern:"Unanalyzed",pathArray:null,crossCells:[]}},s.prototype.Dxi=function(t,n,i){return this.Qxi=i,t&&i&&!t.children.includes(i)&&(t.children.unshift(i),i.leftParent=t),n&&i&&!n.children.includes(i)&&(n.children.unshift(i),i.upParent=n),this.Fxi(i,!0)?(this.Fxi(i,!1),this.Wxi(i),!0):(t&&i&&t.children.includes(i)&&(t.children=t.children.filter(function(t){return t!==i}),i.leftParent=null),n&&i&&n.children.includes(i)&&(n.children=n.children.filter(function(t){return t!==i}),i.upParent=null),!1)},s.prototype.Fxi=function(t,n,i){void 0===i&&(i=[]);var r=t.leftParent,e=t.upParent,o=!0;return!r||this.Yxi(t,r,i,n)||(o=!1),o=!e||this.Yxi(t,e,i,n)?o:!1},s.prototype.Yxi=function(t,n,i,r){var e=!0;if(n){if(r||(t.treeRange.row<n.treeRange.row&&(n.treeRange.row=t.treeRange.row),t.treeRange.col<n.treeRange.col&&(n.treeRange.col=t.treeRange.col),t.treeRange.rowEnd>n.treeRange.rowEnd&&(n.treeRange.rowEnd=t.treeRange.rowEnd),t.treeRange.colEnd>n.treeRange.colEnd&&(n.treeRange.colEnd=t.treeRange.colEnd)),n===this.Qxi&&i.includes(n))return!1;i.unshift(n),e=this.Fxi(n,r,i)}return e},s.prototype.Oxi=function(n,t){var i,r;n&&!n.templateCell.dataColumn&&"No"===n.templateCell.expansionDirection&&(i=this.mxi.hxi(n),r=this.mxi.gxi(n),i||r||t.verticalExpansionTrees.find(function(t){return t.root===n})||t.verticalExpansionTrees.unshift(this.Rxi(n)))},s.prototype.yxi=function(t,n){var i,r,e,o,u,s,c,i=n.templateCell,r=i.row,e=i.col,o=i.rowEnd,u=i.colEnd;if(n.templateCell.paginateBeforeRow)for(s=r;s<=o;s++)t.paginateBeforeRowCache[s]||(t.paginateBeforeRowCache[s]={}),t.paginateBeforeRowCache[s][e]=!0;if(n.templateCell.paginateAfterRow)for(s=r;s<=o;s++)t.paginateAfterRowCache[s]||(t.paginateAfterRowCache[s]={}),t.paginateAfterRowCache[s][e]=!0;if(n.templateCell.paginateBeforeColumn)for(c=e;c<=u;c++)t.paginateBeforeColumnCache[c]||(t.paginateBeforeColumnCache[c]={}),t.paginateBeforeColumnCache[c][r]=!0;if(n.templateCell.paginateAfterColumn)for(c=e;c<=u;c++)t.paginateAfterColumnCache[c]||(t.paginateAfterColumnCache[c]={}),t.paginateAfterColumnCache[c][r]=!0;n.templateCell.canBreakWhenPaging||t.canNotBreakCells.includes(n)||t.canNotBreakCells.unshift(n)},s.prototype.Nxi=function(t){var t,n,i,r,e,o,t,u,s,c,f,t=t.templateCell,n=t.row,i=t.col,r=t.rowEnd,e=t.colEnd,o=t.clearColOffset,t=t.clearRowOffset;if(o)for(u=i;u<=e;u++)for((s=this.Lxi[u])||(this.Lxi[u]=s=[]),c=n;c<=r;c++)s.push(c);if(t)for(c=n;c<=r;c++)for((f=this.Pxi[c])||(this.Pxi[c]=f=[]),u=i;u<=e;u++)f.push(u)},s.prototype.xxi=function(){var o=this,t=this.n_i,u=t.row,s=t.col,c=t.rowEnd,f=t.colEnd;Object.keys(this.Lxi).forEach(function(t){var t=parseInt(t,10),n=o.Lxi[t];n&&(o.Lxi[t]=n.filter(function(t){for(var n,i,i,r,e,i,n=s;n<=f;n++)if(i=o.sxi.get(t,n)){if(i.leftParent||i.upParent)return!1;if(r=(i=i.templateCell).dataColumn,e=i.expansionDirection,i=i.formula,"No"!==e&&(r||i))return!1}return!0}))}),Object.keys(this.Pxi).forEach(function(t){var t=parseInt(t,10),n=o.Pxi[t];n&&(o.Pxi[t]=n.filter(function(t){for(var n,i,i,r,e,i,n=u;n<=c;n++)if(i=o.sxi.get(n,t)){if(i.leftParent||i.upParent)return!1;if(r=(i=i.templateCell).dataColumn,e=i.expansionDirection,i=i.formula,"No"!==e&&(r||i))return!1}return!0}))})},n.ParentChildTreeGenerator=s},391:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.Exi=n.e5t=n.Hxi=n.kxi=n.vxi=n.axi=void 0;var o=i(7789);function r(t){return"DEFAULT"===(t||"").toUpperCase()}function e(t){return"NONE"===(t||"").toUpperCase()}function s(t){var e=[];return t.forEach(function(t){return t=t,n=[],((i=(0,o.phe)(t.root)).some(function(t){return t.some(function(t){return(t.templateCell.dataColumn||t.templateCell.formula)&&("No"!==t.templateCell.expansionDirection||0<Object.values(t.templateCell.filter||{}).length)})})?[t]:(i.some(function(t){return t.some(function(t){return t.templateCell.dataColumn||t.templateCell.formula})})&&(0,o.uxi)(t.root,function(t){(t.templateCell.dataColumn||t.templateCell.formula)&&n.push({root:t,pattern:"Unanalyzed",pathArray:null,crossCells:[]})}),r=[],i.forEach(function(t){return t.forEach(function(t){r.includes(t)||(r.push(t),t.children=[],t.leftParent=null,t.upParent=null,t.indexOfLeftParentChildren=-1,t.indexOfUpParentChildren=-1)})}),n)).forEach(function(t){return e.push(t)});var t,n,i,r}),e}n.axi=r,n.vxi=e,n.kxi=function(t){return!e(t)&&!r(t)},n.Hxi=function(t,n){return t.templateCell.row<n.templateCell.row?-1:t.templateCell.row>n.templateCell.row?1:t.templateCell.col<n.templateCell.col?-1:t.templateCell.col>n.templateCell.col?1:0},n.e5t=function(t){var t;return!(!t||!(t=t.templateCell).dataColumn&&t.isEmpty)},n.Exi=function(t){var n,n,r,e,o,u;r=(n=t).crossCells,e=[],o=function(n){n.upParent&&(n.upParent.children=n.upParent.children.filter(function(t){return t!==n}),n.upParent=null)},u=function(n){n.leftParent&&(n.leftParent.children=n.leftParent.children.filter(function(t){return t!==n}),n.leftParent=null)},r.forEach(function(t){for(var n,i,n=t.leftParent;n;){if(r.includes(n))return void o(t);n=n.leftParent}for(i=t.upParent;i;){if(r.includes(i))return void u(t);i=i.upParent}t.leftParent.upParent!==t.upParent?t.upParent.leftParent!==t.leftParent?e.push(t):u(t):o(t)}),n.crossCells=e,(n=t).verticalExpansionTrees=s(n.verticalExpansionTrees),n.horizontalExpansionTrees=s(n.horizontalExpansionTrees)}},4568:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.DataEntryService=void 0;var e=i(1633),o=i(9036),u=i(8974),s=i(8334),c=i(7680),r;function f(t,n,i){this.u=!1;var r=t.Jxi().templateResolver.getTemplateDataCollectionSetting();this.Kxi=new u.GroupsCache,this.Xxi=new e.AddRecordHelper(t,n,this.Kxi),this.$xi=new o.DeleteRecordHelper(t,r,n),this.qxi=new s.UpdateRecordHelper(n,this.Kxi),this.j2i=new c.DataCollectionHelper(this.$xi.I2i(),t.Jxi(),r,i)}f.prototype.addRecord=function(t,n){var t=this.Xxi.q4i(t,n);return t.success&&(this.u=!0),t},f.prototype.deleteRecord=function(t,n){var t=this.$xi.tEi(t,n);return t.success&&(this.u=!0),t},f.prototype.updateCellValue=function(t,n,i){var t=this.qxi.$4i(t,n,i);return t.success&&(this.u=!0),t},f.prototype.resetAllCellsStateToNormal=function(t,n){performance.now(),this.Kxi.C2i(t,function(t){t.isNew=!1,t.state="normal"}),this.$xi.dl(n),this.u=!1,performance.now()},f.prototype.getDataCollectionResults=function(){return this.j2i.nEi()},f.prototype.isDirty=function(){var t,n,i,r;if(this.u&&0!==(t=this.getDataCollectionResults()).length)for(n=0;n<t.length;n++)if("Smart"===(i=t[n]).dataCollectionSetting.type){if(0<i.deletedRecords.length||0<i.records.length)return!0}else if(0<i.records.length)return!0;return!1},n.DataEntryService=f},1633:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.AddRecordHelper=void 0;var r=i(5443),s=i(1453),e;function o(t,n,i){this.y2i=t,this.N2i=n,this.Kxi=i}o.prototype.q4i=function(t,n){var i,t,n,i={success:!1,nextActiveCell:null},t=this.N2i.get(t,n);return this.D2i(i,t)&&(performance.now(),n=this.A2i(t),performance.now(),this.y2i.T2i(),i.success=!0,i.nextActiveCell=n.dataCell),i},o.prototype.D2i=function(t,n){var n;return n?(n=n.cellNode.templateCell).dataColumn&&n.dataColumn.tableName&&n.dataColumn.columnName?"No"===n.expansionDirection&&(t.error=r.DataEntryErrorCreator.cellIsNonExpansible()):t.error=r.DataEntryErrorCreator.noDataBindingCellNotSupportThisAction():t.error=r.DataEntryErrorCreator.invalidCellRowCol(),!t.error},o.prototype.A2i=function(t){var t=(0,s.E2i)(t.group)||t.group,n=this.S2i(t);return(0,s._2i)(t.cellNode.data.groups,t,n),this.x2i(n,t.dataCell),this.z2i(n),n},o.prototype.x2i=function(t,n){var i,r,e,o,e,u,i=t.leftParent,r=t.upParent,e=t.cellNode,o=e.indexOfLeftParentChildren,e=e.indexOfUpParentChildren;i&&r?(u=i.crossChildren[o].find(function(t){return t.includes(n.group)}),(0,s._2i)(u,n.group,t)):(i&&(0,s._2i)(i.childrenArray[o],n.group,t),r&&(0,s._2i)(r.childrenArray[e],n.group,t))},o.prototype.z2i=function(t){this.L2i(t)},o.prototype.L2i=function(n){var i=this;n.cellNode.children.forEach(function(t){var t;t.leftParent&&t.upParent?"V"===n.cellNode.templateCell.expansionDirection?i.P2i(t,n):i.B2i(t,n):(t=i.G2i(t,n),i.L2i(t))})},o.prototype.P2i=function(r,e){var o=this,t=this.k2i(r.upParent,e),u=[];t.forEach(function(t){var n,i,n=o.R2i(r);n.leftParent=e,n.upParent=t,i=[n],u.push(i),t.crossChildren[r.indexOfUpParentChildren].push(i),r.children.forEach(function(t){return o.Z2i(t,n)})}),e.crossChildren[r.indexOfLeftParentChildren]=u},o.prototype.B2i=function(r,e){var o=this,t=this.k2i(r.leftParent,e),u=[];t.forEach(function(t){var n,i,n=o.R2i(r);n.upParent=e,n.leftParent=t,i=[n],u.push(i),t.crossChildren[r.indexOfLeftParentChildren].push(i),r.children.forEach(function(t){return o.Z2i(t,n)})}),e.crossChildren[r.indexOfUpParentChildren]=u},o.prototype.k2i=function(t,n){var i,r,e,o,i=this,r=t.data.groups,e=[];return this.V2i(n,e),r=0<e.length&&(o=this.U2i(t,e))?r.filter(function(t){return i.H2i(t,o)}):r},o.prototype.Z2i=function(t,n){var i=this,r=this.G2i(t,n);t.children.forEach(function(t){return i.Z2i(t,r)})},o.prototype.G2i=function(t,n){var i=this.R2i(t);return(t.leftParent?(i.leftParent=n).childrenArray[t.indexOfLeftParentChildren]:(i.upParent=n).childrenArray[t.indexOfUpParentChildren]).push(i),i},o.prototype.S2i=function(t){var t=(0,s.S2i)(t,this.W2i(t.cellNode));return this.Kxi.ZP(t),t},o.prototype.W2i=function(t){var n,t,t,n={value:void 0,formula:void 0},t=t.templateCell.newRecordDefaultValueGenerator;return"function"==typeof t&&((t=t())&&"object"==typeof t&&Object.keys(t).includes("formula")?n.formula=t.formula:n.value=t),n},o.prototype.R2i=function(t){var t=(0,s.Q2i)(t,this.W2i(t));return this.Kxi.ZP(t),t.cellNode.data.groups.push(t),t},o.prototype.V2i=function(t,n){t.leftParent&&(n.push(t.leftParent),this.V2i(t.leftParent,n)),t.upParent&&(n.push(t.upParent),this.V2i(t.upParent,n))},o.prototype.U2i=function(n,t){var i,i,i,i=t.find(function(t){return t.cellNode===n});return i||(n.leftParent&&(i=this.U2i(n.leftParent,t))?i:n.upParent&&(i=this.U2i(n.upParent,t))?i:null)},o.prototype.H2i=function(t,n){return t===n||!(!t.leftParent||!this.H2i(t.leftParent,n))||!(!t.upParent||!this.H2i(t.upParent,n))},n.AddRecordHelper=o},7680:function(t,n,i){var v,u,d,s,e,c,r;function o(t,n,i,r){this.F2i=t,this.Y2i=u(u([],n.verticalExpansionTrees,!0),n.horizontalExpansionTrees,!0),this.cxi=n.templateResolver,this.J2i=i,this.N2i=n.cellNodeCache,this.yLi=r}v=this&&this.__assign||function(){return(v=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},u=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r,e=0,o=n.length;e<o;e++)!r&&e in n||((r=r||Array.prototype.slice.call(n,0,e))[e]=n[e]);return t.concat(r||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.DataCollectionHelper=void 0,d=i(7789),s=i(1589),e=i(1453),c=i(5041),o.prototype.nEi=function(){var n=this;return this.J2i&&this.J2i.dataCollections?this.J2i.dataCollections.map(function(t){return n.K2i(t)}):[]},o.prototype.K2i=function(t){switch(t.type){case"Smart":return this.X2i(t);case"Delete":return this.$2i(t);case"Insert":return this.q2i(t);case"Update":return this.tzi(t);default:return null}},o.prototype.X2i=function(n){var t,i=this.nzi(n),t=this.F2i.find(function(t){return t.setting===n});return this.izi(t,i),{dataCollectionSetting:n,deletedRecords:null!=(t=null==t?void 0:t.records)?t:[],records:i,type:"Smart"}},o.prototype.$2i=function(t){return{dataCollectionSetting:t,records:this.rzi(t),type:"Delete"}},o.prototype.q2i=function(t){return{dataCollectionSetting:t,records:this.rzi(t),type:"Insert"}},o.prototype.tzi=function(t){return{dataCollectionSetting:t,records:this.nzi(t),type:"Update"}},o.prototype.nzi=function(t){var n=this.ezi(t),n=this.ozi(n);return this.uzi(n,t.ignoreContainsEmptyValueRecord,t.ignoreNonUpdatedCell,t.allowEmptyKey)},o.prototype.rzi=function(t){var n=this.ezi(t),n=this.ozi(n);return this.uzi(n,t.ignoreContainsEmptyValueRecord)},o.prototype.ezi=function(t){var a=this,h=[],l=[];return t.fields.forEach(function(t){var t,n;"Formula"!==t.type&&("CellGroup"===t.type?h.push(v(v({},t),{rowCols:t.cellNames.map(function(t){return(0,d.QEi)(t)})})):(h.push("Cell"===t.type?v(v({},t),(0,d.QEi)(t.cellName)):v({},t)),"Cell"===t.type&&(n=a.N2i.get((t=h[h.length-1]).row,t.col),l.push({trees:a.Y2i.filter(function(t){return a.szi(t,n)}),node:n}))))}),t.fields.forEach(function(t){var c,t,f;"Formula"===t.type&&(c=v(v({},t),{allDepRowCols:[]}),h.push(c),t=a.cxi.getCellNamesInFormula(t.formula))&&0<t.length&&(f=-1,t.forEach(function(n){var t,i,r,e,t,o,u,u,s,t=(0,d.QEi)(n),i=a.N2i.get(t.row,t.col);i&&(c.allDepRowCols.push(t),r=a.Y2i.find(function(t){return a.szi(t,i)}))&&((e=h.find(function(t){return"Cell"===t.type&&t.cellName===n}))||(e=v({type:"Cell",cellName:n,dbColumnName:"n".concat((new Date).getTime()).concat(Math.floor(1e9*Math.random())),isAutoGeneratedFromFormula:!0},t),h.push(e)),t=0,t=(o=l.find(function(n){return n.trees.some(function(t){return a.hzi(t,n.node,i)})}))?(u=o.trees.find(function(t){return a.hzi(t,o.node,i)}),(s=(u=a.hzi(u,o.node,i)).indexOf(i))>u.indexOf(o.node)?1e4*(s+1):100*(s+1)):a.szi(r,i).indexOf(i)+1,f<t)&&(f=t,c.calcBaseFieldDbColumnName=e.dbColumnName)}))}),h},o.prototype.izi=function(t,i){var r;t&&(r=t.primaryFields.map(function(t){return t.dbColumnName}),t.records=t.records.filter(function(n){return!i.some(function(t){return(0,e.czi)(n.entity,t.entity,r)})}))},o.prototype.ozi=function(t){for(var r,n,i,e,o,u,s,c,f,a,h,l,v,l,r=this,n=t.filter(function(t){return"Formula"===t.type}),i=t.filter(function(t){return t&&"Formula"!==t.type&&"Cell"!==t.type&&"CellGroup"!==t.type}),e=t.filter(function(t){return"CellGroup"===t.type}),o=t.filter(function(t){return"Cell"===t.type}),u=[];0===e.length&&0<o.length;){if(!(s=o.find(function(t){var t=r.N2i.get(t.row,t.col);return t.leftParent&&t.upParent})))for(f=function(t){var t,n,i,i,t=o[t],n=a.N2i.get(t.row,t.col),i=a.Y2i.find(function(t){return r.szi(t,n)});i&&(i=a.szi(i,n).indexOf(n),c<i)&&(c=i,s=t)},a=this,h=c=0;h<o.length;h++)f(h);s=s||o[0],v=(l=this.fzi(s,o)).entry,l=l.newFields,u.push(v),o=l}return{entries:u,cellFields:t.filter(function(t){return"Cell"===t.type}),cellGroupFields:e,formulaFields:n,valueFields:i,allFields:t}},o.prototype.fzi=function(u,t){var s,c,f,a,h,s=this,c={field:u,routedFields:[]},f=this.N2i.get(u.row,u.col),a=this.Y2i.filter(function(t){return s.szi(t,f)});return 0===a.length?{newFields:t.filter(function(t){return t!==u}),entry:c}:(h=[],t.forEach(function(t){var n,i,r,e,o;if(t!==u)if(n=s.N2i.get(t.row,t.col),(i=a.find(function(t){return s.hzi(t,n,f)}))&&(r=s.hzi(i,n,f)))c.routedFields.push({field:t,steps:s.azi(r,f,r,n)});else{for(e=0;e<a.length;e++)if(o=s.lzi(a[e],n,f))return void c.routedFields.push({field:t,steps:s.azi(s.lzi(a[e],f,n),f,o,n)});h.push(t)}}),{newFields:h,entry:c})},o.prototype.szi=function(t,n){return t.pathArray.find(function(t){return t.some(function(t){return t===n})})},o.prototype.hzi=function(t,n,i){return t.pathArray.find(function(t){return t.some(function(t){return t===n})&&t.some(function(t){return t===i})})},o.prototype.lzi=function(t,n,i){return t.pathArray.find(function(t){return t.some(function(t){return t===i})&&t.some(function(t){return t===n})})||t.pathArray.find(function(t){return t.some(function(t){return t===n})})},o.prototype.azi=function(t,n,i,r){var e=t===i?Math.min(t.indexOf(n),i.indexOf(r)):(0,s.vzi)(t,i),o=(0,s.dzi)(t,n,e,function(t){return new("left"===t?c.LeftParentStep:c.UpParentStep)}),t=(0,s.pzi)(i,r,e,function(t,n){return t.leftParent&&t.upParent?new c.CrossChildStep(n,o.length):new c.NormalChildStep(n)});return u(u([],o,!0),t,!0)},o.prototype.uzi=function(t,r,e,o){var u,n,i,s,c,f,t,a,h,l,v,d,p,w,u=this,n=t.entries,i=t.cellFields,s=t.cellGroupFields,c=t.formulaFields,f=t.valueFields,t=t.allFields,a=[];return 0<n.length&&(a=this.wzi(n)),0===(a=0<s.length?this.gzi(s):a).length&&(0<c.length||0<f.length)&&a.push({entity:{},info:{}}),a.forEach(function(e){f.forEach(function(t){e.entity[t.dbColumnName]=t.value}),c.forEach(function(t){var n,i,r,n=-1,i=-1;t.calcBaseFieldDbColumnName&&(r=e.info[t.calcBaseFieldDbColumnName])&&(n=r.row,i=r.col,(e.info[t.dbColumnName]=r).depRowCols=[],t.allDepRowCols.forEach(function(t){u.yLi.A5i(t.row,t.col,n,i).forEach(function(t){return r.depRowCols.push({row:t.row,col:t.col})})})),e.entity[t.dbColumnName]=u.cxi.evaluateFormula(n,i,t.formula)}),0<s.length&&i.forEach(function(t){var n,n,i=u.N2i.get(t.row,t.col);0<(null==(n=null==(n=null==i?void 0:i.data)?void 0:n.groups)?void 0:n.length)&&u.Mzi(e,i.data.groups[0],t)})}),0!==(h=t.filter(function(t){return t.isPrimary})).length||e?(l=[],v=t.filter(function(t){return!("Cell"===t.type&&t.isAutoGeneratedFromFormula)}).map(function(t){return t.dbColumnName}),d=t.filter(function(t){return"Cell"===t.type||"CellGroup"===t.type}).map(function(t){return t.dbColumnName}),p=h.map(function(t){return t.dbColumnName}),w=v.filter(function(t){return!p.includes(t)}),a.forEach(function(i){var n;d.some(function(t){return i.info[t]&&"deleted"===i.info[t].state})||0!==h.length&&(!o&&!p.every(function(t){return void 0!==i.entity[t]&&null!==i.entity[t]&&""!==i.entity[t]})||l.find(function(n){return p.every(function(t){return void 0!==i.entity[t]&&null!==i.entity[t]&&""!==i.entity[t]&&i.entity[t]===n.entity[t]})}))||e&&!d.some(function(t){return i.info[t]&&"normal"!==i.info[t].state})||r&&(o?w:v).some(function(t){return void 0===i.entity[t]||null===i.entity[t]||""===i.entity[t]})||(n={entity:{},info:{}},v.forEach(function(t){n.entity[t]=i.entity[t],n.info[t]=i.info[t]}),l.push(n))}),l):a},o.prototype.wzi=function(t){for(var n=[],i=0;i<t.length;i++)n=this.jzi(t[i],n);return n},o.prototype.jzi=function(t,n){var s=this,i=t.field,r=t.routedFields,e=[];return this.N2i.get(i.row,i.col).data.groups.forEach(function(o){var u={entity:{},info:{}};s.Mzi(u,o,i),r.forEach(function(t){for(var n=t.steps,t=t.field,i=[o],r=o,e=0;e<n.length;e++){if(!(r=n[e].Izi(r,i)))return;i.push(r)}s.Mzi(u,r,t)}),0<n.length?n.forEach(function(t){var n=s.Czi(t);Object.keys(u.entity).forEach(function(t){n.entity[t]=u.entity[t],n.info[t]=v({},u.info[t])}),e.push(n)}):e.push(u)}),e},o.prototype.Czi=function(n){var i={entity:{},info:{}};return Object.keys(n.entity).forEach(function(t){i.entity[t]=n.entity[t],i.info[t]=v({},n.info[t])}),i},o.prototype.Mzi=function(t,n,i){var r=n.value,e=n.dataCell,o=e.row,e=e.col,u=n.state,n={oldValue:n.oldValue,state:u,row:o,col:e};t.entity[i.dbColumnName]=r,t.info[i.dbColumnName]=n},o.prototype.gzi=function(t){var e=this,o=t[0].rowCols.map(function(){return{entity:{},info:{}}});return t.forEach(function(r){r.rowCols.forEach(function(t,n){var i,i,t=e.N2i.get(t.row,t.col);0<(null==(i=null==(i=null==t?void 0:t.data)?void 0:i.groups)?void 0:i.length)&&e.Mzi(o[n],t.data.groups[0],r)})}),o},n.DataCollectionHelper=o},5733:function(t,n){var i;function r(t,n){this.bzi=t,this.mzi=n}Object.defineProperty(n,"__esModule",{value:!0}),n.CrossChildStep=void 0,r.prototype.Izi=function(t,n){for(var i,r,e,o,i=t.crossChildren[this.bzi],r=n[this.mzi-1],e=0;e<i.length;e++)if((o=i[e][0])&&o.leftParent===r.leftParent&&o.upParent===r.upParent)return o;return null},n.CrossChildStep=r},5041:function(t,n,i){var r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&!("get"in e?!n.__esModule:e.writable||e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i(1626),n),e(i(6702),n),e(i(8560),n),e(i(5733),n)},1626:function(t,n){var i;function r(){}Object.defineProperty(n,"__esModule",{value:!0}),n.LeftParentStep=void 0,r.prototype.Izi=function(t){return t.leftParent},n.LeftParentStep=r},8560:function(t,n){var i;function r(t){this.bzi=t}Object.defineProperty(n,"__esModule",{value:!0}),n.NormalChildStep=void 0,r.prototype.Izi=function(t){return t.childrenArray[this.bzi][0]},n.NormalChildStep=r},6702:function(t,n){var i;function r(){}Object.defineProperty(n,"__esModule",{value:!0}),n.UpParentStep=void 0,r.prototype.Izi=function(t){return t.upParent},n.UpParentStep=r},9036:function(t,n,i){var r,e,o,u,s;function c(t,n,i){this.y2i=t,this.N2i=i,this.F2i=n?n.dataCollections.filter(function(t){return"Smart"===t.type&&t.fields.some(function(t){return t.isPrimary})}).map(function(t){return{setting:t,primaryFields:t.fields.filter(function(t){return t.isPrimary&&"CellGroup"!==t.type}).map(function(t){return"Cell"===t.type?r(r({},t),(0,e.QEi)(t.cellName)):r({},t)}),records:[]}}):[],this.yzi=new Array(this.F2i.length)}r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.DeleteRecordHelper=void 0,e=i(7789),o=i(5443),u=i(1453),c.prototype.tEi=function(t,n){var i,t,n,r,r,i={success:!1,nextActiveCell:null},t=this.N2i.get(t,n);return this.Nzi(i,t)&&(performance.now(),n=this.Dzi(t),r=(r=(0,u.E2i)(t.group))?r.dataCell:t,this.Ozi(r),(0,u.Azi)(r.cellNode)?this.Tzi(r):(this.Ezi(r.cellNode.data.groups,r.group),this.x2i(r),this.z2i(r)),performance.now(),this.y2i.T2i(),i.success=!0,i.nextActiveCell=null==n?void 0:n.dataCell),i},c.prototype.I2i=function(){return this.F2i},c.prototype.dl=function(i){this.F2i.forEach(function(t){t.records=i&&0<i.length?t.records.filter(function(n){return!i.find(function(t){return(0,u.gtr)(n,t)})}):[]})},c.prototype.Tzi=function(n){var t=n.cellNode,i=[];t.leftParent&&t.upParent?i=n.group.leftParent.crossChildren[t.indexOfLeftParentChildren].find(function(t){return t.includes(n.group)}):t.leftParent?i=n.group.leftParent.childrenArray[t.indexOfLeftParentChildren]:t.upParent&&(i=n.group.upParent.childrenArray[t.indexOfUpParentChildren]),this.Szi(n.group),1===i.length?this._zi(n.group):((0,u.xzi)(i,n.group),(0,u.xzi)(n.cellNode.data.groups,n.group)),this.zzi(n.group)},c.prototype.zzi=function(i){var r=this;i.childrenArray.forEach(function(t,n){var t;0!==t.length&&(t.forEach(function(t){r.Ezi(t.cellNode.data.groups,t),r.zzi(t)}),t=t[0],r._zi(t),i.childrenArray[n]=[t])})},c.prototype.Dzi=function(n){var t,i;return n.group.leftParent&&n.group.upParent||(t=n.cellNode.data.groups,n.group.leftParent?t=n.group.leftParent.childrenArray[n.cellNode.indexOfLeftParentChildren]:n.group.upParent&&(t=n.group.upParent.childrenArray[n.cellNode.indexOfUpParentChildren]),-1===(i=t.findIndex(function(t){return t===n.group})))||1===t.length?null:0===i?t[i+1]:t[i-1]},c.prototype.x2i=function(t){var n=t.group;n.leftParent&&this.Lzi(t),n.upParent&&this.Pzi(t)},c.prototype.Lzi=function(t){var n=t.group;if(n.leftParent)for(this.Ezi(n.leftParent.childrenArray[n.cellNode.indexOfLeftParentChildren],n);n.leftParent&&(0,u.Bzi)(n.leftParent);)this.Ezi(n.leftParent.cellNode.data.groups,n.leftParent),this.Gzi(n.leftParent),this.kzi(n.leftParent),n=n.leftParent},c.prototype.Pzi=function(t){var n=t.group;if(n.upParent)for(this.Ezi(n.upParent.childrenArray[n.cellNode.indexOfUpParentChildren],n);n.upParent&&(0,u.Bzi)(n.upParent);)this.Ezi(n.upParent.cellNode.data.groups,n.upParent),this.Gzi(n.upParent),this.Rzi(n.upParent),n=n.upParent},c.prototype.z2i=function(t){this.Zzi(t.group)},c.prototype.Zzi=function(t){this.Vzi(t),this.Gzi(t)},c.prototype.Vzi=function(t){var n=this;t.childrenArray.forEach(function(t){t.forEach(function(t){n.Ezi(t.cellNode.data.groups,t),n.Zzi(t)})})},c.prototype.Gzi=function(i){var r=this;i.crossChildren.forEach(function(t){t.forEach(function(t){var n=t[0];n&&(t.forEach(function(t){(0,u.xzi)(n.cellNode.data.groups,t),r.Vzi(t)}),n.upParent===i?r.Uzi(t):r.Hzi(t))})})},c.prototype.Uzi=function(t){var n,i,n=t[0];if(n)for(this.Wzi(n.leftParent.crossChildren[n.cellNode.indexOfLeftParentChildren],t),i=n.leftParent;i&&(0,u.Bzi)(i);)this.Ezi(i.cellNode.data.groups,i),this.kzi(i),i=i.leftParent},c.prototype.Hzi=function(t){var n,i,n=t[0];if(n)for(this.Wzi(n.upParent.crossChildren[n.cellNode.indexOfUpParentChildren],t),i=n.upParent;i&&(0,u.Bzi)(i);)this.Ezi(i.cellNode.data.groups,i),this.Rzi(i),i=i.upParent},c.prototype.Rzi=function(t){var n=t.upParent;n&&this.Ezi(n.childrenArray[t.cellNode.indexOfUpParentChildren],t)},c.prototype.kzi=function(t){var n=t.leftParent;n&&this.Ezi(n.childrenArray[t.cellNode.indexOfLeftParentChildren],t)},c.prototype.Nzi=function(t,n){var n;return n?(n=n.cellNode.templateCell).dataColumn&&n.dataColumn.tableName&&n.dataColumn.columnName||(t.error=o.DataEntryErrorCreator.noDataBindingCellNotSupportThisAction()):t.error=o.DataEntryErrorCreator.invalidCellRowCol(),!t.error},c.prototype.Ezi=function(t,n){this.Szi(n),(0,u.xzi)(t,n)},c.prototype._zi=function(t){t.oldValue=void 0,t.value=void 0,t.isNew=void 0,t.cached=void 0,t.state="deleted",t.expandedCols=[]},c.prototype.Wzi=function(t,n){var i=this;n.forEach(function(t){return i.Szi(t)}),(0,u.xzi)(t,n)},c.prototype.Szi=function(r){var e=this;0<r.cellNode.children.length||this.F2i.forEach(function(t,n){var i;e.yzi[n]&&(i=(0,u.Qzi)(t.primaryFields,r,e.y2i.Jxi().cellNodeCache),t.primaryFields.some(function(t){return void 0===i.entity[t.dbColumnName]})||t.records.find(function(t){return(0,u.czi)(t.entity,i.entity)})||t.records.push(i))})},c.prototype.Ozi=function(i){var r=this;this.F2i.forEach(function(t,n){r.yzi[n]=r.Fzi(i,t)})},c.prototype.Fzi=function(t,n){var i=t.cellNode.templateCell;return!!n.primaryFields.some(function(t){return"Cell"===t.type&&i.row===t.row&&i.col===t.col})||!!this.Yzi(t.cellNode,n.primaryFields)||n.setting.fields.some(function(t){var t,n,t;return"Cell"===t.type&&(n=(t=(0,e.QEi)(t.cellName)).row,t=t.col,i.row===n)&&i.col===t})&&this.Jzi(t.cellNode,n.primaryFields)},c.prototype.Yzi=function(t,n){var i,r,e,i=t.templateCell,r=n.some(function(t){return"Cell"===t.type&&i.row===t.row&&i.col===t.col});if(!r)for(e=0;e<t.children.length&&!(r=this.Yzi(t.children[e],n));e++);return r},c.prototype.Jzi=function(t,n){var i=t.templateCell;return!!n.some(function(t){return"Cell"===t.type&&i.row===t.row&&i.col===t.col})||!(!t.leftParent||!this.Jzi(t.leftParent,n))||!(!t.upParent||!this.Jzi(t.upParent,n))},n.DeleteRecordHelper=c},8334:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.UpdateRecordHelper=void 0;var r=i(5443),e;function o(t,n){this.N2i=t,this.Kxi=n}o.prototype.$4i=function(t,n,i){var r={success:!1,updatedCell:null},t=this.N2i.get(t,n);return this.Kzi(r,t)&&(performance.now(),i!==t.value&&("updated"!==t.group.state&&(t.group.oldValue=t.group.value),t.value=i,t.group.value=i,t.group.oldValue!==i?(t.group.state="updated",this.Kxi.ZP(t.group)):(t.group.state=t.group.isNew?"new":"normal",this.Kxi.VP(t.group))),performance.now(),r.success=!0,r.updatedCell=t),r},o.prototype.Kzi=function(t,n){return n||(t.error=r.DataEntryErrorCreator.invalidCellRowCol()),!t.error},n.UpdateRecordHelper=o},96:function(t,n,i){var r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&!("get"in e?!n.__esModule:e.writable||e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i(4568),n)},5443:function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.DataEntryErrorCreator=void 0,n.DataEntryErrorCreator={invalidCellRowCol:function(){return{code:"InvalidCellRowCol",message:"Invalid cell row, col."}},cellIsNonExpansible:function(){return{code:"CellIsNonExpansible",message:"Cell is non-expansible."}},noDataBindingCellNotSupportThisAction:function(){return{code:"noDataBindingCellNotSupportThisAction",message:"No data binding cell not support this action."}},crossCellNotSupportThisAction:function(){return{code:"crossCellNotSupportThisAction",message:"Cross cell not support this action."}}}},8974:function(t,n){var i;function r(){this.QMt=[]}Object.defineProperty(n,"__esModule",{value:!0}),n.GroupsCache=void 0,r.prototype.ZP=function(t){t.cached||(this.QMt.push(t),t.cached=!0)},r.prototype.VP=function(n){n.cached=!1;var t=this.QMt.findIndex(function(t){return t===n});this.QMt.splice(t,1)},r.prototype.C2i=function(t,n){var i,i,r,e,o,u,s,r=t?{}:null;for(null!=t&&t.forEach(function(t){Object.values(t.info).forEach(function(t){t&&(t.depRowCols?t.depRowCols.forEach(function(t){r["".concat(t.row,"-").concat(t.col)]=!0}):r["".concat(t.row,"-").concat(t.col)]=!0)})}),e=[],o=this.QMt.length,u=0;u<o;u++)s=this.QMt[u],!r||r["".concat(null==(i=s.dataCell)?void 0:i.row,"-").concat(null==(i=s.dataCell)?void 0:i.col)]?(n(s),s.cached=!1):e.push(s);this.QMt=e},n.GroupsCache=r},1453:function(t,n,i){var f,a;function e(n,i,t){if(!t){var r=Object.keys(n),e=Object.keys(i);if(r.length!==e.length)return!1;t=r}return t.every(function(t){return n[t]===i[t]})}function h(t,n,i){var r,e,o,u,s,c,u,f,a,i,r=i.leftParent,e=i.upParent,o=i.value,u=i.cellNode.templateCell,s=u.row,c=u.col,u=i.state,f=i.dataCell,a=n.find(function(t){return t.row===s&&t.col===c});a&&(i={oldValue:i.oldValue,state:u,row:f.row,col:f.col},t.entity[a.dbColumnName]=o,t.info[a.dbColumnName]=i),r&&h(t,n,r),e&&h(t,n,e)}f=this&&this.__assign||function(){return(f=Object.assign||function(t){for(var n,i,r,e,i=1,r=arguments.length;i<r;i++)for(e in n=arguments[i])Object.prototype.hasOwnProperty.call(n,e)&&(t[e]=n[e]);return t}).apply(this,arguments)},Object.defineProperty(n,"__esModule",{value:!0}),n.Azi=n.Bzi=n.Qzi=n.Xzi=n.czi=n.gtr=n.xzi=n.Q2i=n.S2i=n._2i=n.E2i=void 0,a=i(1589),n.E2i=function(t){var n,i,r,n,e,o,u,s,c,f;if(!t)return null;for(r=null!=(n=t.cellNode.templateCell.expansionDirection)?n:"V",e=(n=t.cellNode.templateCell).row,o=n.col,u=n.rowEnd,s=n.colEnd,c=null;t&&(!t.leftParent||!t.upParent)&&(t=t.leftParent||t.upParent)&&t.cellNode.templateCell.expansionDirection===r&&("List"===(null==(i=(f=t.cellNode.templateCell).dataSetting)?void 0:i.type)&&("V"===r&&f.row===e&&f.rowEnd===u||"H"===r&&f.col===o&&f.colEnd===s));)c=t;return c},n._2i=function(t,n,i){var r=t.findIndex(function(t){return t===n});t.splice(r+1,0,i)},n.S2i=function(t,n){return{value:n.value,defaultFormula:n.formula,leftParent:t.leftParent,upParent:t.upParent,childrenArray:t.childrenArray.map(function(){return[]}),crossChildren:t.crossChildren.map(function(){return[]}),cellNode:t.dataCell.cellNode,dataCell:null,isNew:!0,state:"new"}},n.Q2i=function(t,n){var i=t.templateCell.value;return{value:void 0!==n.value?n.value:i,defaultFormula:n.formula,leftParent:null,upParent:null,childrenArray:t.children.map(function(){return[]}),crossChildren:t.children.map(function(){return[]}),cellNode:t,dataCell:null,isNew:!0,state:"new"}},n.xzi=function(t,n){var i=t.findIndex(function(t){return t===n});return-1!==i&&t.splice(i,1),i},n.gtr=function(t,n){return!(!t||!n)&&e(t.entity,t.entity)&&(i=t.info,r=t.info,!(!i||!r))&&(n=Object.keys(i),t=Object.keys(r),n.length===t.length)&&n.every(function(t){return i[t].row===r[t].row&&i[t].col===r[t].col});var i,r,n,t},n.czi=e,n.Xzi=function(t,n){for(var i=t.length;i--;)if(n(t[i],i,t))return i;return-1},n.Qzi=function(t,n,i){void 0===i&&(i=null);var r={entity:{},info:{}},e=[],n,i,o,u,s,c;return t.forEach(function(t){"CellGroup"!==t.type&&("Cell"===t.type?e.push(t):"Formula"===t.type?r.entity[t.dbColumnName]=t.formula:r.entity[t.dbColumnName]=t.value)}),h(r,e,n),i&&(n=[r],o=i,0<(u=(i=t).filter(function(t){var t;return"Cell"===t.type&&(t=o.get(t.row,t.col))&&!t.leftParent&&!t.upParent&&0===t.children.length&&!(0,a.$zi)(t)})).length&&(0===n.length&&n.push({entity:{},info:{}}),i=u.map(function(t){return o.get(t.row,t.col)}),s=i.map(function(t){return t.data.groups[0].value}),c=i.map(function(t){var t=t.data.groups;return{oldValue:t[0].oldValue,state:t[0].state,row:t[0].dataCell.row,col:t[0].dataCell.col}}),n.forEach(function(i){u.forEach(function(t,n){i.entity[t.dbColumnName]=s[n],i.info[t.dbColumnName]=f({},c[n])})}))),r},n.Bzi=function(t){return t.childrenArray.every(function(t){return!t||0===t.length})&&t.crossChildren.every(function(t){return!t||0===t.length})},n.Azi=function t(n){return!(!n.leftParent||!n.upParent)||!(!n.leftParent||!t(n.leftParent))||!(!n.upParent||!t(n.upParent))}},3670:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.DataPopulatorsBootstrapper=void 0;var e=i(8346),r=i(2e3),o=i(9918),u=i(4305),s=i(1986),v=i(1589),c=i(1038),f;function a(t){this.qzi=[],this.t5i=[],this.n5i=[],this.i5i=t,this.r5i=(0,u.createVTreeDataPopulators)(),this.e5i=(0,u.createHTreeDataPopulators)();var t=this.i5i.cellNodeCache.getRange(),n=t.row,i=t.col,r=t.rowEnd,t=t.colEnd;this.N2i=new e.SmartCache(n,i,-1,-1),this.o5i=new e.SmartCache(n,i,r,t),this.u5i={},this.s5i={}}a.prototype.T2i=function(t){return performance.now(),this.C8(t),this.c5i(),this.f5i(),performance.now(),this.N2i},a.prototype.Jxi=function(){return this.i5i},a.prototype.h5i=function(){return new s.ExpandedContext(this.qzi,this.t5i)},a.prototype.a5i=function(){return this.l5i},a.prototype.c5i=function(){var i=this;(0,r.v5i)(this.i5i).forEach(function(t){var n=i.d5i(t);0<n.length&&(n.sort(r.p5i),n.forEach(function(t){return i.w5i(t,!0)})),i.w5i(t)})},a.prototype.w5i=function(n,t){var i,r;if(void 0===t&&(t=!1),i=("H"===n.root.templateCell.expansionDirection?this.e5i:this.r5i).find(function(t){return t.Pit(n)})){r={tree:n,cells:this.N2i,templateCellAccessCache:this.o5i,rowOffset:this.g5i(n.root.treeRange.row),colOffset:this.M5i(n.root.treeRange.col),expandedRows:this.qzi,expandedCols:this.t5i,overwriteRoots:this.n5i,treeGeneratorResult:this.i5i,unCreatedHTreeCellsAfterCrossCells:this.u5i,dryRun:t,paginationContext:this.l5i};try{i.T2i(r),t||i.j5i()}catch(n){}t||i.I5i(),this.s5i[this.C5i(n)]=!0}},a.prototype.d5i=function(n){var i=this;return this.i5i.horizontalExpansionTrees.filter(function(t){return!i.s5i[i.C5i(t)]&&t.root.treeRange.col<n.root.treeRange.col})},a.prototype.C5i=function(t){return"".concat(t.root.templateCell.row,"-").concat(t.root.templateCell.col)},a.prototype.f5i=function(){var t,n,i,r,e,o,u,n,s,n,c,f,a,h,l,v,d,h,t=this.i5i.cellNodeCache,n=t.getRange(),i=n.row,r=n.col,e=n.rowEnd,o=n.colEnd,u=[];for(this.l5i.enable&&"PaginationByRow"===this.l5i.paginationSetting.type&&(s=(n=this.l5i.paginationSetting).titleRows,n=n.endRows,s&&0<s.length&&s.forEach(function(t){u[t]=!0}),n)&&0<n.length&&n.forEach(function(t){u[t]=!0}),c=i;c<=e;c++)for(f=r;f<=o;f++)this.o5i.get(c,f)||(a=t.get(c,f))&&(l=(h=a.templateCell).row,v=h.col,d=h.value,h=h.formula,l!==c||v!==f||void 0===d&&!h||this.b5i(a,u))},a.prototype.b5i=function(t,n){var i,r,e,o,i,u,s,o,e,c,f,a,h,l,i=t.templateCell,r=i.row,e=i.col,o=i.rowEnd,i=i.colEnd,u=this.g5i(r,e),s=this.M5i(e,r),o=this.g5i(o+1,e),e=this.M5i(i+1,r),c=(0,v.m5i)(t,u,s,o,e,n[r]);if(this.N2i.get(c.row,c.col))(0,v.y5i)(this.N2i,c);else for(f=c.row+c.rowCount-1,a=c.col+c.colCount-1,h=c.row;h<=f;h++)for(l=c.col;l<=a;l++)this.N2i.set(h,l,c)},a.prototype.g5i=function(t,n){return(0,o.g5i)(this.qzi,t,n,this.i5i.rowOffsetClearCache)},a.prototype.M5i=function(t,n){return(0,o.M5i)(this.t5i,t,n,this.i5i.colOffsetClearCache)},a.prototype.C8=function(t){var n,i,r,e,n,o,n=this.i5i.cellNodeCache.getRange(),i=n.row,r=n.col,e=n.rowEnd,n=n.colEnd;this.N2i.reset(i,r,-1,-1),this.o5i.reset(i,r,e,n),this.u5i={},this.qzi=[],this.t5i=[],o=new c.PaginationSettingAnalyser(this.i5i).N5i(),this.l5i={enable:t&&!!o,paginationSetting:o,paginationStartCols:[0],paginationStartRows:[0],titleRowsCount:o?o.titleRows.length:0,endRowsCount:o?o.endRows.length:0,titleColsCount:o?o.titleCols.length:0,endColsCount:o?o.endCols.length:0},(0,v.D5i)(i,r,e,n)},n.DataPopulatorsBootstrapper=a},1986:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.ExpandedContext=void 0;var r=i(9918),e;function o(t,n){this.qzi=t,this.t5i=n}o.prototype.calcExpandedRowCountBeforeRow=function(t){return(0,r.g5i)(this.qzi,t)},o.prototype.calcExpandedColCountBeforeCol=function(t){return(0,r.M5i)(this.t5i,t)},n.ExpandedContext=o},4455:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.GetCellsHelper=void 0;var a=i(2e3),f=i(1589),r;function e(t,n){this.O5i={},this.N2i=t,this.i5i=n}e.prototype.A5i=function(t,n,i,r){var e="".concat(t,"-").concat(n,"-").concat(i,"-").concat(r),o=this.O5i[e];return o||(o=this.T5i(t,n,i,r),this.O5i[e]=o),o},e.prototype.E5i=function(t,n){var t,i,t=this.i5i.cellNodeCache.get(t,n);return t?(i=[],t.data.groups.forEach(function(t){t.dataCells?t.dataCells.forEach(function(t){return i.push(t)}):i.push(t.dataCell)}),i):[]},e.prototype.dl=function(){this.O5i={}},e.prototype.T5i=function(t,n,i,r){var e,o,u;try{return(e=this.i5i.cellNodeCache.get(t,n))?void 0!==i&&void 0!==r&&this.N2i.get(i,r)?(o=this.N2i.get(i,r),(u=(u=this.S5i(o,e))||this._5i(o,e))||e.data.groups.map(function(t){return t.dataCell})):e.data.groups.map(function(t){return t.dataCell}):[]}catch(t){return[]}},e.prototype._5i=function(i,r){var e,t,n,o,u,s,n,c,t,f,e=this,t=(0,a.x5i)(i.cellNode,this.i5i);return 0===t.length||(n=r.templateCell,o=n.row,u=n.col,s=[],t.forEach(function(t){var n;t.pathArray.some(function(t){return t.some(function(t){var t=t.templateCell;return t.row===o&&t.col===u})})&&e.z5i(t,i,r).forEach(function(t){return s.push(t)})}),0===s.length)?null:1===(n=s.map(function(t){return e.L5i(t,i)})).length?n[0].map(function(t){return t.dataCell}):(c=[],t=n[0],f=n[1],t.forEach(function(t){f.includes(t)&&c.push(t.dataCell)}),c)},e.prototype.z5i=function(t,u,s){var n=t.pathArray.find(function(t){return t.some(function(t){return t===u.cellNode})&&t.some(function(t){return t===s})}),i=n?[n]:t.pathArray.filter(function(t){return t.some(function(t){return t===u.cellNode})}),c=n?[n]:t.pathArray.filter(function(t){return t.some(function(t){return t===s})});return i.map(function(t){var n,i,r,e,o,i=-1,r=c.findIndex(function(t){return t.some(function(t){return t===u.cellNode})});if(-1!==r)i=c[r].findIndex(function(t){return t===u.cellNode}),n=c[r];else for(e=0;e<c.length;e++)i<(o=(0,f.vzi)(t,c[e]))&&(i=o,n=c[e]);return{currentCellToClosestAncestor:(0,f.dzi)(t,u.cellNode,i,function(t){return t}),closestAncestorToTargetCell:(0,f.pzi)(n,s,i,function(t){return t})}})},e.prototype.L5i=function(t,n){var o,u,s,o=n.group;return t.currentCellToClosestAncestor.forEach(function(t){o="left"===t?o.leftParent:o.upParent}),u=[],s=o.cellNode.children,t.closestAncestorToTargetCell.forEach(function(n,t){var i,r,r,e,i=s.findIndex(function(t){return t===n}),r=s[i];s=r.children,r=r.leftParent&&r.upParent,u=0===t?r?o.crossChildren[i].reduce(function(n,t){return t.forEach(function(t){return n.push(t)}),n},[]):o.childrenArray[i]:(e=[],r?u.forEach(function(t){t.crossChildren[i].forEach(function(t){t.forEach(function(t){return e.push(t)})})}):u.forEach(function(t){t.childrenArray[i].forEach(function(t){return e.push(t)})}),e)}),u},e.prototype.S5i=function(t,n){var i,r,i,e,o,e,u,r,o,i,i=t.cellNode.templateCell,r=i.row,i=i.col,e=n.templateCell,o=e.row,e=e.col;return r===o&&i===e?[t]:(o=(r=t.group).leftParent,i=r.upParent,o&&(u=this.S5i(o.dataCell,n))||i&&(u=this.S5i(i.dataCell,n))?u:null)},n.GetCellsHelper=e},943:function(t,n){var i;function r(t,n){this.l5i=t,this.N2i=n}Object.defineProperty(n,"__esModule",{value:!0}),n.PaginationInfoGenerator=void 0,r.prototype.Pjn=function(){var t;return"RowFirst"===(null==(t=this.l5i.paginationSetting)?void 0:t.paginationOrder)?this.P5i():this.B5i()},r.prototype.B5i=function(){for(var t=this.N2i.getRange().rowEnd,n=this.l5i.paginationStartRows,i={pages:[]},r=n[0],e=1;e<n.length;e++)this.G5i(r,n[e]-1,i),r=n[e];return this.G5i(r,t,i),i},r.prototype.G5i=function(t,n,i){for(var r=this.N2i.getRange().colEnd,e=this.l5i.paginationStartCols,o=e[0],u=1;u<e.length;u++)i.pages.push({row:t,col:o,rowEnd:n,colEnd:e[u]-1}),o=e[u];i.pages.push({row:t,col:o,rowEnd:n,colEnd:r})},r.prototype.P5i=function(){for(var t=this.N2i.getRange().colEnd,n=this.l5i.paginationStartCols,i={pages:[]},r=n[0],e=1;e<n.length;e++)this.k5i(r,n[e]-1,i),r=n[e];return this.k5i(r,t,i),i},r.prototype.k5i=function(t,n,i){for(var r=this.N2i.getRange().rowEnd,e=this.l5i.paginationStartRows,o=e[0],u=1;u<e.length;u++)i.pages.push({row:o,col:t,rowEnd:e[u]-1,colEnd:n}),o=e[u];i.pages.push({row:o,col:t,rowEnd:r,colEnd:n})},n.PaginationInfoGenerator=r},1038:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.PaginationSettingAnalyser=void 0;var a=i(7789),r;function e(t){this.i5i=t}e.prototype.N5i=function(){var t,n,i,r,e,o,u,s,c,i,f,f,n=this.i5i,i=n.templateResolver.getTemplatePaginationSetting();return i?(r=i.rowPagination,e=i.titleRows,o=i.endRows,u=i.titleCols,s=i.endCols,c=i.pagePixelSize,i=i.paginationOrder||"RowFirst",r&&r.paginationDataCell?(f=(0,a.QEi)(r.paginationDataCell),!(f=n.cellNodeCache.get(f.row,f.col))||"List"!==(null==(t=f.templateCell.dataSetting)?void 0:t.type)||!r.rowCountPerPage||r.rowCountPerPage<0?null:{type:"PaginationByRow",titleRows:e||[],endRows:o||[],titleCols:u||[],endCols:s||[],pagePixelSize:c,paginationDataCell:f,rowCountPerPage:r.rowCountPerPage,paginationOrder:i}):c?{type:"PaginationByPageSize",titleRows:e||[],endRows:o||[],titleCols:u||[],endCols:s||[],pagePixelSize:c,paginateBeforeRowCache:n.paginateBeforeRowCache,paginateAfterRowCache:n.paginateAfterRowCache,paginateBeforeColCache:n.paginateBeforeColumnCache,paginateAfterColCache:n.paginateAfterColumnCache,paginationOrder:i}:null):null},n.PaginationSettingAnalyser=e},2e3:function(t,n){var e=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r,e=0,o=n.length;e<o;e++)!r&&e in n||((r=r||Array.prototype.slice.call(n,0,e))[e]=n[e]);return t.concat(r||Array.prototype.slice.call(n))};function r(t,n){return t.root.treeRange.row<n.root.treeRange.row?-1:t.root.treeRange.row>n.root.treeRange.row?1:t.root.treeRange.col<n.root.treeRange.col?-1:t.root.treeRange.col>n.root.treeRange.col?1:0}Object.defineProperty(n,"__esModule",{value:!0}),n.x5i=n.v5i=n.p5i=void 0,n.p5i=r,n.v5i=function(t){var n=t.verticalExpansionTrees.filter(function(t){return 0===t.root.children.length&&"No"===t.root.templateCell.expansionDirection}),i=t.verticalExpansionTrees.filter(function(t){return-1===n.indexOf(t)});return e(e([],e(e([],t.horizontalExpansionTrees,!0),i,!0).sort(r),!0),n.sort(r),!0)},n.x5i=function(t,n){var t=t.templateCell,i=t.row,r=t.col,t=n.verticalExpansionTrees,n=n.horizontalExpansionTrees;return e(e([],t,!0),n,!0).filter(function(t){return t.pathArray.find(function(t){return t.find(function(t){return t.templateCell.row===i&&t.templateCell.col===r})})})}},1589:function(t,n,i){var i,d;function e(t,n){for(var i,r,e,o,u,s,i=t.row,r=t.col,e=t.rowEnd,o=t.colEnd,u=i;u<=e;u++)for(s=r;s<=o;s++)n(u,s)}function p(t,n){return{value:t.templateCell.value,leftParent:null,upParent:null,childrenArray:[],crossChildren:[],cellNode:t,dataCell:n,state:"normal"}}Object.defineProperty(n,"__esModule",{value:!0}),n.pzi=n.dzi=n.vzi=n.$zi=n.R5i=n.y5i=n.Z5i=n.m5i=n.D5i=n.V5i=n.U5i=void 0,i=i(8346),n.U5i=function(i,t,r){e(t,function(t,n){i.set(t,n,r)})},n.V5i=e,d=new i.SmartCache(1,1,1,1),n.D5i=function(t,n,i,r){d.reset(t,n,i,r)},n.m5i=function(t,n,i,r,e,o){var u,s,c,f,a,h,l,f,a,v,s=(u=t.templateCell).row,c=u.col,f=u.value,a=u.rowEnd,h=u.colEnd,l=u.hExpansible,f={cellNode:t,value:f,group:null,row:s+n,col:c+i,rowCount:a-s+1+(u.vExpansible?r-n:0),colCount:h-c+1+(l?e-i:0)};return(o=void 0===o?!1:o)?0===t.data.groups.length?(f.group=p(t,f),f.group.dataCells=[f],t.data.groups.push(f.group)):(a=t.data.groups[0].dataCells[0],f.row<=a.row&&f.col<=a.col?((v=p(t,f)).dataCells=[],f.group=v,a.group.dataCells.forEach(function(t){(t.group=v).dataCells.push(t)}),v.dataCells.unshift(f),t.data.groups=[v]):(f.group=t.data.groups[0],f.group.dataCells.push(f))):(f.group=p(t,f),d.get(s,c)?t.data.groups.push(f.group):(t.data.groups=[f.group],d.set(s,c,!0))),f},n.Z5i=p,n.y5i=function(t,n){for(var i,r,e,o,u,s,i=n.cellNode,r=n.row+n.rowCount-1,e=n.col+n.colCount-1,o=n.row;o<=r;o++)for(u=n.col;u<=e;u++)(s=t.get(o,u))&&(s.overwrittenCellNode=i)},n.R5i=function(t,n){return t.children.findIndex(function(t){return t===n})},n.$zi=function(t){return!("No"===(null==t?void 0:t.templateCell.expansionDirection))},n.vzi=function(t,n){for(var i=Math.min(t.length,n.length),r=0;r<=i;){if(t[r]!==n[r]){r--;break}r++}return r},n.dzi=function(t,n,i,r){for(var e,n,o,u,s,c,f,a,h,a,l,v,l,e=[],n=n.templateCell,o=n.row,u=n.col,s,c=t.findIndex(function(t){var t=t.templateCell;return t.row===o&&t.col===u});i<c;c--)(f=t[c]).leftParent&&f.upParent?(h=(a=f.leftParent.templateCell).row,a=a.col,v=(l=t[c-1].templateCell).row,l=l.col,e.push(r(h===v&&a===l?"left":"up"))):f.leftParent?e.push(r("left")):e.push(r("up"));return e},n.pzi=function(i,t,n,r){for(var e=[],t=t.templateCell,o=t.row,u=t.col,s=i.findIndex(function(t){var t=t.templateCell;return t.row===o&&t.col===u}),c=function(t){var n=i[t+1];e.push(r(n,i[t].children.findIndex(function(t){return t===n})))},f=n;f<s;f++)c(f);return e}},3530:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.HeightPager=void 0;var e=i(8346),r;function S(t,n,i,r){this.H5i=t,this.i5i=t.Jxi(),this.l5i=t.a5i(),this.N2i=n,this.xl=i,this.Q4i=r,this.sE()}S.prototype.W5i=function(){var t,n,i,r,e,o,t,u,s,c,f,a,t,h,l,v,d,p,w,I,M,g,C,N,E,j,A,T,D,b,O,t=this.N2i.getRange(),n=t.rowEnd,i=t.col,r=t.colEnd,e=this.xl,o=this.Q4i,t=this.l5i.paginationSetting,u=t.pagePixelSize.height,s=t.paginateBeforeRowCache,c=t.paginateAfterRowCache;if(this.Q5i+this.F5i>u)return this.l5i.paginationStartRows=[0],this.N2i;for(f=this.i5i.canNotBreakCells,this.l5i.paginationStartRows=a=[],h=u-this.F5i+(t=S.Y5i),l=u+t,v=0<this.J5i.length,d=this.J5i[0],w=(p=v?this.J5i[this.J5i.length-1]:-1)+1,I=v?p-d+1:0,C=(g=(M=0<this.K5i.length)?this.K5i[0]:-1)-1,N=this.K5i[this.K5i.length-1],E=M?N-g+1:0,j=0,T=A=-1;A<n;){if(a.push(j),D=0,b={},v&&p<A&&(!M||A+1<g)&&(this.X5i(d,p,j),j+=I,D+=this.Q5i),(O=A+1)===T)return this.l5i.paginationStartRows=[0],this.N2i;for(T=O;D+e[A+1]<=(d<A?h:l)&&A+1<=n;)if(++A!==g){if(A!==O&&A!==w&&s[o[A]]&&this.$5i(s[o[A]],A,i,r)){A--;break}if(c[o[A]]&&this.q5i(c[o[A]],A,i,r))break;D+=e[A],b[A]=D}else A=N;if(0<f.length)for(A=this.tLi(f,b,O,A,i,r);0===e[A+1]&&A+1<=n;)if(++A!==g){if(A!==O&&A!==w&&s[o[A]]&&this.$5i(s[o[A]],A,i,r)){A--;break}if(c[o[A]]&&this.q5i(c[o[A]],A,i,r))break}else A=N;O<=A&&(this.X5i(O,A,j),j+=A-O+1,M)&&p<A&&A<=C&&(this.X5i(g,N,j),j+=E,A===C)&&(A+=E)}return this.nLi},S.prototype.sE=function(){var t=this.N2i.getRange(),n=t.row,t=t.col,i=this.l5i.paginationSetting,r=i.titleRows,i=i.endRows;this.nLi=new e.SmartCache(n,t,-1,-1),this.J5i=this.iLi(r),this.K5i=this.iLi(i),this.Q5i=this.rLi(r),this.F5i=this.rLi(i)},S.prototype.iLi=function(t){var n;return 0===t.length?[]:(n=this.H5i.h5i().calcExpandedRowCountBeforeRow(t[0]),t.map(function(t){return t+n}))},S.prototype.rLi=function(t){var n=0,i=this.i5i.templateResolver;return t.forEach(function(t){n+=i.getRowHeight(t)}),n},S.prototype.$5i=function(t,n,i,r){for(var e,o,e=i;e<=r;e++)if((o=this.N2i.get(n,e))&&t[o.cellNode.templateCell.col]&&o.row===n)return!0;return!1},S.prototype.q5i=function(t,n,i,r){for(var e,o,e=i;e<=r;e++)if((o=this.N2i.get(n,e))&&t[o.cellNode.templateCell.col]&&o.rowCount+o.row-1===n)return!0;return!1},S.prototype.tLi=function(t,n,i,r,e,o,u,s){var c,f,a;if(void 0===u&&(u=-1),void 0===s&&(s=-1),0!==t.length)for(c=e;c<=o;)if(f=this.N2i.get(r,c)){if(t.includes(f.cellNode)&&f.row+f.rowCount-1>r)return i<(a=0<s?f.row+f.rowCount-1:f.row-1)&&0<n[a]?this.tLi(t,n,i,a,e,o,-1===u?f.row+f.rowCount-1:u,s):this.tLi(t,n,i,-1===u?f.row+f.rowCount-1:u,e,o,-1,1);c+=f.cellNode.templateCell.colEnd-f.cellNode.templateCell.col+1}else c++;return r},S.prototype.X5i=function(t,n,i){for(var r,i,e,o,u,s,c,f,f,r=i-t,i=this.N2i.getRange(),e=i.col,o=i.colEnd,u=t;u<=n;u++)for(s=n-u+1,c=e;c<=o;c++)this.nLi.get(u+r,c)||(f=this.N2i.get(u,c))&&(f=this.eLi(f,u,s,u+r),this.oLi(f))},S.prototype.eLi=function(t,n,i,r){var r={cellNode:t.cellNode,value:t.cellNode.templateCell.repeatContentWhenPaging||n===t.row?t.value:"",group:t.group,overwrittenCellNode:t.overwrittenCellNode,row:r,col:t.col,rowCount:Math.min(t.rowCount-(n-t.row),i),colCount:t.colCount};return this.uLi(t.group,r),r},S.prototype.oLi=function(t){for(var n,i,r,e,o,n=this.nLi,i=t.row+t.rowCount-1,r=t.col+t.colCount-1,e=t.row;e<=i;e++)for(o=t.col;o<=r;o++)n.set(e,o,t)},S.prototype.uLi=function(t,n){t.heightPagerAccessed||(t.dataCells=[],t.dataCell=n,t.heightPagerAccessed=!0),t.dataCells.push(n)},S.Y5i=0,n.HeightPager=S},5630:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.WidthPager=void 0;var e=i(8346),r;function S(t,n,i,r){this.H5i=t,this.i5i=t.Jxi(),this.l5i=t.a5i(),this.N2i=n,this.Nl=i,this.F4i=r,this.sE()}S.prototype.W5i=function(){var t,n,i,r,e,o,t,u,s,c,f,a,t,h,l,v,d,p,w,I,M,g,C,N,E,j,A,T,D,b,O,t=this.N2i.getRange(),n=t.colEnd,i=t.row,r=t.rowEnd,e=this.Nl,o=this.F4i,t=this.l5i.paginationSetting,u=t.pagePixelSize.width,s=t.paginateBeforeColCache,c=t.paginateAfterColCache;if(this.sLi+this.cLi>u)return this.l5i.paginationStartCols=[0],this.N2i;for(f=this.i5i.canNotBreakCells,this.l5i.paginationStartCols=a=[],h=u-this.cLi+(t=S.fLi),l=u+t,v=0<this.hLi.length,d=this.hLi[0],w=(p=v?this.hLi[this.hLi.length-1]:-1)+1,I=v?p-d+1:0,C=(g=(M=0<this.aLi.length)?this.aLi[0]:-1)-1,N=this.aLi[this.aLi.length-1],E=M?N-g+1:0,j=0,T=A=-1;A<n;){if(a.push(j),D=0,b={},v&&p<A&&(!M||A+1<g)&&(this.lLi(d,p,j),j+=I,D+=this.sLi),(O=A+1)===T)return this.l5i.paginationStartCols=[0],this.N2i;for(T=O;D+e[A+1]<=(d<A?h:l)&&A+1<=n;)if(++A!==g){if(A!==O&&A!==w&&s[o[A]]&&this.vLi(s[o[A]],A,i,r)){A--;break}if(c[o[A]]&&this.dLi(c[o[A]],A,i,r))break;D+=e[A],b[A]=D}else A=N;if(0<f.length)for(A=this.pLi(f,b,O,A,i,r);0===e[A+1]&&A+1<=n;)if(++A!==g){if(A!==O&&A!==w&&s[o[A]]&&this.vLi(s[o[A]],A,i,r)){A--;break}if(c[o[A]]&&this.dLi(c[o[A]],A,i,r))break}else A=N;O<=A&&(this.lLi(O,A,j,!0),j+=A-O+1,M)&&p<A&&A<=C&&(this.lLi(g,N,j),j+=E,A===C)&&(A+=E)}return this.nLi},S.prototype.sE=function(){var t=this.N2i.getRange(),n=t.row,t=t.col,i=this.l5i.paginationSetting,r=i.titleCols,i=i.endCols;this.nLi=new e.SmartCache(n,t,-1,-1),this.hLi=this.wLi(r),this.aLi=this.wLi(i),this.sLi=this.gLi(r),this.cLi=this.gLi(i)},S.prototype.wLi=function(t){var n;return 0===t.length?[]:(n=this.H5i.h5i().calcExpandedColCountBeforeCol(t[0]),t.map(function(t){return t+n}))},S.prototype.gLi=function(t){var n=0,i=this.i5i.templateResolver;return t.forEach(function(t){n+=i.getColumnWidth(t)}),n},S.prototype.vLi=function(t,n,i,r){for(var e,o,e=i;e<=r;e++)if((o=this.N2i.get(e,n))&&t[o.cellNode.templateCell.row]&&o.col===n)return!0;return!1},S.prototype.dLi=function(t,n,i,r){for(var e,o,e=i;e<=r;e++)if((o=this.N2i.get(e,n))&&t[o.cellNode.templateCell.row]&&o.colCount+o.col-1===n)return!0;return!1},S.prototype.pLi=function(t,n,i,r,e,o,u,s){var c,f,a;if(void 0===u&&(u=-1),void 0===s&&(s=-1),0!==t.length)for(c=e;c<=o;)if(f=this.N2i.get(c,r)){if(t.includes(f.cellNode)&&f.col+f.colCount-1>r)return i<(a=0<s?f.col+f.colCount-1:f.col-1)&&0<n[a]?this.pLi(t,n,i,a,e,o,-1===u?f.col+f.colCount-1:u,s):this.pLi(t,n,i,-1===u?f.col+f.colCount-1:u,e,o,-1,1);c+=f.cellNode.templateCell.rowEnd-f.cellNode.templateCell.row+1}else c++;return r},S.prototype.lLi=function(t,n,i,r){var e,i,o,u,s,c,f,a,a;for(void 0===r&&(r=!1),e=i-t,o=(i=this.N2i.getRange()).row,u=i.rowEnd,s=t;s<=n;s++)for(c=n-s+1,f=o;f<=u;f++)this.nLi.get(f,s+e)||(a=this.N2i.get(f,s))&&(a=this.eLi(a,s,c,s+e,r&&s===t&&0<this.hLi.length),this.oLi(a))},S.prototype.eLi=function(t,n,i,r,e){var i,o,e,e;return void 0===e&&(e=!1),i=Math.min(t.colCount-(n-t.col),i),e&&0<r&&(o=this.nLi.get(t.row,r-1),e=this.l5i.paginationStartCols[this.l5i.paginationStartCols.length-1],o)&&o.cellNode===t.cellNode&&o.col>=e?(o.colCount+=i,o):(e={cellNode:t.cellNode,value:t.cellNode.templateCell.repeatContentWhenPaging||n===t.col?t.value:"",group:t.group,overwrittenCellNode:t.overwrittenCellNode,row:t.row,col:r,rowCount:t.rowCount,colCount:i},this.uLi(t.group,e),e)},S.prototype.oLi=function(t){for(var n,i,r,e,o,n=this.nLi,i=t.row+t.rowCount-1,r=t.col+t.colCount-1,e=t.row;e<=i;e++)for(o=t.col;o<=r;o++)n.set(e,o,t)},S.prototype.uLi=function(t,n){t.widthPagerAccessed||(t.dataCells=[],t.dataCell=n,t.widthPagerAccessed=!0),t.dataCells.push(n)},S.fLi=0,n.WidthPager=S},5910:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.PageSizePager=void 0;var r=i(1269),a=i(3530),h=i(5630),e;function o(t,n,i){this.H5i=t,this.N2i=n,this.MU=i}o.prototype.W5i=function(){performance.now();var t=new r.ReportDataService(this.N2i,this.H5i),t=this.MU.beforePageSizePaginate(t),n=this.N2i;return this.MLi(t.rowHeightCache)&&(n=new a.HeightPager(this.H5i,this.N2i,t.rowHeightCache,t.rowToTemplateRowCache).W5i()),this.jLi(t.colWidthCache)&&(n=new h.WidthPager(this.H5i,n,t.colWidthCache,t.colToTemplateColCache).W5i()),performance.now(),n},o.prototype.MLi=function(t){var n,i,r,e,o,u,i,s,c,f,n=this.N2i.getRange().rowEnd,i=this.H5i.a5i().paginationSetting,r=i.paginateBeforeRowCache,e=i.paginateAfterRowCache,o=i.titleRows,u=i.endRows,i=i.pagePixelSize;if(!(0===n||o.length&&o[o.length-1]===n)){if(0<Object.keys(r).length||0<Object.keys(e).length||0<o.length||0<u.length)return!0;for(s=i.height+a.HeightPager.Y5i,f=c=0;f<=n;){if((c+=t[f])>s)return!0;f++}}return!1},o.prototype.jLi=function(t){var n,i,r,e,o,u,i,s,c,f,n=this.N2i.getRange().colEnd,i=this.H5i.a5i().paginationSetting,r=i.paginateBeforeColCache,e=i.paginateAfterColCache,o=i.titleCols,u=i.endCols,i=i.pagePixelSize;if(!(0===n||o.length&&o[o.length-1]===n)){if(0<Object.keys(r).length||0<Object.keys(e).length||0<o.length||0<u.length)return!0;for(s=i.width+h.WidthPager.fLi,f=c=0;f<=n;){if((c+=t[f])>s)return!0;f++}}return!1},n.PageSizePager=o},7329:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.ReportDataGenerator=void 0;var r=i(4396),e=i(3670),o=i(5910),u=i(355),s;function c(t,n){this.i5i=t,this.N3=n,this.H5i=new e.DataPopulatorsBootstrapper(t)}c.prototype._process=function(t){var n,i;return this.ILi(null==t?void 0:t.parameter),n=this.H5i.T2i(null==t?void 0:t.enablePagination),null!=t&&t.enablePagination?((i=this.i5i.templateResolver.getTemplateSplitSetting())&&(n=new u.Spliter(i,n,this.i5i).W5i()),this.CLi(n,t)):n},c.prototype.bLi=function(){return this.H5i},c.prototype.ILi=function(t){new r.TreeDataGenerator(this.i5i,this.N3).Pjn(t)},c.prototype.CLi=function(t,n){var i=this.H5i.a5i(),r=i.enable,i=i.paginationSetting;return r&&"PaginationByPageSize"===i.type?new o.PageSizePager(this.H5i,t,n).W5i():t},n.ReportDataGenerator=c},1269:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.ReportDataService=void 0;var r=i(96),e=i(4455),o=i(943),u;function s(t,n){this.N2i=t,this.yLi=new e.GetCellsHelper(t,n.Jxi()),this.NLi=new o.PaginationInfoGenerator(n.a5i(),t),this.mLi=new r.DataEntryService(n,t,this.yLi)}s.prototype.getCell=function(t,n){return this.N2i.get(t,n)},s.prototype.getCells=function(t,n,i,r){return this.yLi.A5i(t,n,i,r)},s.prototype.getAllCells=function(t,n){return this.yLi.E5i(t,n)},s.prototype.getReportRange=function(){return this.N2i.getRange()},s.prototype.getPaginationInfo=function(){return this.NLi.Pjn()},s.prototype.addRecord=function(t,n){var t=this.mLi.addRecord(t,n);return t.success&&this.yLi.dl(),t},s.prototype.updateCellValue=function(t,n,i){return this.mLi.updateCellValue(t,n,i)},s.prototype.deleteRecord=function(t,n){var t=this.mLi.deleteRecord(t,n);return t.success&&this.yLi.dl(),t},s.prototype.resetAllCellsStateToNormal=function(){this.mLi.resetAllCellsStateToNormal()},s.prototype.resetCellsStateToNormal=function(t,n){this.mLi.resetAllCellsStateToNormal(t,n)},s.prototype.getDataCollectionResults=function(){return this.mLi.getDataCollectionResults()},s.prototype.isDirty=function(){return this.mLi.isDirty()},n.ReportDataService=s},794:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.ColumnSpliter=void 0;var p=i(8346),w=i(4125),r;function e(t,n,i,r){this.DLi=t,this.N2i=n,this.OLi=i,this.ALi=r;var t=this.N2i.getRange(),n=t.row,i=t.col;this.nLi=new p.SmartCache(n,i,-1,-1)}e.prototype.W5i=function(){for(var t,n,i,t,r,e,o,u,t,s,c,f,a,h,t,t=this.DLi,n=t.columnCount,i=t.repeatCols,t=this.ALi,r=t.row,e=t.col,o=t.rowEnd,u=t.colEnd,t=e-this.OLi.col,s=i?i.start+t:-1,c=i?i.end+t:-1,f=o-r+1,a=r,h=e;h<=u;)i&&this.lLi(s,c,a,s),this.TLi(h,a,e),a+=f,h+=n;return this.ELi(t=a-r-f),this.SLi(t),this._Li(),this.xLi(t),this.nLi},e.prototype.ELi=function(t){var n,i,r,e,o,r,n=this.N2i.getRange().col,i=this.ALi.col;n!==i&&((r=this.DLi.repeatCols)?(e=i-this.OLi.col,o=r.start+e,r=r.end+e+1,n<o&&this.zLi(n,o-1,n,t),r<i&&this.zLi(r,i-1,r,t)):this.zLi(n,i-1,n,t))},e.prototype.SLi=function(t){var n,i,r,n,n=this.DLi.columnCount,i=this.N2i.getRange().colEnd,r=this.ALi.colEnd+1;r<=i&&(n=this.ALi.col+n,this.zLi(r,i,n,t))},e.prototype.TLi=function(t,n,i){var r=this.DLi.columnCount,r=Math.min(t+r-1,this.ALi.colEnd);this.lLi(t,r,n,i)},e.prototype.lLi=function(t,n,i,r){for(var e,o,u,s,c,f,a,h,l,l,e=this.ALi,o=e.row,u=e.rowEnd,s=r-t,c=i-o,f=t;f<=n;f++)for(a=n-f+1,h=o;h<=u;h++)this.nLi.get(h+c,f+s)||(l=this.N2i.get(h,f))&&(l=this.eLi(l,f,a,h+c,f+s),(0,w.oLi)(this.nLi,l))},e.prototype.zLi=function(t,n,i,r){for(var e,o,u,s,c,f,a,h,e,l,v,d,p,p,o=this.ALi,u=o.row,s=o.rowEnd,c=i-t,f=[],a=[],h=t;h<=n;h++)!(e=null==(e=this.N2i.get(u,h))?void 0:e.cellNode.templateCell)||!e.clearRowOffset&&e.vExpansible||(a[h]=!0),e&&e.clearRowOffset&&(f[h]=!0);for(h=t;h<=n;h++)for(l=n-h+1,v=void 0,d=u;d<=s;d+=v?v.rowCount:1)(v=this.N2i.get(d,h))&&(p=v.row===u||f[h]?0:r,this.nLi.get(d+p,h+c)||(p=this.eLi(v,h,l,d+p,h+c,v.row!==u||a[h]?0:r),(0,w.oLi)(this.nLi,p)))},e.prototype.eLi=function(t,n,i,r,e,o){var r={cellNode:t.cellNode,value:t.value,group:t.group,overwrittenCellNode:t.overwrittenCellNode,row:r,col:e,rowCount:t.rowCount+(o=void 0===o?0:o),colCount:Math.min(t.colCount-(n-t.col),i)};return t.group.dataCell=r},e.prototype._Li=function(){var t=this.N2i.getRange().row,n=this.ALi.row;t<n&&this.X5i(t,n-1,t)},e.prototype.xLi=function(t){var n=this.N2i.getRange().rowEnd,i=this.ALi.rowEnd;i<n&&this.X5i(i+1,n,i+1+t)},e.prototype.X5i=function(t,n,i){for(var r,e,o,u,s,c,f,a,h,l,v,v,d,d,r=this.N2i.getRange(),e=r.col,o=r.colEnd,u=this.ALi.col,s=this.ALi.colEnd-u+1-this.DLi.columnCount,c=i-t,f=new p.SmartCache(0,0,n,o),a=t;a<=n;a++)for(h=e;h<=o;h++)(l=this.N2i.get(a,h))&&!f.get(l.row,l.col)&&(v=l.col>u?-s:0,this.nLi.get(a+c,h+v)||(v=(0,w.LLi)(l,a+c,h+v),l.col<=u&&l.col+l.colCount-1>=u&&(d=(d=v.cellNode.templateCell).colEnd-d.col+1,v.colCount>d&&v.colCount>s&&(v.colCount-=s),h=l.col+l.colCount-1),(0,w.oLi)(this.nLi,v),f.set(l.row,l.col,!0)))},n.ColumnSpliter=e},2148:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.RowSpliter=void 0;var p=i(8346),w=i(4125),r;function e(t,n,i,r){this.DLi=t,this.N2i=n,this.OLi=i,this.ALi=r;var t=this.N2i.getRange(),n=t.row,i=t.col;this.nLi=new p.SmartCache(n,i,-1,-1)}e.prototype.W5i=function(){for(var t,n,i,t,r,e,o,t,u,s,c,f,a,h,u,t=this.DLi,n=t.rowCount,i=t.repeatRows,t=this.ALi,r=t.row,e=t.col,o=t.rowEnd,t=t.colEnd,u=r-this.OLi.row,s=i?i.start+u:-1,c=i?i.end+u:-1,f=t-e+1,a=e,h=r;h<=o;)i&&this.X5i(s,c,s,a),this.TLi(h,r,a),a+=f,h+=n;return this.ELi(u=a-e-f),this.SLi(u),this.PLi(),this.BLi(u),this.nLi},e.prototype.ELi=function(t){var n,i,r,e,o,r,n=this.N2i.getRange().row,i=this.ALi.row;n!==i&&((r=this.DLi.repeatRows)?(e=i-this.OLi.row,o=r.start+e,r=r.end+e+1,n<o&&this.GLi(n,o-1,n,t),r<i&&this.GLi(r,i-1,r,t)):this.GLi(n,i-1,n,t))},e.prototype.SLi=function(t){var n,i,r,n,n=this.DLi.rowCount,i=this.N2i.getRange().rowEnd,r=this.ALi.rowEnd+1;r<=i&&(n=this.ALi.row+n,this.GLi(r,i,n,t))},e.prototype.TLi=function(t,n,i){var r=this.DLi.rowCount,r=Math.min(t+r-1,this.ALi.rowEnd);this.X5i(t,r,n,i)},e.prototype.X5i=function(t,n,i,r){for(var e,o,u,s,c,f,a,h,l,l,e=this.ALi,o=e.col,u=e.colEnd,s=i-t,c=r-o,f=t;f<=n;f++)for(a=n-f+1,h=o;h<=u;h++)this.nLi.get(f+s,h+c)||(l=this.N2i.get(f,h))&&(l=this.eLi(l,f,a,f+s,h+c),(0,w.oLi)(this.nLi,l))},e.prototype.GLi=function(t,n,i,r){for(var e,o,u,s,c,f,a,h,e,l,v,d,p,p,o=this.ALi,u=o.col,s=o.colEnd,c=i-t,f=[],a=[],h=t;h<=n;h++)!(e=null==(e=this.N2i.get(h,u))?void 0:e.cellNode.templateCell)||!e.clearColOffset&&e.hExpansible||(a[h]=!0),e&&e.clearColOffset&&(f[h]=!0);for(h=t;h<=n;h++)for(l=n-h+1,v=void 0,d=u;d<=s;d+=v?v.colCount:1)(v=this.N2i.get(h,d))&&(p=v.col===u||f[h]?0:r,this.nLi.get(h+c,d+p)||(p=this.eLi(v,h,l,h+c,d+p,u!==v.col||a[h]?0:r),(0,w.oLi)(this.nLi,p)))},e.prototype.eLi=function(t,n,i,r,e,o){void 0===o&&(o=0);var r={cellNode:t.cellNode,value:t.value,group:t.group,overwrittenCellNode:t.overwrittenCellNode,row:r,col:e,rowCount:Math.min(t.rowCount-(n-t.row),i),colCount:t.colCount+o};return t.group.dataCell=r},e.prototype.PLi=function(){var t=this.N2i.getRange().col,n=this.ALi.col;t<n&&this.lLi(t,n-1,t)},e.prototype.BLi=function(t){var n=this.N2i.getRange().colEnd,i=this.ALi.colEnd;i<n&&this.lLi(i+1,n,i+1+t)},e.prototype.lLi=function(t,n,i){for(var r,e,o,u,s,c,f,a,h,l,v,v,d,d,r=this.N2i.getRange(),e=r.row,o=r.rowEnd,u=this.ALi.row,s=this.ALi.rowEnd-u+1-this.DLi.rowCount,c=i-t,f=new p.SmartCache(0,0,o,n),a=t;a<=n;a++)for(h=e;h<=o;h++)(l=this.N2i.get(h,a))&&!f.get(l.row,l.col)&&(v=l.row>u?-s:0,this.nLi.get(h+v,a+c)||(v=(0,w.LLi)(l,h+v,a+c),l.row<=u&&l.row+l.rowCount-1>=u&&(d=(d=v.cellNode.templateCell).rowEnd-d.row+1,v.rowCount>d&&v.rowCount>s&&(v.rowCount-=s),h=l.row+l.rowCount-1),(0,w.oLi)(this.nLi,v),f.set(l.row,l.col,!0)))},n.RowSpliter=e},4125:function(t,n){Object.defineProperty(n,"__esModule",{value:!0}),n.LLi=n.oLi=void 0,n.oLi=function(t,n){for(var i,r,e,o,i=n.row+n.rowCount-1,r=n.col+n.colCount-1,e=n.row;e<=i;e++)for(o=n.col;o<=r;o++)t.set(e,o,n)},n.LLi=function(t,n,i){var n={cellNode:t.cellNode,value:t.value,group:t.group,overwrittenCellNode:t.overwrittenCellNode,row:n,col:i,rowCount:t.rowCount,colCount:t.colCount};return t.group.dataCell=n}},355:function(t,n,i){var h,c,r,e,o;function u(t,n,i){this.DLi=t,this.N2i=n,this.i5i=i}h=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r,e=0,o=n.length;e<o;e++)!r&&e in n||((r=r||Array.prototype.slice.call(n,0,e))[e]=n[e]);return t.concat(r||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.Spliter=void 0,c=i(7789),r=i(2148),e=i(794),u.prototype.W5i=function(){var t,n,t,t=this.kLi();return!t||-1===(n=this.RLi(t)).rowEnd||-1===n.colEnd?this.N2i:(performance.now(),t=new("RowSplit"===this.DLi.type?r.RowSpliter:e.ColumnSpliter)(this.DLi,this.N2i,t,n).W5i(),performance.now(),t)},u.prototype.kLi=function(){var t,n,i,r,e,o,u,s;if(!this.DLi.dataRange)return null;if(2<(t=this.DLi.dataRange.split(":").map(c.QEi)).length)return null;for(n=Number.MAX_VALUE,i=Number.MAX_VALUE,e=r=-1,o=0,u=t.length;o<u;o++){if(!(s=t[o]))return null;n=Math.min(n,s.row),i=Math.min(i,s.col),r=Math.max(r,s.row),e=Math.max(e,s.col)}return{row:n,col:i,rowEnd:r,colEnd:e}},u.prototype.RLi=function(t){var n=Number.MAX_VALUE,i=Number.MAX_VALUE,r=-1,e=-1,o=h(h([],this.i5i.verticalExpansionTrees,!0),this.i5i.horizontalExpansionTrees,!0),u=t.row,s=t.col,c=t.rowEnd,f=t.colEnd,a=function(t){t.dataCell&&(n=Math.min(n,t.dataCell.row),i=Math.min(i,t.dataCell.col),r=Math.max(r,t.dataCell.row+t.dataCell.rowCount-1),e=Math.max(e,t.dataCell.col+t.dataCell.colCount-1)),t.childrenArray&&t.childrenArray.forEach(function(t){t&&t.forEach(a)}),t.crossChildren&&t.crossChildren.forEach(function(t){t&&t.forEach(function(t){t&&t.forEach(a)})})};return o.forEach(function(t){var n,i,r,e,n,i,n=t.root.treeRange,i=n.row,r=n.col,e=n.rowEnd,n=n.colEnd;i<=u&&r<=s&&c<=e&&f<=n&&((i=t.root.data.groups)[0]&&a(i[0]),1<i.length)&&a(i[i.length-1])}),{row:n,col:i,rowEnd:r,colEnd:e}},n.Spliter=u},4396:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.TreeDataGenerator=void 0;var r=i(7789),e;function o(t,n){this.i5i=t,this.N3=n}o.prototype.Pjn=function(t){performance.now(),this.ZLi(t),performance.now()},o.prototype.ZLi=function(t){var i,t,i=this;this.N3&&(t={verticalExpansionTrees:this.i5i.verticalExpansionTrees,horizontalExpansionTrees:this.i5i.horizontalExpansionTrees,crossCells:this.i5i.crossCells,cellNodeGetter:function(t){var t=(0,r.QEi)(t),n=t.row,t=t.col;return i.i5i.cellNodeCache.get(n,t)},parameter:t},this.N3.generateTreeData(t))},n.TreeDataGenerator=o},8226:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.DataPopulatorBase=void 0;var r=i(9918),e=i(7789),a=i(8346),h=i(1589),o=i(6319),u;function s(){}s.prototype.VLi=function(t){this.DJ=t,this.ULi=this.DJ.tree.pathArray.some(function(t){return t.some(function(t){return t.templateCell.overwriteWhenExpand&&(0,r.HLi)(t)})}),this.N2i=this.DJ.cells,this.sxi=this.DJ.treeGeneratorResult.cellNodeCache,this.WLi=!!this.DJ.dryRun,this.n_i=this.DJ.treeGeneratorResult.templateResolver.getTemplateRange(),this.QLi=this.DJ.paginationContext.enable},s.prototype.j5i=function(){var r=this,t=this.DJ,e=t.templateCellAccessCache,o=t.treeGeneratorResult.cellNodeCache,u=this.DJ.tree.root.treeRange;(0,h.V5i)(u,function(t,n){var i=o.get(t,n);!i||i.templateCell.isEmpty||e.get(t,n)||i.templateCell.row<u.row||i.templateCell.col<u.col||i.templateCell.row!==t||i.templateCell.col!==n||i.leftParent||i.upParent||0<i.children.length||i.templateCell.dataColumn||"No"!==i.templateCell.expansionDirection||r.FLi(i)})},s.prototype.I5i=function(){var t=this.DJ,n=t.tree.root,t=t.templateCellAccessCache;(0,h.U5i)(t,n.treeRange,!0)},s.prototype.FLi=function(t){var i=this.DJ.cells,r=this.m5i(t);(0,h.V5i)({row:r.row,col:r.col,rowEnd:r.row+r.rowCount-1,colEnd:r.col+r.colCount-1},function(t,n){return i.set(t,n,r)})},s.prototype.YLi=function(t,n,i,r,e,o){var u=e.cellNode.templateCell,s=u.row,c=u.col,f=u.rowEnd,u=u.colEnd,e={cellNode:e.cellNode,value:e.value,group:e,row:s+t,col:c+n,rowCount:f-s+1+i,colCount:u-c+1+r};return this.b5i(e,o),e},s.prototype.JLi=function(t,n,i){return this.YLi(t,n,0,0,i)},s.prototype.b5i=function(t,n,i){(i=void 0===i?!0:i)&&(t.group.dataCell=t);var i=t.cellNode.templateCell;i.hExpansible||(t.colCount=i.colEnd-i.col+1),i.vExpansible||(t.rowCount=i.rowEnd-i.row+1),n&&this.ULi&&this.N2i.get(t.row,t.col)?(0,h.y5i)(this.N2i,t):this.oLi(t)},s.prototype.oLi=function(t){var n,i,r,e,o;if(!this.WLi)for(n=this.DJ.cells,i=t.row+t.rowCount-1,r=t.col+t.colCount-1,e=t.row;e<=i;e++)for(o=t.col;o<=r;o++){if(n.get(e,o))return t.rowCount=e-t.row+1-(o===t.col?1:0),void(t.colCount=o-t.col+1-(o===t.col?0:1));n.set(e,o,t)}},s.prototype.KLi=function(t,n){(0,r.KLi)(n||this.DJ.expandedRows,t)},s.prototype.XLi=function(t,n){(0,r.XLi)(n||this.DJ.expandedCols,t)},s.prototype.g5i=function(t){return(0,r.g5i)(this.DJ.expandedRows,t)},s.prototype.M5i=function(t){return(0,r.M5i)(this.DJ.expandedCols,t)},s.prototype.$Li=function(t,n,i,r,e){var t=t.templateCell,o=t.row,t=t.col,o=this.DJ.treeGeneratorResult.cellNodeCache.get(o,t),u=this.createSubTree(o),t=function(n){return!u.pathArray.some(function(t){return t.some(function(t){var t=t.templateCell;return t.row===n.row&&t.col===n.col})})},s=JSON.parse(JSON.stringify(this.DJ.expandedRows.filter(t))),c=JSON.parse(JSON.stringify(this.DJ.expandedCols.filter(t)));return i&&(i.qLi().forEach(function(n){s.some(function(t){return t.row===n.row&&t.col===n.col})||s.push(n)}),i.tPi().forEach(function(n){c.some(function(t){return t.row===n.row&&t.col===n.col})||c.push(n)})),{tree:u,cells:this.DJ.cells,templateCellAccessCache:this.DJ.templateCellAccessCache,rowOffset:r,colOffset:e,expandedRows:s,expandedCols:c,overwriteRoots:this.DJ.overwriteRoots,treeGeneratorResult:this.DJ.treeGeneratorResult,subTreeContext:this.nPi(n),unCreatedHTreeCellsAfterCrossCells:this.DJ.unCreatedHTreeCellsAfterCrossCells,dryRun:this.DJ.dryRun,paginationContext:this.DJ.paginationContext}},s.prototype.nPi=function(t){var t;return{rootGroups:t,ancestor:(null==(t=this.DJ.subTreeContext)?void 0:t.ancestor)||this.DJ.tree.root}},s.prototype.createSubTree=function(t){var i=(0,e.phe)(t);return{root:t,pattern:"Unanalyzed",pathArray:i,crossCells:this.DJ.treeGeneratorResult.crossCells.filter(function(t){var n=t.templateCell;return i.some(function(t){return t.some(function(t){var t=t.templateCell;return n.row===t.row&&n.col===t.col})})})}},s.prototype.iPi=function(){return(this.DJ.subTreeContext?this.DJ.subTreeContext.rootGroups:this.DJ.tree.root.data.groups)||[]},s.prototype.rPi=function(t,n,i,r,e){var o=t.templateCell,u=o.expansionDirection,s=o.row,o=o.col,c=this.$Li(t,n,i,r,e),t=("H"===u?this.e5i:this.r5i).find(function(t){return t.Pit(c.tree)}).T2i(c),n=t.rowEnd-t.row+1,r=t.colEnd-t.col+1,e=c.tree.root.treeRange,n={rowCount:n-(e.rowEnd-e.row+1),colCount:r-(e.colEnd-e.col+1)};return 0<n.rowCount&&("H"!==u||0===c.tree.crossCells.length)&&i.KLi({row:s,col:o,expandedCount:n.rowCount}),0<n.colCount&&("H"===u||0===c.tree.crossCells.length)&&i.XLi({row:s,col:o,expandedCount:n.colCount}),{dataRange:t,expansion:n}},s.prototype.m5i=function(t){var n=t.templateCell,i=n.row,r=n.col,e=n.rowEnd,n=n.colEnd,i=this.g5i(i),r=this.M5i(r),e=this.g5i(e+1),n=this.M5i(n+1);return(0,h.m5i)(t,i,r,e,n)},s.prototype.ePi=function(t){this.DJ.paginationContext.paginationStartRows.push(t)},s.prototype.oPi=function(t){this.DJ.paginationContext.paginationStartCols.push(t)},s.prototype.uPi=function(t){return this.zpt(t,this.DJ.paginationContext.paginationSetting.titleRows),this.DJ.paginationContext.titleRowsCount},s.prototype.sPi=function(t){return this.zpt(t,this.DJ.paginationContext.paginationSetting.endRows),this.DJ.paginationContext.endRowsCount},s.prototype.zpt=function(t,n){var r,e,i,o,u,s,c,f,r=this;0!==n.length&&(e=this.sxi,o=(i=this.n_i).row,u=i.col,s=i.colEnd,c=new a.SmartCache(o,u,-1,-1),f=t-n[0],n.forEach(function(t){for(var n,i,i,n=u;n<=s;n++)(i=e.get(t,n))&&!c.get(i.templateCell.row,i.templateCell.col)&&(c.set(i.templateCell.row,i.templateCell.col,!0),i=(0,h.m5i)(i,f,0,f,0,!0),r.b5i(i,!1,!1))}))},s.prototype.cPi=function(t){var s,n,i,r,s=[];for(t.pathArray.forEach(function(t){return t.forEach(function(t){var n;"Summary"!==(null==(n=t.templateCell.dataSetting)?void 0:n.type)||s.includes(t)||s.push(t)})}),n=function(u){if((0,o.B_t)(t.root,function(t){var t,n,i,r,e,o,t,e,o,r,t;return s[u]!==t&&(n=(t=t.templateCell).row,i=t.col,r=t.dataSetting,e=t.dataColumn,o=t.formula,t=t.expansionDirection,!(!e&&!o||"Summary"===(null==r?void 0:r.type)||"No"===t))&&(o=(e=s[u].templateCell).row,r=e.rowEnd,t=e.col,o<=n)&&n<=r&&t<i}))return{value:!0}},i=0;i<s.length;i++)if("object"==typeof(r=n(i)))return r.value;return!1},n.DataPopulatorBase=s},277:function(t,n,i){var r,e,o,u,s,c;function f(){var t=null!==c&&c.apply(this,arguments)||this;return t.fPi=!1,t.hPi=Number.MAX_SAFE_INTEGER,t}e=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.HDataPopulatorBase=void 0,o=i(8226),u=i(1589),c=o.DataPopulatorBase,e(f,c),f.prototype.VLi=function(t){c.prototype.VLi.call(this,t),this.aPi=[],this.fPi=0<this.DJ.tree.crossCells.length,this.hPi=this.fPi?Math.min.apply(Math,this.DJ.tree.crossCells.map(function(t){return t.templateCell.row})):Number.MAX_SAFE_INTEGER},f.prototype.j5i=function(){c.prototype.j5i.call(this),this.populateCellsAfterCrossCell()},f.prototype.FLi=function(t){var n=t.templateCell,i=n.col,n=n.colEnd,i=this.M5i(i),n=this.M5i(n+1);this.fPi&&t.templateCell.row>this.hPi?this.aPi.push({colOffset:i,expandedRowCount:0,expandedColCount:n-i,group:(0,u.Z5i)(t)}):c.prototype.FLi.call(this,t)},f.prototype.populateCellsAfterCrossCell=function(t){var n,n,t,i;0!==this.aPi.length&&(n=this.DJ.tree,n="".concat(n.root.templateCell.row,"-").concat(n.root.templateCell.col),(t=this.utr(t))&&((i=this.DJ.unCreatedHTreeCellsAfterCrossCells[t])||(this.DJ.unCreatedHTreeCellsAfterCrossCells[t]=i=[]),i.push({rowCol:n,cells:this.aPi})),this.aPi=[])},f.prototype.utr=function(t){var r,n,t,r=null;return this.DJ.tree.crossCells.forEach(function(t){for(var n=t.leftParent,i=t.leftParent;i;)"V"===i.templateCell.expansionDirection&&(n=i),i=i.leftParent;(!r||n.templateCell.row>=r.templateCell.row)&&(r=n)}),r?(n="".concat(r.templateCell.row,"-").concat(r.templateCell.col),t&&(t=this.str(t))&&(t.id||(t.id="g".concat((new Date).getTime()).concat(Math.random())),n="".concat(n,"-").concat(t.id)),n):null},f.prototype.str=function(t){var n;return"V"===t.cellNode.templateCell.expansionDirection?t:t.leftParent&&(n=this.str(t.leftParent))||t.upParent&&(n=this.str(t.upParent))?n:null},n.HDataPopulatorBase=f},5856:function(t,n,i){var r,e,o,u,s,c,f;function a(){var t=null!==f&&f.apply(this,arguments)||this;return t.fPi=!1,t.pPi=Number.MAX_SAFE_INTEGER,t}e=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.VDataPopulatorBase=void 0,o=i(9918),u=i(8226),s=i(6319),f=u.DataPopulatorBase,e(a,f),a.prototype.VLi=function(t){var i,t,r,i=this;f.prototype.VLi.call(this,t),this.wPi={},this.gPi={},this.fPi=0<this.DJ.tree.crossCells.length,this.pPi=this.fPi?Math.min.apply(Math,this.DJ.tree.crossCells.map(function(t){return t.templateCell.col})):Number.MAX_SAFE_INTEGER,this.MPi=[],t=this.DJ.tree.crossCells.map(function(t){return(0,s.jPi)(t)}),r=Math.max.apply(Math,t),t.forEach(function(t,n){t===r&&i.MPi.push(i.DJ.tree.crossCells[n])})},a.prototype.IPi=function(t,n,i,r){var e,o,u,e=r.cellNode.templateCell.col,o=this.wPi[e];return void 0===o&&(u=this.M5i(this.DJ.tree.root.templateCell.col),o=this.M5i(e)-u+this.DJ.colOffset,this.wPi[e]=o),this.YLi(t,o,n,i,r)},a.prototype.CPi=function(t,n,i,r,e){var e,o,u,e=(r||e).cellNode.templateCell.row,o=this.gPi[e];return void 0===o&&(u=this.g5i(this.DJ.tree.root.templateCell.row),o=this.g5i(e)-u+this.DJ.rowOffset,this.gPi[e]=o),this.YLi(o,t,n,i,r)},a.prototype.bPi=function(i,r,t,n){var e=this,o=r.templateCell,u=o.row,s=o.col,c=o.rowEnd,f=o.colEnd,o=r.leftParent.templateCell,a=o.row,o=o.rowEnd,h=c-u+1+(u===a&&c===o?n:0);t.forEach(function(t){var n,t;t&&t[0]&&(n=e.mPi(r,t[0].upParent),t={cellNode:r,value:t[0].value,group:t[0],row:u+i,col:s+n,rowCount:h,colCount:f-s+1},e.b5i(t))})},a.prototype.mPi=function(t,n){var t,i;return n.dataCell&&n.expandedCols?(t=(0,o.M5i)(n.expandedCols,t.templateCell.col),i=(0,o.M5i)(n.expandedCols,n.cellNode.templateCell.col),n.dataCell.col-n.cellNode.templateCell.col+(t-i)):0},a.prototype.yPi=function(t){var n,i,i,r,n=this,i=this.DJ.tree,i="".concat(i.root.templateCell.row,"-").concat(i.root.templateCell.col);t&&(i="".concat(i,"-").concat(t.id)),(r=this.DJ.unCreatedHTreeCellsAfterCrossCells[i])&&0!==r.length&&(this.NPi=t,r.forEach(function(t){t.cells.forEach(function(t){return n.CPi(t.colOffset,t.expandedRowCount,t.expandedColCount,t.group,null)})}),this.DJ.unCreatedHTreeCellsAfterCrossCells[i]=void 0,this.NPi=void 0)},n.VDataPopulatorBase=a},7528:function(t,n,i){var r,e,o,u,s,c,f,w,I,M,a,h;function l(){return null!==h&&h.apply(this,arguments)||this}e=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.HCommonDataPopulator=void 0,o=i(7789),u=i(277),s=i(8357),c=i(9955),f=i(470),w=i(6319),I=i(1589),M=i(9918),h=u.HDataPopulatorBase,e(l,h),l.prototype.Pit=function(t){return"H"===t.root.templateCell.expansionDirection&&(t.pattern="HorizontalCommon",!0)},l.prototype.T2i=function(t){return this.VLi(t),this.DPi()},l.prototype.VLi=function(t){h.prototype.VLi.call(this,t),this.r5i=(0,f.createVTreeDataPopulators)(),this.e5i=(0,s.createHTreeDataPopulators)(),this.Dyt=this.DJ.rowOffset,this._yt=this.DJ.colOffset,this.OPi=this.DJ.rowOffset,this.APi=this.DJ.colOffset,this.TPi=0,this.EPi=0,this.SPi=0,this._Pi=new c.ExpandedCountHelper(t.overwriteRoots)},l.prototype.DPi=function(){var t,u,s,i,n,r,c,f,n,a,h,l,t,n,e,o,t,v,d,p,o,v,u=this,s=this.DJ.tree,i=s.root.children.filter(function(t){return!(t.upParent&&t.leftParent||(0,I.$zi)(t)||0!==t.children.length)}),n=s.root.children.filter(function(t){return(0,I.$zi)(t)||0!==t.children.length}).filter(function(t){return!t.leftParent||!t.upParent}),r=n.filter(function(t){return"H"===t.templateCell.expansionDirection}),c=n.filter(function(t){return"H"!==t.templateCell.expansionDirection}),f=s.root.children.filter(function(t){return t.upParent&&t.leftParent}),n=this.iPi(),a=(null==(t=s.root.templateCell.lineBreakOption)?void 0:t.groupsCount)||Number.MAX_SAFE_INTEGER,h=[],l=1;return n.forEach(function(e){var o,n,t,t,o=[];u._Pi.c5(),r.forEach(function(t){return u.xPi(t,e,o)}),n=[],c.forEach(function(t){u.zPi(t)?n.push(t):u.xPi(t,e,o)}),f.forEach(function(t){var n,n,n,n=e.crossChildren[t.indexOfUpParentChildren],n=n&&0!==n.length?n[0]:[];u.LPi(t),n=u.PPi(n,t),o.push(n),(0,M.BPi)(t,n,u._Pi)}),i.forEach(function(t){u.LPi(t);var n=(0,M.GPi)(u.DJ,u._Pi,t),i=(0,w.kPi)(s.root,t),r=(0,w.RPi)(s.root,t);o.push(u.ZPi(e.childrenArray[(0,I.R5i)(e.cellNode,t)][0],i?0:n.rowCount,r?0:n.colCount,!0))}),u.populateCellsAfterCrossCell(e),n.forEach(function(t){return u.xPi(t,e,o)}),u.LPi(e.cellNode),t=(0,M.GPi)(u.DJ,u._Pi,e.cellNode),o.push(u.ZPi(e,t.rowCount,t.colCount)),t=(0,w.VPi)(o),h.push(t),l===a?(l=1,u.EPi=0,u.TPi+=u.SPi):(l++,u.EPi+=t.colEnd-t.col+1,u.SPi=Math.max(u.SPi,t.rowEnd-t.row+1)),u.fPi&&(e.expandedCols=u._Pi.tPi())}),n=(t=s.root.treeRange).row,e=t.col,o=t.rowEnd,t=t.colEnd,o=(v=(0,w.VPi)(h)).rowEnd-v.row+1-(d=o-n+1),v=v.colEnd-v.col+1-(p=t-e+1),(0,M.UPi)(s.root)&&(0<o&&0===s.crossCells.length&&this.KLi({row:n,col:e,expandedCount:o}),0<v)&&this.XLi({row:n,col:e,expandedCount:v}),{row:s.root.treeRange.row+this.DJ.rowOffset,col:s.root.treeRange.col+this.DJ.colOffset,rowEnd:s.root.treeRange.rowEnd+this.DJ.rowOffset+o,colEnd:s.root.treeRange.colEnd+this.DJ.colOffset+v}},l.prototype.LPi=function(t){this.Dyt=this._Pi.g5i(t.templateCell.row)+this.OPi+this.TPi,this._yt=this._Pi.M5i(t.templateCell.col)+this.APi+this.EPi},l.prototype.xPi=function(t,n,i){this.LPi(t);var n=this.rPi(t,n.childrenArray[(0,I.R5i)(n.cellNode,t)],this._Pi,this.Dyt,this._yt);i.push(n.dataRange)},l.prototype.ZPi=function(t,n,i,r){var e,e,e,n,r,e=t.cellNode;return!(this.fPi&&e.templateCell.row>this.hPi)||(e=e.upParent||e.leftParent).leftParent&&e.upParent?{row:n=(e=this.YLi(this.Dyt,this._yt,n,i,t,r)).row,col:r=e.col,rowEnd:n+e.rowCount-1,colEnd:r+e.colCount-1}:(this.aPi.push({colOffset:this._yt,expandedRowCount:0,expandedColCount:i,group:t}),null)},l.prototype.zPi=function(n){var i;return"V"===n.templateCell.expansionDirection&&((i=!1,o.uxi)(n,function(t){return!(t===n||!t.leftParent||!t.upParent||(i=!0,0))}),i)},l.prototype.PPi=function(t,n){var r=this,n=n.templateCell,e=n.row,o=n.col,u=n.rowEnd,s=n.colEnd,c=n.expansionDirection,n=this.DJ.treeGeneratorResult.cellNodeCache.get(e,o).treeRange,f=n.rowEnd-n.row+1,a=n.colEnd-n.col+1,h=[{row:n.row+this.Dyt,col:n.col+this._yt,rowEnd:n.rowEnd+this.Dyt,colEnd:n.colEnd+this._yt}];return t.forEach(function(t,n){var i=r.Dyt+("V"===c?n*f:0),n=r._yt+("H"===c?n*a:0);h.push({row:e+i,col:o+n,rowEnd:u+i,colEnd:s+n})}),(0,w.VPi)(h)},n.HCommonDataPopulator=l},9078:function(t,n,i){var r,e,o,u;function s(){return null!==u&&u.apply(this,arguments)||this}e=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.HFreeDataPopulator=void 0,u=i(8226).DataPopulatorBase,e(s,u),s.prototype.Pit=function(t){var n,i;return"H"===t.root.templateCell.expansionDirection&&1!==t.pathArray.length&&!!t.pathArray.every(function(t){return 2===t.length})&&!t.pathArray.some(function(t){return t.some(function(t){return t.leftParent&&t.upParent})})&&!(t.root.data.groups.some(function(t){return t.childrenArray.some(function(t){return 1<t.length})})||(n=t.pathArray.some(function(t){return t[1].templateCell.row!==t[0].templateCell.row}),i=t.pathArray.some(function(t){return t[1].templateCell.col!==t[0].templateCell.col}),!n)||!i||(t.pattern="HorizontalFree",0))},s.prototype.T2i=function(t){var n,e,t,i,r,t,o,u,s,n,i,r,c,f,a,r,h,r,l,l,i,e=this;return this.VLi(t),i=(t=this.DJ).rowOffset,r=t.colOffset,t=t.tree,o=i,u=r,s=(null==(n=t.root.templateCell.lineBreakOption)?void 0:n.groupsCount)||Number.MAX_SAFE_INTEGER,n={row:t.root.treeRange.row+i,col:t.root.treeRange.col+r,rowEnd:t.root.treeRange.rowEnd+i,colEnd:t.root.treeRange.colEnd+r},0!==(i=this.iPi()).length&&(r=t.root.treeRange,c=r.rowEnd-r.row+1,f=r.colEnd-r.col+1,a=t.root.children,i.forEach(function(r,t){s!==Number.MAX_SAFE_INTEGER&&(e.DJ.rowOffset=o+(Math.ceil((t+1)/s)-1)*c,e.DJ.colOffset=u+t%s*f);var t=r.cellNode.templateCell,t={cellNode:r.cellNode,value:r.value,group:r,row:t.row+e.DJ.rowOffset,col:t.col+e.DJ.colOffset,rowCount:t.rowEnd-t.row+1,colCount:t.colEnd-t.col+1};e.b5i(t,null),a.forEach(function(t,n){var n=r.childrenArray[n][0],i=t.templateCell,t={cellNode:t,value:n.value,group:n,row:i.row+e.DJ.rowOffset,col:i.col+e.DJ.colOffset,rowCount:i.rowEnd-i.row+1,colCount:i.colEnd-i.col+1};e.b5i(t)}),s===Number.MAX_SAFE_INTEGER&&(e.DJ.colOffset+=f)}),h=(r=t.root.templateCell).row,r=r.col,s===Number.MAX_SAFE_INTEGER?(l=f*(i.length-1),n.colEnd=u+t.root.treeRange.colEnd+l,0<l&&this.XLi({row:h,col:r,expandedCount:l})):(l=(Math.ceil(i.length/s)-1)*c,n.rowEnd=o+t.root.treeRange.rowEnd+l,i=(Math.min(s,i.length)-1)*f,n.colEnd=u+t.root.treeRange.colEnd+i,0<l&&this.KLi({row:h,col:r,expandedCount:l}),0<i&&this.XLi({row:h,col:r,expandedCount:i}))),n},n.HFreeDataPopulator=s},750:function(t,n,i){var r,e,f,o,a,u,s;function c(){return null!==s&&s.apply(this,arguments)||this}e=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.HNormalDataPopulator=void 0,f=i(1589),o=i(277),a=i(9918),s=o.HDataPopulatorBase,e(c,s),c.prototype.Pit=function(t){var n,i,r,n,e,o,u;return"H"===t.root.templateCell.expansionDirection&&!t.crossCells.some(function(t){return 0<t.children.length})&&!((t.root.leftParent||t.root.upParent)&&0<t.crossCells.length||t.pathArray.some(function(t){return t.some(function(t){return t.leftParent&&"H"===t.leftParent.templateCell.expansionDirection})})||(n=t.root.templateCell,i=n.col,r=n.colEnd,n=t.pathArray.every(function(t){return t.every(function(t){return t.templateCell.col===i&&t.templateCell.colEnd===r})}),e=!t.pathArray.some(function(t){return t.some(function(t){return!("V"!==t.templateCell.expansionDirection||t.leftParent&&t.upParent)})}),o=!t.pathArray.some(function(t){return t.some(function(t){return"No"===t.templateCell.expansionDirection&&0<t.children.length&&(!t.upParent||!t.leftParent)})}),u=!this.cPi(t),!(n&&e&&o&&u))||(t.pattern="HorizontalNormal",0))},c.prototype.T2i=function(t){var n,i,r,t,e,n=t.rowOffset,i=t.colOffset,r=t.tree;return this.VLi(t),this.HPi(),t=this.WPi(),e=this.QPi(),this.populateCellsAfterCrossCell(),{row:r.root.treeRange.row+n,col:r.root.treeRange.col+i,rowEnd:r.root.treeRange.rowEnd+n+e,colEnd:r.root.treeRange.colEnd+i+t}},c.prototype.VLi=function(t){s.prototype.VLi.call(this,t),this.Dyt=this.DJ.rowOffset;var t=this.DJ.tree.root;this.FPi=t.templateCell.overwriteWhenExpand&&(0,a.HLi)(t)},c.prototype.KLi=function(t,n){this.FPi||s.prototype.KLi.call(this,t,n)},c.prototype.XLi=function(t,n){this.FPi||s.prototype.XLi.call(this,t,n)},c.prototype.HPi=function(){this.FPi&&(0,a.HPi)(this.DJ.overwriteRoots,this.DJ.tree.root)},c.prototype.WPi=function(){var t,t,n,i,n,t=this.iPi(),t=this.YPi(t,this.DJ.colOffset);return t&&(i=(n=this.DJ.tree.root.templateCell).row,n=n.col,this.XLi({row:i,col:n,expandedCount:t})),t},c.prototype.YPi=function(t,n){var i,r,t,t,i=this;return 0===t.length?0:(r=0,t.forEach(function(t){r+=i.JPi(t,r+n)}),t=(t=t[0].cellNode.templateCell).colEnd-t.col+1,r-t)},c.prototype.JPi=function(r,e){var o,i,t,u,s,c,o=this,i=r.cellNode.templateCell,t=this.sxi.get(i.row,i.col);return t?(u=[],r.childrenArray.forEach(function(t,n){var n,t,n,i,n,n=r.cellNode.children[n];(0,f.$zi)(n)&&0!==(t=o.YPi(t,(0,a.M5i)(u,n.templateCell.col)+e))&&(i=(n=n.templateCell).row,n=n.col,(0,a.XLi)(u,{row:i,col:n,expandedCount:t}))}),r.crossChildren.forEach(function(t,n){var n,t,n,i,n;t&&0!==t.length&&(n=r.cellNode.children[n],(0,f.$zi)(n))&&0!==(t=o.KPi(t,n))&&(i=(n=n.templateCell).row,n=n.col,(0,a.XLi)(u,{row:i,col:n,expandedCount:t}))}),s=(0,a.M5i)(u,Number.MAX_SAFE_INTEGER),c=this.XPi(e,s,r),t.children.forEach(function(t,n){(0,f.$zi)(t)||t.leftParent&&t.upParent||!r.childrenArray[n]||(t.templateCell.col===i.col&&t.templateCell.colEnd===i.colEnd?o.XPi(e,s,r.childrenArray[n][0],c):o.XPi((0,a.M5i)(u,t.templateCell.col)+e,0,r.childrenArray[n][0]))}),this.fPi&&(r.expandedCols=u),i.colEnd-i.col+1+s):0},c.prototype.XPi=function(t,n,i,r){var e,o,u,s,e,e,e,e,e=i.cellNode.templateCell,o=e.row,u=e.col,s=e.rowEnd,e=e.colEnd;return(r=r||e-u+1+n,!(this.fPi&&o>this.hPi)||(e=(e=i.cellNode).upParent||e.leftParent).leftParent&&e.upParent)?(e={cellNode:i.cellNode,value:i.value,group:i,row:o+this.Dyt,col:u+t,rowCount:s-o+1,colCount:r},this.b5i(e)):this.aPi.push({colOffset:t,expandedRowCount:0,expandedColCount:n,group:i}),r},c.prototype.QPi=function(){return this.fPi?this.g5i(this.DJ.tree.root.treeRange.rowEnd+1)-this.g5i(this.DJ.tree.root.treeRange.row):0},c.prototype.KPi=function(t,n){var n,i,r,n=n.templateCell,i=n.colEnd-n.col+1;return 0===t.length||"H"!==n.expansionDirection?0:(r=0,t.forEach(function(t){var t=(t.length-1)*i;r<t&&(r=t)}),r)},n.HNormalDataPopulator=c},8357:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.createHTreeDataPopulators=void 0;var r=i(750),e=i(9078),o=i(7528);n.createHTreeDataPopulators=function(){return[new r.HNormalDataPopulator,new e.HFreeDataPopulator,new o.HCommonDataPopulator]}},9955:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.ExpandedCountHelper=void 0;var r=i(9918),e;function o(t){this.qzi=[],this.t5i=[],this.n5i=t}o.prototype.c5=function(){this.qzi=[],this.t5i=[]},o.prototype.KLi=function(t){this.$Pi(t.row,t.col)||(0,r.KLi)(this.qzi,t)},o.prototype.XLi=function(t){this.$Pi(t.row,t.col)||(0,r.XLi)(this.t5i,t)},o.prototype.g5i=function(t){return(0,r.g5i)(this.qzi,t)},o.prototype.M5i=function(t){return(0,r.M5i)(this.t5i,t)},o.prototype.qPi=function(t){return(0,r.qPi)(this.qzi,this.t5i,t)},o.prototype.qLi=function(){return JSON.parse(JSON.stringify(this.qzi))},o.prototype.tPi=function(){return JSON.parse(JSON.stringify(this.t5i))},o.prototype.$Pi=function(n,i){return this.n5i.some(function(t){return t.templateCell.row===n&&t.templateCell.col===i})},n.ExpandedCountHelper=o},9918:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.HLi=n.BPi=n.HPi=n.UPi=n.GPi=n.vtr=n.dtr=n.qPi=n.M5i=n.g5i=n.XLi=n.KLi=void 0;var s=i(6319);function r(t,n,i){return{rowCount:e(t,i),colCount:o(n,i)}}function e(t,n){var n=n.templateCell,i=n.row,r=n.rowEnd;return t.reduce(function(t,n){return n.row>=i&&n.row<=r&&(t+=n.expandedCount),t},0)}function o(t,n){var n=n.templateCell,i=n.col,r=n.colEnd;return t.reduce(function(t,n){return n.col>=i&&n.col<=r&&(t+=n.expandedCount),t},0)}function u(t){return t.leftParent||t.upParent||0<t.children.length||"No"!==t.templateCell.expansionDirection}function c(t,n){var i,i,r,i,r,i,r,e;if("V"===n.templateCell.expansionDirection&&(r=(i=n.templateCell).row,i=i.rowEnd,t.templateCell.row!==r||t.templateCell.rowEnd!==i))return!1;if("H"===n.templateCell.expansionDirection&&(i=(r=n.templateCell).col,r=r.colEnd,t.templateCell.col!==i||t.templateCell.colEnd!==r))return!1;if("Group"===(null==(i=t.templateCell.dataSetting)?void 0:i.type))return!1;for(e=0;e<t.children.length;e++)if(!c(t.children[e],n))return!1;return!0}n.KLi=function(t,n){var i=t.findIndex(function(t){return t.row===n.row});-1!==i?n.expandedCount>t[i].expandedCount&&(t[i]=n):t.push(n)},n.XLi=function(t,n){var i=t.findIndex(function(t){return t.col===n.col});-1!==i?n.expandedCount>t[i].expandedCount&&(t[i]=n):t.push(n)},n.g5i=function(t,i,r,e){var o=0;return t.forEach(function(t){if(void 0!==r&&e){var n=e[t.row];if(n&&n.includes(r))return}i>t.row&&(o+=t.expandedCount)}),o},n.M5i=function(t,i,r,e){var o=0;return t.forEach(function(t){if(void 0!==r&&e){var n=e[t.col];if(n&&n.includes(r))return}i>t.col&&(o+=t.expandedCount)}),o},n.qPi=r,n.dtr=e,n.vtr=o,n.GPi=function(t,n,i){var n,t,n=n.qPi(i);return u(t.tree.root)?n:(t=r(t.expandedRows,t.expandedCols,i),{rowCount:n.rowCount+t.rowCount,colCount:n.colCount+t.colCount})},n.UPi=u,n.HPi=function(t,n){var i=n.templateCell,r=i.row,e=i.col;t.find(function(t){return t.templateCell.row===r&&t.templateCell.col===e})||t.push(n)},n.BPi=function(t,n,i){var r,e,r,e,n,r,o,u,r,r=t.treeRange,e=r.rowEnd-r.row-1,r=r.colEnd-r.col-1,e=n.rowEnd-n.row-1-e,n=n.colEnd-n.col-1-r;0<e&&(o=(r=(0,s.t9i)(t,"V").templateCell).row,u=r.col,i.KLi({row:o,col:u,expandedCount:e})),0<n&&(o=(r=(0,s.t9i)(t,"H").templateCell).row,u=r.col,i.XLi({row:o,col:u,expandedCount:n}))},n.HLi=function(t){return c(t,t)}},6319:function(t,n){function r(t,n){if(n(t))return!0;for(var i=0;i<t.children.length;i++)if(r(t.children[i],n))return!0;return!1}Object.defineProperty(n,"__esModule",{value:!0}),n.t9i=n.RPi=n.kPi=n.B_t=n.n9i=n.jPi=n.VPi=void 0,n.VPi=function(t){var n=Number.MAX_SAFE_INTEGER,i=0,r=Number.MAX_SAFE_INTEGER,e=0;return t.forEach(function(t){t&&(t.col<r&&(r=t.col),t.colEnd>e&&(e=t.colEnd),t.row<n&&(n=t.row),t.rowEnd>i)&&(i=t.rowEnd)}),{row:n,col:r,rowEnd:i,colEnd:e}},n.jPi=function(t){for(var n=0;t.upParent;)n++,t=t.upParent;return n},n.n9i=function(t){return{value:t.templateCell.value,leftParent:null,upParent:null,childrenArray:t.children.map(function(){return[]}),crossChildren:t.children.map(function(){return[]}),cellNode:t,dataCell:null,state:"normal"}},n.B_t=r,n.kPi=function(n,i){return r(n,function(t){return t!==i&&t!==n&&t.templateCell.row>=i.templateCell.row&&"No"!==t.templateCell.expansionDirection&&(t.templateCell.col<=i.templateCell.col&&t.templateCell.colEnd>=i.templateCell.colEnd||t.templateCell.col>=i.templateCell.col&&t.templateCell.col<i.templateCell.colEnd||t.templateCell.colEnd>i.templateCell.col&&t.templateCell.colEnd<=i.templateCell.colEnd)})},n.RPi=function(n,i){return r(n,function(t){return t!==i&&t!==n&&t.templateCell.col>=i.templateCell.col&&"No"!==t.templateCell.expansionDirection&&(t.templateCell.row<=i.templateCell.row&&t.templateCell.rowEnd>=i.templateCell.rowEnd||t.templateCell.row>=i.templateCell.row&&t.templateCell.row<i.templateCell.rowEnd||t.templateCell.rowEnd>i.templateCell.row&&t.templateCell.rowEnd<=i.templateCell.rowEnd)})},n.t9i=function(t,n){for(var i,r,i=[t];0<i.length;){if((r=i.shift()).templateCell.expansionDirection===n&&(r.templateCell.formula||r.templateCell.dataColumn))return r;r.leftParent&&i.push(r.leftParent),r.upParent&&i.push(r.upParent)}return t}},4305:function(t,n,i){var r=this&&this.__createBinding||(Object.create?function(t,n,i,r){void 0===r&&(r=i);var e=Object.getOwnPropertyDescriptor(n,i);e&&!("get"in e?!n.__esModule:e.writable||e.configurable)||(e={enumerable:!0,get:function(){return n[i]}}),Object.defineProperty(t,r,e)}:function(t,n,i,r){t[r=void 0===r?i:r]=n[i]}),e=this&&this.__exportStar||function(t,n){for(var i in t)"default"===i||Object.prototype.hasOwnProperty.call(n,i)||r(n,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),e(i(8357),n),e(i(470),n)},470:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.createVTreeDataPopulators=void 0;var r=i(3443),e=i(2942),o=i(839);n.createVTreeDataPopulators=function(){return[new e.VFreeDataPopulator,new r.VNormalDataPopulator,new o.VCommonDataPopulator]}},839:function(t,n,i){var r,e,c,o,u,s,f,a,d,p,w,h,l;function v(){return null!==l&&l.apply(this,arguments)||this}e=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),c=this&&this.__spreadArray||function(t,n,i){if(i||2===arguments.length)for(var r,e=0,o=n.length;e<o;e++)!r&&e in n||((r=r||Array.prototype.slice.call(n,0,e))[e]=n[e]);return t.concat(r||Array.prototype.slice.call(n))},Object.defineProperty(n,"__esModule",{value:!0}),n.VCommonDataPopulator=void 0,o=i(7789),u=i(5856),s=i(8357),f=i(9955),a=i(470),d=i(6319),p=i(1589),w=i(9918),l=u.VDataPopulatorBase,e(v,l),v.prototype.Pit=function(t){return"No"===t.root.templateCell.expansionDirection?(t.pattern="NoExpansionNode",!0):"V"===t.root.templateCell.expansionDirection&&(t.pattern="VerticalCommon",!0)},v.prototype.T2i=function(t){this.VLi(t);var t=this.DPi();return this.yPi(),t},v.prototype.VLi=function(t){l.prototype.VLi.call(this,t),this.r5i=(0,a.createVTreeDataPopulators)(),this.e5i=(0,s.createHTreeDataPopulators)(),this.Dyt=this.DJ.rowOffset,this._yt=this.DJ.colOffset,this.OPi=this.DJ.rowOffset,this.APi=this.DJ.colOffset,this.TPi=0,this.EPi=0,this.i9i=0,this._Pi=new f.ExpandedCountHelper(t.overwriteRoots)},v.prototype.CPi=function(t,n,i,r,e){var o,u,u,s;return this.NPi?(u=(o=(r||e).cellNode).templateCell.row,u=this.NPi?"".concat(u,"-").concat(this.NPi.id):u,void 0===(s=this.gPi[u])&&(this.LPi(o),s=this.Dyt,this.gPi[u]=s),this.YLi(s,t,n,i,r)):l.prototype.CPi.call(this,t,n,i,r,e)},v.prototype.DPi=function(){var t,u,s,n,i,r,c,f,i,a,h,l,v,t,i,e,o,e,i,o,e,t,u=this,s=this.DJ.tree,n=s.root.children.filter(function(t){return!(t.upParent&&t.leftParent||(0,p.$zi)(t)||0!==t.children.length)}),i=s.root.children.filter(function(t){return(0,p.$zi)(t)||0!==t.children.length}).filter(function(t){return!t.upParent||!t.leftParent}),r=i.filter(function(t){return"H"===t.templateCell.expansionDirection}),c=i.filter(function(t){return"H"!==t.templateCell.expansionDirection}),f=s.root.children.filter(function(t){return t.upParent&&t.leftParent}),i=this.iPi(),a=(null==(t=s.root.templateCell.lineBreakOption)?void 0:t.groupsCount)||Number.MAX_SAFE_INTEGER,h=[],l=1,v=r.map(function(){return[]});return i.forEach(function(e){var o,t,t,o=[];u._Pi.c5(),r.forEach(function(t,n){return v[n].push(u.xPi(t,e,o))}),c.forEach(function(t){return u.xPi(t,e,o)}),f.forEach(function(i){var t,r;u.LPi(i),(t=e.crossChildren[i.indexOfLeftParentChildren])&&0!==t.length&&(r=[],t.forEach(function(t){var n,n,n=t[0];n&&(n.upParent.dataCell&&(u._yt=u.mPi(i,n.upParent)),n=u.rPi(i,t,u._Pi,u.Dyt,u._yt),o.push(n.dataRange),r.push(n.dataRange))}),(0,w.BPi)(i,(0,d.VPi)(r),u._Pi))}),n.forEach(function(t){u.LPi(t,!0);var n=(0,w.GPi)(u.DJ,u._Pi,t),i=(0,d.kPi)(s.root,t),r=(0,d.RPi)(s.root,t);o.push(u.ZPi(e.childrenArray[(0,p.R5i)(e.cellNode,t)][0],i?0:n.rowCount,r?0:n.colCount,!0))}),u.LPi(e.cellNode),t=u.qPi(u.DJ,u._Pi,e),o.push(u.ZPi(e,t.rowCount,t.colCount)),t=(0,d.VPi)(o),h.push(t),u.yPi(e),l===a?(l=1,u.TPi=0,u.EPi+=u.i9i):(l++,u.TPi+=t.rowEnd-t.row+1,u.i9i=Math.max(u.i9i,t.colEnd-t.col+1))}),t=(0,d.VPi)(h),e=(i=s.root.treeRange).row,o=i.col,e=i.rowEnd-e+1,i=i.colEnd-o+1,o=t.rowEnd-t.row+1-e,e=t.colEnd-t.col+1-i,(0,w.UPi)(s.root)&&(t=s.root.templateCell,0<o&&this.KLi({row:t.row,col:t.col,expandedCount:o}),0<e)&&(0<r.length&&this.htr(c,f)?this.atr(r,v):0===s.crossCells.length&&this.XLi({row:t.row,col:t.col,expandedCount:e})),{row:s.root.treeRange.row+this.DJ.rowOffset,col:s.root.treeRange.col+this.DJ.colOffset,rowEnd:s.root.treeRange.rowEnd+this.DJ.rowOffset+o,colEnd:s.root.treeRange.colEnd+this.DJ.colOffset+e}},v.prototype.xPi=function(t,n,i){this.LPi(t,!0);var n=this.rPi(t,n.childrenArray[(0,p.R5i)(n.cellNode,t)],this._Pi,this.Dyt,this._yt);return i.push(n.dataRange),n.dataRange},v.prototype.LPi=function(t,n){void 0===n&&(n=!1),this.Dyt=this._Pi.g5i(t.templateCell.row)+this.OPi+this.TPi,n&&this.r9i(t)||(this._yt=this._Pi.M5i(t.templateCell.col)+this.APi+this.EPi)},v.prototype.r9i=function(e){var t,o,n,i,t,u,s,t,r,o=c(c([],this.DJ.treeGeneratorResult.verticalExpansionTrees,!0),this.DJ.treeGeneratorResult.horizontalExpansionTrees,!0),n=this.DJ.tree.root.treeRange,i=(null==(t=this.DJ.subTreeContext)?void 0:t.ancestor)||this.DJ.tree;return!!(o.some(function(t){return t!==i&&t.root.templateCell.col>n.col&&t.root.templateCell.col<n.colEnd})&&(t=e.templateCell.col,u=[],s=[],this.DJ.expandedCols.forEach(function(n){var t,i,r,i,t,t=o.find(function(t){return t.root.treeRange.row===n.row&&t.root.treeRange.col===n.col});t&&(r=(i=e.templateCell).row,i=i.col,r>=(t=t.root.treeRange).row&&r<=t.rowEnd&&i>=t.col&&i<=t.colEnd||(u.push(n),s.push(t)))}),(t=(0,w.M5i)(u,t))>this.APi))&&(r=this._Pi.tPi().filter(function(r){return!s.some(function(t){var n=r.row,i=r.col;return n>=t.row&&n<=t.rowEnd&&i>=t.col&&i<=t.colEnd})}),this._yt=(0,w.M5i)(r,e.templateCell.col)+t+this.EPi,!0)},v.prototype.atr=function(t,e){var o=this,n=e[e.length-1],u=-1,i=-1;n.forEach(function(t,n){t.colEnd>i&&(u=n,i=t.colEnd)}),t.forEach(function(t,n){var n=e[n][u],i=t.treeRange,r=i.col,i=i.colEnd-r+1,r=n.colEnd-n.col+1-i;o.XLi({row:t.templateCell.row,col:t.templateCell.col,expandedCount:r})})},v.prototype.htr=function(t,n){return!(t.some(function(t){return(0,o.uxi)(t,function(t){return"H"===t.templateCell.expansionDirection})})||n.some(function(t){return(0,o.uxi)(t,function(t){return"H"===t.templateCell.expansionDirection})}))},v.prototype.qPi=function(t,n,i){var t,n,r,r,t=(0,w.GPi)(t,n,i.cellNode);return i.leftParent&&i.upParent&&i.upParent.dataCell&&(n=i.upParent.cellNode.templateCell,(r=i.cellNode.templateCell).col===n.col)&&r.colEnd===n.colEnd&&(r=i.upParent.dataCell,t.colCount=r.colCount-(n.colEnd-n.col+1)),t},v.prototype.ZPi=function(t,n,i,r){var n=this.YLi(this.Dyt,this._yt,n,i,t,r),i=n.row,t=n.col;return{row:i,col:t,rowEnd:i+n.rowCount-1,colEnd:t+n.colCount-1}},n.VCommonDataPopulator=v},2942:function(t,n,i){var r,e,o,u;function s(){return null!==u&&u.apply(this,arguments)||this}e=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.VFreeDataPopulator=void 0,u=i(8226).DataPopulatorBase,e(s,u),s.prototype.Pit=function(t){var n,i;return"V"===t.root.templateCell.expansionDirection&&1!==t.pathArray.length&&!!t.pathArray.every(function(t){return 2===t.length})&&!t.pathArray.some(function(t){return t.some(function(t){return t.leftParent&&t.upParent})})&&!(t.root.data.groups.some(function(t){return t.childrenArray.some(function(t){return 1<t.length})})||(n=t.pathArray.some(function(t){return t[1].templateCell.row!==t[0].templateCell.row}),i=t.pathArray.some(function(t){return t[1].templateCell.col!==t[0].templateCell.col}),!n)||!i||(t.pattern="VerticalFree",0))},s.prototype.T2i=function(t){var n,e,t,i,r,t,o,u,s,n,i,r,c,f,a,r,h,r,l,l,i,e=this;return this.VLi(t),i=(t=this.DJ).rowOffset,r=t.colOffset,t=t.tree,o=i,u=r,s=(null==(n=t.root.templateCell.lineBreakOption)?void 0:n.groupsCount)||Number.MAX_SAFE_INTEGER,n={row:t.root.treeRange.row+i,col:t.root.treeRange.col+r,rowEnd:t.root.treeRange.rowEnd+i,colEnd:t.root.treeRange.colEnd+r},0!==(i=this.iPi()).length&&(r=t.root.treeRange,c=r.rowEnd-r.row+1,f=r.colEnd-r.col+1,a=t.root.children,i.forEach(function(r,t){s!==Number.MAX_SAFE_INTEGER&&(e.DJ.rowOffset=o+t%s*c,e.DJ.colOffset=u+(Math.ceil((t+1)/s)-1)*f);var t=r.cellNode.templateCell,t={cellNode:r.cellNode,value:r.value,group:r,row:t.row+e.DJ.rowOffset,col:t.col+e.DJ.colOffset,rowCount:t.rowEnd-t.row+1,colCount:t.colEnd-t.col+1};e.b5i(t,null),a.forEach(function(t,n){var n=r.childrenArray[n][0],i=t.templateCell,t={cellNode:t,value:n.value,group:n,row:i.row+e.DJ.rowOffset,col:i.col+e.DJ.colOffset,rowCount:i.rowEnd-i.row+1,colCount:i.colEnd-i.col+1};e.b5i(t,null)}),s===Number.MAX_SAFE_INTEGER&&(e.DJ.rowOffset+=c)}),h=(r=t.root.templateCell).row,r=r.col,s===Number.MAX_SAFE_INTEGER?(l=c*(i.length-1),n.rowEnd=o+t.root.treeRange.rowEnd+l,0<l&&this.KLi({row:h,col:r,expandedCount:l})):(l=(Math.min(s,i.length)-1)*c,n.rowEnd=o+t.root.treeRange.rowEnd+l,i=(Math.ceil(i.length/s)-1)*f,n.colEnd=u+t.root.treeRange.colEnd+i,0<l&&this.KLi({row:h,col:r,expandedCount:l}),0<i&&this.XLi({row:h,col:r,expandedCount:i}))),n},n.VFreeDataPopulator=s},3443:function(t,n,i){var r,e,a,o,f,u,s;function c(){var t=null!==s&&s.apply(this,arguments)||this;return t.e9i=!0,t}e=this&&this.__extends||(r=function(t,n){return(r=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,n){t.__proto__=n}:function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}))(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=t}r(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}),Object.defineProperty(n,"__esModule",{value:!0}),n.VNormalDataPopulator=void 0,a=i(1589),o=i(5856),f=i(9918),s=o.VDataPopulatorBase,e(c,s),c.prototype.Pit=function(t){var n,i,r,n,e,o,u;return"V"===t.root.templateCell.expansionDirection&&!t.crossCells.some(function(t){return 0<t.children.length})&&!((t.root.leftParent||t.root.upParent)&&0<t.crossCells.length||t.pathArray.some(function(t){return t.some(function(t){return t.upParent&&"V"===t.upParent.templateCell.expansionDirection})})||(n=t.root.templateCell,i=n.row,r=n.rowEnd,n=t.pathArray.every(function(t){return t.every(function(t){return t.templateCell.row===i&&t.templateCell.rowEnd===r})}),e=!t.pathArray.some(function(t){return t.some(function(t){return!("H"!==t.templateCell.expansionDirection||t.upParent&&t.leftParent)})}),o=!t.pathArray.some(function(t){return t.some(function(t){return"No"===t.templateCell.expansionDirection&&0<t.children.length&&(!t.upParent||!t.leftParent)})}),u=!this.cPi(t),!(n&&e&&o&&u))||(t.pattern="VerticalNormal",0))},c.prototype.T2i=function(t){var n,i,r,t,e,n=t.rowOffset,i=t.colOffset,r=t.tree;return this.VLi(t),this.HPi(),t=this.DPi(),e=this.M5i(r.root.treeRange.colEnd)-this.M5i(r.root.treeRange.col),this.yPi(),{row:r.root.treeRange.row+n,col:r.root.treeRange.col+i,rowEnd:r.root.treeRange.rowEnd+n+t,colEnd:r.root.treeRange.colEnd+i+e}},c.prototype.VLi=function(t){s.prototype.VLi.call(this,t),this._yt=this.DJ.colOffset;var t=this.DJ.tree.root;this.FPi=t.templateCell.overwriteWhenExpand&&(0,f.HLi)(t),this.e9i=!this.o9i(t),this.ptr={}},c.prototype.KLi=function(t,n){this.FPi||s.prototype.KLi.call(this,t,n)},c.prototype.XLi=function(t,n){this.FPi||s.prototype.XLi.call(this,t,n)},c.prototype.HPi=function(){this.FPi&&(0,f.HPi)(this.DJ.overwriteRoots,this.DJ.tree.root)},c.prototype.DPi=function(){var t,t,n,i,n,t=this.iPi(),t=this.YPi(t,this.DJ.rowOffset,!0);return t&&(i=(n=this.DJ.tree.root.templateCell).row,n=n.col,this.KLi({row:i,col:n,expandedCount:t})),t},c.prototype.YPi=function(r,e,t){var o,u,s,c,f,t,t,o=this;return void 0===t&&(t=!1),0===r.length?0:(s=u=0,c=this.QLi&&t&&"PaginationByRow"===this.DJ.paginationContext.paginationSetting.type,f=this.DJ.paginationContext.paginationSetting,r.forEach(function(t,n){var t,i;u+=o.JPi(t,u+e),c&&f.paginationDataCell===t.cellNode&&n+1<r.length&&(n+1)%f.rowCountPerPage==0&&(o.u9i(r[s],f.rowCountPerPage),t=t.dataCell.row+t.dataCell.rowCount,i=o.sPi(t),u+=i,o.ePi(t+=i),u+=o.uPi(t),s=n+1)}),c&&this.u9i(r[s],r.length-s),t=(t=r[0].cellNode.templateCell).rowEnd-t.row+1,u-t)},c.prototype.JPi=function(r,e){var o,n,t,u,i,o=this,n=r.cellNode.templateCell,t=this.sxi.get(n.row,n.col);return t?(u=[],r.childrenArray.forEach(function(t,n){var n,t,n,i,n,n=r.cellNode.children[n];(0,a.$zi)(n)&&0!==(t=o.YPi(t,(0,f.g5i)(u,n.templateCell.row)+e))&&(i=(n=n.templateCell).row,n=n.col,o.KLi({row:i,col:n,expandedCount:t},u))}),r.crossChildren.forEach(function(t,n){var n,t,n,i,n;t&&0!==t.length&&(n=r.cellNode.children[n],(0,a.$zi)(n))&&0!==(t=o.s9i(t,(0,f.g5i)(u,n.templateCell.row)+e,n))&&(i=(n=n.templateCell).row,n=n.col,o.KLi({row:i,col:n,expandedCount:t},u))}),i=(0,f.g5i)(u,Number.MAX_SAFE_INTEGER),this.XPi(e,i,r),t.children.forEach(function(t){(0,a.$zi)(t)||(t.templateCell.row===n.row&&t.templateCell.rowEnd===n.rowEnd?o.c9i(e,t,r,i):o.c9i((0,f.g5i)(u,t.templateCell.row)+e,t,r,0))}),n.rowEnd-n.row+1+i):0},c.prototype.XPi=function(t,n,i){var r,e,o,u,r,u,s,c,s,r=i.cellNode.templateCell,e=r.row,o=r.col,u=r.rowEnd,r=r.colEnd,u=u-e+1+n,s=o===r?o:"".concat(o,"-").concat(r),c=this.ptr[s];return(void 0===c&&(c=(0,f.vtr)(this.DJ.expandedCols,i.cellNode),this.ptr[s]=c),this.e9i)?this.IPi(t,n,c,i):(s={cellNode:i.cellNode,value:i.value,group:i,row:e+t,col:o+this._yt,rowCount:u,colCount:r-o+1+c},this.b5i(s)),u},c.prototype.c9i=function(t,n,i,r){n.upParent?this.bPi(t,n,i.crossChildren[n.indexOfLeftParentChildren],r):i.childrenArray[n.indexOfLeftParentChildren][0]&&this.XPi(t,r,i.childrenArray[n.indexOfLeftParentChildren][0])},c.prototype.s9i=function(t,e,o){var u=this,s=o.templateCell,c=s.rowEnd-s.row+1,f=s.colEnd-s.col+1,a=0,h=Math.max.apply(Math,t.map(function(t){return t.length}));return t.forEach(function(t){var n,i,r;if(0!==t.length)if(n=t.length,i=u.mPi(o,t[0].upParent),"No"===s.expansionDirection)u.JLi(e,i,t[0]);else if("V"===s.expansionDirection)for(a=(h-1)*c,r=0;r<n;r++)u.JLi(e+r*c,i,t[r]);else if("H"===s.expansionDirection)for(r=0;r<n;r++)u.JLi(e,i+r*f,t[r])}),a},c.prototype.o9i=function(t){return!(!t.leftParent||!t.upParent)||!(!t.leftParent||!this.o9i(t.leftParent))||!(!t.upParent||!this.o9i(t.upParent))},c.prototype.u9i=function(i,t){var r=this,n=this.f9i(),e=this.DJ.tree.root.treeRange,o=(e.rowEnd-e.row+1)*(t-1);n.forEach(function(t){var n=(0,a.m5i)(t,0,0,0,0);n.row=i.dataCell.row,t.templateCell.row===e.row&&(n.rowCount+=o),r.b5i(n)})},c.prototype.f9i=function(){var t,n,i,t,r,e,o,u,s,c,f;if(!this.h9i)for(this.h9i=[],n=(t=this.n_i).col,i=t.colEnd,r=(t=this.DJ.tree.root.treeRange).row,e=t.rowEnd,o=t.col,u=t.colEnd,s=n;s<=i;s++)if(s!==o){if(s<o||u<s)for(c=r;c<=e;c++)(f=this.sxi.get(c,s))&&!this.h9i.includes(f)&&((0,a.U5i)(this.DJ.templateCellAccessCache,f.templateCell,!0),this.h9i.push(f))}else s=u;return this.h9i},n.VNormalDataPopulator=c},6401:function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.ReportEngine=void 0;var r=i(9034),e=i(7329),o=i(1269),u;function s(t,n){this.cxi=t,this.N3=n}s.prototype.generateReport=function(t){try{performance.now(),this.a9i=new r.ParentChildTreeGenerator(this.cxi).process(),this.l9i=new e.ReportDataGenerator(this.a9i,this.N3);var n=this.l9i._process(t),i=new o.ReportDataService(n,this.l9i.bLi());return performance.now(),null!=t&&t.enablePagination,i}catch(t){return null}},s.prototype.getTreeGenerateResult=function(){return this.a9i},s.prototype.getExpandedContext=function(){var t;return null==(t=this.l9i)?void 0:t.bLi().h5i()},n.ReportEngine=s}},e={},t=function t(n){var i,i,i=e[n];return void 0!==i||(i=e[n]={exports:{}},r[n].call(i.exports,i,i.exports,t)),i.exports}(3607);(o={}).Report=t}(),r=o||{},"object"==typeof t.exports?t.exports=r.Report:void 0!==(n=function(){return r.Report}.apply(n,i=[]))&&(t.exports=n)},Report:function(t){"use strict";t.exports=r.Report},Common:function(t){"use strict";t.exports=r.Spread},CalcEngine:function(t){"use strict";t.exports=r.Spread.CalcEngine},Core:function(t){"use strict";t.exports=r.Spread.Sheets},Bindings:function(t){"use strict";t.exports=r.Spread.Sheets.Bindings},SheetsCalc:function(t){"use strict";t.exports=r.Spread.Sheets.CalcEngine},CellTypes:function(t){"use strict";t.exports=r.Spread.Sheets.CellTypes},Chart:function(t){"use strict";t.exports=r.Spread.Sheets.Charts},ConditionalFormatting:function(t){"use strict";t.exports=r.Spread.Sheets.ConditionalFormatting},Print:function(t){"use strict";t.exports=r.Spread.Sheets.Print},Shapes:function(t){"use strict";t.exports=r.Spread.Sheets.Shapes}},o={},t=i("./dist/plugins/report/report-all-entry.js"),((r=void 0===r?{}:r).Spread=r.Spread||{}).Report=t});